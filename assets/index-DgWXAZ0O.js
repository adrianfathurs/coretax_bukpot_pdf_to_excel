var K1=i=>{throw TypeError(i)};var Md=(i,t,e)=>t.has(i)||K1("Cannot "+e);var Ye=(i,t,e)=>(Md(i,t,"read from private field"),e?e.call(i):t.get(i)),la=(i,t,e)=>t.has(i)?K1("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),si=(i,t,e,n)=>(Md(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),ca=(i,t,e)=>(Md(i,t,"access private method"),e);var W1=(i,t,e,n)=>({set _(r){si(i,t,r,e)},get _(){return Ye(i,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();var bu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ub(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Nd={exports:{}},vl={};var Y1;function zb(){if(Y1)return vl;Y1=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,r,o){var l=null;if(o!==void 0&&(l=""+o),r.key!==void 0&&(l=""+r.key),"key"in r){o={};for(var c in r)c!=="key"&&(o[c]=r[c])}else o=r;return r=o.ref,{$$typeof:i,type:n,key:l,ref:r!==void 0?r:null,props:o}}return vl.Fragment=t,vl.jsx=e,vl.jsxs=e,vl}var q1;function Hb(){return q1||(q1=1,Nd.exports=zb()),Nd.exports}var yt=Hb(),Fd={exports:{}},ie={};var $1;function jb(){if($1)return ie;$1=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function v(M){return M===null||typeof M!="object"?null:(M=m&&M[m]||M["@@iterator"],typeof M=="function"?M:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,A={};function S(M,C,X){this.props=M,this.context=C,this.refs=A,this.updater=X||b}S.prototype.isReactComponent={},S.prototype.setState=function(M,C){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,C,"setState")},S.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function w(){}w.prototype=S.prototype;function E(M,C,X){this.props=M,this.context=C,this.refs=A,this.updater=X||b}var D=E.prototype=new w;D.constructor=E,y(D,S.prototype),D.isPureReactComponent=!0;var P=Array.isArray;function L(){}var R={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function F(M,C,X){var U=X.ref;return{$$typeof:i,type:M,key:C,ref:U!==void 0?U:null,props:X}}function Z(M,C){return F(M.type,C,M.props)}function tt(M){return typeof M=="object"&&M!==null&&M.$$typeof===i}function I(M){var C={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(X){return C[X]})}var nt=/\/+/g;function O(M,C){return typeof M=="object"&&M!==null&&M.key!=null?I(""+M.key):C.toString(36)}function rt(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(L,L):(M.status="pending",M.then(function(C){M.status==="pending"&&(M.status="fulfilled",M.value=C)},function(C){M.status==="pending"&&(M.status="rejected",M.reason=C)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function Q(M,C,X,U,j){var ot=typeof M;(ot==="undefined"||ot==="boolean")&&(M=null);var bt=!1;if(M===null)bt=!0;else switch(ot){case"bigint":case"string":case"number":bt=!0;break;case"object":switch(M.$$typeof){case i:case t:bt=!0;break;case g:return bt=M._init,Q(bt(M._payload),C,X,U,j)}}if(bt)return j=j(M),bt=U===""?"."+O(M,0):U,P(j)?(X="",bt!=null&&(X=bt.replace(nt,"$&/")+"/"),Q(j,C,X,"",function(Mt){return Mt})):j!=null&&(tt(j)&&(j=Z(j,X+(j.key==null||M&&M.key===j.key?"":(""+j.key).replace(nt,"$&/")+"/")+bt)),C.push(j)),1;bt=0;var Ot=U===""?".":U+":";if(P(M))for(var Tt=0;Tt<M.length;Tt++)U=M[Tt],ot=Ot+O(U,Tt),bt+=Q(U,C,X,ot,j);else if(Tt=v(M),typeof Tt=="function")for(M=Tt.call(M),Tt=0;!(U=M.next()).done;)U=U.value,ot=Ot+O(U,Tt++),bt+=Q(U,C,X,ot,j);else if(ot==="object"){if(typeof M.then=="function")return Q(rt(M),C,X,U,j);throw C=String(M),Error("Objects are not valid as a React child (found: "+(C==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":C)+"). If you meant to render a collection of children, use an array instead.")}return bt}function J(M,C,X){if(M==null)return M;var U=[],j=0;return Q(M,U,"","",function(ot){return C.call(X,ot,j++)}),U}function _t(M){if(M._status===-1){var C=M._result;C=C(),C.then(function(X){(M._status===0||M._status===-1)&&(M._status=1,M._result=X)},function(X){(M._status===0||M._status===-1)&&(M._status=2,M._result=X)}),M._status===-1&&(M._status=0,M._result=C)}if(M._status===1)return M._result.default;throw M._result}var vt=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var C=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(C))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)},Nt={map:J,forEach:function(M,C,X){J(M,function(){C.apply(this,arguments)},X)},count:function(M){var C=0;return J(M,function(){C++}),C},toArray:function(M){return J(M,function(C){return C})||[]},only:function(M){if(!tt(M))throw Error("React.Children.only expected to receive a single React element child.");return M}};return ie.Activity=p,ie.Children=Nt,ie.Component=S,ie.Fragment=e,ie.Profiler=r,ie.PureComponent=E,ie.StrictMode=n,ie.Suspense=h,ie.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,ie.__COMPILER_RUNTIME={__proto__:null,c:function(M){return R.H.useMemoCache(M)}},ie.cache=function(M){return function(){return M.apply(null,arguments)}},ie.cacheSignal=function(){return null},ie.cloneElement=function(M,C,X){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var U=y({},M.props),j=M.key;if(C!=null)for(ot in C.key!==void 0&&(j=""+C.key),C)!V.call(C,ot)||ot==="key"||ot==="__self"||ot==="__source"||ot==="ref"&&C.ref===void 0||(U[ot]=C[ot]);var ot=arguments.length-2;if(ot===1)U.children=X;else if(1<ot){for(var bt=Array(ot),Ot=0;Ot<ot;Ot++)bt[Ot]=arguments[Ot+2];U.children=bt}return F(M.type,j,U)},ie.createContext=function(M){return M={$$typeof:l,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:o,_context:M},M},ie.createElement=function(M,C,X){var U,j={},ot=null;if(C!=null)for(U in C.key!==void 0&&(ot=""+C.key),C)V.call(C,U)&&U!=="key"&&U!=="__self"&&U!=="__source"&&(j[U]=C[U]);var bt=arguments.length-2;if(bt===1)j.children=X;else if(1<bt){for(var Ot=Array(bt),Tt=0;Tt<bt;Tt++)Ot[Tt]=arguments[Tt+2];j.children=Ot}if(M&&M.defaultProps)for(U in bt=M.defaultProps,bt)j[U]===void 0&&(j[U]=bt[U]);return F(M,ot,j)},ie.createRef=function(){return{current:null}},ie.forwardRef=function(M){return{$$typeof:c,render:M}},ie.isValidElement=tt,ie.lazy=function(M){return{$$typeof:g,_payload:{_status:-1,_result:M},_init:_t}},ie.memo=function(M,C){return{$$typeof:f,type:M,compare:C===void 0?null:C}},ie.startTransition=function(M){var C=R.T,X={};R.T=X;try{var U=M(),j=R.S;j!==null&&j(X,U),typeof U=="object"&&U!==null&&typeof U.then=="function"&&U.then(L,vt)}catch(ot){vt(ot)}finally{C!==null&&X.types!==null&&(C.types=X.types),R.T=C}},ie.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},ie.use=function(M){return R.H.use(M)},ie.useActionState=function(M,C,X){return R.H.useActionState(M,C,X)},ie.useCallback=function(M,C){return R.H.useCallback(M,C)},ie.useContext=function(M){return R.H.useContext(M)},ie.useDebugValue=function(){},ie.useDeferredValue=function(M,C){return R.H.useDeferredValue(M,C)},ie.useEffect=function(M,C){return R.H.useEffect(M,C)},ie.useEffectEvent=function(M){return R.H.useEffectEvent(M)},ie.useId=function(){return R.H.useId()},ie.useImperativeHandle=function(M,C,X){return R.H.useImperativeHandle(M,C,X)},ie.useInsertionEffect=function(M,C){return R.H.useInsertionEffect(M,C)},ie.useLayoutEffect=function(M,C){return R.H.useLayoutEffect(M,C)},ie.useMemo=function(M,C){return R.H.useMemo(M,C)},ie.useOptimistic=function(M,C){return R.H.useOptimistic(M,C)},ie.useReducer=function(M,C,X){return R.H.useReducer(M,C,X)},ie.useRef=function(M){return R.H.useRef(M)},ie.useState=function(M){return R.H.useState(M)},ie.useSyncExternalStore=function(M,C,X){return R.H.useSyncExternalStore(M,C,X)},ie.useTransition=function(){return R.H.useTransition()},ie.version="19.2.3",ie}var Z1;function A0(){return Z1||(Z1=1,Fd.exports=jb()),Fd.exports}var pa=A0(),Ld={exports:{}},yl={},Bd={exports:{}},Id={};var J1;function Gb(){return J1||(J1=1,(function(i){function t(Q,J){var _t=Q.length;Q.push(J);t:for(;0<_t;){var vt=_t-1>>>1,Nt=Q[vt];if(0<r(Nt,J))Q[vt]=J,Q[_t]=Nt,_t=vt;else break t}}function e(Q){return Q.length===0?null:Q[0]}function n(Q){if(Q.length===0)return null;var J=Q[0],_t=Q.pop();if(_t!==J){Q[0]=_t;t:for(var vt=0,Nt=Q.length,M=Nt>>>1;vt<M;){var C=2*(vt+1)-1,X=Q[C],U=C+1,j=Q[U];if(0>r(X,_t))U<Nt&&0>r(j,X)?(Q[vt]=j,Q[U]=_t,vt=U):(Q[vt]=X,Q[C]=_t,vt=C);else if(U<Nt&&0>r(j,_t))Q[vt]=j,Q[U]=_t,vt=U;else break t}}return J}function r(Q,J){var _t=Q.sortIndex-J.sortIndex;return _t!==0?_t:Q.id-J.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;i.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();i.unstable_now=function(){return l.now()-c}}var h=[],f=[],g=1,p=null,m=3,v=!1,b=!1,y=!1,A=!1,S=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function D(Q){for(var J=e(f);J!==null;){if(J.callback===null)n(f);else if(J.startTime<=Q)n(f),J.sortIndex=J.expirationTime,t(h,J);else break;J=e(f)}}function P(Q){if(y=!1,D(Q),!b)if(e(h)!==null)b=!0,L||(L=!0,I());else{var J=e(f);J!==null&&rt(P,J.startTime-Q)}}var L=!1,R=-1,V=5,F=-1;function Z(){return A?!0:!(i.unstable_now()-F<V)}function tt(){if(A=!1,L){var Q=i.unstable_now();F=Q;var J=!0;try{t:{b=!1,y&&(y=!1,w(R),R=-1),v=!0;var _t=m;try{e:{for(D(Q),p=e(h);p!==null&&!(p.expirationTime>Q&&Z());){var vt=p.callback;if(typeof vt=="function"){p.callback=null,m=p.priorityLevel;var Nt=vt(p.expirationTime<=Q);if(Q=i.unstable_now(),typeof Nt=="function"){p.callback=Nt,D(Q),J=!0;break e}p===e(h)&&n(h),D(Q)}else n(h);p=e(h)}if(p!==null)J=!0;else{var M=e(f);M!==null&&rt(P,M.startTime-Q),J=!1}}break t}finally{p=null,m=_t,v=!1}J=void 0}}finally{J?I():L=!1}}}var I;if(typeof E=="function")I=function(){E(tt)};else if(typeof MessageChannel<"u"){var nt=new MessageChannel,O=nt.port2;nt.port1.onmessage=tt,I=function(){O.postMessage(null)}}else I=function(){S(tt,0)};function rt(Q,J){R=S(function(){Q(i.unstable_now())},J)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Q){Q.callback=null},i.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<Q?Math.floor(1e3/Q):5},i.unstable_getCurrentPriorityLevel=function(){return m},i.unstable_next=function(Q){switch(m){case 1:case 2:case 3:var J=3;break;default:J=m}var _t=m;m=J;try{return Q()}finally{m=_t}},i.unstable_requestPaint=function(){A=!0},i.unstable_runWithPriority=function(Q,J){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var _t=m;m=Q;try{return J()}finally{m=_t}},i.unstable_scheduleCallback=function(Q,J,_t){var vt=i.unstable_now();switch(typeof _t=="object"&&_t!==null?(_t=_t.delay,_t=typeof _t=="number"&&0<_t?vt+_t:vt):_t=vt,Q){case 1:var Nt=-1;break;case 2:Nt=250;break;case 5:Nt=1073741823;break;case 4:Nt=1e4;break;default:Nt=5e3}return Nt=_t+Nt,Q={id:g++,callback:J,priorityLevel:Q,startTime:_t,expirationTime:Nt,sortIndex:-1},_t>vt?(Q.sortIndex=_t,t(f,Q),e(h)===null&&Q===e(f)&&(y?(w(R),R=-1):y=!0,rt(P,_t-vt))):(Q.sortIndex=Nt,t(h,Q),b||v||(b=!0,L||(L=!0,I()))),Q},i.unstable_shouldYield=Z,i.unstable_wrapCallback=function(Q){var J=m;return function(){var _t=m;m=J;try{return Q.apply(this,arguments)}finally{m=_t}}}})(Id)),Id}var Q1;function Vb(){return Q1||(Q1=1,Bd.exports=Gb()),Bd.exports}var Ud={exports:{}},Hn={};var tv;function Xb(){if(tv)return Hn;tv=1;var i=A0();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(h,f,g){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:p==null?null:""+p,children:h,containerInfo:f,implementation:g}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Hn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Hn.createPortal=function(h,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return o(h,f,null,g)},Hn.flushSync=function(h){var f=l.T,g=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=f,n.p=g,n.d.f()}},Hn.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},Hn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Hn.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var g=f.as,p=c(g,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:v}):g==="script"&&n.d.X(h,{crossOrigin:p,integrity:m,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Hn.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=c(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},Hn.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,p=c(g,f.crossOrigin);n.d.L(h,g,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Hn.preloadModule=function(h,f){if(typeof h=="string")if(f){var g=c(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},Hn.requestFormReset=function(h){n.d.r(h)},Hn.unstable_batchedUpdates=function(h,f){return h(f)},Hn.useFormState=function(h,f,g){return l.H.useFormState(h,f,g)},Hn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Hn.version="19.2.3",Hn}var ev;function Kb(){if(ev)return Ud.exports;ev=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),Ud.exports=Xb(),Ud.exports}var nv;function Wb(){if(nv)return yl;nv=1;var i=Vb(),t=A0(),e=Kb();function n(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)s+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function o(a){var s=a,u=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,(s.flags&4098)!==0&&(u=s.return),a=s.return;while(a)}return s.tag===3?u:null}function l(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function c(a){if(a.tag===31){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function h(a){if(o(a)!==a)throw Error(n(188))}function f(a){var s=a.alternate;if(!s){if(s=o(a),s===null)throw Error(n(188));return s!==a?null:a}for(var u=a,d=s;;){var x=u.return;if(x===null)break;var _=x.alternate;if(_===null){if(d=x.return,d!==null){u=d;continue}break}if(x.child===_.child){for(_=x.child;_;){if(_===u)return h(x),a;if(_===d)return h(x),s;_=_.sibling}throw Error(n(188))}if(u.return!==d.return)u=x,d=_;else{for(var T=!1,B=x.child;B;){if(B===u){T=!0,u=x,d=_;break}if(B===d){T=!0,d=x,u=_;break}B=B.sibling}if(!T){for(B=_.child;B;){if(B===u){T=!0,u=_,d=x;break}if(B===d){T=!0,d=_,u=x;break}B=B.sibling}if(!T)throw Error(n(189))}}if(u.alternate!==d)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?a:s}function g(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=g(a),s!==null)return s;a=a.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),E=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),tt=Symbol.iterator;function I(a){return a===null||typeof a!="object"?null:(a=tt&&a[tt]||a["@@iterator"],typeof a=="function"?a:null)}var nt=Symbol.for("react.client.reference");function O(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===nt?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case y:return"Fragment";case S:return"Profiler";case A:return"StrictMode";case P:return"Suspense";case L:return"SuspenseList";case F:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case b:return"Portal";case E:return a.displayName||"Context";case w:return(a._context.displayName||"Context")+".Consumer";case D:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case R:return s=a.displayName||null,s!==null?s:O(a.type)||"Memo";case V:s=a._payload,a=a._init;try{return O(a(s))}catch{}}return null}var rt=Array.isArray,Q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_t={pending:!1,data:null,method:null,action:null},vt=[],Nt=-1;function M(a){return{current:a}}function C(a){0>Nt||(a.current=vt[Nt],vt[Nt]=null,Nt--)}function X(a,s){Nt++,vt[Nt]=a.current,a.current=s}var U=M(null),j=M(null),ot=M(null),bt=M(null);function Ot(a,s){switch(X(ot,s),X(j,a),X(U,null),s.nodeType){case 9:case 11:a=(a=s.documentElement)&&(a=a.namespaceURI)?p1(a):0;break;default:if(a=s.tagName,s=s.namespaceURI)s=p1(s),a=m1(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}C(U),X(U,a)}function Tt(){C(U),C(j),C(ot)}function Mt(a){a.memoizedState!==null&&X(bt,a);var s=U.current,u=m1(s,a.type);s!==u&&(X(j,a),X(U,u))}function Zt(a){j.current===a&&(C(U),C(j)),bt.current===a&&(C(bt),dl._currentValue=_t)}var te,ve;function k(a){if(te===void 0)try{throw Error()}catch(u){var s=u.stack.trim().match(/\n( *(at )?)/);te=s&&s[1]||"",ve=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+te+a+ve}var St=!1;function lt(a,s){if(!a||St)return"";St=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(s){var Dt=function(){throw Error()};if(Object.defineProperty(Dt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Dt,[])}catch(xt){var pt=xt}Reflect.construct(a,[],Dt)}else{try{Dt.call()}catch(xt){pt=xt}a.call(Dt.prototype)}}else{try{throw Error()}catch(xt){pt=xt}(Dt=a())&&typeof Dt.catch=="function"&&Dt.catch(function(){})}}catch(xt){if(xt&&pt&&typeof xt.stack=="string")return[xt.stack,pt.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=d.DetermineComponentFrameRoot(),T=_[0],B=_[1];if(T&&B){var et=T.split(`
`),ut=B.split(`
`);for(x=d=0;d<et.length&&!et[d].includes("DetermineComponentFrameRoot");)d++;for(;x<ut.length&&!ut[x].includes("DetermineComponentFrameRoot");)x++;if(d===et.length||x===ut.length)for(d=et.length-1,x=ut.length-1;1<=d&&0<=x&&et[d]!==ut[x];)x--;for(;1<=d&&0<=x;d--,x--)if(et[d]!==ut[x]){if(d!==1||x!==1)do if(d--,x--,0>x||et[d]!==ut[x]){var wt=`
`+et[d].replace(" at new "," at ");return a.displayName&&wt.includes("<anonymous>")&&(wt=wt.replace("<anonymous>",a.displayName)),wt}while(1<=d&&0<=x);break}}}finally{St=!1,Error.prepareStackTrace=u}return(u=a?a.displayName||a.name:"")?k(u):""}function z(a,s){switch(a.tag){case 26:case 27:case 5:return k(a.type);case 16:return k("Lazy");case 13:return a.child!==s&&s!==null?k("Suspense Fallback"):k("Suspense");case 19:return k("SuspenseList");case 0:case 15:return lt(a.type,!1);case 11:return lt(a.type.render,!1);case 1:return lt(a.type,!0);case 31:return k("Activity");default:return""}}function K(a){try{var s="",u=null;do s+=z(a,u),u=a,a=a.return;while(a);return s}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var at=Object.prototype.hasOwnProperty,kt=i.unstable_scheduleCallback,Rt=i.unstable_cancelCallback,ht=i.unstable_shouldYield,Bt=i.unstable_requestPaint,It=i.unstable_now,Ut=i.unstable_getCurrentPriorityLevel,$t=i.unstable_ImmediatePriority,ye=i.unstable_UserBlockingPriority,ne=i.unstable_NormalPriority,zn=i.unstable_LowPriority,Ki=i.unstable_IdlePriority,Vn=i.log,na=i.unstable_setDisableYieldValue,Te=null,an=null;function Xn(a){if(typeof Vn=="function"&&na(a),an&&typeof an.setStrictMode=="function")try{an.setStrictMode(Te,a)}catch{}}var je=Math.clz32?Math.clz32:ms,gs=Math.log,ps=Math.LN2;function ms(a){return a>>>=0,a===0?32:31-(gs(a)/ps|0)|0}var xa=256,_a=262144,Ci=4194304;function Cn(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function vs(a,s,u){var d=a.pendingLanes;if(d===0)return 0;var x=0,_=a.suspendedLanes,T=a.pingedLanes;a=a.warmLanes;var B=d&134217727;return B!==0?(d=B&~_,d!==0?x=Cn(d):(T&=B,T!==0?x=Cn(T):u||(u=B&~a,u!==0&&(x=Cn(u))))):(B=d&~_,B!==0?x=Cn(B):T!==0?x=Cn(T):u||(u=d&~a,u!==0&&(x=Cn(u)))),x===0?0:s!==0&&s!==x&&(s&_)===0&&(_=x&-x,u=s&-s,_>=u||_===32&&(u&4194048)!==0)?s:x}function Or(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function Sh(a,s){switch(a){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oc(){var a=Ci;return Ci<<=1,(Ci&62914560)===0&&(Ci=4194304),a}function To(a){for(var s=[],u=0;31>u;u++)s.push(a);return s}function Rr(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function wh(a,s,u,d,x,_){var T=a.pendingLanes;a.pendingLanes=u,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=u,a.entangledLanes&=u,a.errorRecoveryDisabledLanes&=u,a.shellSuspendCounter=0;var B=a.entanglements,et=a.expirationTimes,ut=a.hiddenUpdates;for(u=T&~u;0<u;){var wt=31-je(u),Dt=1<<wt;B[wt]=0,et[wt]=-1;var pt=ut[wt];if(pt!==null)for(ut[wt]=null,wt=0;wt<pt.length;wt++){var xt=pt[wt];xt!==null&&(xt.lane&=-536870913)}u&=~Dt}d!==0&&lc(a,d,0),_!==0&&x===0&&a.tag!==0&&(a.suspendedLanes|=_&~(T&~s))}function lc(a,s,u){a.pendingLanes|=s,a.suspendedLanes&=~s;var d=31-je(s);a.entangledLanes|=s,a.entanglements[d]=a.entanglements[d]|1073741824|u&261930}function ys(a,s){var u=a.entangledLanes|=s;for(a=a.entanglements;u;){var d=31-je(u),x=1<<d;x&s|a[d]&s&&(a[d]|=s),u&=~x}}function cc(a,s){var u=s&-s;return u=(u&42)!==0?1:Co(u),(u&(a.suspendedLanes|s))!==0?0:u}function Co(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function ko(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function N(){var a=J.p;return a!==0?a:(a=window.event,a===void 0?32:U1(a.type))}function Y(a,s){var u=J.p;try{return J.p=a,s()}finally{J.p=u}}var H=Math.random().toString(36).slice(2),G="__reactFiber$"+H,W="__reactProps$"+H,q="__reactContainer$"+H,ft="__reactEvents$"+H,Et="__reactListeners$"+H,dt="__reactHandles$"+H,gt="__reactResources$"+H,mt="__reactMarker$"+H;function Ft(a){delete a[G],delete a[W],delete a[ft],delete a[Et],delete a[dt]}function zt(a){var s=a[G];if(s)return s;for(var u=a.parentNode;u;){if(s=u[q]||u[G]){if(u=s.alternate,s.child!==null||u!==null&&u.child!==null)for(a=S1(a);a!==null;){if(u=a[G])return u;a=S1(a)}return s}a=u,u=a.parentNode}return null}function Vt(a){if(a=a[G]||a[q]){var s=a.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return a}return null}function Lt(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(n(33))}function Gt(a){var s=a[gt];return s||(s=a[gt]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Yt(a){a[mt]=!0}var ze=new Set,He={};function Ke(a,s){ki(a,s),ki(a+"Capture",s)}function ki(a,s){for(He[a]=s,a=0;a<s.length;a++)ze.add(s[a])}var Pr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qa={},ia={};function Do(a){return at.call(ia,a)?!0:at.call(qa,a)?!1:Pr.test(a)?ia[a]=!0:(qa[a]=!0,!1)}function Qn(a,s,u){if(Do(s))if(u===null)a.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var d=s.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+u)}}function uc(a,s,u){if(u===null)a.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+u)}}function ba(a,s,u,d){if(d===null)a.removeAttribute(u);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(u);return}a.setAttributeNS(s,u,""+d)}}function Di(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function og(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Px(a,s,u){var d=Object.getOwnPropertyDescriptor(a.constructor.prototype,s);if(!a.hasOwnProperty(s)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,_=d.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return x.call(this)},set:function(T){u=""+T,_.call(this,T)}}),Object.defineProperty(a,s,{enumerable:d.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function Eh(a){if(!a._valueTracker){var s=og(a)?"checked":"value";a._valueTracker=Px(a,s,""+a[s])}}function lg(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var u=s.getValue(),d="";return a&&(d=og(a)?a.checked?"true":"false":a.value),a=d,a!==u?(s.setValue(a),!0):!1}function hc(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Mx=/[\n"\\]/g;function Oi(a){return a.replace(Mx,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Th(a,s,u,d,x,_,T,B){a.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?a.type=T:a.removeAttribute("type"),s!=null?T==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+Di(s)):a.value!==""+Di(s)&&(a.value=""+Di(s)):T!=="submit"&&T!=="reset"||a.removeAttribute("value"),s!=null?Ch(a,T,Di(s)):u!=null?Ch(a,T,Di(u)):d!=null&&a.removeAttribute("value"),x==null&&_!=null&&(a.defaultChecked=!!_),x!=null&&(a.checked=x&&typeof x!="function"&&typeof x!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?a.name=""+Di(B):a.removeAttribute("name")}function cg(a,s,u,d,x,_,T,B){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(a.type=_),s!=null||u!=null){if(!(_!=="submit"&&_!=="reset"||s!=null)){Eh(a);return}u=u!=null?""+Di(u):"",s=s!=null?""+Di(s):u,B||s===a.value||(a.value=s),a.defaultValue=s}d=d??x,d=typeof d!="function"&&typeof d!="symbol"&&!!d,a.checked=B?a.checked:!!d,a.defaultChecked=!!d,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(a.name=T),Eh(a)}function Ch(a,s,u){s==="number"&&hc(a.ownerDocument)===a||a.defaultValue===""+u||(a.defaultValue=""+u)}function xs(a,s,u,d){if(a=a.options,s){s={};for(var x=0;x<u.length;x++)s["$"+u[x]]=!0;for(u=0;u<a.length;u++)x=s.hasOwnProperty("$"+a[u].value),a[u].selected!==x&&(a[u].selected=x),x&&d&&(a[u].defaultSelected=!0)}else{for(u=""+Di(u),s=null,x=0;x<a.length;x++){if(a[x].value===u){a[x].selected=!0,d&&(a[x].defaultSelected=!0);return}s!==null||a[x].disabled||(s=a[x])}s!==null&&(s.selected=!0)}}function ug(a,s,u){if(s!=null&&(s=""+Di(s),s!==a.value&&(a.value=s),u==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=u!=null?""+Di(u):""}function hg(a,s,u,d){if(s==null){if(d!=null){if(u!=null)throw Error(n(92));if(rt(d)){if(1<d.length)throw Error(n(93));d=d[0]}u=d}u==null&&(u=""),s=u}u=Di(s),a.defaultValue=u,d=a.textContent,d===u&&d!==""&&d!==null&&(a.value=d),Eh(a)}function _s(a,s){if(s){var u=a.firstChild;if(u&&u===a.lastChild&&u.nodeType===3){u.nodeValue=s;return}}a.textContent=s}var Nx=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fg(a,s,u){var d=s.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?d?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":d?a.setProperty(s,u):typeof u!="number"||u===0||Nx.has(s)?s==="float"?a.cssFloat=u:a[s]=(""+u).trim():a[s]=u+"px"}function dg(a,s,u){if(s!=null&&typeof s!="object")throw Error(n(62));if(a=a.style,u!=null){for(var d in u)!u.hasOwnProperty(d)||s!=null&&s.hasOwnProperty(d)||(d.indexOf("--")===0?a.setProperty(d,""):d==="float"?a.cssFloat="":a[d]="");for(var x in s)d=s[x],s.hasOwnProperty(x)&&u[x]!==d&&fg(a,x,d)}else for(var _ in s)s.hasOwnProperty(_)&&fg(a,_,s[_])}function kh(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fx=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Lx=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function fc(a){return Lx.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Aa(){}var Dh=null;function Oh(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var bs=null,As=null;function gg(a){var s=Vt(a);if(s&&(a=s.stateNode)){var u=a[W]||null;t:switch(a=s.stateNode,s.type){case"input":if(Th(a,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),s=u.name,u.type==="radio"&&s!=null){for(u=a;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Oi(""+s)+'"][type="radio"]'),s=0;s<u.length;s++){var d=u[s];if(d!==a&&d.form===a.form){var x=d[W]||null;if(!x)throw Error(n(90));Th(d,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(s=0;s<u.length;s++)d=u[s],d.form===a.form&&lg(d)}break t;case"textarea":ug(a,u.value,u.defaultValue);break t;case"select":s=u.value,s!=null&&xs(a,!!u.multiple,s,!1)}}}var Rh=!1;function pg(a,s,u){if(Rh)return a(s,u);Rh=!0;try{var d=a(s);return d}finally{if(Rh=!1,(bs!==null||As!==null)&&(Qc(),bs&&(s=bs,a=As,As=bs=null,gg(s),a)))for(s=0;s<a.length;s++)gg(a[s])}}function Oo(a,s){var u=a.stateNode;if(u===null)return null;var d=u[W]||null;if(d===null)return null;u=d[s];t:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(a=a.type,d=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!d;break t;default:a=!1}if(a)return null;if(u&&typeof u!="function")throw Error(n(231,s,typeof u));return u}var Sa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ph=!1;if(Sa)try{var Ro={};Object.defineProperty(Ro,"passive",{get:function(){Ph=!0}}),window.addEventListener("test",Ro,Ro),window.removeEventListener("test",Ro,Ro)}catch{Ph=!1}var $a=null,Mh=null,dc=null;function mg(){if(dc)return dc;var a,s=Mh,u=s.length,d,x="value"in $a?$a.value:$a.textContent,_=x.length;for(a=0;a<u&&s[a]===x[a];a++);var T=u-a;for(d=1;d<=T&&s[u-d]===x[_-d];d++);return dc=x.slice(a,1<d?1-d:void 0)}function gc(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function pc(){return!0}function vg(){return!1}function ti(a){function s(u,d,x,_,T){this._reactName=u,this._targetInst=x,this.type=d,this.nativeEvent=_,this.target=T,this.currentTarget=null;for(var B in a)a.hasOwnProperty(B)&&(u=a[B],this[B]=u?u(_):_[B]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?pc:vg,this.isPropagationStopped=vg,this}return p(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=pc)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=pc)},persist:function(){},isPersistent:pc}),s}var Mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mc=ti(Mr),Po=p({},Mr,{view:0,detail:0}),Bx=ti(Po),Nh,Fh,Mo,vc=p({},Po,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bh,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Mo&&(Mo&&a.type==="mousemove"?(Nh=a.screenX-Mo.screenX,Fh=a.screenY-Mo.screenY):Fh=Nh=0,Mo=a),Nh)},movementY:function(a){return"movementY"in a?a.movementY:Fh}}),yg=ti(vc),Ix=p({},vc,{dataTransfer:0}),Ux=ti(Ix),zx=p({},Po,{relatedTarget:0}),Lh=ti(zx),Hx=p({},Mr,{animationName:0,elapsedTime:0,pseudoElement:0}),jx=ti(Hx),Gx=p({},Mr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Vx=ti(Gx),Xx=p({},Mr,{data:0}),xg=ti(Xx),Kx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qx(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=Yx[a])?!!s[a]:!1}function Bh(){return qx}var $x=p({},Po,{key:function(a){if(a.key){var s=Kx[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=gc(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Wx[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bh,charCode:function(a){return a.type==="keypress"?gc(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?gc(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Zx=ti($x),Jx=p({},vc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_g=ti(Jx),Qx=p({},Po,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bh}),t_=ti(Qx),e_=p({},Mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),n_=ti(e_),i_=p({},vc,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),a_=ti(i_),r_=p({},Mr,{newState:0,oldState:0}),s_=ti(r_),o_=[9,13,27,32],Ih=Sa&&"CompositionEvent"in window,No=null;Sa&&"documentMode"in document&&(No=document.documentMode);var l_=Sa&&"TextEvent"in window&&!No,bg=Sa&&(!Ih||No&&8<No&&11>=No),Ag=" ",Sg=!1;function wg(a,s){switch(a){case"keyup":return o_.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Eg(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ss=!1;function c_(a,s){switch(a){case"compositionend":return Eg(s);case"keypress":return s.which!==32?null:(Sg=!0,Ag);case"textInput":return a=s.data,a===Ag&&Sg?null:a;default:return null}}function u_(a,s){if(Ss)return a==="compositionend"||!Ih&&wg(a,s)?(a=mg(),dc=Mh=$a=null,Ss=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return bg&&s.locale!=="ko"?null:s.data;default:return null}}var h_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tg(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!h_[a.type]:s==="textarea"}function Cg(a,s,u,d){bs?As?As.push(d):As=[d]:bs=d,s=su(s,"onChange"),0<s.length&&(u=new mc("onChange","change",null,u,d),a.push({event:u,listeners:s}))}var Fo=null,Lo=null;function f_(a){c1(a,0)}function yc(a){var s=Lt(a);if(lg(s))return a}function kg(a,s){if(a==="change")return s}var Dg=!1;if(Sa){var Uh;if(Sa){var zh="oninput"in document;if(!zh){var Og=document.createElement("div");Og.setAttribute("oninput","return;"),zh=typeof Og.oninput=="function"}Uh=zh}else Uh=!1;Dg=Uh&&(!document.documentMode||9<document.documentMode)}function Rg(){Fo&&(Fo.detachEvent("onpropertychange",Pg),Lo=Fo=null)}function Pg(a){if(a.propertyName==="value"&&yc(Lo)){var s=[];Cg(s,Lo,a,Oh(a)),pg(f_,s)}}function d_(a,s,u){a==="focusin"?(Rg(),Fo=s,Lo=u,Fo.attachEvent("onpropertychange",Pg)):a==="focusout"&&Rg()}function g_(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return yc(Lo)}function p_(a,s){if(a==="click")return yc(s)}function m_(a,s){if(a==="input"||a==="change")return yc(s)}function v_(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var fi=typeof Object.is=="function"?Object.is:v_;function Bo(a,s){if(fi(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var u=Object.keys(a),d=Object.keys(s);if(u.length!==d.length)return!1;for(d=0;d<u.length;d++){var x=u[d];if(!at.call(s,x)||!fi(a[x],s[x]))return!1}return!0}function Mg(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Ng(a,s){var u=Mg(a);a=0;for(var d;u;){if(u.nodeType===3){if(d=a+u.textContent.length,a<=s&&d>=s)return{node:u,offset:s-a};a=d}t:{for(;u;){if(u.nextSibling){u=u.nextSibling;break t}u=u.parentNode}u=void 0}u=Mg(u)}}function Fg(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?Fg(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function Lg(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=hc(a.document);s instanceof a.HTMLIFrameElement;){try{var u=typeof s.contentWindow.location.href=="string"}catch{u=!1}if(u)a=s.contentWindow;else break;s=hc(a.document)}return s}function Hh(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}var y_=Sa&&"documentMode"in document&&11>=document.documentMode,ws=null,jh=null,Io=null,Gh=!1;function Bg(a,s,u){var d=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Gh||ws==null||ws!==hc(d)||(d=ws,"selectionStart"in d&&Hh(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Io&&Bo(Io,d)||(Io=d,d=su(jh,"onSelect"),0<d.length&&(s=new mc("onSelect","select",null,s,u),a.push({event:s,listeners:d}),s.target=ws)))}function Nr(a,s){var u={};return u[a.toLowerCase()]=s.toLowerCase(),u["Webkit"+a]="webkit"+s,u["Moz"+a]="moz"+s,u}var Es={animationend:Nr("Animation","AnimationEnd"),animationiteration:Nr("Animation","AnimationIteration"),animationstart:Nr("Animation","AnimationStart"),transitionrun:Nr("Transition","TransitionRun"),transitionstart:Nr("Transition","TransitionStart"),transitioncancel:Nr("Transition","TransitionCancel"),transitionend:Nr("Transition","TransitionEnd")},Vh={},Ig={};Sa&&(Ig=document.createElement("div").style,"AnimationEvent"in window||(delete Es.animationend.animation,delete Es.animationiteration.animation,delete Es.animationstart.animation),"TransitionEvent"in window||delete Es.transitionend.transition);function Fr(a){if(Vh[a])return Vh[a];if(!Es[a])return a;var s=Es[a],u;for(u in s)if(s.hasOwnProperty(u)&&u in Ig)return Vh[a]=s[u];return a}var Ug=Fr("animationend"),zg=Fr("animationiteration"),Hg=Fr("animationstart"),x_=Fr("transitionrun"),__=Fr("transitionstart"),b_=Fr("transitioncancel"),jg=Fr("transitionend"),Gg=new Map,Xh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Xh.push("scrollEnd");function Wi(a,s){Gg.set(a,s),Ke(s,[a])}var xc=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Ri=[],Ts=0,Kh=0;function _c(){for(var a=Ts,s=Kh=Ts=0;s<a;){var u=Ri[s];Ri[s++]=null;var d=Ri[s];Ri[s++]=null;var x=Ri[s];Ri[s++]=null;var _=Ri[s];if(Ri[s++]=null,d!==null&&x!==null){var T=d.pending;T===null?x.next=x:(x.next=T.next,T.next=x),d.pending=x}_!==0&&Vg(u,x,_)}}function bc(a,s,u,d){Ri[Ts++]=a,Ri[Ts++]=s,Ri[Ts++]=u,Ri[Ts++]=d,Kh|=d,a.lanes|=d,a=a.alternate,a!==null&&(a.lanes|=d)}function Wh(a,s,u,d){return bc(a,s,u,d),Ac(a)}function Lr(a,s){return bc(a,null,null,s),Ac(a)}function Vg(a,s,u){a.lanes|=u;var d=a.alternate;d!==null&&(d.lanes|=u);for(var x=!1,_=a.return;_!==null;)_.childLanes|=u,d=_.alternate,d!==null&&(d.childLanes|=u),_.tag===22&&(a=_.stateNode,a===null||a._visibility&1||(x=!0)),a=_,_=_.return;return a.tag===3?(_=a.stateNode,x&&s!==null&&(x=31-je(u),a=_.hiddenUpdates,d=a[x],d===null?a[x]=[s]:d.push(s),s.lane=u|536870912),_):null}function Ac(a){if(50<sl)throw sl=0,id=null,Error(n(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var Cs={};function A_(a,s,u,d){this.tag=a,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(a,s,u,d){return new A_(a,s,u,d)}function Yh(a){return a=a.prototype,!(!a||!a.isReactComponent)}function wa(a,s){var u=a.alternate;return u===null?(u=di(a.tag,s,a.key,a.mode),u.elementType=a.elementType,u.type=a.type,u.stateNode=a.stateNode,u.alternate=a,a.alternate=u):(u.pendingProps=s,u.type=a.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=a.flags&65011712,u.childLanes=a.childLanes,u.lanes=a.lanes,u.child=a.child,u.memoizedProps=a.memoizedProps,u.memoizedState=a.memoizedState,u.updateQueue=a.updateQueue,s=a.dependencies,u.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},u.sibling=a.sibling,u.index=a.index,u.ref=a.ref,u.refCleanup=a.refCleanup,u}function Xg(a,s){a.flags&=65011714;var u=a.alternate;return u===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,s=u.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function Sc(a,s,u,d,x,_){var T=0;if(d=a,typeof a=="function")Yh(a)&&(T=1);else if(typeof a=="string")T=Cb(a,u,U.current)?26:a==="html"||a==="head"||a==="body"?27:5;else t:switch(a){case F:return a=di(31,u,s,x),a.elementType=F,a.lanes=_,a;case y:return Br(u.children,x,_,s);case A:T=8,x|=24;break;case S:return a=di(12,u,s,x|2),a.elementType=S,a.lanes=_,a;case P:return a=di(13,u,s,x),a.elementType=P,a.lanes=_,a;case L:return a=di(19,u,s,x),a.elementType=L,a.lanes=_,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case E:T=10;break t;case w:T=9;break t;case D:T=11;break t;case R:T=14;break t;case V:T=16,d=null;break t}T=29,u=Error(n(130,a===null?"null":typeof a,"")),d=null}return s=di(T,u,s,x),s.elementType=a,s.type=d,s.lanes=_,s}function Br(a,s,u,d){return a=di(7,a,d,s),a.lanes=u,a}function qh(a,s,u){return a=di(6,a,null,s),a.lanes=u,a}function Kg(a){var s=di(18,null,null,0);return s.stateNode=a,s}function $h(a,s,u){return s=di(4,a.children!==null?a.children:[],a.key,s),s.lanes=u,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}var Wg=new WeakMap;function Pi(a,s){if(typeof a=="object"&&a!==null){var u=Wg.get(a);return u!==void 0?u:(s={value:a,source:s,stack:K(s)},Wg.set(a,s),s)}return{value:a,source:s,stack:K(s)}}var ks=[],Ds=0,wc=null,Uo=0,Mi=[],Ni=0,Za=null,aa=1,ra="";function Ea(a,s){ks[Ds++]=Uo,ks[Ds++]=wc,wc=a,Uo=s}function Yg(a,s,u){Mi[Ni++]=aa,Mi[Ni++]=ra,Mi[Ni++]=Za,Za=a;var d=aa;a=ra;var x=32-je(d)-1;d&=~(1<<x),u+=1;var _=32-je(s)+x;if(30<_){var T=x-x%5;_=(d&(1<<T)-1).toString(32),d>>=T,x-=T,aa=1<<32-je(s)+x|u<<x|d,ra=_+a}else aa=1<<_|u<<x|d,ra=a}function Zh(a){a.return!==null&&(Ea(a,1),Yg(a,1,0))}function Jh(a){for(;a===wc;)wc=ks[--Ds],ks[Ds]=null,Uo=ks[--Ds],ks[Ds]=null;for(;a===Za;)Za=Mi[--Ni],Mi[Ni]=null,ra=Mi[--Ni],Mi[Ni]=null,aa=Mi[--Ni],Mi[Ni]=null}function qg(a,s){Mi[Ni++]=aa,Mi[Ni++]=ra,Mi[Ni++]=Za,aa=s.id,ra=s.overflow,Za=a}var kn=null,Ge=null,ge=!1,Ja=null,Fi=!1,Qh=Error(n(519));function Qa(a){var s=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw zo(Pi(s,a)),Qh}function $g(a){var s=a.stateNode,u=a.type,d=a.memoizedProps;switch(s[G]=a,s[W]=d,u){case"dialog":he("cancel",s),he("close",s);break;case"iframe":case"object":case"embed":he("load",s);break;case"video":case"audio":for(u=0;u<ll.length;u++)he(ll[u],s);break;case"source":he("error",s);break;case"img":case"image":case"link":he("error",s),he("load",s);break;case"details":he("toggle",s);break;case"input":he("invalid",s),cg(s,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":he("invalid",s);break;case"textarea":he("invalid",s),hg(s,d.value,d.defaultValue,d.children)}u=d.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||s.textContent===""+u||d.suppressHydrationWarning===!0||d1(s.textContent,u)?(d.popover!=null&&(he("beforetoggle",s),he("toggle",s)),d.onScroll!=null&&he("scroll",s),d.onScrollEnd!=null&&he("scrollend",s),d.onClick!=null&&(s.onclick=Aa),s=!0):s=!1,s||Qa(a,!0)}function Zg(a){for(kn=a.return;kn;)switch(kn.tag){case 5:case 31:case 13:Fi=!1;return;case 27:case 3:Fi=!0;return;default:kn=kn.return}}function Os(a){if(a!==kn)return!1;if(!ge)return Zg(a),ge=!0,!1;var s=a.tag,u;if((u=s!==3&&s!==27)&&((u=s===5)&&(u=a.type,u=!(u!=="form"&&u!=="button")||yd(a.type,a.memoizedProps)),u=!u),u&&Ge&&Qa(a),Zg(a),s===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Ge=A1(a)}else if(s===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Ge=A1(a)}else s===27?(s=Ge,dr(a.type)?(a=Sd,Sd=null,Ge=a):Ge=s):Ge=kn?Bi(a.stateNode.nextSibling):null;return!0}function Ir(){Ge=kn=null,ge=!1}function tf(){var a=Ja;return a!==null&&(ai===null?ai=a:ai.push.apply(ai,a),Ja=null),a}function zo(a){Ja===null?Ja=[a]:Ja.push(a)}var ef=M(null),Ur=null,Ta=null;function tr(a,s,u){X(ef,s._currentValue),s._currentValue=u}function Ca(a){a._currentValue=ef.current,C(ef)}function nf(a,s,u){for(;a!==null;){var d=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,d!==null&&(d.childLanes|=s)):d!==null&&(d.childLanes&s)!==s&&(d.childLanes|=s),a===u)break;a=a.return}}function af(a,s,u,d){var x=a.child;for(x!==null&&(x.return=a);x!==null;){var _=x.dependencies;if(_!==null){var T=x.child;_=_.firstContext;t:for(;_!==null;){var B=_;_=x;for(var et=0;et<s.length;et++)if(B.context===s[et]){_.lanes|=u,B=_.alternate,B!==null&&(B.lanes|=u),nf(_.return,u,a),d||(T=null);break t}_=B.next}}else if(x.tag===18){if(T=x.return,T===null)throw Error(n(341));T.lanes|=u,_=T.alternate,_!==null&&(_.lanes|=u),nf(T,u,a),T=null}else T=x.child;if(T!==null)T.return=x;else for(T=x;T!==null;){if(T===a){T=null;break}if(x=T.sibling,x!==null){x.return=T.return,T=x;break}T=T.return}x=T}}function Rs(a,s,u,d){a=null;for(var x=s,_=!1;x!==null;){if(!_){if((x.flags&524288)!==0)_=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var T=x.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var B=x.type;fi(x.pendingProps.value,T.value)||(a!==null?a.push(B):a=[B])}}else if(x===bt.current){if(T=x.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(a!==null?a.push(dl):a=[dl])}x=x.return}a!==null&&af(s,a,u,d),s.flags|=262144}function Ec(a){for(a=a.firstContext;a!==null;){if(!fi(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function zr(a){Ur=a,Ta=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Dn(a){return Jg(Ur,a)}function Tc(a,s){return Ur===null&&zr(a),Jg(a,s)}function Jg(a,s){var u=s._currentValue;if(s={context:s,memoizedValue:u,next:null},Ta===null){if(a===null)throw Error(n(308));Ta=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else Ta=Ta.next=s;return u}var S_=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(u,d){a.push(d)}};this.abort=function(){s.aborted=!0,a.forEach(function(u){return u()})}},w_=i.unstable_scheduleCallback,E_=i.unstable_NormalPriority,ln={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function rf(){return{controller:new S_,data:new Map,refCount:0}}function Ho(a){a.refCount--,a.refCount===0&&w_(E_,function(){a.controller.abort()})}var jo=null,sf=0,Ps=0,Ms=null;function T_(a,s){if(jo===null){var u=jo=[];sf=0,Ps=cd(),Ms={status:"pending",value:void 0,then:function(d){u.push(d)}}}return sf++,s.then(Qg,Qg),s}function Qg(){if(--sf===0&&jo!==null){Ms!==null&&(Ms.status="fulfilled");var a=jo;jo=null,Ps=0,Ms=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function C_(a,s){var u=[],d={status:"pending",value:null,reason:null,then:function(x){u.push(x)}};return a.then(function(){d.status="fulfilled",d.value=s;for(var x=0;x<u.length;x++)(0,u[x])(s)},function(x){for(d.status="rejected",d.reason=x,x=0;x<u.length;x++)(0,u[x])(void 0)}),d}var tp=Q.S;Q.S=function(a,s){Bm=It(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&T_(a,s),tp!==null&&tp(a,s)};var Hr=M(null);function of(){var a=Hr.current;return a!==null?a:Ie.pooledCache}function Cc(a,s){s===null?X(Hr,Hr.current):X(Hr,s.pool)}function ep(){var a=of();return a===null?null:{parent:ln._currentValue,pool:a}}var Ns=Error(n(460)),lf=Error(n(474)),kc=Error(n(542)),Dc={then:function(){}};function np(a){return a=a.status,a==="fulfilled"||a==="rejected"}function ip(a,s,u){switch(u=a[u],u===void 0?a.push(s):u!==s&&(s.then(Aa,Aa),s=u),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,rp(a),a;default:if(typeof s.status=="string")s.then(Aa,Aa);else{if(a=Ie,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=s,a.status="pending",a.then(function(d){if(s.status==="pending"){var x=s;x.status="fulfilled",x.value=d}},function(d){if(s.status==="pending"){var x=s;x.status="rejected",x.reason=d}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,rp(a),a}throw Gr=s,Ns}}function jr(a){try{var s=a._init;return s(a._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Gr=u,Ns):u}}var Gr=null;function ap(){if(Gr===null)throw Error(n(459));var a=Gr;return Gr=null,a}function rp(a){if(a===Ns||a===kc)throw Error(n(483))}var Fs=null,Go=0;function Oc(a){var s=Go;return Go+=1,Fs===null&&(Fs=[]),ip(Fs,a,s)}function Vo(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function Rc(a,s){throw s.$$typeof===m?Error(n(525)):(a=Object.prototype.toString.call(s),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function sp(a){function s(st,it){if(a){var ct=st.deletions;ct===null?(st.deletions=[it],st.flags|=16):ct.push(it)}}function u(st,it){if(!a)return null;for(;it!==null;)s(st,it),it=it.sibling;return null}function d(st){for(var it=new Map;st!==null;)st.key!==null?it.set(st.key,st):it.set(st.index,st),st=st.sibling;return it}function x(st,it){return st=wa(st,it),st.index=0,st.sibling=null,st}function _(st,it,ct){return st.index=ct,a?(ct=st.alternate,ct!==null?(ct=ct.index,ct<it?(st.flags|=67108866,it):ct):(st.flags|=67108866,it)):(st.flags|=1048576,it)}function T(st){return a&&st.alternate===null&&(st.flags|=67108866),st}function B(st,it,ct,Ct){return it===null||it.tag!==6?(it=qh(ct,st.mode,Ct),it.return=st,it):(it=x(it,ct),it.return=st,it)}function et(st,it,ct,Ct){var Jt=ct.type;return Jt===y?wt(st,it,ct.props.children,Ct,ct.key):it!==null&&(it.elementType===Jt||typeof Jt=="object"&&Jt!==null&&Jt.$$typeof===V&&jr(Jt)===it.type)?(it=x(it,ct.props),Vo(it,ct),it.return=st,it):(it=Sc(ct.type,ct.key,ct.props,null,st.mode,Ct),Vo(it,ct),it.return=st,it)}function ut(st,it,ct,Ct){return it===null||it.tag!==4||it.stateNode.containerInfo!==ct.containerInfo||it.stateNode.implementation!==ct.implementation?(it=$h(ct,st.mode,Ct),it.return=st,it):(it=x(it,ct.children||[]),it.return=st,it)}function wt(st,it,ct,Ct,Jt){return it===null||it.tag!==7?(it=Br(ct,st.mode,Ct,Jt),it.return=st,it):(it=x(it,ct),it.return=st,it)}function Dt(st,it,ct){if(typeof it=="string"&&it!==""||typeof it=="number"||typeof it=="bigint")return it=qh(""+it,st.mode,ct),it.return=st,it;if(typeof it=="object"&&it!==null){switch(it.$$typeof){case v:return ct=Sc(it.type,it.key,it.props,null,st.mode,ct),Vo(ct,it),ct.return=st,ct;case b:return it=$h(it,st.mode,ct),it.return=st,it;case V:return it=jr(it),Dt(st,it,ct)}if(rt(it)||I(it))return it=Br(it,st.mode,ct,null),it.return=st,it;if(typeof it.then=="function")return Dt(st,Oc(it),ct);if(it.$$typeof===E)return Dt(st,Tc(st,it),ct);Rc(st,it)}return null}function pt(st,it,ct,Ct){var Jt=it!==null?it.key:null;if(typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint")return Jt!==null?null:B(st,it,""+ct,Ct);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case v:return ct.key===Jt?et(st,it,ct,Ct):null;case b:return ct.key===Jt?ut(st,it,ct,Ct):null;case V:return ct=jr(ct),pt(st,it,ct,Ct)}if(rt(ct)||I(ct))return Jt!==null?null:wt(st,it,ct,Ct,null);if(typeof ct.then=="function")return pt(st,it,Oc(ct),Ct);if(ct.$$typeof===E)return pt(st,it,Tc(st,ct),Ct);Rc(st,ct)}return null}function xt(st,it,ct,Ct,Jt){if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint")return st=st.get(ct)||null,B(it,st,""+Ct,Jt);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case v:return st=st.get(Ct.key===null?ct:Ct.key)||null,et(it,st,Ct,Jt);case b:return st=st.get(Ct.key===null?ct:Ct.key)||null,ut(it,st,Ct,Jt);case V:return Ct=jr(Ct),xt(st,it,ct,Ct,Jt)}if(rt(Ct)||I(Ct))return st=st.get(ct)||null,wt(it,st,Ct,Jt,null);if(typeof Ct.then=="function")return xt(st,it,ct,Oc(Ct),Jt);if(Ct.$$typeof===E)return xt(st,it,ct,Tc(it,Ct),Jt);Rc(it,Ct)}return null}function Wt(st,it,ct,Ct){for(var Jt=null,xe=null,qt=it,le=it=0,de=null;qt!==null&&le<ct.length;le++){qt.index>le?(de=qt,qt=null):de=qt.sibling;var _e=pt(st,qt,ct[le],Ct);if(_e===null){qt===null&&(qt=de);break}a&&qt&&_e.alternate===null&&s(st,qt),it=_(_e,it,le),xe===null?Jt=_e:xe.sibling=_e,xe=_e,qt=de}if(le===ct.length)return u(st,qt),ge&&Ea(st,le),Jt;if(qt===null){for(;le<ct.length;le++)qt=Dt(st,ct[le],Ct),qt!==null&&(it=_(qt,it,le),xe===null?Jt=qt:xe.sibling=qt,xe=qt);return ge&&Ea(st,le),Jt}for(qt=d(qt);le<ct.length;le++)de=xt(qt,st,le,ct[le],Ct),de!==null&&(a&&de.alternate!==null&&qt.delete(de.key===null?le:de.key),it=_(de,it,le),xe===null?Jt=de:xe.sibling=de,xe=de);return a&&qt.forEach(function(yr){return s(st,yr)}),ge&&Ea(st,le),Jt}function ee(st,it,ct,Ct){if(ct==null)throw Error(n(151));for(var Jt=null,xe=null,qt=it,le=it=0,de=null,_e=ct.next();qt!==null&&!_e.done;le++,_e=ct.next()){qt.index>le?(de=qt,qt=null):de=qt.sibling;var yr=pt(st,qt,_e.value,Ct);if(yr===null){qt===null&&(qt=de);break}a&&qt&&yr.alternate===null&&s(st,qt),it=_(yr,it,le),xe===null?Jt=yr:xe.sibling=yr,xe=yr,qt=de}if(_e.done)return u(st,qt),ge&&Ea(st,le),Jt;if(qt===null){for(;!_e.done;le++,_e=ct.next())_e=Dt(st,_e.value,Ct),_e!==null&&(it=_(_e,it,le),xe===null?Jt=_e:xe.sibling=_e,xe=_e);return ge&&Ea(st,le),Jt}for(qt=d(qt);!_e.done;le++,_e=ct.next())_e=xt(qt,st,le,_e.value,Ct),_e!==null&&(a&&_e.alternate!==null&&qt.delete(_e.key===null?le:_e.key),it=_(_e,it,le),xe===null?Jt=_e:xe.sibling=_e,xe=_e);return a&&qt.forEach(function(Ib){return s(st,Ib)}),ge&&Ea(st,le),Jt}function Fe(st,it,ct,Ct){if(typeof ct=="object"&&ct!==null&&ct.type===y&&ct.key===null&&(ct=ct.props.children),typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case v:t:{for(var Jt=ct.key;it!==null;){if(it.key===Jt){if(Jt=ct.type,Jt===y){if(it.tag===7){u(st,it.sibling),Ct=x(it,ct.props.children),Ct.return=st,st=Ct;break t}}else if(it.elementType===Jt||typeof Jt=="object"&&Jt!==null&&Jt.$$typeof===V&&jr(Jt)===it.type){u(st,it.sibling),Ct=x(it,ct.props),Vo(Ct,ct),Ct.return=st,st=Ct;break t}u(st,it);break}else s(st,it);it=it.sibling}ct.type===y?(Ct=Br(ct.props.children,st.mode,Ct,ct.key),Ct.return=st,st=Ct):(Ct=Sc(ct.type,ct.key,ct.props,null,st.mode,Ct),Vo(Ct,ct),Ct.return=st,st=Ct)}return T(st);case b:t:{for(Jt=ct.key;it!==null;){if(it.key===Jt)if(it.tag===4&&it.stateNode.containerInfo===ct.containerInfo&&it.stateNode.implementation===ct.implementation){u(st,it.sibling),Ct=x(it,ct.children||[]),Ct.return=st,st=Ct;break t}else{u(st,it);break}else s(st,it);it=it.sibling}Ct=$h(ct,st.mode,Ct),Ct.return=st,st=Ct}return T(st);case V:return ct=jr(ct),Fe(st,it,ct,Ct)}if(rt(ct))return Wt(st,it,ct,Ct);if(I(ct)){if(Jt=I(ct),typeof Jt!="function")throw Error(n(150));return ct=Jt.call(ct),ee(st,it,ct,Ct)}if(typeof ct.then=="function")return Fe(st,it,Oc(ct),Ct);if(ct.$$typeof===E)return Fe(st,it,Tc(st,ct),Ct);Rc(st,ct)}return typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint"?(ct=""+ct,it!==null&&it.tag===6?(u(st,it.sibling),Ct=x(it,ct),Ct.return=st,st=Ct):(u(st,it),Ct=qh(ct,st.mode,Ct),Ct.return=st,st=Ct),T(st)):u(st,it)}return function(st,it,ct,Ct){try{Go=0;var Jt=Fe(st,it,ct,Ct);return Fs=null,Jt}catch(qt){if(qt===Ns||qt===kc)throw qt;var xe=di(29,qt,null,st.mode);return xe.lanes=Ct,xe.return=st,xe}}}var Vr=sp(!0),op=sp(!1),er=!1;function cf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function uf(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function nr(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function ir(a,s,u){var d=a.updateQueue;if(d===null)return null;if(d=d.shared,(Ae&2)!==0){var x=d.pending;return x===null?s.next=s:(s.next=x.next,x.next=s),d.pending=s,s=Ac(a),Vg(a,null,u),s}return bc(a,d,s,u),Ac(a)}function Xo(a,s,u){if(s=s.updateQueue,s!==null&&(s=s.shared,(u&4194048)!==0)){var d=s.lanes;d&=a.pendingLanes,u|=d,s.lanes=u,ys(a,u)}}function hf(a,s){var u=a.updateQueue,d=a.alternate;if(d!==null&&(d=d.updateQueue,u===d)){var x=null,_=null;if(u=u.firstBaseUpdate,u!==null){do{var T={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};_===null?x=_=T:_=_.next=T,u=u.next}while(u!==null);_===null?x=_=s:_=_.next=s}else x=_=s;u={baseState:d.baseState,firstBaseUpdate:x,lastBaseUpdate:_,shared:d.shared,callbacks:d.callbacks},a.updateQueue=u;return}a=u.lastBaseUpdate,a===null?u.firstBaseUpdate=s:a.next=s,u.lastBaseUpdate=s}var ff=!1;function Ko(){if(ff){var a=Ms;if(a!==null)throw a}}function Wo(a,s,u,d){ff=!1;var x=a.updateQueue;er=!1;var _=x.firstBaseUpdate,T=x.lastBaseUpdate,B=x.shared.pending;if(B!==null){x.shared.pending=null;var et=B,ut=et.next;et.next=null,T===null?_=ut:T.next=ut,T=et;var wt=a.alternate;wt!==null&&(wt=wt.updateQueue,B=wt.lastBaseUpdate,B!==T&&(B===null?wt.firstBaseUpdate=ut:B.next=ut,wt.lastBaseUpdate=et))}if(_!==null){var Dt=x.baseState;T=0,wt=ut=et=null,B=_;do{var pt=B.lane&-536870913,xt=pt!==B.lane;if(xt?(fe&pt)===pt:(d&pt)===pt){pt!==0&&pt===Ps&&(ff=!0),wt!==null&&(wt=wt.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});t:{var Wt=a,ee=B;pt=s;var Fe=u;switch(ee.tag){case 1:if(Wt=ee.payload,typeof Wt=="function"){Dt=Wt.call(Fe,Dt,pt);break t}Dt=Wt;break t;case 3:Wt.flags=Wt.flags&-65537|128;case 0:if(Wt=ee.payload,pt=typeof Wt=="function"?Wt.call(Fe,Dt,pt):Wt,pt==null)break t;Dt=p({},Dt,pt);break t;case 2:er=!0}}pt=B.callback,pt!==null&&(a.flags|=64,xt&&(a.flags|=8192),xt=x.callbacks,xt===null?x.callbacks=[pt]:xt.push(pt))}else xt={lane:pt,tag:B.tag,payload:B.payload,callback:B.callback,next:null},wt===null?(ut=wt=xt,et=Dt):wt=wt.next=xt,T|=pt;if(B=B.next,B===null){if(B=x.shared.pending,B===null)break;xt=B,B=xt.next,xt.next=null,x.lastBaseUpdate=xt,x.shared.pending=null}}while(!0);wt===null&&(et=Dt),x.baseState=et,x.firstBaseUpdate=ut,x.lastBaseUpdate=wt,_===null&&(x.shared.lanes=0),lr|=T,a.lanes=T,a.memoizedState=Dt}}function lp(a,s){if(typeof a!="function")throw Error(n(191,a));a.call(s)}function cp(a,s){var u=a.callbacks;if(u!==null)for(a.callbacks=null,a=0;a<u.length;a++)lp(u[a],s)}var Ls=M(null),Pc=M(0);function up(a,s){a=La,X(Pc,a),X(Ls,s),La=a|s.baseLanes}function df(){X(Pc,La),X(Ls,Ls.current)}function gf(){La=Pc.current,C(Ls),C(Pc)}var gi=M(null),Li=null;function ar(a){var s=a.alternate;X(rn,rn.current&1),X(gi,a),Li===null&&(s===null||Ls.current!==null||s.memoizedState!==null)&&(Li=a)}function pf(a){X(rn,rn.current),X(gi,a),Li===null&&(Li=a)}function hp(a){a.tag===22?(X(rn,rn.current),X(gi,a),Li===null&&(Li=a)):rr()}function rr(){X(rn,rn.current),X(gi,gi.current)}function pi(a){C(gi),Li===a&&(Li=null),C(rn)}var rn=M(0);function Mc(a){for(var s=a;s!==null;){if(s.tag===13){var u=s.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||bd(u)||Ad(u)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var ka=0,oe=null,Me=null,cn=null,Nc=!1,Bs=!1,Xr=!1,Fc=0,Yo=0,Is=null,k_=0;function Je(){throw Error(n(321))}function mf(a,s){if(s===null)return!1;for(var u=0;u<s.length&&u<a.length;u++)if(!fi(a[u],s[u]))return!1;return!0}function vf(a,s,u,d,x,_){return ka=_,oe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Q.H=a===null||a.memoizedState===null?Yp:Pf,Xr=!1,_=u(d,x),Xr=!1,Bs&&(_=dp(s,u,d,x)),fp(a),_}function fp(a){Q.H=Zo;var s=Me!==null&&Me.next!==null;if(ka=0,cn=Me=oe=null,Nc=!1,Yo=0,Is=null,s)throw Error(n(300));a===null||un||(a=a.dependencies,a!==null&&Ec(a)&&(un=!0))}function dp(a,s,u,d){oe=a;var x=0;do{if(Bs&&(Is=null),Yo=0,Bs=!1,25<=x)throw Error(n(301));if(x+=1,cn=Me=null,a.updateQueue!=null){var _=a.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}Q.H=qp,_=s(u,d)}while(Bs);return _}function D_(){var a=Q.H,s=a.useState()[0];return s=typeof s.then=="function"?qo(s):s,a=a.useState()[0],(Me!==null?Me.memoizedState:null)!==a&&(oe.flags|=1024),s}function yf(){var a=Fc!==0;return Fc=0,a}function xf(a,s,u){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~u}function _f(a){if(Nc){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}Nc=!1}ka=0,cn=Me=oe=null,Bs=!1,Yo=Fc=0,Is=null}function Kn(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cn===null?oe.memoizedState=cn=a:cn=cn.next=a,cn}function sn(){if(Me===null){var a=oe.alternate;a=a!==null?a.memoizedState:null}else a=Me.next;var s=cn===null?oe.memoizedState:cn.next;if(s!==null)cn=s,Me=a;else{if(a===null)throw oe.alternate===null?Error(n(467)):Error(n(310));Me=a,a={memoizedState:Me.memoizedState,baseState:Me.baseState,baseQueue:Me.baseQueue,queue:Me.queue,next:null},cn===null?oe.memoizedState=cn=a:cn=cn.next=a}return cn}function Lc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function qo(a){var s=Yo;return Yo+=1,Is===null&&(Is=[]),a=ip(Is,a,s),s=oe,(cn===null?s.memoizedState:cn.next)===null&&(s=s.alternate,Q.H=s===null||s.memoizedState===null?Yp:Pf),a}function Bc(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return qo(a);if(a.$$typeof===E)return Dn(a)}throw Error(n(438,String(a)))}function bf(a){var s=null,u=oe.updateQueue;if(u!==null&&(s=u.memoCache),s==null){var d=oe.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(s={data:d.data.map(function(x){return x.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),u===null&&(u=Lc(),oe.updateQueue=u),u.memoCache=s,u=s.data[s.index],u===void 0)for(u=s.data[s.index]=Array(a),d=0;d<a;d++)u[d]=Z;return s.index++,u}function Da(a,s){return typeof s=="function"?s(a):s}function Ic(a){var s=sn();return Af(s,Me,a)}function Af(a,s,u){var d=a.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=u;var x=a.baseQueue,_=d.pending;if(_!==null){if(x!==null){var T=x.next;x.next=_.next,_.next=T}s.baseQueue=x=_,d.pending=null}if(_=a.baseState,x===null)a.memoizedState=_;else{s=x.next;var B=T=null,et=null,ut=s,wt=!1;do{var Dt=ut.lane&-536870913;if(Dt!==ut.lane?(fe&Dt)===Dt:(ka&Dt)===Dt){var pt=ut.revertLane;if(pt===0)et!==null&&(et=et.next={lane:0,revertLane:0,gesture:null,action:ut.action,hasEagerState:ut.hasEagerState,eagerState:ut.eagerState,next:null}),Dt===Ps&&(wt=!0);else if((ka&pt)===pt){ut=ut.next,pt===Ps&&(wt=!0);continue}else Dt={lane:0,revertLane:ut.revertLane,gesture:null,action:ut.action,hasEagerState:ut.hasEagerState,eagerState:ut.eagerState,next:null},et===null?(B=et=Dt,T=_):et=et.next=Dt,oe.lanes|=pt,lr|=pt;Dt=ut.action,Xr&&u(_,Dt),_=ut.hasEagerState?ut.eagerState:u(_,Dt)}else pt={lane:Dt,revertLane:ut.revertLane,gesture:ut.gesture,action:ut.action,hasEagerState:ut.hasEagerState,eagerState:ut.eagerState,next:null},et===null?(B=et=pt,T=_):et=et.next=pt,oe.lanes|=Dt,lr|=Dt;ut=ut.next}while(ut!==null&&ut!==s);if(et===null?T=_:et.next=B,!fi(_,a.memoizedState)&&(un=!0,wt&&(u=Ms,u!==null)))throw u;a.memoizedState=_,a.baseState=T,a.baseQueue=et,d.lastRenderedState=_}return x===null&&(d.lanes=0),[a.memoizedState,d.dispatch]}function Sf(a){var s=sn(),u=s.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=a;var d=u.dispatch,x=u.pending,_=s.memoizedState;if(x!==null){u.pending=null;var T=x=x.next;do _=a(_,T.action),T=T.next;while(T!==x);fi(_,s.memoizedState)||(un=!0),s.memoizedState=_,s.baseQueue===null&&(s.baseState=_),u.lastRenderedState=_}return[_,d]}function gp(a,s,u){var d=oe,x=sn(),_=ge;if(_){if(u===void 0)throw Error(n(407));u=u()}else u=s();var T=!fi((Me||x).memoizedState,u);if(T&&(x.memoizedState=u,un=!0),x=x.queue,Tf(vp.bind(null,d,x,a),[a]),x.getSnapshot!==s||T||cn!==null&&cn.memoizedState.tag&1){if(d.flags|=2048,Us(9,{destroy:void 0},mp.bind(null,d,x,u,s),null),Ie===null)throw Error(n(349));_||(ka&127)!==0||pp(d,s,u)}return u}function pp(a,s,u){a.flags|=16384,a={getSnapshot:s,value:u},s=oe.updateQueue,s===null?(s=Lc(),oe.updateQueue=s,s.stores=[a]):(u=s.stores,u===null?s.stores=[a]:u.push(a))}function mp(a,s,u,d){s.value=u,s.getSnapshot=d,yp(s)&&xp(a)}function vp(a,s,u){return u(function(){yp(s)&&xp(a)})}function yp(a){var s=a.getSnapshot;a=a.value;try{var u=s();return!fi(a,u)}catch{return!0}}function xp(a){var s=Lr(a,2);s!==null&&ri(s,a,2)}function wf(a){var s=Kn();if(typeof a=="function"){var u=a;if(a=u(),Xr){Xn(!0);try{u()}finally{Xn(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:a},s}function _p(a,s,u,d){return a.baseState=u,Af(a,Me,typeof d=="function"?d:Da)}function O_(a,s,u,d,x){if(Hc(a))throw Error(n(485));if(a=s.action,a!==null){var _={payload:x,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){_.listeners.push(T)}};Q.T!==null?u(!0):_.isTransition=!1,d(_),u=s.pending,u===null?(_.next=s.pending=_,bp(s,_)):(_.next=u.next,s.pending=u.next=_)}}function bp(a,s){var u=s.action,d=s.payload,x=a.state;if(s.isTransition){var _=Q.T,T={};Q.T=T;try{var B=u(x,d),et=Q.S;et!==null&&et(T,B),Ap(a,s,B)}catch(ut){Ef(a,s,ut)}finally{_!==null&&T.types!==null&&(_.types=T.types),Q.T=_}}else try{_=u(x,d),Ap(a,s,_)}catch(ut){Ef(a,s,ut)}}function Ap(a,s,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(d){Sp(a,s,d)},function(d){return Ef(a,s,d)}):Sp(a,s,u)}function Sp(a,s,u){s.status="fulfilled",s.value=u,wp(s),a.state=u,s=a.pending,s!==null&&(u=s.next,u===s?a.pending=null:(u=u.next,s.next=u,bp(a,u)))}function Ef(a,s,u){var d=a.pending;if(a.pending=null,d!==null){d=d.next;do s.status="rejected",s.reason=u,wp(s),s=s.next;while(s!==d)}a.action=null}function wp(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function Ep(a,s){return s}function Tp(a,s){if(ge){var u=Ie.formState;if(u!==null){t:{var d=oe;if(ge){if(Ge){e:{for(var x=Ge,_=Fi;x.nodeType!==8;){if(!_){x=null;break e}if(x=Bi(x.nextSibling),x===null){x=null;break e}}_=x.data,x=_==="F!"||_==="F"?x:null}if(x){Ge=Bi(x.nextSibling),d=x.data==="F!";break t}}Qa(d)}d=!1}d&&(s=u[0])}}return u=Kn(),u.memoizedState=u.baseState=s,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ep,lastRenderedState:s},u.queue=d,u=Xp.bind(null,oe,d),d.dispatch=u,d=wf(!1),_=Rf.bind(null,oe,!1,d.queue),d=Kn(),x={state:s,dispatch:null,action:a,pending:null},d.queue=x,u=O_.bind(null,oe,x,_,u),x.dispatch=u,d.memoizedState=a,[s,u,!1]}function Cp(a){var s=sn();return kp(s,Me,a)}function kp(a,s,u){if(s=Af(a,s,Ep)[0],a=Ic(Da)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var d=qo(s)}catch(T){throw T===Ns?kc:T}else d=s;s=sn();var x=s.queue,_=x.dispatch;return u!==s.memoizedState&&(oe.flags|=2048,Us(9,{destroy:void 0},R_.bind(null,x,u),null)),[d,_,a]}function R_(a,s){a.action=s}function Dp(a){var s=sn(),u=Me;if(u!==null)return kp(s,u,a);sn(),s=s.memoizedState,u=sn();var d=u.queue.dispatch;return u.memoizedState=a,[s,d,!1]}function Us(a,s,u,d){return a={tag:a,create:u,deps:d,inst:s,next:null},s=oe.updateQueue,s===null&&(s=Lc(),oe.updateQueue=s),u=s.lastEffect,u===null?s.lastEffect=a.next=a:(d=u.next,u.next=a,a.next=d,s.lastEffect=a),a}function Op(){return sn().memoizedState}function Uc(a,s,u,d){var x=Kn();oe.flags|=a,x.memoizedState=Us(1|s,{destroy:void 0},u,d===void 0?null:d)}function zc(a,s,u,d){var x=sn();d=d===void 0?null:d;var _=x.memoizedState.inst;Me!==null&&d!==null&&mf(d,Me.memoizedState.deps)?x.memoizedState=Us(s,_,u,d):(oe.flags|=a,x.memoizedState=Us(1|s,_,u,d))}function Rp(a,s){Uc(8390656,8,a,s)}function Tf(a,s){zc(2048,8,a,s)}function P_(a){oe.flags|=4;var s=oe.updateQueue;if(s===null)s=Lc(),oe.updateQueue=s,s.events=[a];else{var u=s.events;u===null?s.events=[a]:u.push(a)}}function Pp(a){var s=sn().memoizedState;return P_({ref:s,nextImpl:a}),function(){if((Ae&2)!==0)throw Error(n(440));return s.impl.apply(void 0,arguments)}}function Mp(a,s){return zc(4,2,a,s)}function Np(a,s){return zc(4,4,a,s)}function Fp(a,s){if(typeof s=="function"){a=a();var u=s(a);return function(){typeof u=="function"?u():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function Lp(a,s,u){u=u!=null?u.concat([a]):null,zc(4,4,Fp.bind(null,s,a),u)}function Cf(){}function Bp(a,s){var u=sn();s=s===void 0?null:s;var d=u.memoizedState;return s!==null&&mf(s,d[1])?d[0]:(u.memoizedState=[a,s],a)}function Ip(a,s){var u=sn();s=s===void 0?null:s;var d=u.memoizedState;if(s!==null&&mf(s,d[1]))return d[0];if(d=a(),Xr){Xn(!0);try{a()}finally{Xn(!1)}}return u.memoizedState=[d,s],d}function kf(a,s,u){return u===void 0||(ka&1073741824)!==0&&(fe&261930)===0?a.memoizedState=s:(a.memoizedState=u,a=Um(),oe.lanes|=a,lr|=a,u)}function Up(a,s,u,d){return fi(u,s)?u:Ls.current!==null?(a=kf(a,u,d),fi(a,s)||(un=!0),a):(ka&42)===0||(ka&1073741824)!==0&&(fe&261930)===0?(un=!0,a.memoizedState=u):(a=Um(),oe.lanes|=a,lr|=a,s)}function zp(a,s,u,d,x){var _=J.p;J.p=_!==0&&8>_?_:8;var T=Q.T,B={};Q.T=B,Rf(a,!1,s,u);try{var et=x(),ut=Q.S;if(ut!==null&&ut(B,et),et!==null&&typeof et=="object"&&typeof et.then=="function"){var wt=C_(et,d);$o(a,s,wt,yi(a))}else $o(a,s,d,yi(a))}catch(Dt){$o(a,s,{then:function(){},status:"rejected",reason:Dt},yi())}finally{J.p=_,T!==null&&B.types!==null&&(T.types=B.types),Q.T=T}}function M_(){}function Df(a,s,u,d){if(a.tag!==5)throw Error(n(476));var x=Hp(a).queue;zp(a,x,s,_t,u===null?M_:function(){return jp(a),u(d)})}function Hp(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:_t,baseState:_t,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:_t},next:null};var u={};return s.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:u},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function jp(a){var s=Hp(a);s.next===null&&(s=a.alternate.memoizedState),$o(a,s.next.queue,{},yi())}function Of(){return Dn(dl)}function Gp(){return sn().memoizedState}function Vp(){return sn().memoizedState}function N_(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var u=yi();a=nr(u);var d=ir(s,a,u);d!==null&&(ri(d,s,u),Xo(d,s,u)),s={cache:rf()},a.payload=s;return}s=s.return}}function F_(a,s,u){var d=yi();u={lane:d,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Hc(a)?Kp(s,u):(u=Wh(a,s,u,d),u!==null&&(ri(u,a,d),Wp(u,s,d)))}function Xp(a,s,u){var d=yi();$o(a,s,u,d)}function $o(a,s,u,d){var x={lane:d,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Hc(a))Kp(s,x);else{var _=a.alternate;if(a.lanes===0&&(_===null||_.lanes===0)&&(_=s.lastRenderedReducer,_!==null))try{var T=s.lastRenderedState,B=_(T,u);if(x.hasEagerState=!0,x.eagerState=B,fi(B,T))return bc(a,s,x,0),Ie===null&&_c(),!1}catch{}if(u=Wh(a,s,x,d),u!==null)return ri(u,a,d),Wp(u,s,d),!0}return!1}function Rf(a,s,u,d){if(d={lane:2,revertLane:cd(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},Hc(a)){if(s)throw Error(n(479))}else s=Wh(a,u,d,2),s!==null&&ri(s,a,2)}function Hc(a){var s=a.alternate;return a===oe||s!==null&&s===oe}function Kp(a,s){Bs=Nc=!0;var u=a.pending;u===null?s.next=s:(s.next=u.next,u.next=s),a.pending=s}function Wp(a,s,u){if((u&4194048)!==0){var d=s.lanes;d&=a.pendingLanes,u|=d,s.lanes=u,ys(a,u)}}var Zo={readContext:Dn,use:Bc,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useLayoutEffect:Je,useInsertionEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useSyncExternalStore:Je,useId:Je,useHostTransitionStatus:Je,useFormState:Je,useActionState:Je,useOptimistic:Je,useMemoCache:Je,useCacheRefresh:Je};Zo.useEffectEvent=Je;var Yp={readContext:Dn,use:Bc,useCallback:function(a,s){return Kn().memoizedState=[a,s===void 0?null:s],a},useContext:Dn,useEffect:Rp,useImperativeHandle:function(a,s,u){u=u!=null?u.concat([a]):null,Uc(4194308,4,Fp.bind(null,s,a),u)},useLayoutEffect:function(a,s){return Uc(4194308,4,a,s)},useInsertionEffect:function(a,s){Uc(4,2,a,s)},useMemo:function(a,s){var u=Kn();s=s===void 0?null:s;var d=a();if(Xr){Xn(!0);try{a()}finally{Xn(!1)}}return u.memoizedState=[d,s],d},useReducer:function(a,s,u){var d=Kn();if(u!==void 0){var x=u(s);if(Xr){Xn(!0);try{u(s)}finally{Xn(!1)}}}else x=s;return d.memoizedState=d.baseState=x,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:x},d.queue=a,a=a.dispatch=F_.bind(null,oe,a),[d.memoizedState,a]},useRef:function(a){var s=Kn();return a={current:a},s.memoizedState=a},useState:function(a){a=wf(a);var s=a.queue,u=Xp.bind(null,oe,s);return s.dispatch=u,[a.memoizedState,u]},useDebugValue:Cf,useDeferredValue:function(a,s){var u=Kn();return kf(u,a,s)},useTransition:function(){var a=wf(!1);return a=zp.bind(null,oe,a.queue,!0,!1),Kn().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,u){var d=oe,x=Kn();if(ge){if(u===void 0)throw Error(n(407));u=u()}else{if(u=s(),Ie===null)throw Error(n(349));(fe&127)!==0||pp(d,s,u)}x.memoizedState=u;var _={value:u,getSnapshot:s};return x.queue=_,Rp(vp.bind(null,d,_,a),[a]),d.flags|=2048,Us(9,{destroy:void 0},mp.bind(null,d,_,u,s),null),u},useId:function(){var a=Kn(),s=Ie.identifierPrefix;if(ge){var u=ra,d=aa;u=(d&~(1<<32-je(d)-1)).toString(32)+u,s="_"+s+"R_"+u,u=Fc++,0<u&&(s+="H"+u.toString(32)),s+="_"}else u=k_++,s="_"+s+"r_"+u.toString(32)+"_";return a.memoizedState=s},useHostTransitionStatus:Of,useFormState:Tp,useActionState:Tp,useOptimistic:function(a){var s=Kn();s.memoizedState=s.baseState=a;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=u,s=Rf.bind(null,oe,!0,u),u.dispatch=s,[a,s]},useMemoCache:bf,useCacheRefresh:function(){return Kn().memoizedState=N_.bind(null,oe)},useEffectEvent:function(a){var s=Kn(),u={impl:a};return s.memoizedState=u,function(){if((Ae&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},Pf={readContext:Dn,use:Bc,useCallback:Bp,useContext:Dn,useEffect:Tf,useImperativeHandle:Lp,useInsertionEffect:Mp,useLayoutEffect:Np,useMemo:Ip,useReducer:Ic,useRef:Op,useState:function(){return Ic(Da)},useDebugValue:Cf,useDeferredValue:function(a,s){var u=sn();return Up(u,Me.memoizedState,a,s)},useTransition:function(){var a=Ic(Da)[0],s=sn().memoizedState;return[typeof a=="boolean"?a:qo(a),s]},useSyncExternalStore:gp,useId:Gp,useHostTransitionStatus:Of,useFormState:Cp,useActionState:Cp,useOptimistic:function(a,s){var u=sn();return _p(u,Me,a,s)},useMemoCache:bf,useCacheRefresh:Vp};Pf.useEffectEvent=Pp;var qp={readContext:Dn,use:Bc,useCallback:Bp,useContext:Dn,useEffect:Tf,useImperativeHandle:Lp,useInsertionEffect:Mp,useLayoutEffect:Np,useMemo:Ip,useReducer:Sf,useRef:Op,useState:function(){return Sf(Da)},useDebugValue:Cf,useDeferredValue:function(a,s){var u=sn();return Me===null?kf(u,a,s):Up(u,Me.memoizedState,a,s)},useTransition:function(){var a=Sf(Da)[0],s=sn().memoizedState;return[typeof a=="boolean"?a:qo(a),s]},useSyncExternalStore:gp,useId:Gp,useHostTransitionStatus:Of,useFormState:Dp,useActionState:Dp,useOptimistic:function(a,s){var u=sn();return Me!==null?_p(u,Me,a,s):(u.baseState=a,[a,u.queue.dispatch])},useMemoCache:bf,useCacheRefresh:Vp};qp.useEffectEvent=Pp;function Mf(a,s,u,d){s=a.memoizedState,u=u(d,s),u=u==null?s:p({},s,u),a.memoizedState=u,a.lanes===0&&(a.updateQueue.baseState=u)}var Nf={enqueueSetState:function(a,s,u){a=a._reactInternals;var d=yi(),x=nr(d);x.payload=s,u!=null&&(x.callback=u),s=ir(a,x,d),s!==null&&(ri(s,a,d),Xo(s,a,d))},enqueueReplaceState:function(a,s,u){a=a._reactInternals;var d=yi(),x=nr(d);x.tag=1,x.payload=s,u!=null&&(x.callback=u),s=ir(a,x,d),s!==null&&(ri(s,a,d),Xo(s,a,d))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var u=yi(),d=nr(u);d.tag=2,s!=null&&(d.callback=s),s=ir(a,d,u),s!==null&&(ri(s,a,u),Xo(s,a,u))}};function $p(a,s,u,d,x,_,T){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(d,_,T):s.prototype&&s.prototype.isPureReactComponent?!Bo(u,d)||!Bo(x,_):!0}function Zp(a,s,u,d){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(u,d),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(u,d),s.state!==a&&Nf.enqueueReplaceState(s,s.state,null)}function Kr(a,s){var u=s;if("ref"in s){u={};for(var d in s)d!=="ref"&&(u[d]=s[d])}if(a=a.defaultProps){u===s&&(u=p({},u));for(var x in a)u[x]===void 0&&(u[x]=a[x])}return u}function Jp(a){xc(a)}function Qp(a){console.error(a)}function tm(a){xc(a)}function jc(a,s){try{var u=a.onUncaughtError;u(s.value,{componentStack:s.stack})}catch(d){setTimeout(function(){throw d})}}function em(a,s,u){try{var d=a.onCaughtError;d(u.value,{componentStack:u.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Ff(a,s,u){return u=nr(u),u.tag=3,u.payload={element:null},u.callback=function(){jc(a,s)},u}function nm(a){return a=nr(a),a.tag=3,a}function im(a,s,u,d){var x=u.type.getDerivedStateFromError;if(typeof x=="function"){var _=d.value;a.payload=function(){return x(_)},a.callback=function(){em(s,u,d)}}var T=u.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(a.callback=function(){em(s,u,d),typeof x!="function"&&(cr===null?cr=new Set([this]):cr.add(this));var B=d.stack;this.componentDidCatch(d.value,{componentStack:B!==null?B:""})})}function L_(a,s,u,d,x){if(u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(s=u.alternate,s!==null&&Rs(s,u,x,!0),u=gi.current,u!==null){switch(u.tag){case 31:case 13:return Li===null?tu():u.alternate===null&&Qe===0&&(Qe=3),u.flags&=-257,u.flags|=65536,u.lanes=x,d===Dc?u.flags|=16384:(s=u.updateQueue,s===null?u.updateQueue=new Set([d]):s.add(d),sd(a,d,x)),!1;case 22:return u.flags|=65536,d===Dc?u.flags|=16384:(s=u.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([d])},u.updateQueue=s):(u=s.retryQueue,u===null?s.retryQueue=new Set([d]):u.add(d)),sd(a,d,x)),!1}throw Error(n(435,u.tag))}return sd(a,d,x),tu(),!1}if(ge)return s=gi.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=x,d!==Qh&&(a=Error(n(422),{cause:d}),zo(Pi(a,u)))):(d!==Qh&&(s=Error(n(423),{cause:d}),zo(Pi(s,u))),a=a.current.alternate,a.flags|=65536,x&=-x,a.lanes|=x,d=Pi(d,u),x=Ff(a.stateNode,d,x),hf(a,x),Qe!==4&&(Qe=2)),!1;var _=Error(n(520),{cause:d});if(_=Pi(_,u),rl===null?rl=[_]:rl.push(_),Qe!==4&&(Qe=2),s===null)return!0;d=Pi(d,u),u=s;do{switch(u.tag){case 3:return u.flags|=65536,a=x&-x,u.lanes|=a,a=Ff(u.stateNode,d,a),hf(u,a),!1;case 1:if(s=u.type,_=u.stateNode,(u.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(cr===null||!cr.has(_))))return u.flags|=65536,x&=-x,u.lanes|=x,x=nm(x),im(x,a,u,d),hf(u,x),!1}u=u.return}while(u!==null);return!1}var Lf=Error(n(461)),un=!1;function On(a,s,u,d){s.child=a===null?op(s,null,u,d):Vr(s,a.child,u,d)}function am(a,s,u,d,x){u=u.render;var _=s.ref;if("ref"in d){var T={};for(var B in d)B!=="ref"&&(T[B]=d[B])}else T=d;return zr(s),d=vf(a,s,u,T,_,x),B=yf(),a!==null&&!un?(xf(a,s,x),Oa(a,s,x)):(ge&&B&&Zh(s),s.flags|=1,On(a,s,d,x),s.child)}function rm(a,s,u,d,x){if(a===null){var _=u.type;return typeof _=="function"&&!Yh(_)&&_.defaultProps===void 0&&u.compare===null?(s.tag=15,s.type=_,sm(a,s,_,d,x)):(a=Sc(u.type,null,d,s,s.mode,x),a.ref=s.ref,a.return=s,s.child=a)}if(_=a.child,!Vf(a,x)){var T=_.memoizedProps;if(u=u.compare,u=u!==null?u:Bo,u(T,d)&&a.ref===s.ref)return Oa(a,s,x)}return s.flags|=1,a=wa(_,d),a.ref=s.ref,a.return=s,s.child=a}function sm(a,s,u,d,x){if(a!==null){var _=a.memoizedProps;if(Bo(_,d)&&a.ref===s.ref)if(un=!1,s.pendingProps=d=_,Vf(a,x))(a.flags&131072)!==0&&(un=!0);else return s.lanes=a.lanes,Oa(a,s,x)}return Bf(a,s,u,d,x)}function om(a,s,u,d){var x=d.children,_=a!==null?a.memoizedState:null;if(a===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((s.flags&128)!==0){if(_=_!==null?_.baseLanes|u:u,a!==null){for(d=s.child=a.child,x=0;d!==null;)x=x|d.lanes|d.childLanes,d=d.sibling;d=x&~_}else d=0,s.child=null;return lm(a,s,_,u,d)}if((u&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&Cc(s,_!==null?_.cachePool:null),_!==null?up(s,_):df(),hp(s);else return d=s.lanes=536870912,lm(a,s,_!==null?_.baseLanes|u:u,u,d)}else _!==null?(Cc(s,_.cachePool),up(s,_),rr(),s.memoizedState=null):(a!==null&&Cc(s,null),df(),rr());return On(a,s,x,u),s.child}function Jo(a,s){return a!==null&&a.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function lm(a,s,u,d,x){var _=of();return _=_===null?null:{parent:ln._currentValue,pool:_},s.memoizedState={baseLanes:u,cachePool:_},a!==null&&Cc(s,null),df(),hp(s),a!==null&&Rs(a,s,d,!0),s.childLanes=x,null}function Gc(a,s){return s=Xc({mode:s.mode,children:s.children},a.mode),s.ref=a.ref,a.child=s,s.return=a,s}function cm(a,s,u){return Vr(s,a.child,null,u),a=Gc(s,s.pendingProps),a.flags|=2,pi(s),s.memoizedState=null,a}function B_(a,s,u){var d=s.pendingProps,x=(s.flags&128)!==0;if(s.flags&=-129,a===null){if(ge){if(d.mode==="hidden")return a=Gc(s,d),s.lanes=536870912,Jo(null,a);if(pf(s),(a=Ge)?(a=b1(a,Fi),a=a!==null&&a.data==="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:Za!==null?{id:aa,overflow:ra}:null,retryLane:536870912,hydrationErrors:null},u=Kg(a),u.return=s,s.child=u,kn=s,Ge=null)):a=null,a===null)throw Qa(s);return s.lanes=536870912,null}return Gc(s,d)}var _=a.memoizedState;if(_!==null){var T=_.dehydrated;if(pf(s),x)if(s.flags&256)s.flags&=-257,s=cm(a,s,u);else if(s.memoizedState!==null)s.child=a.child,s.flags|=128,s=null;else throw Error(n(558));else if(un||Rs(a,s,u,!1),x=(u&a.childLanes)!==0,un||x){if(d=Ie,d!==null&&(T=cc(d,u),T!==0&&T!==_.retryLane))throw _.retryLane=T,Lr(a,T),ri(d,a,T),Lf;tu(),s=cm(a,s,u)}else a=_.treeContext,Ge=Bi(T.nextSibling),kn=s,ge=!0,Ja=null,Fi=!1,a!==null&&qg(s,a),s=Gc(s,d),s.flags|=4096;return s}return a=wa(a.child,{mode:d.mode,children:d.children}),a.ref=s.ref,s.child=a,a.return=s,a}function Vc(a,s){var u=s.ref;if(u===null)a!==null&&a.ref!==null&&(s.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(a===null||a.ref!==u)&&(s.flags|=4194816)}}function Bf(a,s,u,d,x){return zr(s),u=vf(a,s,u,d,void 0,x),d=yf(),a!==null&&!un?(xf(a,s,x),Oa(a,s,x)):(ge&&d&&Zh(s),s.flags|=1,On(a,s,u,x),s.child)}function um(a,s,u,d,x,_){return zr(s),s.updateQueue=null,u=dp(s,d,u,x),fp(a),d=yf(),a!==null&&!un?(xf(a,s,_),Oa(a,s,_)):(ge&&d&&Zh(s),s.flags|=1,On(a,s,u,_),s.child)}function hm(a,s,u,d,x){if(zr(s),s.stateNode===null){var _=Cs,T=u.contextType;typeof T=="object"&&T!==null&&(_=Dn(T)),_=new u(d,_),s.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Nf,s.stateNode=_,_._reactInternals=s,_=s.stateNode,_.props=d,_.state=s.memoizedState,_.refs={},cf(s),T=u.contextType,_.context=typeof T=="object"&&T!==null?Dn(T):Cs,_.state=s.memoizedState,T=u.getDerivedStateFromProps,typeof T=="function"&&(Mf(s,u,T,d),_.state=s.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(T=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),T!==_.state&&Nf.enqueueReplaceState(_,_.state,null),Wo(s,d,_,x),Ko(),_.state=s.memoizedState),typeof _.componentDidMount=="function"&&(s.flags|=4194308),d=!0}else if(a===null){_=s.stateNode;var B=s.memoizedProps,et=Kr(u,B);_.props=et;var ut=_.context,wt=u.contextType;T=Cs,typeof wt=="object"&&wt!==null&&(T=Dn(wt));var Dt=u.getDerivedStateFromProps;wt=typeof Dt=="function"||typeof _.getSnapshotBeforeUpdate=="function",B=s.pendingProps!==B,wt||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(B||ut!==T)&&Zp(s,_,d,T),er=!1;var pt=s.memoizedState;_.state=pt,Wo(s,d,_,x),Ko(),ut=s.memoizedState,B||pt!==ut||er?(typeof Dt=="function"&&(Mf(s,u,Dt,d),ut=s.memoizedState),(et=er||$p(s,u,et,d,pt,ut,T))?(wt||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(s.flags|=4194308)):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=d,s.memoizedState=ut),_.props=d,_.state=ut,_.context=T,d=et):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),d=!1)}else{_=s.stateNode,uf(a,s),T=s.memoizedProps,wt=Kr(u,T),_.props=wt,Dt=s.pendingProps,pt=_.context,ut=u.contextType,et=Cs,typeof ut=="object"&&ut!==null&&(et=Dn(ut)),B=u.getDerivedStateFromProps,(ut=typeof B=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(T!==Dt||pt!==et)&&Zp(s,_,d,et),er=!1,pt=s.memoizedState,_.state=pt,Wo(s,d,_,x),Ko();var xt=s.memoizedState;T!==Dt||pt!==xt||er||a!==null&&a.dependencies!==null&&Ec(a.dependencies)?(typeof B=="function"&&(Mf(s,u,B,d),xt=s.memoizedState),(wt=er||$p(s,u,wt,d,pt,xt,et)||a!==null&&a.dependencies!==null&&Ec(a.dependencies))?(ut||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(d,xt,et),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(d,xt,et)),typeof _.componentDidUpdate=="function"&&(s.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof _.componentDidUpdate!="function"||T===a.memoizedProps&&pt===a.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||T===a.memoizedProps&&pt===a.memoizedState||(s.flags|=1024),s.memoizedProps=d,s.memoizedState=xt),_.props=d,_.state=xt,_.context=et,d=wt):(typeof _.componentDidUpdate!="function"||T===a.memoizedProps&&pt===a.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||T===a.memoizedProps&&pt===a.memoizedState||(s.flags|=1024),d=!1)}return _=d,Vc(a,s),d=(s.flags&128)!==0,_||d?(_=s.stateNode,u=d&&typeof u.getDerivedStateFromError!="function"?null:_.render(),s.flags|=1,a!==null&&d?(s.child=Vr(s,a.child,null,x),s.child=Vr(s,null,u,x)):On(a,s,u,x),s.memoizedState=_.state,a=s.child):a=Oa(a,s,x),a}function fm(a,s,u,d){return Ir(),s.flags|=256,On(a,s,u,d),s.child}var If={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Uf(a){return{baseLanes:a,cachePool:ep()}}function zf(a,s,u){return a=a!==null?a.childLanes&~u:0,s&&(a|=vi),a}function dm(a,s,u){var d=s.pendingProps,x=!1,_=(s.flags&128)!==0,T;if((T=_)||(T=a!==null&&a.memoizedState===null?!1:(rn.current&2)!==0),T&&(x=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,a===null){if(ge){if(x?ar(s):rr(),(a=Ge)?(a=b1(a,Fi),a=a!==null&&a.data!=="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:Za!==null?{id:aa,overflow:ra}:null,retryLane:536870912,hydrationErrors:null},u=Kg(a),u.return=s,s.child=u,kn=s,Ge=null)):a=null,a===null)throw Qa(s);return Ad(a)?s.lanes=32:s.lanes=536870912,null}var B=d.children;return d=d.fallback,x?(rr(),x=s.mode,B=Xc({mode:"hidden",children:B},x),d=Br(d,x,u,null),B.return=s,d.return=s,B.sibling=d,s.child=B,d=s.child,d.memoizedState=Uf(u),d.childLanes=zf(a,T,u),s.memoizedState=If,Jo(null,d)):(ar(s),Hf(s,B))}var et=a.memoizedState;if(et!==null&&(B=et.dehydrated,B!==null)){if(_)s.flags&256?(ar(s),s.flags&=-257,s=jf(a,s,u)):s.memoizedState!==null?(rr(),s.child=a.child,s.flags|=128,s=null):(rr(),B=d.fallback,x=s.mode,d=Xc({mode:"visible",children:d.children},x),B=Br(B,x,u,null),B.flags|=2,d.return=s,B.return=s,d.sibling=B,s.child=d,Vr(s,a.child,null,u),d=s.child,d.memoizedState=Uf(u),d.childLanes=zf(a,T,u),s.memoizedState=If,s=Jo(null,d));else if(ar(s),Ad(B)){if(T=B.nextSibling&&B.nextSibling.dataset,T)var ut=T.dgst;T=ut,d=Error(n(419)),d.stack="",d.digest=T,zo({value:d,source:null,stack:null}),s=jf(a,s,u)}else if(un||Rs(a,s,u,!1),T=(u&a.childLanes)!==0,un||T){if(T=Ie,T!==null&&(d=cc(T,u),d!==0&&d!==et.retryLane))throw et.retryLane=d,Lr(a,d),ri(T,a,d),Lf;bd(B)||tu(),s=jf(a,s,u)}else bd(B)?(s.flags|=192,s.child=a.child,s=null):(a=et.treeContext,Ge=Bi(B.nextSibling),kn=s,ge=!0,Ja=null,Fi=!1,a!==null&&qg(s,a),s=Hf(s,d.children),s.flags|=4096);return s}return x?(rr(),B=d.fallback,x=s.mode,et=a.child,ut=et.sibling,d=wa(et,{mode:"hidden",children:d.children}),d.subtreeFlags=et.subtreeFlags&65011712,ut!==null?B=wa(ut,B):(B=Br(B,x,u,null),B.flags|=2),B.return=s,d.return=s,d.sibling=B,s.child=d,Jo(null,d),d=s.child,B=a.child.memoizedState,B===null?B=Uf(u):(x=B.cachePool,x!==null?(et=ln._currentValue,x=x.parent!==et?{parent:et,pool:et}:x):x=ep(),B={baseLanes:B.baseLanes|u,cachePool:x}),d.memoizedState=B,d.childLanes=zf(a,T,u),s.memoizedState=If,Jo(a.child,d)):(ar(s),u=a.child,a=u.sibling,u=wa(u,{mode:"visible",children:d.children}),u.return=s,u.sibling=null,a!==null&&(T=s.deletions,T===null?(s.deletions=[a],s.flags|=16):T.push(a)),s.child=u,s.memoizedState=null,u)}function Hf(a,s){return s=Xc({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function Xc(a,s){return a=di(22,a,null,s),a.lanes=0,a}function jf(a,s,u){return Vr(s,a.child,null,u),a=Hf(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function gm(a,s,u){a.lanes|=s;var d=a.alternate;d!==null&&(d.lanes|=s),nf(a.return,s,u)}function Gf(a,s,u,d,x,_){var T=a.memoizedState;T===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:d,tail:u,tailMode:x,treeForkCount:_}:(T.isBackwards=s,T.rendering=null,T.renderingStartTime=0,T.last=d,T.tail=u,T.tailMode=x,T.treeForkCount=_)}function pm(a,s,u){var d=s.pendingProps,x=d.revealOrder,_=d.tail;d=d.children;var T=rn.current,B=(T&2)!==0;if(B?(T=T&1|2,s.flags|=128):T&=1,X(rn,T),On(a,s,d,u),d=ge?Uo:0,!B&&a!==null&&(a.flags&128)!==0)t:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&gm(a,u,s);else if(a.tag===19)gm(a,u,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break t;for(;a.sibling===null;){if(a.return===null||a.return===s)break t;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(x){case"forwards":for(u=s.child,x=null;u!==null;)a=u.alternate,a!==null&&Mc(a)===null&&(x=u),u=u.sibling;u=x,u===null?(x=s.child,s.child=null):(x=u.sibling,u.sibling=null),Gf(s,!1,x,u,_,d);break;case"backwards":case"unstable_legacy-backwards":for(u=null,x=s.child,s.child=null;x!==null;){if(a=x.alternate,a!==null&&Mc(a)===null){s.child=x;break}a=x.sibling,x.sibling=u,u=x,x=a}Gf(s,!0,u,null,_,d);break;case"together":Gf(s,!1,null,null,void 0,d);break;default:s.memoizedState=null}return s.child}function Oa(a,s,u){if(a!==null&&(s.dependencies=a.dependencies),lr|=s.lanes,(u&s.childLanes)===0)if(a!==null){if(Rs(a,s,u,!1),(u&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(n(153));if(s.child!==null){for(a=s.child,u=wa(a,a.pendingProps),s.child=u,u.return=s;a.sibling!==null;)a=a.sibling,u=u.sibling=wa(a,a.pendingProps),u.return=s;u.sibling=null}return s.child}function Vf(a,s){return(a.lanes&s)!==0?!0:(a=a.dependencies,!!(a!==null&&Ec(a)))}function I_(a,s,u){switch(s.tag){case 3:Ot(s,s.stateNode.containerInfo),tr(s,ln,a.memoizedState.cache),Ir();break;case 27:case 5:Mt(s);break;case 4:Ot(s,s.stateNode.containerInfo);break;case 10:tr(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,pf(s),null;break;case 13:var d=s.memoizedState;if(d!==null)return d.dehydrated!==null?(ar(s),s.flags|=128,null):(u&s.child.childLanes)!==0?dm(a,s,u):(ar(s),a=Oa(a,s,u),a!==null?a.sibling:null);ar(s);break;case 19:var x=(a.flags&128)!==0;if(d=(u&s.childLanes)!==0,d||(Rs(a,s,u,!1),d=(u&s.childLanes)!==0),x){if(d)return pm(a,s,u);s.flags|=128}if(x=s.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),X(rn,rn.current),d)break;return null;case 22:return s.lanes=0,om(a,s,u,s.pendingProps);case 24:tr(s,ln,a.memoizedState.cache)}return Oa(a,s,u)}function mm(a,s,u){if(a!==null)if(a.memoizedProps!==s.pendingProps)un=!0;else{if(!Vf(a,u)&&(s.flags&128)===0)return un=!1,I_(a,s,u);un=(a.flags&131072)!==0}else un=!1,ge&&(s.flags&1048576)!==0&&Yg(s,Uo,s.index);switch(s.lanes=0,s.tag){case 16:t:{var d=s.pendingProps;if(a=jr(s.elementType),s.type=a,typeof a=="function")Yh(a)?(d=Kr(a,d),s.tag=1,s=hm(null,s,a,d,u)):(s.tag=0,s=Bf(null,s,a,d,u));else{if(a!=null){var x=a.$$typeof;if(x===D){s.tag=11,s=am(null,s,a,d,u);break t}else if(x===R){s.tag=14,s=rm(null,s,a,d,u);break t}}throw s=O(a)||a,Error(n(306,s,""))}}return s;case 0:return Bf(a,s,s.type,s.pendingProps,u);case 1:return d=s.type,x=Kr(d,s.pendingProps),hm(a,s,d,x,u);case 3:t:{if(Ot(s,s.stateNode.containerInfo),a===null)throw Error(n(387));d=s.pendingProps;var _=s.memoizedState;x=_.element,uf(a,s),Wo(s,d,null,u);var T=s.memoizedState;if(d=T.cache,tr(s,ln,d),d!==_.cache&&af(s,[ln],u,!0),Ko(),d=T.element,_.isDehydrated)if(_={element:d,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=_,s.memoizedState=_,s.flags&256){s=fm(a,s,d,u);break t}else if(d!==x){x=Pi(Error(n(424)),s),zo(x),s=fm(a,s,d,u);break t}else for(a=s.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,Ge=Bi(a.firstChild),kn=s,ge=!0,Ja=null,Fi=!0,u=op(s,null,d,u),s.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Ir(),d===x){s=Oa(a,s,u);break t}On(a,s,d,u)}s=s.child}return s;case 26:return Vc(a,s),a===null?(u=C1(s.type,null,s.pendingProps,null))?s.memoizedState=u:ge||(u=s.type,a=s.pendingProps,d=ou(ot.current).createElement(u),d[G]=s,d[W]=a,Rn(d,u,a),Yt(d),s.stateNode=d):s.memoizedState=C1(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return Mt(s),a===null&&ge&&(d=s.stateNode=w1(s.type,s.pendingProps,ot.current),kn=s,Fi=!0,x=Ge,dr(s.type)?(Sd=x,Ge=Bi(d.firstChild)):Ge=x),On(a,s,s.pendingProps.children,u),Vc(a,s),a===null&&(s.flags|=4194304),s.child;case 5:return a===null&&ge&&((x=d=Ge)&&(d=gb(d,s.type,s.pendingProps,Fi),d!==null?(s.stateNode=d,kn=s,Ge=Bi(d.firstChild),Fi=!1,x=!0):x=!1),x||Qa(s)),Mt(s),x=s.type,_=s.pendingProps,T=a!==null?a.memoizedProps:null,d=_.children,yd(x,_)?d=null:T!==null&&yd(x,T)&&(s.flags|=32),s.memoizedState!==null&&(x=vf(a,s,D_,null,null,u),dl._currentValue=x),Vc(a,s),On(a,s,d,u),s.child;case 6:return a===null&&ge&&((a=u=Ge)&&(u=pb(u,s.pendingProps,Fi),u!==null?(s.stateNode=u,kn=s,Ge=null,a=!0):a=!1),a||Qa(s)),null;case 13:return dm(a,s,u);case 4:return Ot(s,s.stateNode.containerInfo),d=s.pendingProps,a===null?s.child=Vr(s,null,d,u):On(a,s,d,u),s.child;case 11:return am(a,s,s.type,s.pendingProps,u);case 7:return On(a,s,s.pendingProps,u),s.child;case 8:return On(a,s,s.pendingProps.children,u),s.child;case 12:return On(a,s,s.pendingProps.children,u),s.child;case 10:return d=s.pendingProps,tr(s,s.type,d.value),On(a,s,d.children,u),s.child;case 9:return x=s.type._context,d=s.pendingProps.children,zr(s),x=Dn(x),d=d(x),s.flags|=1,On(a,s,d,u),s.child;case 14:return rm(a,s,s.type,s.pendingProps,u);case 15:return sm(a,s,s.type,s.pendingProps,u);case 19:return pm(a,s,u);case 31:return B_(a,s,u);case 22:return om(a,s,u,s.pendingProps);case 24:return zr(s),d=Dn(ln),a===null?(x=of(),x===null&&(x=Ie,_=rf(),x.pooledCache=_,_.refCount++,_!==null&&(x.pooledCacheLanes|=u),x=_),s.memoizedState={parent:d,cache:x},cf(s),tr(s,ln,x)):((a.lanes&u)!==0&&(uf(a,s),Wo(s,null,null,u),Ko()),x=a.memoizedState,_=s.memoizedState,x.parent!==d?(x={parent:d,cache:d},s.memoizedState=x,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=x),tr(s,ln,d)):(d=_.cache,tr(s,ln,d),d!==x.cache&&af(s,[ln],u,!0))),On(a,s,s.pendingProps.children,u),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function Ra(a){a.flags|=4}function Xf(a,s,u,d,x){if((s=(a.mode&32)!==0)&&(s=!1),s){if(a.flags|=16777216,(x&335544128)===x)if(a.stateNode.complete)a.flags|=8192;else if(Gm())a.flags|=8192;else throw Gr=Dc,lf}else a.flags&=-16777217}function vm(a,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!P1(s))if(Gm())a.flags|=8192;else throw Gr=Dc,lf}function Kc(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?oc():536870912,a.lanes|=s,Gs|=s)}function Qo(a,s){if(!ge)switch(a.tailMode){case"hidden":s=a.tail;for(var u=null;s!==null;)s.alternate!==null&&(u=s),s=s.sibling;u===null?a.tail=null:u.sibling=null;break;case"collapsed":u=a.tail;for(var d=null;u!==null;)u.alternate!==null&&(d=u),u=u.sibling;d===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:d.sibling=null}}function Ve(a){var s=a.alternate!==null&&a.alternate.child===a.child,u=0,d=0;if(s)for(var x=a.child;x!==null;)u|=x.lanes|x.childLanes,d|=x.subtreeFlags&65011712,d|=x.flags&65011712,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)u|=x.lanes|x.childLanes,d|=x.subtreeFlags,d|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=d,a.childLanes=u,s}function U_(a,s,u){var d=s.pendingProps;switch(Jh(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ve(s),null;case 1:return Ve(s),null;case 3:return u=s.stateNode,d=null,a!==null&&(d=a.memoizedState.cache),s.memoizedState.cache!==d&&(s.flags|=2048),Ca(ln),Tt(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(a===null||a.child===null)&&(Os(s)?Ra(s):a===null||a.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,tf())),Ve(s),null;case 26:var x=s.type,_=s.memoizedState;return a===null?(Ra(s),_!==null?(Ve(s),vm(s,_)):(Ve(s),Xf(s,x,null,d,u))):_?_!==a.memoizedState?(Ra(s),Ve(s),vm(s,_)):(Ve(s),s.flags&=-16777217):(a=a.memoizedProps,a!==d&&Ra(s),Ve(s),Xf(s,x,a,d,u)),null;case 27:if(Zt(s),u=ot.current,x=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==d&&Ra(s);else{if(!d){if(s.stateNode===null)throw Error(n(166));return Ve(s),null}a=U.current,Os(s)?$g(s):(a=w1(x,d,u),s.stateNode=a,Ra(s))}return Ve(s),null;case 5:if(Zt(s),x=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==d&&Ra(s);else{if(!d){if(s.stateNode===null)throw Error(n(166));return Ve(s),null}if(_=U.current,Os(s))$g(s);else{var T=ou(ot.current);switch(_){case 1:_=T.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:_=T.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":_=T.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":_=T.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":_=T.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof d.is=="string"?T.createElement("select",{is:d.is}):T.createElement("select"),d.multiple?_.multiple=!0:d.size&&(_.size=d.size);break;default:_=typeof d.is=="string"?T.createElement(x,{is:d.is}):T.createElement(x)}}_[G]=s,_[W]=d;t:for(T=s.child;T!==null;){if(T.tag===5||T.tag===6)_.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===s)break t;for(;T.sibling===null;){if(T.return===null||T.return===s)break t;T=T.return}T.sibling.return=T.return,T=T.sibling}s.stateNode=_;t:switch(Rn(_,x,d),x){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break t;case"img":d=!0;break t;default:d=!1}d&&Ra(s)}}return Ve(s),Xf(s,s.type,a===null?null:a.memoizedProps,s.pendingProps,u),null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==d&&Ra(s);else{if(typeof d!="string"&&s.stateNode===null)throw Error(n(166));if(a=ot.current,Os(s)){if(a=s.stateNode,u=s.memoizedProps,d=null,x=kn,x!==null)switch(x.tag){case 27:case 5:d=x.memoizedProps}a[G]=s,a=!!(a.nodeValue===u||d!==null&&d.suppressHydrationWarning===!0||d1(a.nodeValue,u)),a||Qa(s,!0)}else a=ou(a).createTextNode(d),a[G]=s,s.stateNode=a}return Ve(s),null;case 31:if(u=s.memoizedState,a===null||a.memoizedState!==null){if(d=Os(s),u!==null){if(a===null){if(!d)throw Error(n(318));if(a=s.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[G]=s}else Ir(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Ve(s),a=!1}else u=tf(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=u),a=!0;if(!a)return s.flags&256?(pi(s),s):(pi(s),null);if((s.flags&128)!==0)throw Error(n(558))}return Ve(s),null;case 13:if(d=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(x=Os(s),d!==null&&d.dehydrated!==null){if(a===null){if(!x)throw Error(n(318));if(x=s.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(n(317));x[G]=s}else Ir(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Ve(s),x=!1}else x=tf(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=x),x=!0;if(!x)return s.flags&256?(pi(s),s):(pi(s),null)}return pi(s),(s.flags&128)!==0?(s.lanes=u,s):(u=d!==null,a=a!==null&&a.memoizedState!==null,u&&(d=s.child,x=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(x=d.alternate.memoizedState.cachePool.pool),_=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(_=d.memoizedState.cachePool.pool),_!==x&&(d.flags|=2048)),u!==a&&u&&(s.child.flags|=8192),Kc(s,s.updateQueue),Ve(s),null);case 4:return Tt(),a===null&&dd(s.stateNode.containerInfo),Ve(s),null;case 10:return Ca(s.type),Ve(s),null;case 19:if(C(rn),d=s.memoizedState,d===null)return Ve(s),null;if(x=(s.flags&128)!==0,_=d.rendering,_===null)if(x)Qo(d,!1);else{if(Qe!==0||a!==null&&(a.flags&128)!==0)for(a=s.child;a!==null;){if(_=Mc(a),_!==null){for(s.flags|=128,Qo(d,!1),a=_.updateQueue,s.updateQueue=a,Kc(s,a),s.subtreeFlags=0,a=u,u=s.child;u!==null;)Xg(u,a),u=u.sibling;return X(rn,rn.current&1|2),ge&&Ea(s,d.treeForkCount),s.child}a=a.sibling}d.tail!==null&&It()>Zc&&(s.flags|=128,x=!0,Qo(d,!1),s.lanes=4194304)}else{if(!x)if(a=Mc(_),a!==null){if(s.flags|=128,x=!0,a=a.updateQueue,s.updateQueue=a,Kc(s,a),Qo(d,!0),d.tail===null&&d.tailMode==="hidden"&&!_.alternate&&!ge)return Ve(s),null}else 2*It()-d.renderingStartTime>Zc&&u!==536870912&&(s.flags|=128,x=!0,Qo(d,!1),s.lanes=4194304);d.isBackwards?(_.sibling=s.child,s.child=_):(a=d.last,a!==null?a.sibling=_:s.child=_,d.last=_)}return d.tail!==null?(a=d.tail,d.rendering=a,d.tail=a.sibling,d.renderingStartTime=It(),a.sibling=null,u=rn.current,X(rn,x?u&1|2:u&1),ge&&Ea(s,d.treeForkCount),a):(Ve(s),null);case 22:case 23:return pi(s),gf(),d=s.memoizedState!==null,a!==null?a.memoizedState!==null!==d&&(s.flags|=8192):d&&(s.flags|=8192),d?(u&536870912)!==0&&(s.flags&128)===0&&(Ve(s),s.subtreeFlags&6&&(s.flags|=8192)):Ve(s),u=s.updateQueue,u!==null&&Kc(s,u.retryQueue),u=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),d=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(d=s.memoizedState.cachePool.pool),d!==u&&(s.flags|=2048),a!==null&&C(Hr),null;case 24:return u=null,a!==null&&(u=a.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),Ca(ln),Ve(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function z_(a,s){switch(Jh(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return Ca(ln),Tt(),a=s.flags,(a&65536)!==0&&(a&128)===0?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return Zt(s),null;case 31:if(s.memoizedState!==null){if(pi(s),s.alternate===null)throw Error(n(340));Ir()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 13:if(pi(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Ir()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return C(rn),null;case 4:return Tt(),null;case 10:return Ca(s.type),null;case 22:case 23:return pi(s),gf(),a!==null&&C(Hr),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return Ca(ln),null;case 25:return null;default:return null}}function ym(a,s){switch(Jh(s),s.tag){case 3:Ca(ln),Tt();break;case 26:case 27:case 5:Zt(s);break;case 4:Tt();break;case 31:s.memoizedState!==null&&pi(s);break;case 13:pi(s);break;case 19:C(rn);break;case 10:Ca(s.type);break;case 22:case 23:pi(s),gf(),a!==null&&C(Hr);break;case 24:Ca(ln)}}function tl(a,s){try{var u=s.updateQueue,d=u!==null?u.lastEffect:null;if(d!==null){var x=d.next;u=x;do{if((u.tag&a)===a){d=void 0;var _=u.create,T=u.inst;d=_(),T.destroy=d}u=u.next}while(u!==x)}}catch(B){ke(s,s.return,B)}}function sr(a,s,u){try{var d=s.updateQueue,x=d!==null?d.lastEffect:null;if(x!==null){var _=x.next;d=_;do{if((d.tag&a)===a){var T=d.inst,B=T.destroy;if(B!==void 0){T.destroy=void 0,x=s;var et=u,ut=B;try{ut()}catch(wt){ke(x,et,wt)}}}d=d.next}while(d!==_)}}catch(wt){ke(s,s.return,wt)}}function xm(a){var s=a.updateQueue;if(s!==null){var u=a.stateNode;try{cp(s,u)}catch(d){ke(a,a.return,d)}}}function _m(a,s,u){u.props=Kr(a.type,a.memoizedProps),u.state=a.memoizedState;try{u.componentWillUnmount()}catch(d){ke(a,s,d)}}function el(a,s){try{var u=a.ref;if(u!==null){switch(a.tag){case 26:case 27:case 5:var d=a.stateNode;break;case 30:d=a.stateNode;break;default:d=a.stateNode}typeof u=="function"?a.refCleanup=u(d):u.current=d}}catch(x){ke(a,s,x)}}function sa(a,s){var u=a.ref,d=a.refCleanup;if(u!==null)if(typeof d=="function")try{d()}catch(x){ke(a,s,x)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(x){ke(a,s,x)}else u.current=null}function bm(a){var s=a.type,u=a.memoizedProps,d=a.stateNode;try{t:switch(s){case"button":case"input":case"select":case"textarea":u.autoFocus&&d.focus();break t;case"img":u.src?d.src=u.src:u.srcSet&&(d.srcset=u.srcSet)}}catch(x){ke(a,a.return,x)}}function Kf(a,s,u){try{var d=a.stateNode;lb(d,a.type,u,s),d[W]=s}catch(x){ke(a,a.return,x)}}function Am(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&dr(a.type)||a.tag===4}function Wf(a){t:for(;;){for(;a.sibling===null;){if(a.return===null||Am(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&dr(a.type)||a.flags&2||a.child===null||a.tag===4)continue t;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Yf(a,s,u){var d=a.tag;if(d===5||d===6)a=a.stateNode,s?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(a,s):(s=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,s.appendChild(a),u=u._reactRootContainer,u!=null||s.onclick!==null||(s.onclick=Aa));else if(d!==4&&(d===27&&dr(a.type)&&(u=a.stateNode,s=null),a=a.child,a!==null))for(Yf(a,s,u),a=a.sibling;a!==null;)Yf(a,s,u),a=a.sibling}function Wc(a,s,u){var d=a.tag;if(d===5||d===6)a=a.stateNode,s?u.insertBefore(a,s):u.appendChild(a);else if(d!==4&&(d===27&&dr(a.type)&&(u=a.stateNode),a=a.child,a!==null))for(Wc(a,s,u),a=a.sibling;a!==null;)Wc(a,s,u),a=a.sibling}function Sm(a){var s=a.stateNode,u=a.memoizedProps;try{for(var d=a.type,x=s.attributes;x.length;)s.removeAttributeNode(x[0]);Rn(s,d,u),s[G]=a,s[W]=u}catch(_){ke(a,a.return,_)}}var Pa=!1,hn=!1,qf=!1,wm=typeof WeakSet=="function"?WeakSet:Set,bn=null;function H_(a,s){if(a=a.containerInfo,md=gu,a=Lg(a),Hh(a)){if("selectionStart"in a)var u={start:a.selectionStart,end:a.selectionEnd};else t:{u=(u=a.ownerDocument)&&u.defaultView||window;var d=u.getSelection&&u.getSelection();if(d&&d.rangeCount!==0){u=d.anchorNode;var x=d.anchorOffset,_=d.focusNode;d=d.focusOffset;try{u.nodeType,_.nodeType}catch{u=null;break t}var T=0,B=-1,et=-1,ut=0,wt=0,Dt=a,pt=null;e:for(;;){for(var xt;Dt!==u||x!==0&&Dt.nodeType!==3||(B=T+x),Dt!==_||d!==0&&Dt.nodeType!==3||(et=T+d),Dt.nodeType===3&&(T+=Dt.nodeValue.length),(xt=Dt.firstChild)!==null;)pt=Dt,Dt=xt;for(;;){if(Dt===a)break e;if(pt===u&&++ut===x&&(B=T),pt===_&&++wt===d&&(et=T),(xt=Dt.nextSibling)!==null)break;Dt=pt,pt=Dt.parentNode}Dt=xt}u=B===-1||et===-1?null:{start:B,end:et}}else u=null}u=u||{start:0,end:0}}else u=null;for(vd={focusedElem:a,selectionRange:u},gu=!1,bn=s;bn!==null;)if(s=bn,a=s.child,(s.subtreeFlags&1028)!==0&&a!==null)a.return=s,bn=a;else for(;bn!==null;){switch(s=bn,_=s.alternate,a=s.flags,s.tag){case 0:if((a&4)!==0&&(a=s.updateQueue,a=a!==null?a.events:null,a!==null))for(u=0;u<a.length;u++)x=a[u],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&_!==null){a=void 0,u=s,x=_.memoizedProps,_=_.memoizedState,d=u.stateNode;try{var Wt=Kr(u.type,x);a=d.getSnapshotBeforeUpdate(Wt,_),d.__reactInternalSnapshotBeforeUpdate=a}catch(ee){ke(u,u.return,ee)}}break;case 3:if((a&1024)!==0){if(a=s.stateNode.containerInfo,u=a.nodeType,u===9)_d(a);else if(u===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":_d(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=s.sibling,a!==null){a.return=s.return,bn=a;break}bn=s.return}}function Em(a,s,u){var d=u.flags;switch(u.tag){case 0:case 11:case 15:Na(a,u),d&4&&tl(5,u);break;case 1:if(Na(a,u),d&4)if(a=u.stateNode,s===null)try{a.componentDidMount()}catch(T){ke(u,u.return,T)}else{var x=Kr(u.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(x,s,a.__reactInternalSnapshotBeforeUpdate)}catch(T){ke(u,u.return,T)}}d&64&&xm(u),d&512&&el(u,u.return);break;case 3:if(Na(a,u),d&64&&(a=u.updateQueue,a!==null)){if(s=null,u.child!==null)switch(u.child.tag){case 27:case 5:s=u.child.stateNode;break;case 1:s=u.child.stateNode}try{cp(a,s)}catch(T){ke(u,u.return,T)}}break;case 27:s===null&&d&4&&Sm(u);case 26:case 5:Na(a,u),s===null&&d&4&&bm(u),d&512&&el(u,u.return);break;case 12:Na(a,u);break;case 31:Na(a,u),d&4&&km(a,u);break;case 13:Na(a,u),d&4&&Dm(a,u),d&64&&(a=u.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(u=$_.bind(null,u),mb(a,u))));break;case 22:if(d=u.memoizedState!==null||Pa,!d){s=s!==null&&s.memoizedState!==null||hn,x=Pa;var _=hn;Pa=d,(hn=s)&&!_?Fa(a,u,(u.subtreeFlags&8772)!==0):Na(a,u),Pa=x,hn=_}break;case 30:break;default:Na(a,u)}}function Tm(a){var s=a.alternate;s!==null&&(a.alternate=null,Tm(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&Ft(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var We=null,ei=!1;function Ma(a,s,u){for(u=u.child;u!==null;)Cm(a,s,u),u=u.sibling}function Cm(a,s,u){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Te,u)}catch{}switch(u.tag){case 26:hn||sa(u,s),Ma(a,s,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:hn||sa(u,s);var d=We,x=ei;dr(u.type)&&(We=u.stateNode,ei=!1),Ma(a,s,u),ul(u.stateNode),We=d,ei=x;break;case 5:hn||sa(u,s);case 6:if(d=We,x=ei,We=null,Ma(a,s,u),We=d,ei=x,We!==null)if(ei)try{(We.nodeType===9?We.body:We.nodeName==="HTML"?We.ownerDocument.body:We).removeChild(u.stateNode)}catch(_){ke(u,s,_)}else try{We.removeChild(u.stateNode)}catch(_){ke(u,s,_)}break;case 18:We!==null&&(ei?(a=We,x1(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,u.stateNode),Zs(a)):x1(We,u.stateNode));break;case 4:d=We,x=ei,We=u.stateNode.containerInfo,ei=!0,Ma(a,s,u),We=d,ei=x;break;case 0:case 11:case 14:case 15:sr(2,u,s),hn||sr(4,u,s),Ma(a,s,u);break;case 1:hn||(sa(u,s),d=u.stateNode,typeof d.componentWillUnmount=="function"&&_m(u,s,d)),Ma(a,s,u);break;case 21:Ma(a,s,u);break;case 22:hn=(d=hn)||u.memoizedState!==null,Ma(a,s,u),hn=d;break;default:Ma(a,s,u)}}function km(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{Zs(a)}catch(u){ke(s,s.return,u)}}}function Dm(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Zs(a)}catch(u){ke(s,s.return,u)}}function j_(a){switch(a.tag){case 31:case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new wm),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new wm),s;default:throw Error(n(435,a.tag))}}function Yc(a,s){var u=j_(a);s.forEach(function(d){if(!u.has(d)){u.add(d);var x=Z_.bind(null,a,d);d.then(x,x)}})}function ni(a,s){var u=s.deletions;if(u!==null)for(var d=0;d<u.length;d++){var x=u[d],_=a,T=s,B=T;t:for(;B!==null;){switch(B.tag){case 27:if(dr(B.type)){We=B.stateNode,ei=!1;break t}break;case 5:We=B.stateNode,ei=!1;break t;case 3:case 4:We=B.stateNode.containerInfo,ei=!0;break t}B=B.return}if(We===null)throw Error(n(160));Cm(_,T,x),We=null,ei=!1,_=x.alternate,_!==null&&(_.return=null),x.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Om(s,a),s=s.sibling}var Yi=null;function Om(a,s){var u=a.alternate,d=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:ni(s,a),ii(a),d&4&&(sr(3,a,a.return),tl(3,a),sr(5,a,a.return));break;case 1:ni(s,a),ii(a),d&512&&(hn||u===null||sa(u,u.return)),d&64&&Pa&&(a=a.updateQueue,a!==null&&(d=a.callbacks,d!==null&&(u=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=u===null?d:u.concat(d))));break;case 26:var x=Yi;if(ni(s,a),ii(a),d&512&&(hn||u===null||sa(u,u.return)),d&4){var _=u!==null?u.memoizedState:null;if(d=a.memoizedState,u===null)if(d===null)if(a.stateNode===null){t:{d=a.type,u=a.memoizedProps,x=x.ownerDocument||x;e:switch(d){case"title":_=x.getElementsByTagName("title")[0],(!_||_[mt]||_[G]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=x.createElement(d),x.head.insertBefore(_,x.querySelector("head > title"))),Rn(_,d,u),_[G]=a,Yt(_),d=_;break t;case"link":var T=O1("link","href",x).get(d+(u.href||""));if(T){for(var B=0;B<T.length;B++)if(_=T[B],_.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&_.getAttribute("rel")===(u.rel==null?null:u.rel)&&_.getAttribute("title")===(u.title==null?null:u.title)&&_.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){T.splice(B,1);break e}}_=x.createElement(d),Rn(_,d,u),x.head.appendChild(_);break;case"meta":if(T=O1("meta","content",x).get(d+(u.content||""))){for(B=0;B<T.length;B++)if(_=T[B],_.getAttribute("content")===(u.content==null?null:""+u.content)&&_.getAttribute("name")===(u.name==null?null:u.name)&&_.getAttribute("property")===(u.property==null?null:u.property)&&_.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&_.getAttribute("charset")===(u.charSet==null?null:u.charSet)){T.splice(B,1);break e}}_=x.createElement(d),Rn(_,d,u),x.head.appendChild(_);break;default:throw Error(n(468,d))}_[G]=a,Yt(_),d=_}a.stateNode=d}else R1(x,a.type,a.stateNode);else a.stateNode=D1(x,d,a.memoizedProps);else _!==d?(_===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):_.count--,d===null?R1(x,a.type,a.stateNode):D1(x,d,a.memoizedProps)):d===null&&a.stateNode!==null&&Kf(a,a.memoizedProps,u.memoizedProps)}break;case 27:ni(s,a),ii(a),d&512&&(hn||u===null||sa(u,u.return)),u!==null&&d&4&&Kf(a,a.memoizedProps,u.memoizedProps);break;case 5:if(ni(s,a),ii(a),d&512&&(hn||u===null||sa(u,u.return)),a.flags&32){x=a.stateNode;try{_s(x,"")}catch(Wt){ke(a,a.return,Wt)}}d&4&&a.stateNode!=null&&(x=a.memoizedProps,Kf(a,x,u!==null?u.memoizedProps:x)),d&1024&&(qf=!0);break;case 6:if(ni(s,a),ii(a),d&4){if(a.stateNode===null)throw Error(n(162));d=a.memoizedProps,u=a.stateNode;try{u.nodeValue=d}catch(Wt){ke(a,a.return,Wt)}}break;case 3:if(uu=null,x=Yi,Yi=lu(s.containerInfo),ni(s,a),Yi=x,ii(a),d&4&&u!==null&&u.memoizedState.isDehydrated)try{Zs(s.containerInfo)}catch(Wt){ke(a,a.return,Wt)}qf&&(qf=!1,Rm(a));break;case 4:d=Yi,Yi=lu(a.stateNode.containerInfo),ni(s,a),ii(a),Yi=d;break;case 12:ni(s,a),ii(a);break;case 31:ni(s,a),ii(a),d&4&&(d=a.updateQueue,d!==null&&(a.updateQueue=null,Yc(a,d)));break;case 13:ni(s,a),ii(a),a.child.flags&8192&&a.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&($c=It()),d&4&&(d=a.updateQueue,d!==null&&(a.updateQueue=null,Yc(a,d)));break;case 22:x=a.memoizedState!==null;var et=u!==null&&u.memoizedState!==null,ut=Pa,wt=hn;if(Pa=ut||x,hn=wt||et,ni(s,a),hn=wt,Pa=ut,ii(a),d&8192)t:for(s=a.stateNode,s._visibility=x?s._visibility&-2:s._visibility|1,x&&(u===null||et||Pa||hn||Wr(a)),u=null,s=a;;){if(s.tag===5||s.tag===26){if(u===null){et=u=s;try{if(_=et.stateNode,x)T=_.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{B=et.stateNode;var Dt=et.memoizedProps.style,pt=Dt!=null&&Dt.hasOwnProperty("display")?Dt.display:null;B.style.display=pt==null||typeof pt=="boolean"?"":(""+pt).trim()}}catch(Wt){ke(et,et.return,Wt)}}}else if(s.tag===6){if(u===null){et=s;try{et.stateNode.nodeValue=x?"":et.memoizedProps}catch(Wt){ke(et,et.return,Wt)}}}else if(s.tag===18){if(u===null){et=s;try{var xt=et.stateNode;x?_1(xt,!0):_1(et.stateNode,!1)}catch(Wt){ke(et,et.return,Wt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break t;for(;s.sibling===null;){if(s.return===null||s.return===a)break t;u===s&&(u=null),s=s.return}u===s&&(u=null),s.sibling.return=s.return,s=s.sibling}d&4&&(d=a.updateQueue,d!==null&&(u=d.retryQueue,u!==null&&(d.retryQueue=null,Yc(a,u))));break;case 19:ni(s,a),ii(a),d&4&&(d=a.updateQueue,d!==null&&(a.updateQueue=null,Yc(a,d)));break;case 30:break;case 21:break;default:ni(s,a),ii(a)}}function ii(a){var s=a.flags;if(s&2){try{for(var u,d=a.return;d!==null;){if(Am(d)){u=d;break}d=d.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var x=u.stateNode,_=Wf(a);Wc(a,_,x);break;case 5:var T=u.stateNode;u.flags&32&&(_s(T,""),u.flags&=-33);var B=Wf(a);Wc(a,B,T);break;case 3:case 4:var et=u.stateNode.containerInfo,ut=Wf(a);Yf(a,ut,et);break;default:throw Error(n(161))}}catch(wt){ke(a,a.return,wt)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function Rm(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;Rm(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function Na(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Em(a,s.alternate,s),s=s.sibling}function Wr(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:sr(4,s,s.return),Wr(s);break;case 1:sa(s,s.return);var u=s.stateNode;typeof u.componentWillUnmount=="function"&&_m(s,s.return,u),Wr(s);break;case 27:ul(s.stateNode);case 26:case 5:sa(s,s.return),Wr(s);break;case 22:s.memoizedState===null&&Wr(s);break;case 30:Wr(s);break;default:Wr(s)}a=a.sibling}}function Fa(a,s,u){for(u=u&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var d=s.alternate,x=a,_=s,T=_.flags;switch(_.tag){case 0:case 11:case 15:Fa(x,_,u),tl(4,_);break;case 1:if(Fa(x,_,u),d=_,x=d.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ut){ke(d,d.return,ut)}if(d=_,x=d.updateQueue,x!==null){var B=d.stateNode;try{var et=x.shared.hiddenCallbacks;if(et!==null)for(x.shared.hiddenCallbacks=null,x=0;x<et.length;x++)lp(et[x],B)}catch(ut){ke(d,d.return,ut)}}u&&T&64&&xm(_),el(_,_.return);break;case 27:Sm(_);case 26:case 5:Fa(x,_,u),u&&d===null&&T&4&&bm(_),el(_,_.return);break;case 12:Fa(x,_,u);break;case 31:Fa(x,_,u),u&&T&4&&km(x,_);break;case 13:Fa(x,_,u),u&&T&4&&Dm(x,_);break;case 22:_.memoizedState===null&&Fa(x,_,u),el(_,_.return);break;case 30:break;default:Fa(x,_,u)}s=s.sibling}}function $f(a,s){var u=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==u&&(a!=null&&a.refCount++,u!=null&&Ho(u))}function Zf(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&Ho(a))}function qi(a,s,u,d){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Pm(a,s,u,d),s=s.sibling}function Pm(a,s,u,d){var x=s.flags;switch(s.tag){case 0:case 11:case 15:qi(a,s,u,d),x&2048&&tl(9,s);break;case 1:qi(a,s,u,d);break;case 3:qi(a,s,u,d),x&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&Ho(a)));break;case 12:if(x&2048){qi(a,s,u,d),a=s.stateNode;try{var _=s.memoizedProps,T=_.id,B=_.onPostCommit;typeof B=="function"&&B(T,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(et){ke(s,s.return,et)}}else qi(a,s,u,d);break;case 31:qi(a,s,u,d);break;case 13:qi(a,s,u,d);break;case 23:break;case 22:_=s.stateNode,T=s.alternate,s.memoizedState!==null?_._visibility&2?qi(a,s,u,d):nl(a,s):_._visibility&2?qi(a,s,u,d):(_._visibility|=2,zs(a,s,u,d,(s.subtreeFlags&10256)!==0||!1)),x&2048&&$f(T,s);break;case 24:qi(a,s,u,d),x&2048&&Zf(s.alternate,s);break;default:qi(a,s,u,d)}}function zs(a,s,u,d,x){for(x=x&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var _=a,T=s,B=u,et=d,ut=T.flags;switch(T.tag){case 0:case 11:case 15:zs(_,T,B,et,x),tl(8,T);break;case 23:break;case 22:var wt=T.stateNode;T.memoizedState!==null?wt._visibility&2?zs(_,T,B,et,x):nl(_,T):(wt._visibility|=2,zs(_,T,B,et,x)),x&&ut&2048&&$f(T.alternate,T);break;case 24:zs(_,T,B,et,x),x&&ut&2048&&Zf(T.alternate,T);break;default:zs(_,T,B,et,x)}s=s.sibling}}function nl(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var u=a,d=s,x=d.flags;switch(d.tag){case 22:nl(u,d),x&2048&&$f(d.alternate,d);break;case 24:nl(u,d),x&2048&&Zf(d.alternate,d);break;default:nl(u,d)}s=s.sibling}}var il=8192;function Hs(a,s,u){if(a.subtreeFlags&il)for(a=a.child;a!==null;)Mm(a,s,u),a=a.sibling}function Mm(a,s,u){switch(a.tag){case 26:Hs(a,s,u),a.flags&il&&a.memoizedState!==null&&kb(u,Yi,a.memoizedState,a.memoizedProps);break;case 5:Hs(a,s,u);break;case 3:case 4:var d=Yi;Yi=lu(a.stateNode.containerInfo),Hs(a,s,u),Yi=d;break;case 22:a.memoizedState===null&&(d=a.alternate,d!==null&&d.memoizedState!==null?(d=il,il=16777216,Hs(a,s,u),il=d):Hs(a,s,u));break;default:Hs(a,s,u)}}function Nm(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function al(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var d=s[u];bn=d,Lm(d,a)}Nm(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Fm(a),a=a.sibling}function Fm(a){switch(a.tag){case 0:case 11:case 15:al(a),a.flags&2048&&sr(9,a,a.return);break;case 3:al(a);break;case 12:al(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&2&&(a.return===null||a.return.tag!==13)?(s._visibility&=-3,qc(a)):al(a);break;default:al(a)}}function qc(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var d=s[u];bn=d,Lm(d,a)}Nm(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:sr(8,s,s.return),qc(s);break;case 22:u=s.stateNode,u._visibility&2&&(u._visibility&=-3,qc(s));break;default:qc(s)}a=a.sibling}}function Lm(a,s){for(;bn!==null;){var u=bn;switch(u.tag){case 0:case 11:case 15:sr(8,u,s);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var d=u.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Ho(u.memoizedState.cache)}if(d=u.child,d!==null)d.return=u,bn=d;else t:for(u=a;bn!==null;){d=bn;var x=d.sibling,_=d.return;if(Tm(d),d===u){bn=null;break t}if(x!==null){x.return=_,bn=x;break t}bn=_}}}var G_={getCacheForType:function(a){var s=Dn(ln),u=s.data.get(a);return u===void 0&&(u=a(),s.data.set(a,u)),u},cacheSignal:function(){return Dn(ln).controller.signal}},V_=typeof WeakMap=="function"?WeakMap:Map,Ae=0,Ie=null,ue=null,fe=0,Ce=0,mi=null,or=!1,js=!1,Jf=!1,La=0,Qe=0,lr=0,Yr=0,Qf=0,vi=0,Gs=0,rl=null,ai=null,td=!1,$c=0,Bm=0,Zc=1/0,Jc=null,cr=null,vn=0,ur=null,Vs=null,Ba=0,ed=0,nd=null,Im=null,sl=0,id=null;function yi(){return(Ae&2)!==0&&fe!==0?fe&-fe:Q.T!==null?cd():N()}function Um(){if(vi===0)if((fe&536870912)===0||ge){var a=_a;_a<<=1,(_a&3932160)===0&&(_a=262144),vi=a}else vi=536870912;return a=gi.current,a!==null&&(a.flags|=32),vi}function ri(a,s,u){(a===Ie&&(Ce===2||Ce===9)||a.cancelPendingCommit!==null)&&(Xs(a,0),hr(a,fe,vi,!1)),Rr(a,u),((Ae&2)===0||a!==Ie)&&(a===Ie&&((Ae&2)===0&&(Yr|=u),Qe===4&&hr(a,fe,vi,!1)),oa(a))}function zm(a,s,u){if((Ae&6)!==0)throw Error(n(327));var d=!u&&(s&127)===0&&(s&a.expiredLanes)===0||Or(a,s),x=d?W_(a,s):rd(a,s,!0),_=d;do{if(x===0){js&&!d&&hr(a,s,0,!1);break}else{if(u=a.current.alternate,_&&!X_(u)){x=rd(a,s,!1),_=!1;continue}if(x===2){if(_=s,a.errorRecoveryDisabledLanes&_)var T=0;else T=a.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;t:{var B=a;x=rl;var et=B.current.memoizedState.isDehydrated;if(et&&(Xs(B,T).flags|=256),T=rd(B,T,!1),T!==2){if(Jf&&!et){B.errorRecoveryDisabledLanes|=_,Yr|=_,x=4;break t}_=ai,ai=x,_!==null&&(ai===null?ai=_:ai.push.apply(ai,_))}x=T}if(_=!1,x!==2)continue}}if(x===1){Xs(a,0),hr(a,s,0,!0);break}t:{switch(d=a,_=x,_){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:hr(d,s,vi,!or);break t;case 2:ai=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(x=$c+300-It(),10<x)){if(hr(d,s,vi,!or),vs(d,0,!0)!==0)break t;Ba=s,d.timeoutHandle=v1(Hm.bind(null,d,u,ai,Jc,td,s,vi,Yr,Gs,or,_,"Throttled",-0,0),x);break t}Hm(d,u,ai,Jc,td,s,vi,Yr,Gs,or,_,null,-0,0)}}break}while(!0);oa(a)}function Hm(a,s,u,d,x,_,T,B,et,ut,wt,Dt,pt,xt){if(a.timeoutHandle=-1,Dt=s.subtreeFlags,Dt&8192||(Dt&16785408)===16785408){Dt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Aa},Mm(s,_,Dt);var Wt=(_&62914560)===_?$c-It():(_&4194048)===_?Bm-It():0;if(Wt=Db(Dt,Wt),Wt!==null){Ba=_,a.cancelPendingCommit=Wt(qm.bind(null,a,s,_,u,d,x,T,B,et,wt,Dt,null,pt,xt)),hr(a,_,T,!ut);return}}qm(a,s,_,u,d,x,T,B,et)}function X_(a){for(var s=a;;){var u=s.tag;if((u===0||u===11||u===15)&&s.flags&16384&&(u=s.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var d=0;d<u.length;d++){var x=u[d],_=x.getSnapshot;x=x.value;try{if(!fi(_(),x))return!1}catch{return!1}}if(u=s.child,s.subtreeFlags&16384&&u!==null)u.return=s,s=u;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function hr(a,s,u,d){s&=~Qf,s&=~Yr,a.suspendedLanes|=s,a.pingedLanes&=~s,d&&(a.warmLanes|=s),d=a.expirationTimes;for(var x=s;0<x;){var _=31-je(x),T=1<<_;d[_]=-1,x&=~T}u!==0&&lc(a,u,s)}function Qc(){return(Ae&6)===0?(ol(0),!1):!0}function ad(){if(ue!==null){if(Ce===0)var a=ue.return;else a=ue,Ta=Ur=null,_f(a),Fs=null,Go=0,a=ue;for(;a!==null;)ym(a.alternate,a),a=a.return;ue=null}}function Xs(a,s){var u=a.timeoutHandle;u!==-1&&(a.timeoutHandle=-1,hb(u)),u=a.cancelPendingCommit,u!==null&&(a.cancelPendingCommit=null,u()),Ba=0,ad(),Ie=a,ue=u=wa(a.current,null),fe=s,Ce=0,mi=null,or=!1,js=Or(a,s),Jf=!1,Gs=vi=Qf=Yr=lr=Qe=0,ai=rl=null,td=!1,(s&8)!==0&&(s|=s&32);var d=a.entangledLanes;if(d!==0)for(a=a.entanglements,d&=s;0<d;){var x=31-je(d),_=1<<x;s|=a[x],d&=~_}return La=s,_c(),u}function jm(a,s){oe=null,Q.H=Zo,s===Ns||s===kc?(s=ap(),Ce=3):s===lf?(s=ap(),Ce=4):Ce=s===Lf?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,mi=s,ue===null&&(Qe=1,jc(a,Pi(s,a.current)))}function Gm(){var a=gi.current;return a===null?!0:(fe&4194048)===fe?Li===null:(fe&62914560)===fe||(fe&536870912)!==0?a===Li:!1}function Vm(){var a=Q.H;return Q.H=Zo,a===null?Zo:a}function Xm(){var a=Q.A;return Q.A=G_,a}function tu(){Qe=4,or||(fe&4194048)!==fe&&gi.current!==null||(js=!0),(lr&134217727)===0&&(Yr&134217727)===0||Ie===null||hr(Ie,fe,vi,!1)}function rd(a,s,u){var d=Ae;Ae|=2;var x=Vm(),_=Xm();(Ie!==a||fe!==s)&&(Jc=null,Xs(a,s)),s=!1;var T=Qe;t:do try{if(Ce!==0&&ue!==null){var B=ue,et=mi;switch(Ce){case 8:ad(),T=6;break t;case 3:case 2:case 9:case 6:gi.current===null&&(s=!0);var ut=Ce;if(Ce=0,mi=null,Ks(a,B,et,ut),u&&js){T=0;break t}break;default:ut=Ce,Ce=0,mi=null,Ks(a,B,et,ut)}}K_(),T=Qe;break}catch(wt){jm(a,wt)}while(!0);return s&&a.shellSuspendCounter++,Ta=Ur=null,Ae=d,Q.H=x,Q.A=_,ue===null&&(Ie=null,fe=0,_c()),T}function K_(){for(;ue!==null;)Km(ue)}function W_(a,s){var u=Ae;Ae|=2;var d=Vm(),x=Xm();Ie!==a||fe!==s?(Jc=null,Zc=It()+500,Xs(a,s)):js=Or(a,s);t:do try{if(Ce!==0&&ue!==null){s=ue;var _=mi;e:switch(Ce){case 1:Ce=0,mi=null,Ks(a,s,_,1);break;case 2:case 9:if(np(_)){Ce=0,mi=null,Wm(s);break}s=function(){Ce!==2&&Ce!==9||Ie!==a||(Ce=7),oa(a)},_.then(s,s);break t;case 3:Ce=7;break t;case 4:Ce=5;break t;case 7:np(_)?(Ce=0,mi=null,Wm(s)):(Ce=0,mi=null,Ks(a,s,_,7));break;case 5:var T=null;switch(ue.tag){case 26:T=ue.memoizedState;case 5:case 27:var B=ue;if(T?P1(T):B.stateNode.complete){Ce=0,mi=null;var et=B.sibling;if(et!==null)ue=et;else{var ut=B.return;ut!==null?(ue=ut,eu(ut)):ue=null}break e}}Ce=0,mi=null,Ks(a,s,_,5);break;case 6:Ce=0,mi=null,Ks(a,s,_,6);break;case 8:ad(),Qe=6;break t;default:throw Error(n(462))}}Y_();break}catch(wt){jm(a,wt)}while(!0);return Ta=Ur=null,Q.H=d,Q.A=x,Ae=u,ue!==null?0:(Ie=null,fe=0,_c(),Qe)}function Y_(){for(;ue!==null&&!ht();)Km(ue)}function Km(a){var s=mm(a.alternate,a,La);a.memoizedProps=a.pendingProps,s===null?eu(a):ue=s}function Wm(a){var s=a,u=s.alternate;switch(s.tag){case 15:case 0:s=um(u,s,s.pendingProps,s.type,void 0,fe);break;case 11:s=um(u,s,s.pendingProps,s.type.render,s.ref,fe);break;case 5:_f(s);default:ym(u,s),s=ue=Xg(s,La),s=mm(u,s,La)}a.memoizedProps=a.pendingProps,s===null?eu(a):ue=s}function Ks(a,s,u,d){Ta=Ur=null,_f(s),Fs=null,Go=0;var x=s.return;try{if(L_(a,x,s,u,fe)){Qe=1,jc(a,Pi(u,a.current)),ue=null;return}}catch(_){if(x!==null)throw ue=x,_;Qe=1,jc(a,Pi(u,a.current)),ue=null;return}s.flags&32768?(ge||d===1?a=!0:js||(fe&536870912)!==0?a=!1:(or=a=!0,(d===2||d===9||d===3||d===6)&&(d=gi.current,d!==null&&d.tag===13&&(d.flags|=16384))),Ym(s,a)):eu(s)}function eu(a){var s=a;do{if((s.flags&32768)!==0){Ym(s,or);return}a=s.return;var u=U_(s.alternate,s,La);if(u!==null){ue=u;return}if(s=s.sibling,s!==null){ue=s;return}ue=s=a}while(s!==null);Qe===0&&(Qe=5)}function Ym(a,s){do{var u=z_(a.alternate,a);if(u!==null){u.flags&=32767,ue=u;return}if(u=a.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!s&&(a=a.sibling,a!==null)){ue=a;return}ue=a=u}while(a!==null);Qe=6,ue=null}function qm(a,s,u,d,x,_,T,B,et){a.cancelPendingCommit=null;do nu();while(vn!==0);if((Ae&6)!==0)throw Error(n(327));if(s!==null){if(s===a.current)throw Error(n(177));if(_=s.lanes|s.childLanes,_|=Kh,wh(a,u,_,T,B,et),a===Ie&&(ue=Ie=null,fe=0),Vs=s,ur=a,Ba=u,ed=_,nd=x,Im=d,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,J_(ne,function(){return t1(),null})):(a.callbackNode=null,a.callbackPriority=0),d=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||d){d=Q.T,Q.T=null,x=J.p,J.p=2,T=Ae,Ae|=4;try{H_(a,s,u)}finally{Ae=T,J.p=x,Q.T=d}}vn=1,$m(),Zm(),Jm()}}function $m(){if(vn===1){vn=0;var a=ur,s=Vs,u=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||u){u=Q.T,Q.T=null;var d=J.p;J.p=2;var x=Ae;Ae|=4;try{Om(s,a);var _=vd,T=Lg(a.containerInfo),B=_.focusedElem,et=_.selectionRange;if(T!==B&&B&&B.ownerDocument&&Fg(B.ownerDocument.documentElement,B)){if(et!==null&&Hh(B)){var ut=et.start,wt=et.end;if(wt===void 0&&(wt=ut),"selectionStart"in B)B.selectionStart=ut,B.selectionEnd=Math.min(wt,B.value.length);else{var Dt=B.ownerDocument||document,pt=Dt&&Dt.defaultView||window;if(pt.getSelection){var xt=pt.getSelection(),Wt=B.textContent.length,ee=Math.min(et.start,Wt),Fe=et.end===void 0?ee:Math.min(et.end,Wt);!xt.extend&&ee>Fe&&(T=Fe,Fe=ee,ee=T);var st=Ng(B,ee),it=Ng(B,Fe);if(st&&it&&(xt.rangeCount!==1||xt.anchorNode!==st.node||xt.anchorOffset!==st.offset||xt.focusNode!==it.node||xt.focusOffset!==it.offset)){var ct=Dt.createRange();ct.setStart(st.node,st.offset),xt.removeAllRanges(),ee>Fe?(xt.addRange(ct),xt.extend(it.node,it.offset)):(ct.setEnd(it.node,it.offset),xt.addRange(ct))}}}}for(Dt=[],xt=B;xt=xt.parentNode;)xt.nodeType===1&&Dt.push({element:xt,left:xt.scrollLeft,top:xt.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Dt.length;B++){var Ct=Dt[B];Ct.element.scrollLeft=Ct.left,Ct.element.scrollTop=Ct.top}}gu=!!md,vd=md=null}finally{Ae=x,J.p=d,Q.T=u}}a.current=s,vn=2}}function Zm(){if(vn===2){vn=0;var a=ur,s=Vs,u=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||u){u=Q.T,Q.T=null;var d=J.p;J.p=2;var x=Ae;Ae|=4;try{Em(a,s.alternate,s)}finally{Ae=x,J.p=d,Q.T=u}}vn=3}}function Jm(){if(vn===4||vn===3){vn=0,Bt();var a=ur,s=Vs,u=Ba,d=Im;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?vn=5:(vn=0,Vs=ur=null,Qm(a,a.pendingLanes));var x=a.pendingLanes;if(x===0&&(cr=null),ko(u),s=s.stateNode,an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Te,s,void 0,(s.current.flags&128)===128)}catch{}if(d!==null){s=Q.T,x=J.p,J.p=2,Q.T=null;try{for(var _=a.onRecoverableError,T=0;T<d.length;T++){var B=d[T];_(B.value,{componentStack:B.stack})}}finally{Q.T=s,J.p=x}}(Ba&3)!==0&&nu(),oa(a),x=a.pendingLanes,(u&261930)!==0&&(x&42)!==0?a===id?sl++:(sl=0,id=a):sl=0,ol(0)}}function Qm(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,Ho(s)))}function nu(){return $m(),Zm(),Jm(),t1()}function t1(){if(vn!==5)return!1;var a=ur,s=ed;ed=0;var u=ko(Ba),d=Q.T,x=J.p;try{J.p=32>u?32:u,Q.T=null,u=nd,nd=null;var _=ur,T=Ba;if(vn=0,Vs=ur=null,Ba=0,(Ae&6)!==0)throw Error(n(331));var B=Ae;if(Ae|=4,Fm(_.current),Pm(_,_.current,T,u),Ae=B,ol(0,!1),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Te,_)}catch{}return!0}finally{J.p=x,Q.T=d,Qm(a,s)}}function e1(a,s,u){s=Pi(u,s),s=Ff(a.stateNode,s,2),a=ir(a,s,2),a!==null&&(Rr(a,2),oa(a))}function ke(a,s,u){if(a.tag===3)e1(a,a,u);else for(;s!==null;){if(s.tag===3){e1(s,a,u);break}else if(s.tag===1){var d=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(cr===null||!cr.has(d))){a=Pi(u,a),u=nm(2),d=ir(s,u,2),d!==null&&(im(u,d,s,a),Rr(d,2),oa(d));break}}s=s.return}}function sd(a,s,u){var d=a.pingCache;if(d===null){d=a.pingCache=new V_;var x=new Set;d.set(s,x)}else x=d.get(s),x===void 0&&(x=new Set,d.set(s,x));x.has(u)||(Jf=!0,x.add(u),a=q_.bind(null,a,s,u),s.then(a,a))}function q_(a,s,u){var d=a.pingCache;d!==null&&d.delete(s),a.pingedLanes|=a.suspendedLanes&u,a.warmLanes&=~u,Ie===a&&(fe&u)===u&&(Qe===4||Qe===3&&(fe&62914560)===fe&&300>It()-$c?(Ae&2)===0&&Xs(a,0):Qf|=u,Gs===fe&&(Gs=0)),oa(a)}function n1(a,s){s===0&&(s=oc()),a=Lr(a,s),a!==null&&(Rr(a,s),oa(a))}function $_(a){var s=a.memoizedState,u=0;s!==null&&(u=s.retryLane),n1(a,u)}function Z_(a,s){var u=0;switch(a.tag){case 31:case 13:var d=a.stateNode,x=a.memoizedState;x!==null&&(u=x.retryLane);break;case 19:d=a.stateNode;break;case 22:d=a.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(s),n1(a,u)}function J_(a,s){return kt(a,s)}var iu=null,Ws=null,od=!1,au=!1,ld=!1,fr=0;function oa(a){a!==Ws&&a.next===null&&(Ws===null?iu=Ws=a:Ws=Ws.next=a),au=!0,od||(od=!0,tb())}function ol(a,s){if(!ld&&au){ld=!0;do for(var u=!1,d=iu;d!==null;){if(a!==0){var x=d.pendingLanes;if(x===0)var _=0;else{var T=d.suspendedLanes,B=d.pingedLanes;_=(1<<31-je(42|a)+1)-1,_&=x&~(T&~B),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(u=!0,s1(d,_))}else _=fe,_=vs(d,d===Ie?_:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(_&3)===0||Or(d,_)||(u=!0,s1(d,_));d=d.next}while(u);ld=!1}}function Q_(){i1()}function i1(){au=od=!1;var a=0;fr!==0&&ub()&&(a=fr);for(var s=It(),u=null,d=iu;d!==null;){var x=d.next,_=a1(d,s);_===0?(d.next=null,u===null?iu=x:u.next=x,x===null&&(Ws=u)):(u=d,(a!==0||(_&3)!==0)&&(au=!0)),d=x}vn!==0&&vn!==5||ol(a),fr!==0&&(fr=0)}function a1(a,s){for(var u=a.suspendedLanes,d=a.pingedLanes,x=a.expirationTimes,_=a.pendingLanes&-62914561;0<_;){var T=31-je(_),B=1<<T,et=x[T];et===-1?((B&u)===0||(B&d)!==0)&&(x[T]=Sh(B,s)):et<=s&&(a.expiredLanes|=B),_&=~B}if(s=Ie,u=fe,u=vs(a,a===s?u:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),d=a.callbackNode,u===0||a===s&&(Ce===2||Ce===9)||a.cancelPendingCommit!==null)return d!==null&&d!==null&&Rt(d),a.callbackNode=null,a.callbackPriority=0;if((u&3)===0||Or(a,u)){if(s=u&-u,s===a.callbackPriority)return s;switch(d!==null&&Rt(d),ko(u)){case 2:case 8:u=ye;break;case 32:u=ne;break;case 268435456:u=Ki;break;default:u=ne}return d=r1.bind(null,a),u=kt(u,d),a.callbackPriority=s,a.callbackNode=u,s}return d!==null&&d!==null&&Rt(d),a.callbackPriority=2,a.callbackNode=null,2}function r1(a,s){if(vn!==0&&vn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var u=a.callbackNode;if(nu()&&a.callbackNode!==u)return null;var d=fe;return d=vs(a,a===Ie?d:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),d===0?null:(zm(a,d,s),a1(a,It()),a.callbackNode!=null&&a.callbackNode===u?r1.bind(null,a):null)}function s1(a,s){if(nu())return null;zm(a,s,!0)}function tb(){fb(function(){(Ae&6)!==0?kt($t,Q_):i1()})}function cd(){if(fr===0){var a=Ps;a===0&&(a=xa,xa<<=1,(xa&261888)===0&&(xa=256)),fr=a}return fr}function o1(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:fc(""+a)}function l1(a,s){var u=s.ownerDocument.createElement("input");return u.name=s.name,u.value=s.value,a.id&&u.setAttribute("form",a.id),s.parentNode.insertBefore(u,s),a=new FormData(a),u.parentNode.removeChild(u),a}function eb(a,s,u,d,x){if(s==="submit"&&u&&u.stateNode===x){var _=o1((x[W]||null).action),T=d.submitter;T&&(s=(s=T[W]||null)?o1(s.formAction):T.getAttribute("formAction"),s!==null&&(_=s,T=null));var B=new mc("action","action",null,d,x);a.push({event:B,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(fr!==0){var et=T?l1(x,T):new FormData(x);Df(u,{pending:!0,data:et,method:x.method,action:_},null,et)}}else typeof _=="function"&&(B.preventDefault(),et=T?l1(x,T):new FormData(x),Df(u,{pending:!0,data:et,method:x.method,action:_},_,et))},currentTarget:x}]})}}for(var ud=0;ud<Xh.length;ud++){var hd=Xh[ud],nb=hd.toLowerCase(),ib=hd[0].toUpperCase()+hd.slice(1);Wi(nb,"on"+ib)}Wi(Ug,"onAnimationEnd"),Wi(zg,"onAnimationIteration"),Wi(Hg,"onAnimationStart"),Wi("dblclick","onDoubleClick"),Wi("focusin","onFocus"),Wi("focusout","onBlur"),Wi(x_,"onTransitionRun"),Wi(__,"onTransitionStart"),Wi(b_,"onTransitionCancel"),Wi(jg,"onTransitionEnd"),ki("onMouseEnter",["mouseout","mouseover"]),ki("onMouseLeave",["mouseout","mouseover"]),ki("onPointerEnter",["pointerout","pointerover"]),ki("onPointerLeave",["pointerout","pointerover"]),Ke("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ke("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ke("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ke("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ke("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ke("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ab=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ll));function c1(a,s){s=(s&4)!==0;for(var u=0;u<a.length;u++){var d=a[u],x=d.event;d=d.listeners;t:{var _=void 0;if(s)for(var T=d.length-1;0<=T;T--){var B=d[T],et=B.instance,ut=B.currentTarget;if(B=B.listener,et!==_&&x.isPropagationStopped())break t;_=B,x.currentTarget=ut;try{_(x)}catch(wt){xc(wt)}x.currentTarget=null,_=et}else for(T=0;T<d.length;T++){if(B=d[T],et=B.instance,ut=B.currentTarget,B=B.listener,et!==_&&x.isPropagationStopped())break t;_=B,x.currentTarget=ut;try{_(x)}catch(wt){xc(wt)}x.currentTarget=null,_=et}}}}function he(a,s){var u=s[ft];u===void 0&&(u=s[ft]=new Set);var d=a+"__bubble";u.has(d)||(u1(s,a,2,!1),u.add(d))}function fd(a,s,u){var d=0;s&&(d|=4),u1(u,a,d,s)}var ru="_reactListening"+Math.random().toString(36).slice(2);function dd(a){if(!a[ru]){a[ru]=!0,ze.forEach(function(u){u!=="selectionchange"&&(ab.has(u)||fd(u,!1,a),fd(u,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[ru]||(s[ru]=!0,fd("selectionchange",!1,s))}}function u1(a,s,u,d){switch(U1(s)){case 2:var x=Pb;break;case 8:x=Mb;break;default:x=kd}u=x.bind(null,s,u,a),x=void 0,!Ph||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(x=!0),d?x!==void 0?a.addEventListener(s,u,{capture:!0,passive:x}):a.addEventListener(s,u,!0):x!==void 0?a.addEventListener(s,u,{passive:x}):a.addEventListener(s,u,!1)}function gd(a,s,u,d,x){var _=d;if((s&1)===0&&(s&2)===0&&d!==null)t:for(;;){if(d===null)return;var T=d.tag;if(T===3||T===4){var B=d.stateNode.containerInfo;if(B===x)break;if(T===4)for(T=d.return;T!==null;){var et=T.tag;if((et===3||et===4)&&T.stateNode.containerInfo===x)return;T=T.return}for(;B!==null;){if(T=zt(B),T===null)return;if(et=T.tag,et===5||et===6||et===26||et===27){d=_=T;continue t}B=B.parentNode}}d=d.return}pg(function(){var ut=_,wt=Oh(u),Dt=[];t:{var pt=Gg.get(a);if(pt!==void 0){var xt=mc,Wt=a;switch(a){case"keypress":if(gc(u)===0)break t;case"keydown":case"keyup":xt=Zx;break;case"focusin":Wt="focus",xt=Lh;break;case"focusout":Wt="blur",xt=Lh;break;case"beforeblur":case"afterblur":xt=Lh;break;case"click":if(u.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xt=yg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xt=Ux;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xt=t_;break;case Ug:case zg:case Hg:xt=jx;break;case jg:xt=n_;break;case"scroll":case"scrollend":xt=Bx;break;case"wheel":xt=a_;break;case"copy":case"cut":case"paste":xt=Vx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xt=_g;break;case"toggle":case"beforetoggle":xt=s_}var ee=(s&4)!==0,Fe=!ee&&(a==="scroll"||a==="scrollend"),st=ee?pt!==null?pt+"Capture":null:pt;ee=[];for(var it=ut,ct;it!==null;){var Ct=it;if(ct=Ct.stateNode,Ct=Ct.tag,Ct!==5&&Ct!==26&&Ct!==27||ct===null||st===null||(Ct=Oo(it,st),Ct!=null&&ee.push(cl(it,Ct,ct))),Fe)break;it=it.return}0<ee.length&&(pt=new xt(pt,Wt,null,u,wt),Dt.push({event:pt,listeners:ee}))}}if((s&7)===0){t:{if(pt=a==="mouseover"||a==="pointerover",xt=a==="mouseout"||a==="pointerout",pt&&u!==Dh&&(Wt=u.relatedTarget||u.fromElement)&&(zt(Wt)||Wt[q]))break t;if((xt||pt)&&(pt=wt.window===wt?wt:(pt=wt.ownerDocument)?pt.defaultView||pt.parentWindow:window,xt?(Wt=u.relatedTarget||u.toElement,xt=ut,Wt=Wt?zt(Wt):null,Wt!==null&&(Fe=o(Wt),ee=Wt.tag,Wt!==Fe||ee!==5&&ee!==27&&ee!==6)&&(Wt=null)):(xt=null,Wt=ut),xt!==Wt)){if(ee=yg,Ct="onMouseLeave",st="onMouseEnter",it="mouse",(a==="pointerout"||a==="pointerover")&&(ee=_g,Ct="onPointerLeave",st="onPointerEnter",it="pointer"),Fe=xt==null?pt:Lt(xt),ct=Wt==null?pt:Lt(Wt),pt=new ee(Ct,it+"leave",xt,u,wt),pt.target=Fe,pt.relatedTarget=ct,Ct=null,zt(wt)===ut&&(ee=new ee(st,it+"enter",Wt,u,wt),ee.target=ct,ee.relatedTarget=Fe,Ct=ee),Fe=Ct,xt&&Wt)e:{for(ee=rb,st=xt,it=Wt,ct=0,Ct=st;Ct;Ct=ee(Ct))ct++;Ct=0;for(var Jt=it;Jt;Jt=ee(Jt))Ct++;for(;0<ct-Ct;)st=ee(st),ct--;for(;0<Ct-ct;)it=ee(it),Ct--;for(;ct--;){if(st===it||it!==null&&st===it.alternate){ee=st;break e}st=ee(st),it=ee(it)}ee=null}else ee=null;xt!==null&&h1(Dt,pt,xt,ee,!1),Wt!==null&&Fe!==null&&h1(Dt,Fe,Wt,ee,!0)}}t:{if(pt=ut?Lt(ut):window,xt=pt.nodeName&&pt.nodeName.toLowerCase(),xt==="select"||xt==="input"&&pt.type==="file")var xe=kg;else if(Tg(pt))if(Dg)xe=m_;else{xe=g_;var qt=d_}else xt=pt.nodeName,!xt||xt.toLowerCase()!=="input"||pt.type!=="checkbox"&&pt.type!=="radio"?ut&&kh(ut.elementType)&&(xe=kg):xe=p_;if(xe&&(xe=xe(a,ut))){Cg(Dt,xe,u,wt);break t}qt&&qt(a,pt,ut),a==="focusout"&&ut&&pt.type==="number"&&ut.memoizedProps.value!=null&&Ch(pt,"number",pt.value)}switch(qt=ut?Lt(ut):window,a){case"focusin":(Tg(qt)||qt.contentEditable==="true")&&(ws=qt,jh=ut,Io=null);break;case"focusout":Io=jh=ws=null;break;case"mousedown":Gh=!0;break;case"contextmenu":case"mouseup":case"dragend":Gh=!1,Bg(Dt,u,wt);break;case"selectionchange":if(y_)break;case"keydown":case"keyup":Bg(Dt,u,wt)}var le;if(Ih)t:{switch(a){case"compositionstart":var de="onCompositionStart";break t;case"compositionend":de="onCompositionEnd";break t;case"compositionupdate":de="onCompositionUpdate";break t}de=void 0}else Ss?wg(a,u)&&(de="onCompositionEnd"):a==="keydown"&&u.keyCode===229&&(de="onCompositionStart");de&&(bg&&u.locale!=="ko"&&(Ss||de!=="onCompositionStart"?de==="onCompositionEnd"&&Ss&&(le=mg()):($a=wt,Mh="value"in $a?$a.value:$a.textContent,Ss=!0)),qt=su(ut,de),0<qt.length&&(de=new xg(de,a,null,u,wt),Dt.push({event:de,listeners:qt}),le?de.data=le:(le=Eg(u),le!==null&&(de.data=le)))),(le=l_?c_(a,u):u_(a,u))&&(de=su(ut,"onBeforeInput"),0<de.length&&(qt=new xg("onBeforeInput","beforeinput",null,u,wt),Dt.push({event:qt,listeners:de}),qt.data=le)),eb(Dt,a,ut,u,wt)}c1(Dt,s)})}function cl(a,s,u){return{instance:a,listener:s,currentTarget:u}}function su(a,s){for(var u=s+"Capture",d=[];a!==null;){var x=a,_=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||_===null||(x=Oo(a,u),x!=null&&d.unshift(cl(a,x,_)),x=Oo(a,s),x!=null&&d.push(cl(a,x,_))),a.tag===3)return d;a=a.return}return[]}function rb(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function h1(a,s,u,d,x){for(var _=s._reactName,T=[];u!==null&&u!==d;){var B=u,et=B.alternate,ut=B.stateNode;if(B=B.tag,et!==null&&et===d)break;B!==5&&B!==26&&B!==27||ut===null||(et=ut,x?(ut=Oo(u,_),ut!=null&&T.unshift(cl(u,ut,et))):x||(ut=Oo(u,_),ut!=null&&T.push(cl(u,ut,et)))),u=u.return}T.length!==0&&a.push({event:s,listeners:T})}var sb=/\r\n?/g,ob=/\u0000|\uFFFD/g;function f1(a){return(typeof a=="string"?a:""+a).replace(sb,`
`).replace(ob,"")}function d1(a,s){return s=f1(s),f1(a)===s}function Ne(a,s,u,d,x,_){switch(u){case"children":typeof d=="string"?s==="body"||s==="textarea"&&d===""||_s(a,d):(typeof d=="number"||typeof d=="bigint")&&s!=="body"&&_s(a,""+d);break;case"className":uc(a,"class",d);break;case"tabIndex":uc(a,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":uc(a,u,d);break;case"style":dg(a,d,_);break;case"data":if(s!=="object"){uc(a,"data",d);break}case"src":case"href":if(d===""&&(s!=="a"||u!=="href")){a.removeAttribute(u);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){a.removeAttribute(u);break}d=fc(""+d),a.setAttribute(u,d);break;case"action":case"formAction":if(typeof d=="function"){a.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(u==="formAction"?(s!=="input"&&Ne(a,s,"name",x.name,x,null),Ne(a,s,"formEncType",x.formEncType,x,null),Ne(a,s,"formMethod",x.formMethod,x,null),Ne(a,s,"formTarget",x.formTarget,x,null)):(Ne(a,s,"encType",x.encType,x,null),Ne(a,s,"method",x.method,x,null),Ne(a,s,"target",x.target,x,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){a.removeAttribute(u);break}d=fc(""+d),a.setAttribute(u,d);break;case"onClick":d!=null&&(a.onclick=Aa);break;case"onScroll":d!=null&&he("scroll",a);break;case"onScrollEnd":d!=null&&he("scrollend",a);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(u=d.__html,u!=null){if(x.children!=null)throw Error(n(60));a.innerHTML=u}}break;case"multiple":a.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":a.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){a.removeAttribute("xlink:href");break}u=fc(""+d),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(u,""+d):a.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(u,""):a.removeAttribute(u);break;case"capture":case"download":d===!0?a.setAttribute(u,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(u,d):a.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?a.setAttribute(u,d):a.removeAttribute(u);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?a.removeAttribute(u):a.setAttribute(u,d);break;case"popover":he("beforetoggle",a),he("toggle",a),Qn(a,"popover",d);break;case"xlinkActuate":ba(a,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":ba(a,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":ba(a,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":ba(a,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":ba(a,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":ba(a,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":ba(a,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":ba(a,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":ba(a,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Qn(a,"is",d);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Fx.get(u)||u,Qn(a,u,d))}}function pd(a,s,u,d,x,_){switch(u){case"style":dg(a,d,_);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(u=d.__html,u!=null){if(x.children!=null)throw Error(n(60));a.innerHTML=u}}break;case"children":typeof d=="string"?_s(a,d):(typeof d=="number"||typeof d=="bigint")&&_s(a,""+d);break;case"onScroll":d!=null&&he("scroll",a);break;case"onScrollEnd":d!=null&&he("scrollend",a);break;case"onClick":d!=null&&(a.onclick=Aa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!He.hasOwnProperty(u))t:{if(u[0]==="o"&&u[1]==="n"&&(x=u.endsWith("Capture"),s=u.slice(2,x?u.length-7:void 0),_=a[W]||null,_=_!=null?_[u]:null,typeof _=="function"&&a.removeEventListener(s,_,x),typeof d=="function")){typeof _!="function"&&_!==null&&(u in a?a[u]=null:a.hasAttribute(u)&&a.removeAttribute(u)),a.addEventListener(s,d,x);break t}u in a?a[u]=d:d===!0?a.setAttribute(u,""):Qn(a,u,d)}}}function Rn(a,s,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":he("error",a),he("load",a);var d=!1,x=!1,_;for(_ in u)if(u.hasOwnProperty(_)){var T=u[_];if(T!=null)switch(_){case"src":d=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Ne(a,s,_,T,u,null)}}x&&Ne(a,s,"srcSet",u.srcSet,u,null),d&&Ne(a,s,"src",u.src,u,null);return;case"input":he("invalid",a);var B=_=T=x=null,et=null,ut=null;for(d in u)if(u.hasOwnProperty(d)){var wt=u[d];if(wt!=null)switch(d){case"name":x=wt;break;case"type":T=wt;break;case"checked":et=wt;break;case"defaultChecked":ut=wt;break;case"value":_=wt;break;case"defaultValue":B=wt;break;case"children":case"dangerouslySetInnerHTML":if(wt!=null)throw Error(n(137,s));break;default:Ne(a,s,d,wt,u,null)}}cg(a,_,B,et,ut,T,x,!1);return;case"select":he("invalid",a),d=T=_=null;for(x in u)if(u.hasOwnProperty(x)&&(B=u[x],B!=null))switch(x){case"value":_=B;break;case"defaultValue":T=B;break;case"multiple":d=B;default:Ne(a,s,x,B,u,null)}s=_,u=T,a.multiple=!!d,s!=null?xs(a,!!d,s,!1):u!=null&&xs(a,!!d,u,!0);return;case"textarea":he("invalid",a),_=x=d=null;for(T in u)if(u.hasOwnProperty(T)&&(B=u[T],B!=null))switch(T){case"value":d=B;break;case"defaultValue":x=B;break;case"children":_=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(n(91));break;default:Ne(a,s,T,B,u,null)}hg(a,d,x,_);return;case"option":for(et in u)u.hasOwnProperty(et)&&(d=u[et],d!=null)&&(et==="selected"?a.selected=d&&typeof d!="function"&&typeof d!="symbol":Ne(a,s,et,d,u,null));return;case"dialog":he("beforetoggle",a),he("toggle",a),he("cancel",a),he("close",a);break;case"iframe":case"object":he("load",a);break;case"video":case"audio":for(d=0;d<ll.length;d++)he(ll[d],a);break;case"image":he("error",a),he("load",a);break;case"details":he("toggle",a);break;case"embed":case"source":case"link":he("error",a),he("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ut in u)if(u.hasOwnProperty(ut)&&(d=u[ut],d!=null))switch(ut){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Ne(a,s,ut,d,u,null)}return;default:if(kh(s)){for(wt in u)u.hasOwnProperty(wt)&&(d=u[wt],d!==void 0&&pd(a,s,wt,d,u,void 0));return}}for(B in u)u.hasOwnProperty(B)&&(d=u[B],d!=null&&Ne(a,s,B,d,u,null))}function lb(a,s,u,d){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,_=null,T=null,B=null,et=null,ut=null,wt=null;for(xt in u){var Dt=u[xt];if(u.hasOwnProperty(xt)&&Dt!=null)switch(xt){case"checked":break;case"value":break;case"defaultValue":et=Dt;default:d.hasOwnProperty(xt)||Ne(a,s,xt,null,d,Dt)}}for(var pt in d){var xt=d[pt];if(Dt=u[pt],d.hasOwnProperty(pt)&&(xt!=null||Dt!=null))switch(pt){case"type":_=xt;break;case"name":x=xt;break;case"checked":ut=xt;break;case"defaultChecked":wt=xt;break;case"value":T=xt;break;case"defaultValue":B=xt;break;case"children":case"dangerouslySetInnerHTML":if(xt!=null)throw Error(n(137,s));break;default:xt!==Dt&&Ne(a,s,pt,xt,d,Dt)}}Th(a,T,B,et,ut,wt,_,x);return;case"select":xt=T=B=pt=null;for(_ in u)if(et=u[_],u.hasOwnProperty(_)&&et!=null)switch(_){case"value":break;case"multiple":xt=et;default:d.hasOwnProperty(_)||Ne(a,s,_,null,d,et)}for(x in d)if(_=d[x],et=u[x],d.hasOwnProperty(x)&&(_!=null||et!=null))switch(x){case"value":pt=_;break;case"defaultValue":B=_;break;case"multiple":T=_;default:_!==et&&Ne(a,s,x,_,d,et)}s=B,u=T,d=xt,pt!=null?xs(a,!!u,pt,!1):!!d!=!!u&&(s!=null?xs(a,!!u,s,!0):xs(a,!!u,u?[]:"",!1));return;case"textarea":xt=pt=null;for(B in u)if(x=u[B],u.hasOwnProperty(B)&&x!=null&&!d.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:Ne(a,s,B,null,d,x)}for(T in d)if(x=d[T],_=u[T],d.hasOwnProperty(T)&&(x!=null||_!=null))switch(T){case"value":pt=x;break;case"defaultValue":xt=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(n(91));break;default:x!==_&&Ne(a,s,T,x,d,_)}ug(a,pt,xt);return;case"option":for(var Wt in u)pt=u[Wt],u.hasOwnProperty(Wt)&&pt!=null&&!d.hasOwnProperty(Wt)&&(Wt==="selected"?a.selected=!1:Ne(a,s,Wt,null,d,pt));for(et in d)pt=d[et],xt=u[et],d.hasOwnProperty(et)&&pt!==xt&&(pt!=null||xt!=null)&&(et==="selected"?a.selected=pt&&typeof pt!="function"&&typeof pt!="symbol":Ne(a,s,et,pt,d,xt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ee in u)pt=u[ee],u.hasOwnProperty(ee)&&pt!=null&&!d.hasOwnProperty(ee)&&Ne(a,s,ee,null,d,pt);for(ut in d)if(pt=d[ut],xt=u[ut],d.hasOwnProperty(ut)&&pt!==xt&&(pt!=null||xt!=null))switch(ut){case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(n(137,s));break;default:Ne(a,s,ut,pt,d,xt)}return;default:if(kh(s)){for(var Fe in u)pt=u[Fe],u.hasOwnProperty(Fe)&&pt!==void 0&&!d.hasOwnProperty(Fe)&&pd(a,s,Fe,void 0,d,pt);for(wt in d)pt=d[wt],xt=u[wt],!d.hasOwnProperty(wt)||pt===xt||pt===void 0&&xt===void 0||pd(a,s,wt,pt,d,xt);return}}for(var st in u)pt=u[st],u.hasOwnProperty(st)&&pt!=null&&!d.hasOwnProperty(st)&&Ne(a,s,st,null,d,pt);for(Dt in d)pt=d[Dt],xt=u[Dt],!d.hasOwnProperty(Dt)||pt===xt||pt==null&&xt==null||Ne(a,s,Dt,pt,d,xt)}function g1(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function cb(){if(typeof performance.getEntriesByType=="function"){for(var a=0,s=0,u=performance.getEntriesByType("resource"),d=0;d<u.length;d++){var x=u[d],_=x.transferSize,T=x.initiatorType,B=x.duration;if(_&&B&&g1(T)){for(T=0,B=x.responseEnd,d+=1;d<u.length;d++){var et=u[d],ut=et.startTime;if(ut>B)break;var wt=et.transferSize,Dt=et.initiatorType;wt&&g1(Dt)&&(et=et.responseEnd,T+=wt*(et<B?1:(B-ut)/(et-ut)))}if(--d,s+=8*(_+T)/(x.duration/1e3),a++,10<a)break}}if(0<a)return s/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var md=null,vd=null;function ou(a){return a.nodeType===9?a:a.ownerDocument}function p1(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function m1(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function yd(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var xd=null;function ub(){var a=window.event;return a&&a.type==="popstate"?a===xd?!1:(xd=a,!0):(xd=null,!1)}var v1=typeof setTimeout=="function"?setTimeout:void 0,hb=typeof clearTimeout=="function"?clearTimeout:void 0,y1=typeof Promise=="function"?Promise:void 0,fb=typeof queueMicrotask=="function"?queueMicrotask:typeof y1<"u"?function(a){return y1.resolve(null).then(a).catch(db)}:v1;function db(a){setTimeout(function(){throw a})}function dr(a){return a==="head"}function x1(a,s){var u=s,d=0;do{var x=u.nextSibling;if(a.removeChild(u),x&&x.nodeType===8)if(u=x.data,u==="/$"||u==="/&"){if(d===0){a.removeChild(x),Zs(s);return}d--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")d++;else if(u==="html")ul(a.ownerDocument.documentElement);else if(u==="head"){u=a.ownerDocument.head,ul(u);for(var _=u.firstChild;_;){var T=_.nextSibling,B=_.nodeName;_[mt]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&_.rel.toLowerCase()==="stylesheet"||u.removeChild(_),_=T}}else u==="body"&&ul(a.ownerDocument.body);u=x}while(u);Zs(s)}function _1(a,s){var u=a;a=0;do{var d=u.nextSibling;if(u.nodeType===1?s?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(s?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),d&&d.nodeType===8)if(u=d.data,u==="/$"){if(a===0)break;a--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||a++;u=d}while(u)}function _d(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var u=s;switch(s=s.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":_d(u),Ft(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}a.removeChild(u)}}function gb(a,s,u,d){for(;a.nodeType===1;){var x=u;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!d&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(d){if(!a[mt])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(_=a.getAttribute("rel"),_==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(_!==x.rel||a.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||a.getAttribute("title")!==(x.title==null?null:x.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(_=a.getAttribute("src"),(_!==(x.src==null?null:x.src)||a.getAttribute("type")!==(x.type==null?null:x.type)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&_&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var _=x.name==null?null:""+x.name;if(x.type==="hidden"&&a.getAttribute("name")===_)return a}else return a;if(a=Bi(a.nextSibling),a===null)break}return null}function pb(a,s,u){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!u||(a=Bi(a.nextSibling),a===null))return null;return a}function b1(a,s){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!s||(a=Bi(a.nextSibling),a===null))return null;return a}function bd(a){return a.data==="$?"||a.data==="$~"}function Ad(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function mb(a,s){var u=a.ownerDocument;if(a.data==="$~")a._reactRetry=s;else if(a.data!=="$?"||u.readyState!=="loading")s();else{var d=function(){s(),u.removeEventListener("DOMContentLoaded",d)};u.addEventListener("DOMContentLoaded",d),a._reactRetry=d}}function Bi(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return a}var Sd=null;function A1(a){a=a.nextSibling;for(var s=0;a;){if(a.nodeType===8){var u=a.data;if(u==="/$"||u==="/&"){if(s===0)return Bi(a.nextSibling);s--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||s++}a=a.nextSibling}return null}function S1(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var u=a.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(s===0)return a;s--}else u!=="/$"&&u!=="/&"||s++}a=a.previousSibling}return null}function w1(a,s,u){switch(s=ou(u),a){case"html":if(a=s.documentElement,!a)throw Error(n(452));return a;case"head":if(a=s.head,!a)throw Error(n(453));return a;case"body":if(a=s.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function ul(a){for(var s=a.attributes;s.length;)a.removeAttributeNode(s[0]);Ft(a)}var Ii=new Map,E1=new Set;function lu(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Ia=J.d;J.d={f:vb,r:yb,D:xb,C:_b,L:bb,m:Ab,X:wb,S:Sb,M:Eb};function vb(){var a=Ia.f(),s=Qc();return a||s}function yb(a){var s=Vt(a);s!==null&&s.tag===5&&s.type==="form"?jp(s):Ia.r(a)}var Ys=typeof document>"u"?null:document;function T1(a,s,u){var d=Ys;if(d&&typeof s=="string"&&s){var x=Oi(s);x='link[rel="'+a+'"][href="'+x+'"]',typeof u=="string"&&(x+='[crossorigin="'+u+'"]'),E1.has(x)||(E1.add(x),a={rel:a,crossOrigin:u,href:s},d.querySelector(x)===null&&(s=d.createElement("link"),Rn(s,"link",a),Yt(s),d.head.appendChild(s)))}}function xb(a){Ia.D(a),T1("dns-prefetch",a,null)}function _b(a,s){Ia.C(a,s),T1("preconnect",a,s)}function bb(a,s,u){Ia.L(a,s,u);var d=Ys;if(d&&a&&s){var x='link[rel="preload"][as="'+Oi(s)+'"]';s==="image"&&u&&u.imageSrcSet?(x+='[imagesrcset="'+Oi(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(x+='[imagesizes="'+Oi(u.imageSizes)+'"]')):x+='[href="'+Oi(a)+'"]';var _=x;switch(s){case"style":_=qs(a);break;case"script":_=$s(a)}Ii.has(_)||(a=p({rel:"preload",href:s==="image"&&u&&u.imageSrcSet?void 0:a,as:s},u),Ii.set(_,a),d.querySelector(x)!==null||s==="style"&&d.querySelector(hl(_))||s==="script"&&d.querySelector(fl(_))||(s=d.createElement("link"),Rn(s,"link",a),Yt(s),d.head.appendChild(s)))}}function Ab(a,s){Ia.m(a,s);var u=Ys;if(u&&a){var d=s&&typeof s.as=="string"?s.as:"script",x='link[rel="modulepreload"][as="'+Oi(d)+'"][href="'+Oi(a)+'"]',_=x;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=$s(a)}if(!Ii.has(_)&&(a=p({rel:"modulepreload",href:a},s),Ii.set(_,a),u.querySelector(x)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(fl(_)))return}d=u.createElement("link"),Rn(d,"link",a),Yt(d),u.head.appendChild(d)}}}function Sb(a,s,u){Ia.S(a,s,u);var d=Ys;if(d&&a){var x=Gt(d).hoistableStyles,_=qs(a);s=s||"default";var T=x.get(_);if(!T){var B={loading:0,preload:null};if(T=d.querySelector(hl(_)))B.loading=5;else{a=p({rel:"stylesheet",href:a,"data-precedence":s},u),(u=Ii.get(_))&&wd(a,u);var et=T=d.createElement("link");Yt(et),Rn(et,"link",a),et._p=new Promise(function(ut,wt){et.onload=ut,et.onerror=wt}),et.addEventListener("load",function(){B.loading|=1}),et.addEventListener("error",function(){B.loading|=2}),B.loading|=4,cu(T,s,d)}T={type:"stylesheet",instance:T,count:1,state:B},x.set(_,T)}}}function wb(a,s){Ia.X(a,s);var u=Ys;if(u&&a){var d=Gt(u).hoistableScripts,x=$s(a),_=d.get(x);_||(_=u.querySelector(fl(x)),_||(a=p({src:a,async:!0},s),(s=Ii.get(x))&&Ed(a,s),_=u.createElement("script"),Yt(_),Rn(_,"link",a),u.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},d.set(x,_))}}function Eb(a,s){Ia.M(a,s);var u=Ys;if(u&&a){var d=Gt(u).hoistableScripts,x=$s(a),_=d.get(x);_||(_=u.querySelector(fl(x)),_||(a=p({src:a,async:!0,type:"module"},s),(s=Ii.get(x))&&Ed(a,s),_=u.createElement("script"),Yt(_),Rn(_,"link",a),u.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},d.set(x,_))}}function C1(a,s,u,d){var x=(x=ot.current)?lu(x):null;if(!x)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(s=qs(u.href),u=Gt(x).hoistableStyles,d=u.get(s),d||(d={type:"style",instance:null,count:0,state:null},u.set(s,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){a=qs(u.href);var _=Gt(x).hoistableStyles,T=_.get(a);if(T||(x=x.ownerDocument||x,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(a,T),(_=x.querySelector(hl(a)))&&!_._p&&(T.instance=_,T.state.loading=5),Ii.has(a)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ii.set(a,u),_||Tb(x,a,u,T.state))),s&&d===null)throw Error(n(528,""));return T}if(s&&d!==null)throw Error(n(529,""));return null;case"script":return s=u.async,u=u.src,typeof u=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=$s(u),u=Gt(x).hoistableScripts,d=u.get(s),d||(d={type:"script",instance:null,count:0,state:null},u.set(s,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function qs(a){return'href="'+Oi(a)+'"'}function hl(a){return'link[rel="stylesheet"]['+a+"]"}function k1(a){return p({},a,{"data-precedence":a.precedence,precedence:null})}function Tb(a,s,u,d){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?d.loading=1:(s=a.createElement("link"),d.preload=s,s.addEventListener("load",function(){return d.loading|=1}),s.addEventListener("error",function(){return d.loading|=2}),Rn(s,"link",u),Yt(s),a.head.appendChild(s))}function $s(a){return'[src="'+Oi(a)+'"]'}function fl(a){return"script[async]"+a}function D1(a,s,u){if(s.count++,s.instance===null)switch(s.type){case"style":var d=a.querySelector('style[data-href~="'+Oi(u.href)+'"]');if(d)return s.instance=d,Yt(d),d;var x=p({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return d=(a.ownerDocument||a).createElement("style"),Yt(d),Rn(d,"style",x),cu(d,u.precedence,a),s.instance=d;case"stylesheet":x=qs(u.href);var _=a.querySelector(hl(x));if(_)return s.state.loading|=4,s.instance=_,Yt(_),_;d=k1(u),(x=Ii.get(x))&&wd(d,x),_=(a.ownerDocument||a).createElement("link"),Yt(_);var T=_;return T._p=new Promise(function(B,et){T.onload=B,T.onerror=et}),Rn(_,"link",d),s.state.loading|=4,cu(_,u.precedence,a),s.instance=_;case"script":return _=$s(u.src),(x=a.querySelector(fl(_)))?(s.instance=x,Yt(x),x):(d=u,(x=Ii.get(_))&&(d=p({},u),Ed(d,x)),a=a.ownerDocument||a,x=a.createElement("script"),Yt(x),Rn(x,"link",d),a.head.appendChild(x),s.instance=x);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(d=s.instance,s.state.loading|=4,cu(d,u.precedence,a));return s.instance}function cu(a,s,u){for(var d=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=d.length?d[d.length-1]:null,_=x,T=0;T<d.length;T++){var B=d[T];if(B.dataset.precedence===s)_=B;else if(_!==x)break}_?_.parentNode.insertBefore(a,_.nextSibling):(s=u.nodeType===9?u.head:u,s.insertBefore(a,s.firstChild))}function wd(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function Ed(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var uu=null;function O1(a,s,u){if(uu===null){var d=new Map,x=uu=new Map;x.set(u,d)}else x=uu,d=x.get(u),d||(d=new Map,x.set(u,d));if(d.has(a))return d;for(d.set(a,null),u=u.getElementsByTagName(a),x=0;x<u.length;x++){var _=u[x];if(!(_[mt]||_[G]||a==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var T=_.getAttribute(s)||"";T=a+T;var B=d.get(T);B?B.push(_):d.set(T,[_])}}return d}function R1(a,s,u){a=a.ownerDocument||a,a.head.insertBefore(u,s==="title"?a.querySelector("head > title"):null)}function Cb(a,s,u){if(u===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(a=s.disabled,typeof s.precedence=="string"&&a==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function P1(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function kb(a,s,u,d){if(u.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var x=qs(d.href),_=s.querySelector(hl(x));if(_){s=_._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(a.count++,a=hu.bind(a),s.then(a,a)),u.state.loading|=4,u.instance=_,Yt(_);return}_=s.ownerDocument||s,d=k1(d),(x=Ii.get(x))&&wd(d,x),_=_.createElement("link"),Yt(_);var T=_;T._p=new Promise(function(B,et){T.onload=B,T.onerror=et}),Rn(_,"link",d),u.instance=_}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(u,s),(s=u.state.preload)&&(u.state.loading&3)===0&&(a.count++,u=hu.bind(a),s.addEventListener("load",u),s.addEventListener("error",u))}}var Td=0;function Db(a,s){return a.stylesheets&&a.count===0&&du(a,a.stylesheets),0<a.count||0<a.imgCount?function(u){var d=setTimeout(function(){if(a.stylesheets&&du(a,a.stylesheets),a.unsuspend){var _=a.unsuspend;a.unsuspend=null,_()}},6e4+s);0<a.imgBytes&&Td===0&&(Td=62500*cb());var x=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&du(a,a.stylesheets),a.unsuspend)){var _=a.unsuspend;a.unsuspend=null,_()}},(a.imgBytes>Td?50:800)+s);return a.unsuspend=u,function(){a.unsuspend=null,clearTimeout(d),clearTimeout(x)}}:null}function hu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)du(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var fu=null;function du(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,fu=new Map,s.forEach(Ob,a),fu=null,hu.call(a))}function Ob(a,s){if(!(s.state.loading&4)){var u=fu.get(a);if(u)var d=u.get(null);else{u=new Map,fu.set(a,u);for(var x=a.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<x.length;_++){var T=x[_];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(u.set(T.dataset.precedence,T),d=T)}d&&u.set(null,d)}x=s.instance,T=x.getAttribute("data-precedence"),_=u.get(T)||d,_===d&&u.set(null,x),u.set(T,x),this.count++,d=hu.bind(this),x.addEventListener("load",d),x.addEventListener("error",d),_?_.parentNode.insertBefore(x,_.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(x,a.firstChild)),s.state.loading|=4}}var dl={$$typeof:E,Provider:null,Consumer:null,_currentValue:_t,_currentValue2:_t,_threadCount:0};function Rb(a,s,u,d,x,_,T,B,et){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=To(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=To(0),this.hiddenUpdates=To(null),this.identifierPrefix=d,this.onUncaughtError=x,this.onCaughtError=_,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=et,this.incompleteTransitions=new Map}function M1(a,s,u,d,x,_,T,B,et,ut,wt,Dt){return a=new Rb(a,s,u,T,et,ut,wt,Dt,B),s=1,_===!0&&(s|=24),_=di(3,null,null,s),a.current=_,_.stateNode=a,s=rf(),s.refCount++,a.pooledCache=s,s.refCount++,_.memoizedState={element:d,isDehydrated:u,cache:s},cf(_),a}function N1(a){return a?(a=Cs,a):Cs}function F1(a,s,u,d,x,_){x=N1(x),d.context===null?d.context=x:d.pendingContext=x,d=nr(s),d.payload={element:u},_=_===void 0?null:_,_!==null&&(d.callback=_),u=ir(a,d,s),u!==null&&(ri(u,a,s),Xo(u,a,s))}function L1(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var u=a.retryLane;a.retryLane=u!==0&&u<s?u:s}}function Cd(a,s){L1(a,s),(a=a.alternate)&&L1(a,s)}function B1(a){if(a.tag===13||a.tag===31){var s=Lr(a,67108864);s!==null&&ri(s,a,67108864),Cd(a,67108864)}}function I1(a){if(a.tag===13||a.tag===31){var s=yi();s=Co(s);var u=Lr(a,s);u!==null&&ri(u,a,s),Cd(a,s)}}var gu=!0;function Pb(a,s,u,d){var x=Q.T;Q.T=null;var _=J.p;try{J.p=2,kd(a,s,u,d)}finally{J.p=_,Q.T=x}}function Mb(a,s,u,d){var x=Q.T;Q.T=null;var _=J.p;try{J.p=8,kd(a,s,u,d)}finally{J.p=_,Q.T=x}}function kd(a,s,u,d){if(gu){var x=Dd(d);if(x===null)gd(a,s,d,pu,u),z1(a,d);else if(Fb(x,a,s,u,d))d.stopPropagation();else if(z1(a,d),s&4&&-1<Nb.indexOf(a)){for(;x!==null;){var _=Vt(x);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var T=Cn(_.pendingLanes);if(T!==0){var B=_;for(B.pendingLanes|=2,B.entangledLanes|=2;T;){var et=1<<31-je(T);B.entanglements[1]|=et,T&=~et}oa(_),(Ae&6)===0&&(Zc=It()+500,ol(0))}}break;case 31:case 13:B=Lr(_,2),B!==null&&ri(B,_,2),Qc(),Cd(_,2)}if(_=Dd(d),_===null&&gd(a,s,d,pu,u),_===x)break;x=_}x!==null&&d.stopPropagation()}else gd(a,s,d,null,u)}}function Dd(a){return a=Oh(a),Od(a)}var pu=null;function Od(a){if(pu=null,a=zt(a),a!==null){var s=o(a);if(s===null)a=null;else{var u=s.tag;if(u===13){if(a=l(s),a!==null)return a;a=null}else if(u===31){if(a=c(s),a!==null)return a;a=null}else if(u===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return pu=a,null}function U1(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ut()){case $t:return 2;case ye:return 8;case ne:case zn:return 32;case Ki:return 268435456;default:return 32}default:return 32}}var Rd=!1,gr=null,pr=null,mr=null,gl=new Map,pl=new Map,vr=[],Nb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function z1(a,s){switch(a){case"focusin":case"focusout":gr=null;break;case"dragenter":case"dragleave":pr=null;break;case"mouseover":case"mouseout":mr=null;break;case"pointerover":case"pointerout":gl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":pl.delete(s.pointerId)}}function ml(a,s,u,d,x,_){return a===null||a.nativeEvent!==_?(a={blockedOn:s,domEventName:u,eventSystemFlags:d,nativeEvent:_,targetContainers:[x]},s!==null&&(s=Vt(s),s!==null&&B1(s)),a):(a.eventSystemFlags|=d,s=a.targetContainers,x!==null&&s.indexOf(x)===-1&&s.push(x),a)}function Fb(a,s,u,d,x){switch(s){case"focusin":return gr=ml(gr,a,s,u,d,x),!0;case"dragenter":return pr=ml(pr,a,s,u,d,x),!0;case"mouseover":return mr=ml(mr,a,s,u,d,x),!0;case"pointerover":var _=x.pointerId;return gl.set(_,ml(gl.get(_)||null,a,s,u,d,x)),!0;case"gotpointercapture":return _=x.pointerId,pl.set(_,ml(pl.get(_)||null,a,s,u,d,x)),!0}return!1}function H1(a){var s=zt(a.target);if(s!==null){var u=o(s);if(u!==null){if(s=u.tag,s===13){if(s=l(u),s!==null){a.blockedOn=s,Y(a.priority,function(){I1(u)});return}}else if(s===31){if(s=c(u),s!==null){a.blockedOn=s,Y(a.priority,function(){I1(u)});return}}else if(s===3&&u.stateNode.current.memoizedState.isDehydrated){a.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}a.blockedOn=null}function mu(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var u=Dd(a.nativeEvent);if(u===null){u=a.nativeEvent;var d=new u.constructor(u.type,u);Dh=d,u.target.dispatchEvent(d),Dh=null}else return s=Vt(u),s!==null&&B1(s),a.blockedOn=u,!1;s.shift()}return!0}function j1(a,s,u){mu(a)&&u.delete(s)}function Lb(){Rd=!1,gr!==null&&mu(gr)&&(gr=null),pr!==null&&mu(pr)&&(pr=null),mr!==null&&mu(mr)&&(mr=null),gl.forEach(j1),pl.forEach(j1)}function vu(a,s){a.blockedOn===s&&(a.blockedOn=null,Rd||(Rd=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Lb)))}var yu=null;function G1(a){yu!==a&&(yu=a,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){yu===a&&(yu=null);for(var s=0;s<a.length;s+=3){var u=a[s],d=a[s+1],x=a[s+2];if(typeof d!="function"){if(Od(d||u)===null)continue;break}var _=Vt(u);_!==null&&(a.splice(s,3),s-=3,Df(_,{pending:!0,data:x,method:u.method,action:d},d,x))}}))}function Zs(a){function s(et){return vu(et,a)}gr!==null&&vu(gr,a),pr!==null&&vu(pr,a),mr!==null&&vu(mr,a),gl.forEach(s),pl.forEach(s);for(var u=0;u<vr.length;u++){var d=vr[u];d.blockedOn===a&&(d.blockedOn=null)}for(;0<vr.length&&(u=vr[0],u.blockedOn===null);)H1(u),u.blockedOn===null&&vr.shift();if(u=(a.ownerDocument||a).$$reactFormReplay,u!=null)for(d=0;d<u.length;d+=3){var x=u[d],_=u[d+1],T=x[W]||null;if(typeof _=="function")T||G1(u);else if(T){var B=null;if(_&&_.hasAttribute("formAction")){if(x=_,T=_[W]||null)B=T.formAction;else if(Od(x)!==null)continue}else B=T.action;typeof B=="function"?u[d+1]=B:(u.splice(d,3),d-=3),G1(u)}}}function V1(){function a(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(T){return x=T})},focusReset:"manual",scroll:"manual"})}function s(){x!==null&&(x(),x=null),d||setTimeout(u,20)}function u(){if(!d&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,x=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(u,100),function(){d=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),x!==null&&(x(),x=null)}}}function Pd(a){this._internalRoot=a}xu.prototype.render=Pd.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(n(409));var u=s.current,d=yi();F1(u,d,a,s,null,null)},xu.prototype.unmount=Pd.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;F1(a.current,2,null,a,null,null),Qc(),s[q]=null}};function xu(a){this._internalRoot=a}xu.prototype.unstable_scheduleHydration=function(a){if(a){var s=N();a={blockedOn:null,target:a,priority:s};for(var u=0;u<vr.length&&s!==0&&s<vr[u].priority;u++);vr.splice(u,0,a),u===0&&H1(a)}};var X1=t.version;if(X1!=="19.2.3")throw Error(n(527,X1,"19.2.3"));J.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=f(s),a=a!==null?g(a):null,a=a===null?null:a.stateNode,a};var Bb={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_u.isDisabled&&_u.supportsFiber)try{Te=_u.inject(Bb),an=_u}catch{}}return yl.createRoot=function(a,s){if(!r(a))throw Error(n(299));var u=!1,d="",x=Jp,_=Qp,T=tm;return s!=null&&(s.unstable_strictMode===!0&&(u=!0),s.identifierPrefix!==void 0&&(d=s.identifierPrefix),s.onUncaughtError!==void 0&&(x=s.onUncaughtError),s.onCaughtError!==void 0&&(_=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError)),s=M1(a,1,!1,null,null,u,d,null,x,_,T,V1),a[q]=s.current,dd(a),new Pd(s)},yl.hydrateRoot=function(a,s,u){if(!r(a))throw Error(n(299));var d=!1,x="",_=Jp,T=Qp,B=tm,et=null;return u!=null&&(u.unstable_strictMode===!0&&(d=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(_=u.onUncaughtError),u.onCaughtError!==void 0&&(T=u.onCaughtError),u.onRecoverableError!==void 0&&(B=u.onRecoverableError),u.formState!==void 0&&(et=u.formState)),s=M1(a,1,!0,s,u??null,d,x,et,_,T,B,V1),s.context=N1(null),u=s.current,d=yi(),d=Co(d),x=nr(d),x.callback=null,ir(u,x,d),u=d,s.current.lanes=u,Rr(s,u),oa(s),a[q]=s.current,dd(a),new xu(s)},yl.version="19.2.3",yl}var iv;function Yb(){if(iv)return Ld.exports;iv=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),Ld.exports=Wb(),Ld.exports}var qb=Yb();function $b({onSelectMode:i}){const[t,e]=pa.useState(null),n=[{id:"pph21",title:"Bukti Potong PPh 21",description:"Convert ZIP berisi PDF Bukti Potong PPh 21 (BP21) ke Excel",icon:"",color:"from-blue-500 to-purple-600"},{id:"unifikasi",title:"Bukti Potong PPh Unifikasi",description:"Convert ZIP berisi PDF Bukti Potong PPh Unifikasi (BPU) ke Excel",icon:"",color:"from-green-500 to-teal-600"}];return yt.jsxs("div",{className:"mode-selection",children:[yt.jsxs("div",{className:"selection-header",children:[yt.jsx("div",{className:"selection-icon",children:""}),yt.jsx("h2",{children:"Pilih Jenis Bukti Potong"}),yt.jsx("p",{children:"Pilih jenis bukti potong yang ingin Anda konversi ke Excel"})]}),yt.jsx("div",{className:"mode-cards",children:n.map(r=>yt.jsxs("div",{className:`mode-card ${t===r.id?"hovered":""}`,onClick:()=>i(r.id),onMouseEnter:()=>e(r.id),onMouseLeave:()=>e(null),children:[yt.jsx("div",{className:"mode-icon",children:r.icon}),yt.jsx("h3",{children:r.title}),yt.jsx("p",{children:r.description}),yt.jsx("div",{className:"mode-arrow",children:""})]},r.id))}),yt.jsx("div",{className:"selection-info",children:yt.jsx("p",{children:" Semua proses dilakukan di browser  Data tidak dikirim ke server"})})]})}function Zb({onFileUpload:i,onBack:t,mode:e}){const[n,r]=pa.useState(!1),o=m=>{m.preventDefault(),r(!0)},l=()=>{r(!1)},c=m=>{m.preventDefault(),r(!1);const v=m.dataTransfer.files;v.length>0&&f(v[0])},h=m=>{const v=m.target.files;v.length>0&&f(v[0])},f=m=>{if(!m.name.toLowerCase().endsWith(".zip")){alert("Harap upload file ZIP yang berisi dokumen PDF Bukti Potong");return}i(m)},g=()=>e==="unifikasi"?"Upload File ZIP Bukti Potong Unifikasi":"Upload File ZIP Bukti Potong PPh 21",p=()=>e==="unifikasi"?"PDF Bukti Potong Unifikasi (BPU)":"PDF Bukti Potong PPh 21 (BP21)";return yt.jsxs("div",{className:"upload-zone",children:[yt.jsxs("button",{className:"back-button",onClick:t,children:[yt.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[yt.jsx("line",{x1:"19",y1:"12",x2:"5",y2:"12"}),yt.jsx("polyline",{points:"12 19 5 12 12 5"})]}),"Kembali"]}),yt.jsxs("div",{className:`upload-area ${n?"dragging":""}`,onDragOver:o,onDragLeave:l,onDrop:c,children:[yt.jsx("div",{className:"upload-icon",children:yt.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[yt.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),yt.jsx("polyline",{points:"17 8 12 3 7 8"}),yt.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),yt.jsx("h2",{children:g()}),yt.jsx("p",{children:"Drag & drop file ZIP di sini, atau"}),yt.jsxs("label",{className:"upload-button",children:["Pilih File",yt.jsx("input",{type:"file",accept:".zip",onChange:h,hidden:!0})]}),yt.jsxs("div",{className:"upload-info",children:[yt.jsx("p",{className:"info-item",children:" Format: .ZIP"}),yt.jsxs("p",{className:"info-item",children:[" Isi: Kumpulan ",p()]}),yt.jsx("p",{className:"info-item",children:" Proses: Cepat & Otomatis"})]})]})]})}function Jb({progress:i}){const{percentage:t,message:e,current:n,total:r}=i;return yt.jsx("div",{className:"processing",children:yt.jsxs("div",{className:"processing-card",children:[yt.jsx("div",{className:"processing-icon",children:yt.jsx("div",{className:"spinner"})}),yt.jsx("h2",{children:"Memproses File..."}),yt.jsxs("div",{className:"progress-container",children:[yt.jsx("div",{className:"progress-bar",children:yt.jsx("div",{className:"progress-fill",style:{width:`${t}%`}})}),yt.jsxs("div",{className:"progress-percentage",children:[t,"%"]})]}),yt.jsx("p",{className:"progress-message",children:e}),r>0&&yt.jsx("div",{className:"progress-stats",children:yt.jsxs("p",{children:["Memproses: ",yt.jsx("strong",{children:n})," dari ",yt.jsx("strong",{children:r})," PDF"]})}),yt.jsxs("div",{className:"processing-steps",children:[yt.jsxs("div",{className:`step ${t>=10?"active":""}`,children:[yt.jsx("span",{className:"step-number",children:"1"}),yt.jsx("span",{className:"step-label",children:"Ekstrak ZIP"})]}),yt.jsxs("div",{className:`step ${t>=20?"active":""}`,children:[yt.jsx("span",{className:"step-number",children:"2"}),yt.jsx("span",{className:"step-label",children:"Baca PDF"})]}),yt.jsxs("div",{className:`step ${t>=90?"active":""}`,children:[yt.jsx("span",{className:"step-number",children:"3"}),yt.jsx("span",{className:"step-label",children:"Buat Excel"})]}),yt.jsxs("div",{className:`step ${t>=100?"active":""}`,children:[yt.jsx("span",{className:"step-number",children:"4"}),yt.jsx("span",{className:"step-label",children:"Download"})]})]})]})})}function Qb({results:i,onReset:t,mode:e}){const n=i.length,r=e==="unifikasi"?"BuktiPotong_Unifikasi_Rekap.xlsx":"BuktiPotong_PPh21_Rekap.xlsx";let o=0,l=0,c=0;e==="unifikasi"?(l=i.reduce((f,g)=>f+(g.dpp||0),0),c=i.reduce((f,g)=>f+(g.pph||0),0)):(o=i.reduce((f,g)=>f+(g.data?.penghasilan_bruto||g.penghasilan_bruto||0),0),c=i.reduce((f,g)=>f+(g.data?.pph_dipotong||g.pph_dipotong||0),0));const h=f=>new Intl.NumberFormat("id-ID").format(f);return yt.jsx("div",{className:"result",children:yt.jsxs("div",{className:"result-card",children:[yt.jsx("div",{className:"success-icon",children:yt.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[yt.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),yt.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]})}),yt.jsx("h2",{children:"Proses Selesai!"}),yt.jsxs("p",{className:"result-message",children:["File Excel telah otomatis terunduh dengan nama ",yt.jsx("strong",{children:r})]}),yt.jsxs("div",{className:"result-stats",children:[yt.jsxs("div",{className:"stat-item",children:[yt.jsx("div",{className:"stat-label",children:"Total PDF"}),yt.jsx("div",{className:"stat-value",children:i.length})]}),yt.jsxs("div",{className:"stat-item success",children:[yt.jsx("div",{className:"stat-label",children:"Berhasil"}),yt.jsx("div",{className:"stat-value",children:n})]}),e==="unifikasi"?yt.jsxs(yt.Fragment,{children:[yt.jsxs("div",{className:"stat-item money",children:[yt.jsx("div",{className:"stat-label",children:"Total DPP"}),yt.jsxs("div",{className:"stat-value",children:["Rp ",h(l)]})]}),yt.jsxs("div",{className:"stat-item money",children:[yt.jsx("div",{className:"stat-label",children:"Total PPh"}),yt.jsxs("div",{className:"stat-value",children:["Rp ",h(c)]})]})]}):yt.jsxs(yt.Fragment,{children:[yt.jsxs("div",{className:"stat-item money",children:[yt.jsx("div",{className:"stat-label",children:"Total Bruto"}),yt.jsxs("div",{className:"stat-value",children:["Rp ",h(o)]})]}),yt.jsxs("div",{className:"stat-item money",children:[yt.jsx("div",{className:"stat-label",children:"Total PPh"}),yt.jsxs("div",{className:"stat-value",children:["Rp ",h(c)]})]})]})]}),yt.jsxs("div",{className:"result-buttons",children:[yt.jsx("button",{className:"back-button-secondary",onClick:t,children:"Kembali ke Beranda"}),yt.jsx("button",{className:"reset-button",onClick:t,children:"Proses File Lain"})]})]})})}function av({message:i,onReset:t}){return yt.jsx("div",{className:"error",children:yt.jsxs("div",{className:"error-card",children:[yt.jsx("div",{className:"error-icon",children:yt.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[yt.jsx("circle",{cx:"12",cy:"12",r:"10"}),yt.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),yt.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),yt.jsx("h2",{children:"Terjadi Kesalahan"}),yt.jsx("p",{className:"error-message",children:i}),yt.jsxs("div",{className:"error-tips",children:[yt.jsx("p",{children:yt.jsx("strong",{children:"Tips:"})}),yt.jsxs("ul",{children:[yt.jsx("li",{children:"Pastikan file ZIP berisi dokumen PDF Bukti Potong yang valid"}),yt.jsx("li",{children:"File PDF tidak boleh dipassword"}),yt.jsx("li",{children:"Coba ekstrak ZIP dan buka PDF manual untuk memastikan bisa dibaca"}),yt.jsx("li",{children:"File ZIP tidak boleh corrupt"})]})]}),yt.jsx("button",{className:"retry-button",onClick:t,children:"Coba Lagi"})]})})}const Wn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),a0=[.001,0,0,.001,0,0],zd=1.35,xi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},_r={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Ll="pdfjs_internal_editor_",se={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},pe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},tA={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},r0={TRIANGLES:1,LATTICE:2},yn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},zu={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},gn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},no={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},lh={ERRORS:0,WARNINGS:1,INFOS:5},Bl={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},xl={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},eA={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let ch=lh.WARNINGS;function nA(i){Number.isInteger(i)&&(ch=i)}function iA(){return ch}function uh(i){ch>=lh.INFOS&&console.info(`Info: ${i}`)}function ae(i){ch>=lh.WARNINGS&&console.warn(`Warning: ${i}`)}function Ue(i){throw new Error(i)}function me(i,t){i||Ue(t)}function aA(i){switch(i?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function x2(i,t=null,e=null){if(!i)return null;if(e&&typeof i=="string"&&(e.addDefaultProtocol&&i.startsWith("www.")&&i.match(/\./g)?.length>=2&&(i=`http://${i}`),e.tryConvertEncoding))try{i=cA(i)}catch{}const n=t?URL.parse(i,t):URL.parse(i);return aA(n)?n:null}function _2(i,t,e=!1){const n=URL.parse(i);return n?(n.hash=t,n.href):e&&x2(i,"http://example.com")?i.split("#",1)[0]+`${t?`#${t}`:""}`:""}function re(i,t,e,n=!1){return Object.defineProperty(i,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const os=(function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t})();class rv extends os{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Hd extends os{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class s0 extends os{constructor(t){super(t,"InvalidPDFException")}}class Gu extends os{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class rA extends os{constructor(t){super(t,"FormatError")}}class wr extends os{constructor(t){super(t,"AbortException")}}function b2(i){(typeof i!="object"||i?.length===void 0)&&Ue("Invalid argument for bytesToString");const t=i.length,e=8192;if(t<e)return String.fromCharCode.apply(null,i);const n=[];for(let r=0;r<t;r+=e){const o=Math.min(r+e,t),l=i.subarray(r,o);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function Yl(i){typeof i!="string"&&Ue("Invalid argument for stringToBytes");const t=i.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=i.charCodeAt(n)&255;return e}function sA(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function oA(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function lA(){try{return new Function(""),!0}catch{return!1}}class _n{static get isLittleEndian(){return re(this,"isLittleEndian",oA())}static get isEvalSupported(){return re(this,"isEvalSupported",lA())}static get isOffscreenCanvasSupported(){return re(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return re(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return re(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return re(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return re(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return re(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const jd=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));class Xt{static makeHexColor(t,e,n){return`#${jd[t]}${jd[e]}${jd[n]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,n=0){const r=t[n],o=t[n+1];t[n]=r*e[0]+o*e[2]+e[4],t[n+1]=r*e[1]+o*e[3]+e[5]}static applyTransformToBezier(t,e,n=0){const r=e[0],o=e[1],l=e[2],c=e[3],h=e[4],f=e[5];for(let g=0;g<6;g+=2){const p=t[n+g],m=t[n+g+1];t[n+g]=p*r+m*l+h,t[n+g+1]=p*o+m*c+f}}static applyInverseTransform(t,e){const n=t[0],r=t[1],o=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-r*e[2]+e[2]*e[5]-e[4]*e[3])/o,t[1]=(-n*e[1]+r*e[0]+e[4]*e[1]-e[5]*e[0])/o}static axialAlignedBoundingBox(t,e,n){const r=e[0],o=e[1],l=e[2],c=e[3],h=e[4],f=e[5],g=t[0],p=t[1],m=t[2],v=t[3];let b=r*g+h,y=b,A=r*m+h,S=A,w=c*p+f,E=w,D=c*v+f,P=D;if(o!==0||l!==0){const L=o*g,R=o*m,V=l*p,F=l*v;b+=V,S+=V,A+=F,y+=F,w+=L,P+=L,D+=R,E+=R}n[0]=Math.min(n[0],b,A,y,S),n[1]=Math.min(n[1],w,D,E,P),n[2]=Math.max(n[2],b,A,y,S),n[3]=Math.max(n[3],w,D,E,P)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],r=t[1],o=t[2],l=t[3],c=n**2+r**2,h=n*o+r*l,f=o**2+l**2,g=(c+f)/2,p=Math.sqrt(g**2-(c*f-h**2));e[0]=Math.sqrt(g+p||1),e[1]=Math.sqrt(g-p||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>r)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return o>l?null:[n,o,r,l]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,r,o){o[0]=Math.min(o[0],t,n),o[1]=Math.min(o[1],e,r),o[2]=Math.max(o[2],t,n),o[3]=Math.max(o[3],e,r)}static#t(t,e,n,r,o,l,c,h,f,g){if(f<=0||f>=1)return;const p=1-f,m=f*f,v=m*f,b=p*(p*(p*t+3*f*e)+3*m*n)+v*r,y=p*(p*(p*o+3*f*l)+3*m*c)+v*h;g[0]=Math.min(g[0],b),g[1]=Math.min(g[1],y),g[2]=Math.max(g[2],b),g[3]=Math.max(g[3],y)}static#e(t,e,n,r,o,l,c,h,f,g,p,m){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&this.#t(t,e,n,r,o,l,c,h,-p/g,m);return}const v=g**2-4*p*f;if(v<0)return;const b=Math.sqrt(v),y=2*f;this.#t(t,e,n,r,o,l,c,h,(-g+b)/y,m),this.#t(t,e,n,r,o,l,c,h,(-g-b)/y,m)}static bezierBoundingBox(t,e,n,r,o,l,c,h,f){f[0]=Math.min(f[0],t,c),f[1]=Math.min(f[1],e,h),f[2]=Math.max(f[2],t,c),f[3]=Math.max(f[3],e,h),this.#e(t,n,o,c,e,r,l,h,3*(-t+3*(n-o)+c),6*(t-2*n+o),3*(n-t),f),this.#e(t,n,o,c,e,r,l,h,3*(-e+3*(r-l)+h),6*(e-2*r+l),3*(r-e),f)}}function cA(i){return decodeURIComponent(escape(i))}let Gd=null,sv=null;function uA(i){return Gd||(Gd=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,sv=new Map([["","t"]])),i.replaceAll(Gd,(t,e,n)=>e?e.normalize("NFKC"):sv.get(n))}function A2(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),b2(i)}const so="pdfjs_internal_id_";function hA(i,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[n,r,...o]=e;if(!i(n)&&!Number.isInteger(n)||!t(r))return!1;const l=o.length;let c=!0;switch(r.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;c=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function Yn(i,t,e){return Math.min(Math.max(i,t),e)}function S2(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(b2(i))}function fA(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):Yl(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...t){return new Promise(e=>{e(i(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((t,e)=>t+e,0)});class Il{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function r(o){if(!o)return;let l=null;const c=o.name;if(c==="#text")l=o.value;else if(Il.shouldBuildText(c))o?.attributes?.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&e.push({str:l}),!!o.children)for(const h of o.children)r(h)}return r(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class w2{static setupStorage(t,e,n,r,o){const l=r.getValue(e,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),o==="print")break;t.addEventListener("input",c=>{r.setValue(e,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?t.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",c=>{r.setValue(e,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),o==="print")break;t.addEventListener("input",c=>{r.setValue(e,{value:c.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}t.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:r,linkService:o}){const{attributes:l}=e,c=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${r}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}c&&o.addLinkAttributes(t,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(t,l.dataId,e,n)}static render(t){const e=t.annotationStorage,n=t.linkService,r=t.xfaHtml,o=t.intent||"display",l=document.createElement(r.name);r.attributes&&this.setAttributes({html:l,element:r,intent:o,linkService:n});const c=o!=="richText",h=t.div;if(h.append(l),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=p}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const p=document.createTextNode(r.value);l.append(p),c&&Il.shouldBuildText(r.name)&&f.push(p)}return{textDivs:f}}const g=[[r,-1,l]];for(;g.length>0;){const[p,m,v]=g.at(-1);if(m+1===p.children.length){g.pop();continue}const b=p.children[++g.at(-1)[1]];if(b===null)continue;const{name:y}=b;if(y==="#text"){const S=document.createTextNode(b.value);f.push(S),v.append(S);continue}const A=b?.attributes?.xmlns?document.createElementNS(b.attributes.xmlns,y):document.createElement(y);if(v.append(A),b.attributes&&this.setAttributes({html:A,element:b,storage:e,intent:o,linkService:n}),b.children?.length>0)g.push([b,-1,A]);else if(b.value){const S=document.createTextNode(b.value);c&&Il.shouldBuildText(y)&&f.push(S),A.append(S)}}for(const p of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const za="http://www.w3.org/2000/svg";class _o{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function ql(i,t="text"){if(El(i,document.baseURI)){const e=await fetch(i);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const r=new XMLHttpRequest;r.open("GET",i,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(r.response);return}e(r.responseText);return}n(new Error(r.statusText))}},r.send(null)})}class $l{constructor({viewBox:t,userUnit:e,scale:n,rotation:r,offsetX:o=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=r,this.offsetX=o,this.offsetY=l,n*=e;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let g,p,m,v;switch(r%=360,r<0&&(r+=360),r){case 180:g=-1,p=0,m=0,v=1;break;case 90:g=0,p=1,m=1,v=0;break;case 270:g=0,p=-1,m=-1,v=0;break;case 0:g=1,p=0,m=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(m=-m,v=-v);let b,y,A,S;g===0?(b=Math.abs(f-t[1])*n+o,y=Math.abs(h-t[0])*n+l,A=(t[3]-t[1])*n,S=(t[2]-t[0])*n):(b=Math.abs(h-t[0])*n+o,y=Math.abs(f-t[1])*n+l,A=(t[2]-t[0])*n,S=(t[3]-t[1])*n),this.transform=[g*n,p*n,m*n,v*n,b-g*n*h-m*n*f,y-p*n*h-v*n*f],this.width=A,this.height=S}get rawDims(){const t=this.viewBox;return re(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:o=!1}={}){return new $l({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:r,dontFlip:o})}convertToViewportPoint(t,e){const n=[t,e];return Xt.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];Xt.applyTransform(e,this.transform);const n=[t[2],t[3]];return Xt.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return Xt.applyInverseTransform(n,this.transform),n}}class S0 extends os{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function hh(i){const t=i.length;let e=0;for(;e<t&&i[e].trim()==="";)e++;return i.substring(e,e+5).toLowerCase()==="data:"}function w0(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function dA(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function gA(i,t="document.pdf"){if(typeof i!="string")return t;if(hh(i))return ae('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(i);if(!n)return t;const r=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},o=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(o.test(l))return r(l);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const f of c)if(o.test(f))return r(f);const h=Array.from(n.searchParams.keys()).reverse();for(const f of h)if(o.test(f))return r(f)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return r(h[0])}return t}class ov{started=Object.create(null);times=[];time(t){t in this.started&&ae(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ae(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:r,end:o}of this.times)t.push(`${n.padEnd(e)} ${o-r}ms
`);return t.join("")}}function El(i,t){const e=t?URL.parse(i,t):URL.parse(i);return e?.protocol==="http:"||e?.protocol==="https:"}function Vi(i){i.preventDefault()}function tn(i){i.preventDefault(),i.stopPropagation()}function pA(i){console.log("Deprecated API usage: "+i)}class o0{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const n=parseInt(e[1],10);let r=parseInt(e[2],10);r=r>=1&&r<=12?r-1:0;let o=parseInt(e[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(e[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const f=e[7]||"Z";let g=parseInt(e[8],10);g=g>=0&&g<=23?g:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,f==="-"?(l+=g,c+=p):f==="+"&&(l-=g,c-=p),new Date(Date.UTC(n,r,o,l,c,h))}}function mA(i,{scale:t=1,rotation:e=0}){const{width:n,height:r}=i.attributes.style,o=[0,0,parseInt(n),parseInt(r)];return new $l({viewBox:o,userUnit:1,scale:t,rotation:e})}function Zl(i){if(i.startsWith("#")){const t=parseInt(i.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(t=>parseInt(t)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ae(`Not a valid color format: "${i}"`),[0,0,0])}function vA(i){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of i.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;i.set(e,Zl(n))}t.remove()}function $e(i){const{a:t,b:e,c:n,d:r,e:o,f:l}=i.getTransform();return[t,e,n,r,o,l]}function ua(i){const{a:t,b:e,c:n,d:r,e:o,f:l}=i.getTransform().invertSelf();return[t,e,n,r,o,l]}function ns(i,t,e=!1,n=!0){if(t instanceof $l){const{pageWidth:r,pageHeight:o}=t.rawDims,{style:l}=i,c=_n.isCSSRoundSupported,h=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${o}px`,g=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,p=c?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(l.width=g,l.height=p):(l.width=p,l.height=g)}n&&i.setAttribute("data-main-rotation",t.rotation)}class va{constructor(){const{pixelRatio:t}=va;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,r,o=-1){let l=1/0,c=1/0,h=1/0;n=va.capPixels(n,o),n>0&&(l=Math.sqrt(n/(t*e))),r!==-1&&(c=r/t,h=r/e);const f=Math.min(l,c,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const l0=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class yA{static get isDarkMode(){return re(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class xA{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:n}=window.getComputedStyle(t);return t.remove(),re(this,"commentForegroundColor",Zl(n))}}function _A(i,t,e,n){n=Math.min(Math.max(n??1,0),1);const r=255*(1-n);return i=Math.round(i*n+r),t=Math.round(t*n+r),e=Math.round(e*n+r),[i,t,e]}function lv(i,t){const e=i[0]/255,n=i[1]/255,r=i[2]/255,o=Math.max(e,n,r),l=Math.min(e,n,r),c=(o+l)/2;if(o===l)t[0]=t[1]=0;else{const h=o-l;switch(t[1]=c<.5?h/(o+l):h/(2-o-l),o){case e:t[0]=((n-r)/h+(n<r?6:0))*60;break;case n:t[0]=((r-e)/h+2)*60;break;case r:t[0]=((e-n)/h+4)*60;break}}t[2]=c}function c0(i,t){const e=i[0],n=i[1],r=i[2],o=(1-Math.abs(2*r-1))*n,l=o*(1-Math.abs(e/60%2-1)),c=r-o/2;switch(Math.floor(e/60)){case 0:t[0]=o+c,t[1]=l+c,t[2]=c;break;case 1:t[0]=l+c,t[1]=o+c,t[2]=c;break;case 2:t[0]=c,t[1]=o+c,t[2]=l+c;break;case 3:t[0]=c,t[1]=l+c,t[2]=o+c;break;case 4:t[0]=l+c,t[1]=c,t[2]=o+c;break;case 5:case 6:t[0]=o+c,t[1]=c,t[2]=l+c;break}}function cv(i){return i<=.03928?i/12.92:((i+.055)/1.055)**2.4}function uv(i,t,e){c0(i,e),e.map(cv);const n=.2126*e[0]+.7152*e[1]+.0722*e[2];c0(t,e),e.map(cv);const r=.2126*e[0]+.7152*e[1]+.0722*e[2];return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)}const hv=new Map;function bA(i,t){const e=i[0]+i[1]*256+i[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let n=hv.get(e);if(n)return n;const r=new Float32Array(9),o=r.subarray(0,3),l=r.subarray(3,6);lv(i,l);const c=r.subarray(6,9);lv(t,c);const h=c[2]<.5,f=h?12:4.5;if(l[2]=h?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),uv(l,c,o)<f){let g,p;h?(g=l[2],p=1):(g=0,p=l[2]);const m=.005;for(;p-g>m;){const v=l[2]=(g+p)/2;h===uv(l,c,o)<f?g=v:p=v}l[2]=h?p:g}return c0(l,o),n=Xt.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),hv.set(e,n),n}function E2({html:i,dir:t,className:e},n){const r=document.createDocumentFragment();if(typeof i=="string"){const o=document.createElement("p");o.dir=t||"auto";const l=i.split(/(?:\r\n?|\n)/);for(let c=0,h=l.length;c<h;++c){const f=l[c];o.append(document.createTextNode(f)),c<h-1&&o.append(document.createElement("br"))}r.append(o)}else w2.render({xfaHtml:i,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",e),n.append(r)}function T2(i){const t=new Path2D;if(!i)return t;for(let e=0,n=i.length;e<n;)switch(i[e++]){case xl.moveTo:t.moveTo(i[e++],i[e++]);break;case xl.lineTo:t.lineTo(i[e++],i[e++]);break;case xl.curveTo:t.bezierCurveTo(i[e++],i[e++],i[e++],i[e++],i[e++],i[e++]);break;case xl.quadraticCurveTo:t.quadraticCurveTo(i[e++],i[e++],i[e++],i[e++]);break;case xl.closePath:t.closePath();break;default:ae(`Unrecognized drawing path operator: ${i[e-1]}`);break}return t}class Dl{#t=null;#e=null;#i;#n=null;#s=null;#r=null;#a=null;#o=null;static#c=null;constructor(t){this.#i=t,Dl.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",Vi,{signal:e}),t.addEventListener("pointerdown",Dl.#l,{signal:e}));const n=this.#n=document.createElement("div");n.className="buttons",t.append(n);const r=this.#i.toolbarPosition;if(r){const{style:o}=t,l=this.#i._uiManager.direction==="ltr"?1-r[0]:r[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#f(t){this.#i._focusEventsAllowed=!1,tn(t)}#h(t){this.#i._focusEventsAllowed=!0,tn(t)}#d(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#f.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Vi,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",Dl.#c[t]),this.#d(n)&&n.addEventListener("click",r=>{e.delete()},{signal:e._signal}),this.#n.append(n)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#d(e),this.#n.append(e,this.#m),this.#s=t}addComment(t,e=null){if(this.#r)return;const n=t.renderForToolbar();if(!n)return;this.#d(n);const r=this.#a=this.#m;e?(this.#n.insertBefore(n,e),this.#n.insertBefore(r,e)):this.#n.append(n,r),this.#r=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#d(e),this.#n.append(e,this.#m)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#i);this.#d(e),this.#n.append(e,this.#m)}removeButton(t){t==="comment"&&(this.#r?.removeToolbarCommentButton(),this.#r=null,this.#a?.remove(),this.#a=null)}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,n){if(!e&&t==="comment")return;const r=this.#n.querySelector(n);r&&t==="comment"&&this.addComment(e,r)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class AA{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",Vi,{signal:e});const n=this.#t=document.createElement("div");return n.className="buttons",t.append(n),this.#i.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#s(t,e){let n=0,r=0;for(const o of t){const l=o.y+o.height;if(l<n)continue;const c=o.x+(e?o.width:0);if(l>n){r=c,n=l;continue}e?c>r&&(r=c):c<r&&(r=c)}return[e?1-r:r,n]}show(t,e,n){const[r,o]=this.#s(e,n),{style:l}=this.#e||=this.#n();t.append(this.#e),l.insetInlineEnd=`${100*r}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,e,n,r){const o=document.createElement("button");o.classList.add("basic",t),o.tabIndex=0,o.setAttribute("data-l10n-id",e);const l=document.createElement("span");o.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const c=this.#i._signal;c instanceof AbortSignal&&!c.aborted&&(o.addEventListener("contextmenu",Vi,{signal:c}),o.addEventListener("click",r,{signal:c})),this.#t.append(o)}}function C2(i,t,e){for(const n of e)t.addEventListener(n,i[n].bind(i))}class we{static#t=NaN;static#e=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(t){(we.#e||=new Set).add(t)}static setPointer(t,e){we.#t||=e,we.#n??=t}static setTimeStamp(t){we.#i=t}static isSamePointerId(t){return we.#t===t}static isSamePointerIdOrRemove(t){return we.#t===t?!0:(we.#e?.delete(t),!1)}static isSamePointerType(t){return we.#n===t}static isInitializedAndDifferentPointerType(t){return we.#n!==null&&!we.isSamePointerType(t)}static isSameTimeStamp(t){return we.#i===t}static isUsingMultiplePointers(){return we.#e?.size>=1}static clearPointerType(){we.#n=null}static clearPointerIds(){we.#t=NaN,we.#e=null}static clearTimeStamp(){we.#i=NaN}}class SA{#t=0;get id(){return`${Ll}${this.#t++}`}}class E0{#t=A2();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const o=r.decode().then(()=>(n.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return re(this,"_isSVGFittingCanvas",o)}async#n(t,e){this.#i||=new Map;let n=this.#i.get(t);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof e=="string"?(n.url=e,r=await ql(e,"blob")):e instanceof File?r=n.file=e:e instanceof Blob&&(r=e),r.type==="image/svg+xml"){const o=E0._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((f,g)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,f()},l.onload=async()=>{const p=n.svgUrl=l.result;c.src=await o?`${p}#svgView(preserveAspectRatio(none))`:p},c.onerror=l.onerror=g});l.readAsDataURL(r),await h}else n.bitmap=await createImageBitmap(r);n.refCounter=1}catch(r){ae(r),n=null}return this.#i.set(t,n),n&&this.#i.set(n.id,n),n}async getFromFile(t){const{lastModified:e,name:n,size:r,type:o}=t;return this.#n(`${e}_${n}_${r}_${o}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const n=await e;return this.#n(t,n)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let n=this.#i.get(t);if(n?.bitmap)return n.refCounter+=1,n;const r=new OffscreenCanvas(e.width,e.height);return r.getContext("2d").drawImage(e,0,0),n={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,n),this.#i.set(n.id,n),n}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(n.width,n.height);r.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=r.convertToBlob()}n.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class wA{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:n,mustExec:r,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(r&&t(),this.#e)return;const h={cmd:t,undo:e,post:n,type:o};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(h);return}if(l&&this.#t[this.#n].type===o){c&&(h.undo=this.#t[this.#n].undo),this.#t[this.#n]=h;return}const f=this.#n+1;f===this.#i?this.#t.splice(0,1):(this.#n=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class Jl{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=_n.platform;for(const[n,r,o={}]of t)for(const l of n){const c=l.startsWith("mac+");e&&c?(this.callbacks.set(l.slice(4),{callback:r,options:o}),this.allKeys.add(l.split("+").at(-1))):!e&&!c&&(this.callbacks.set(l,{callback:r,options:o}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(this.#t(e));if(!n)return;const{callback:r,options:{bubbles:o=!1,args:l=[],checker:c=null}}=n;c&&!c(t,e)||(r.bind(t,...l,e)(),o||tn(e))}}class T0{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return vA(t),re(this,"_colors",t)}convert(t){const e=Zl(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,r]of this._colors)if(r.every((o,l)=>o===e[l]))return T0._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?Xt.makeHexColor(...e):t}}class Er{#t=new AbortController;#e=null;#i=null;#n=new Map;#s=new Map;#r=null;#a=null;#o=null;#c=new wA;#l=null;#f=null;#h=null;#d=0;#m=new Set;#p=null;#u=null;#g=new Set;_editorUndoBar=null;#v=!1;#x=!1;#y=!1;#E=null;#S=null;#b=null;#C=null;#_=!1;#w=null;#O=new SA;#k=!1;#D=!1;#B=!1;#P=null;#N=null;#I=null;#F=null;#V=null;#T=se.NONE;#A=new Set;#M=null;#U=null;#H=null;#W=null;#K=null;#Y={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#j=[0,0];#L=null;#X=null;#J=null;#Q=null;#z=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Er.prototype,e=l=>l.#X.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return re(this,"_keyboardManager",new Jl([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#X.contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#X.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:e}]]))}constructor(t,e,n,r,o,l,c,h,f,g,p,m,v,b,y,A){const S=this._signal=this.#t.signal;this.#X=t,this.#J=e,this.#Q=n,this.#r=r,this.#l=o,this.#U=l,this.#K=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:S}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:S}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:S}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:S}),c._on("setpreference",this.onSetPreference.bind(this),{signal:S}),c._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:S}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:S}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:S}),this.#st(),this.#ft(),this.#et(),this.#a=h.annotationStorage,this.#E=h.filterFactory,this.#H=f,this.#C=g||null,this.#v=p,this.#x=m,this.#y=v,this.#V=b||null,this.viewParameters={realScale:_o.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=y||null,this._supportsPinchToZoom=A!==!1,o?.setSidebarUiManager(this)}destroy(){this.#z?.resolve(),this.#z=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#s.values())t.destroy();this.#s.clear(),this.#n.clear(),this.#g.clear(),this.#F?.clear(),this.#e=null,this.#A.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#U?.destroy(),this.#w?.hide(),this.#w=null,this.#I?.destroy(),this.#I=null,this.#i=null,this.#S&&(clearTimeout(this.#S),this.#S=null),this.#L&&(clearTimeout(this.#L),this.#L=null),this._editorUndoBar?.destroy(),this.#K=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#V}get useNewAltTextFlow(){return this.#x}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return re(this,"hcmFilter",this.#H?this.#E.addHCMFilter(this.#H.foreground,this.#H.background):"none")}get direction(){return re(this,"direction",getComputedStyle(this.#X).direction)}get _highlightColors(){return re(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return re(this,"highlightColors",null);const e=new Map,n=!!this.#H;for(const[r,o]of t){const l=r.endsWith("_HCM");if(n&&l){e.set(r.replace("_HCM",""),o);continue}!n&&!l&&e.set(r,o)}return re(this,"highlightColors",e)}get highlightColorNames(){return re(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#I=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,n,r){this.#l?.showDialog(this,t,e,n,r)}selectComment(t,e){this.#s.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,e,n=void 0){this.#l?.toggleCommentPopup(t,e,n)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#s.has(t-1))return;const{resolve:e,promise:n}=Promise.withResolvers(),r=o=>{o.pageNumber===t&&(this._eventBus._off("editorsrendered",r),e())};this._eventBus.on("editorsrendered",r),await n}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#y=e)}onPageChanging({pageNumber:t}){this.#d=t-1}focusMainContainer(){this.#X.focus()}findParent(t,e){for(const n of this.#s.values()){const{x:r,y:o,width:l,height:c}=n.div.getBoundingClientRect();if(t>=r&&t<=r+l&&e>=o&&e<=o+c)return n}return null}disableUserSelect(t=!1){this.#J.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#g.add(t)}removeShouldRescale(t){this.#g.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*_o.PDF_TO_CSS_UNITS;for(const e of this.#g)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Z({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of this.#s.values())if(n.hasTextLayer(t))return n;return null}highlightSelection(t="",e=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:r,anchorOffset:o,focusNode:l,focusOffset:c}=n,h=n.toString(),g=this.#Z(n).closest(".textLayer"),p=this.getSelectionBoxes(g);if(!p)return;n.empty();const m=this.#tt(g),v=this.#T===se.NONE,b=()=>{const y=m?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:p,anchorNode:r,anchorOffset:o,focusNode:l,focusOffset:c,text:h});v&&this.showAllEditors("highlight",!0,!0),e&&y?.editComment()};if(v){this.switchToMode(se.HIGHLIGHT,b);return}b()}commentSelection(t=""){this.highlightSelection(t,!0)}#at(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=this.#Z(t).closest(".textLayer"),r=this.getSelectionBoxes(n);r&&(this.#w||=new AA(this),this.#w.show(n,r,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#a)return null;const e=`${Ll}${t}`,n=this.#a.getRawValue(e);return n&&this.#a.remove(e),n}addToAnnotationStorage(t){!t.isEmpty()&&this.#a&&!this.#a.has(t.id)&&this.#a.setValue(t.id,t)}a11yAlert(t,e=null){const n=this.#Q;n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}#rt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#M&&(this.#w?.hide(),this.#M=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#M)return;const r=this.#Z(t).closest(".textLayer");if(!r){this.#M&&(this.#w?.hide(),this.#M=null,this.#R({hasSelectedText:!1}));return}if(this.#w?.hide(),this.#M=e,this.#R({hasSelectedText:!0}),!(this.#T!==se.HIGHLIGHT&&this.#T!==se.NONE)&&(this.#T===se.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#_=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#T===se.HIGHLIGHT?this.#tt(r):null;if(o?.toggleDrawing(),this.#D){const l=new AbortController,c=this.combinedSignal(l),h=f=>{f.type==="pointerup"&&f.button!==0||(l.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#q("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else o?.toggleDrawing(!0),this.#q("main_toolbar")}}#q(t=""){this.#T===se.HIGHLIGHT?this.highlightSelection(t):this.#v&&this.#at()}#st(){document.addEventListener("selectionchange",this.#rt.bind(this),{signal:this._signal})}#ot(){if(this.#b)return;this.#b=new AbortController;const t=this.combinedSignal(this.#b);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#b?.abort(),this.#b=null}blur(){if(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#q("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#A)if(e.div.contains(t)){this.#N=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[t,e]=this.#N;this.#N=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#P)return;this.#P=new AbortController;const t=this.combinedSignal(this.#P);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#P?.abort(),this.#P=null}#ut(){if(this.#f)return;this.#f=new AbortController;const t=this.combinedSignal(this.#f);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#f?.abort(),this.#f=null}#ft(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const n of this.#A){const r=n.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const o of e.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(o){ae(`paste: "${o.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const r=this.currentLayer;try{const o=[];for(const h of n){const f=await r.deserialize(h);if(!f)return;o.push(f)}const l=()=>{for(const h of o)this.#nt(h);this.#it(o)},c=()=>{for(const h of o)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(o){ae(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==se.NONE&&!this.isEditorHandlingKeyboard&&Er._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#q("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#R(t){Object.entries(t).some(([n,r])=>this.#Y[n]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#Y,t)}),this.#T===se.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[pe.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#R({isEditing:this.#T!==se.NONE,isEmpty:this.#$(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#G(e.defaultPropertiesToUpdate)}}getId(){return this.#O.id}get currentLayer(){return this.#s.get(this.#d)}getLayer(t){return this.#s.get(t)}get currentPageIndex(){return this.#d}addLayer(t){this.#s.set(t.pageIndex,t),this.#k?t.enable():t.disable()}removeLayer(t){this.#s.delete(t.pageIndex)}async updateMode(t,e=null,n=!1,r=!1,o=!1,l=!1){if(this.#T!==t&&!(this.#z&&(await this.#z.promise,!this.#z))){if(this.#z=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===se.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===se.NONE){this.setEditingState(!1),this.#gt();for(const c of this.#n.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#z.resolve();return}for(const c of this.#n.values())c.addStandaloneCommentButton();t===se.SIGNATURE&&await this.#U?.loadSignatures(),n&&we.clearPointerType(),this.setEditingState(!0),await this.#dt(),this.unselectAll();for(const c of this.#s.values())c.updateMode(t);if(t===se.POPUP){this.#i||=await this.#K.getAnnotationsByType(new Set(this.#u.map(f=>f._editorType)));const c=new Set,h=[];for(const f of this.#n.values()){const{annotationElementId:g,hasComment:p,deleted:m}=f;g&&c.add(g),p&&!m&&h.push(f.getData())}for(const f of this.#i){const{id:g,popupRef:p,contentsObj:m}=f;p&&m?.str&&!c.has(g)&&!this.#m.has(g)&&h.push(f)}this.#l?.showSidebar(h)}if(!e){r&&this.addNewEditorFromKeyboard(),this.#z.resolve();return}for(const c of this.#n.values())c.uid===e?(this.setSelected(c),l?c.editComment():o?c.enterInEditMode():c.focus()):c.unselect();this.#z.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case pe.CREATE:this.currentLayer.addNewEditor(e);return;case pe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#W||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const n of this.#A)n.updateParams(t,e);else for(const n of this.#u)n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){for(const o of this.#n.values())o.editorType===t&&o.show(e);(this.#W?.get(pe.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#G([[pe.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#B!==t){this.#B=t;for(const e of this.#s.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#dt(){if(!this.#k){this.#k=!0;const t=[];for(const e of this.#s.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#gt(){if(this.unselectAll(),this.#k){this.#k=!1;for(const t of this.#s.values())t.disable();for(const t of this.#n.values())t.disable()}}*getEditors(t){for(const e of this.#n.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#S&&clearTimeout(this.#S),this.#S=setTimeout(()=>{this.focusMainContainer(),this.#S=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#F?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#a?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#s.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#pt(){let t=null;for(t of this.#A);return t}updateUI(t){this.#pt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#A.has(t)){this.#A.delete(t),t.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#A.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const e of this.#A)e!==t&&e.unselect();this.#A.clear(),this.#A.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(t){return this.#A.has(t)}get firstSelectedEditor(){return this.#A.values().next().value}unselect(t){t.unselect(),this.#A.delete(t),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#A.size!==0}get isEnterHandled(){return this.#A.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#R({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#$()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#$()})}addCommands(t){this.#c.add(t),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#$()})}cleanUndoStack(t){this.#c.cleanType(t)}#$(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#A],n=()=>{this._editorUndoBar?.show(r,e.length===1?e[0].editorType:e.length);for(const o of e)o.remove()},r=()=>{for(const o of e)this.#nt(o)};this.addCommands({cmd:n,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#it(t){for(const e of this.#A)e.unselect();this.#A.clear();for(const e of t)e.isEmpty()||(this.#A.add(e),e.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#A)t.commit();this.#it(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==se.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#A)t.unselect();this.#A.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#j[0]+=t,this.#j[1]+=e;const[r,o]=this.#j,l=[...this.#A],c=1e3;this.#L&&clearTimeout(this.#L),this.#L=setTimeout(()=>{this.#L=null,this.#j[0]=this.#j[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(r,o),h.translationDone())},undo:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(-r,-o),h.translationDone())},mustExec:!1})},c);for(const h of l)h.translateInPage(t,e),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#A)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let e=!1;for(const[{x:r,y:o,pageIndex:l},c]of t)c.newX=r,c.newY=o,c.newPageIndex=l,e||=r!==c.savedX||o!==c.savedY||l!==c.savedPageIndex;if(!e)return!1;const n=(r,o,l,c)=>{if(this.#n.has(r.id)){const h=this.#s.get(c);h?r._setParentAndPosition(h,o,l):(r.pageIndex=c,r.x=o,r.y=l)}};return this.addCommands({cmd:()=>{for(const[r,{newX:o,newY:l,newPageIndex:c}]of t)n(r,o,l,c)},undo:()=>{for(const[r,{savedX:o,savedY:l,savedPageIndex:c}]of t)n(r,o,l,c)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#p)for(const n of this.#p.keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#A.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==se.NONE}get imageManager(){return re(this,"imageManager",new E0)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,g=e.rangeCount;f<g;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:r,width:o,height:l}=t.getBoundingClientRect();let c;switch(t.getAttribute("data-main-rotation")){case"90":c=(f,g,p,m)=>({x:(g-r)/l,y:1-(f+p-n)/o,width:m/l,height:p/o});break;case"180":c=(f,g,p,m)=>({x:1-(f+p-n)/o,y:1-(g+m-r)/l,width:p/o,height:m/l});break;case"270":c=(f,g,p,m)=>({x:1-(g+m-r)/l,y:(f-n)/o,width:m/l,height:p/o});break;default:c=(f,g,p,m)=>({x:(f-n)/o,y:(g-r)/l,width:p/o,height:m/l});break}const h=[];for(let f=0,g=e.rangeCount;f<g;f++){const p=e.getRangeAt(f);if(!p.collapsed)for(const{x:m,y:v,width:b,height:y}of p.getClientRects())b===0||y===0||h.push(c(m,v,b,y))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const n=this.#a.getRawValue(e);n&&(this.#T===se.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,e,n){const r=this.#F?.get(t);r&&(r.setCanvas(e,n),this.#F.delete(t))}addMissingCanvas(t,e){(this.#F||=new Map).set(t,e)}}class ma{#t=null;#e=!1;#i=null;#n=null;#s=null;#r=null;#a=!1;#o=null;#c=null;#l=null;#f=null;#h=!1;static#d=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,ma.#d||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){ma._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",ma.#d.missing),e.setAttribute("data-l10n-id",ma.#d["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;t.addEventListener("contextmenu",Vi,{signal:n}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const r=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",r,{capture:!0,signal:n}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#a=!0,r(o))},{signal:n}),await this.#p(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#f=await ma._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#f),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#f}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:r,cancel:o=!1}){n&&(this.#l=n,this.#f=r),!(this.#t===t&&this.#e===e)&&(o||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#i&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#s=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#i;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",ma.#d[this.#m]),this.#n?.setAttribute("data-l10n-id",ma.#d[`${this.#m}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const r=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:o})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Au{#t=null;#e=null;#i=!1;#n=null;#s=null;#r=null;#a=null;#o=null;#c=!1;#l=null;constructor(t){this.#n=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#f(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#n.commentButtonPosition;if(e){const{style:n}=t;n.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const r=this.#n.commentButtonColor;r&&(n.backgroundColor=r)}return this.#f(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#n.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:n}=this.#t.getBoundingClientRect(),{x:r,y:o,width:l,height:c}=this.#n.parent.boundingClientRect;return[(t-r)/l,(e+n-o)/c]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#f(t,e){if(!this.#n._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=this.#n._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return t;t.addEventListener("contextmenu",Vi,{signal:n}),e&&(t.addEventListener("focusin",o=>{this.#n._focusEventsAllowed=!1,tn(o)},{capture:!0,signal:n}),t.addEventListener("focusout",o=>{this.#n._focusEventsAllowed=!0,tn(o)},{capture:!0,signal:n})),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const r=o=>{o.preventDefault(),t===this.#e?this.edit():this.#n.toggleComment(!0)};return t.addEventListener("click",r,{capture:!0,signal:n}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#i=!0,r(o))},{signal:n}),t.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:n}),t.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:n}),t}edit(t){const e=this.commentPopupPositionInLayer;let n,r;if(e)[n,r]=e;else{[n,r]=this.#n.commentButtonPosition;const{width:g,height:p,x:m,y:v}=this.#n;n=m+n*g,r=v+r*p}const o=this.#n.parent.boundingClientRect,{x:l,y:c,width:h,height:f}=o;this.#n._uiManager.editComment(this.#n,l+n*h,c+r*f,{...t,parentDimensions:o})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#a===""}isEmpty(){return this.#a===null}hasBeenEdited(){return this.isDeleted()||this.#a!==this.#s}serialize(){return this.data}get data(){return{text:this.#a,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#a&&(this.#r=null),t===null){this.#a="",this.#c=!0;return}this.#a=t,this.#o=new Date,this.#c=!1}setInitialText(t,e=null){this.#s=t,this.data=t,this.#o=null,this.#r=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#a="",this.#r=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class fh{#t;#e=!1;#i=null;#n;#s;#r;#a;#o=null;#c;#l=null;#f;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:r=null,onPinching:o=null,onPinchEnd:l=null,signal:c}){this.#t=t,this.#i=n,this.#n=e,this.#s=r,this.#r=o,this.#a=l,this.#f=new AbortController,this.#c=AbortSignal.any([c,this.#f.signal]),t.addEventListener("touchstart",this.#d.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/va.pixelRatio}#d(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#o)return;const r=this.#o=new AbortController,o=AbortSignal.any([this.#c,r.signal]),l=this.#t,c={capture:!0,signal:o,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(tn(f),h(f))},c),l.addEventListener("pointerup",h,c),l.addEventListener("pointercancel",h,c);return}if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#c,this.#h.signal]),o=this.#t,l={signal:r,capture:!1,passive:!1};o.addEventListener("touchmove",this.#m.bind(this),l);const c=this.#p.bind(this);o.addEventListener("touchend",c,l),o.addEventListener("touchcancel",c,l),l.capture=!0,o.addEventListener("pointerdown",tn,l),o.addEventListener("pointermove",tn,l),o.addEventListener("pointercancel",tn,l),o.addEventListener("pointerup",tn,l),this.#s?.()}if(tn(t),t.touches.length!==2||this.#i?.()){this.#l=null;return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;tn(t);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:r,screenY:o}=e,{screenX:l,screenY:c}=n,h=this.#l,{touch0X:f,touch0Y:g,touch1X:p,touch1Y:m}=h,v=p-f,b=m-g,y=l-r,A=c-o,S=Math.hypot(y,A)||1,w=Math.hypot(v,b)||1;if(!this.#e&&Math.abs(w-S)<=fh.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=o,h.touch1X=l,h.touch1Y=c,!this.#e){this.#e=!0;return}const E=[(r+l)/2,(o+c)/2];this.#r?.(E,w,S)}#p(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#a?.()),this.#l&&(tn(t),this.#l=null,this.#e=!1))}destroy(){this.#f?.abort(),this.#f=null,this.#o?.abort(),this.#o=null}}class Qt{#t=null;#e=null;#i=null;#n=null;#s=null;#r=!1;#a=null;#o="";#c=null;#l=null;#f=null;#h=null;#d=null;#m="";#p=!1;#u=null;#g=!1;#v=!1;#x=!1;#y=null;#E=0;#S=0;#b=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#_=!1;#w=Qt._zIndex++;static _borderLineWidth=-1;static _colorManager=new T0;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Qt.prototype._resizeWithKeyboard,e=Er.TRANSLATE_SMALL,n=Er.TRANSLATE_BIG;return re(this,"_resizerKeyboardManager",new Jl([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],Qt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:n,pageHeight:r,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[o,l];const[c,h]=this.parentDimensions;this.x=t.x/c,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return re(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new EA({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Qt._l10n??=t,Qt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Qt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Qt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Ue("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#_}set _isDraggable(t){this.#_=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#w}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#L(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#p?this.#p=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,r){const[o,l]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(t+n)/o,this.y=(e+r)/l,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,r]=this.parentDimensions;this.setAt(t*n,e*r,this.width*n,this.height*r),this._onTranslated()}#O([t,e],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/t,this.y+=r/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#O(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#O(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[r,o]}=this;if(this.x+=t/r,this.y+=e/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,f]=this.getBaseTranslation();l+=h,c+=f;const{style:g}=n;g.left=`${(100*l).toFixed(2)}%`,g.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=Qt,r=n/t,o=n/e;switch(this.rotation){case 90:return[-r,o];case 180:return[r,o];case 270:return[r,-o];default:return[-r,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,r]}=this;let{x:o,y:l,width:c,height:h}=this;if(c*=n,h*=r,o*=n,l*=r,this._mustFixPosition)switch(t){case 0:o=Yn(o,0,n-c),l=Yn(l,0,r-h);break;case 90:o=Yn(o,0,n-h),l=Yn(l,c,r);break;case 180:o=Yn(o,c,n),l=Yn(l,h,r);break;case 270:o=Yn(o,h,n),l=Yn(l,0,r-c);break}this.x=o/=n,this.y=l/=r;const[f,g]=this.getBaseTranslation();o+=f,l+=g,e.left=`${(100*o).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#k(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Qt.#k(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Qt.#k(t,e,360-this.parentRotation)}#D(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(){const{div:{style:t},width:e,height:n}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#B(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",n),r.setAttribute("data-resizer-name",n),r.addEventListener("pointerdown",this.#P.bind(this,n),{signal:e}),r.addEventListener("contextmenu",Vi,{signal:e}),r.tabIndex=-1}this.div.prepend(this.#c)}#P(t,e){e.preventDefault();const{isMac:n}=_n.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#i?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#F.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",tn,{passive:!1,signal:l}),window.addEventListener("contextmenu",Vi,{signal:l}),this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#I()};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}#N(t,e,n,r){this.width=n,this.height=r,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#I(){if(!this.#f)return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:r}=this.#f;this.#f=null;const o=this.x,l=this.y,c=this.width,h=this.height;o===t&&l===e&&c===n&&h===r||this.addCommands({cmd:this.#N.bind(this,o,l,c,h),undo:this.#N.bind(this,t,e,n,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#F(t,e){const[n,r]=this.parentDimensions,o=this.x,l=this.y,c=this.width,h=this.height,f=Qt.MIN_SIZE/n,g=Qt.MIN_SIZE/r,p=this.#D(this.rotation),m=(Q,J)=>[p[0]*Q+p[2]*J,p[1]*Q+p[3]*J],v=this.#D(360-this.rotation),b=(Q,J)=>[v[0]*Q+v[2]*J,v[1]*Q+v[3]*J];let y,A,S=!1,w=!1;switch(t){case"topLeft":S=!0,y=(Q,J)=>[0,0],A=(Q,J)=>[Q,J];break;case"topMiddle":y=(Q,J)=>[Q/2,0],A=(Q,J)=>[Q/2,J];break;case"topRight":S=!0,y=(Q,J)=>[Q,0],A=(Q,J)=>[0,J];break;case"middleRight":w=!0,y=(Q,J)=>[Q,J/2],A=(Q,J)=>[0,J/2];break;case"bottomRight":S=!0,y=(Q,J)=>[Q,J],A=(Q,J)=>[0,0];break;case"bottomMiddle":y=(Q,J)=>[Q/2,J],A=(Q,J)=>[Q/2,0];break;case"bottomLeft":S=!0,y=(Q,J)=>[0,J],A=(Q,J)=>[Q,0];break;case"middleLeft":w=!0,y=(Q,J)=>[0,J/2],A=(Q,J)=>[Q,J/2];break}const E=y(c,h),D=A(c,h);let P=m(...D);const L=Qt._round(o+P[0]),R=Qt._round(l+P[1]);let V=1,F=1,Z,tt;if(e.fromKeyboard)({deltaX:Z,deltaY:tt}=e);else{const{screenX:Q,screenY:J}=e,[_t,vt]=this.#l;[Z,tt]=this.screenToPageTranslation(Q-_t,J-vt),this.#l[0]=Q,this.#l[1]=J}if([Z,tt]=b(Z/n,tt/r),S){const Q=Math.hypot(c,h);V=F=Math.max(Math.min(Math.hypot(D[0]-E[0]-Z,D[1]-E[1]-tt)/Q,1/c,1/h),f/c,g/h)}else w?V=Yn(Math.abs(D[0]-E[0]-Z),f,1)/c:F=Yn(Math.abs(D[1]-E[1]-tt),g,1)/h;const I=Qt._round(c*V),nt=Qt._round(h*F);P=m(...A(I,nt));const O=L-P[0],rt=R-P[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=I,this.height=nt,this.x=O,this.y=rt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#v)return this._editToolbar;this._editToolbar=new Dl(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,n]of t)await this._editToolbar.addButton(e,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(ma.initialize(Qt._l10n),this.#i=new ma(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new Au(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#s){this._uiManager.isEditingMode()&&this.#s.classList.remove("hidden");return}this.hasComment&&(this.#s=this.#n.renderForStandalone(),this.div.append(this.#s))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#s=null}hideStandaloneCommentButton(){this.#s?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:n,deleted:r}}=this.#n;return{text:e,richText:t,date:n,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#n||=new Au(this),this.#n.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:n}){if(!e||(this.#n||=new Au(this),this.#n.setInitialText(t,n),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(t){this.#n||=new Au(this),this.#n.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#n.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,r]=t.rect,[o]=this.pageDimensions,[l]=this.pageTranslation,c=l+o+1,h=r-100,f=c+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,f,r]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#n.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#H();const[e,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/n).toFixed(2)}%`);const[r,o]=this.getInitialTranslation();return this.translate(r,o),C2(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new fh({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#V.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#A.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#V(){this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,e,n){let o=.7*(n/e)+1-.7;if(o===1)return;const l=this.#D(this.rotation),c=(L,R)=>[l[0]*L+l[2]*R,l[1]*L+l[3]*R],[h,f]=this.parentDimensions,g=this.x,p=this.y,m=this.width,v=this.height,b=Qt.MIN_SIZE/h,y=Qt.MIN_SIZE/f;o=Math.max(Math.min(o,1/m,1/v),b/m,y/v);const A=Qt._round(m*o),S=Qt._round(v*o);if(A===m&&S===v)return;this.#u||=[g,p,m,v];const w=c(m/2,v/2),E=Qt._round(g+w[0]),D=Qt._round(p+w[1]),P=c(A/2,S/2);this.x=E-P[0],this.y=D-P[1],this.width=A,this.height=S,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#A(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#I()}pointerdown(t){const{isMac:e}=_n.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#p=!0,this._isDraggable){this.#U(t);return}this.#M(t)}#M(t){const{isMac:e}=_n.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const r=new AbortController,o=this._uiManager.combinedSignal(r),l={capture:!0,passive:!1,signal:o},c=f=>{r.abort(),this.#a=null,this.#p=!1,this._uiManager.endDragSession()||this.#M(f),n&&this._onStopDragging()};e&&(this.#E=t.clientX,this.#S=t.clientY,this.#a=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:g,clientY:p,pointerId:m}=f;if(m!==this.#a){tn(f);return}const[v,b]=this.screenToPageTranslation(g-this.#E,p-this.#S);this.#E=g,this.#S=p,this._uiManager.dragSelectedEditors(v,b)},l),window.addEventListener("touchmove",tn,l),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&c(f),tn(f)},l));const h=f=>{if(!this.#a||this.#a===f.pointerId){c(f);return}tn(f)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const r=this.parentScale,[o,l]=this.pageDimensions,[c,h]=this.pageTranslation,f=t/r,g=e/r,p=this.x*o,m=this.y*l,v=this.width*o,b=this.height*l;switch(n){case 0:return[p+f+c,l-m-g-b+h,p+f+v+c,l-m-g+h];case 90:return[p+g+c,l-m+f+h,p+g+b+c,l-m+f+v+h];case 180:return[p-f-v+c,l-m+g+h,p-f+c,l-m+g+b+h];case 270:return[p-g-b+c,l-m-f-v+h,p-g+c,l-m-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,r,o,l]=t,c=o-n,h=l-r;switch(this.rotation){case 0:return[n,e-l,c,h];case 90:return[n,e-r,h,c];case 180:return[o,e-r,c,h];case 270:return[o,e-l,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Qt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:n,opacity:r,deleted:o,richText:l},uid:c,pageIndex:h,creationDate:f,modificationDate:g}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:l,contentsObj:{str:t},creationDate:f,modificationDate:n||g,popupRef:!o,color:e,opacity:r}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#v=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#v=!1,!0):!1}isInEditMode(){return this.#v}shouldGetKeyboardEvents(){return this.#x}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:r}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return e<l&&r>0&&t<o&&n>0}#H(){if(this.#d||!this.div)return;this.#d=new AbortController;const t=this._uiManager.combinedSignal(this.#d);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#H()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,n){const r=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[o,l]=r.pageDimensions,[c,h,f,g]=r.getRectInCurrentCoords(t.rect,l);return r.x=c/o,r.y=h/l,r.width=f/o,r.height=g/l,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#d?.abort(),this.#d=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#L(),this.removeEditToolbar(),this.#b){for(const t of this.#b.values())clearTimeout(t);this.#b=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#B(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[n,r,o,l]=this.getPDFRect();return[Qt._round(n+(o-n)*t),Qt._round(r+(l-r)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(t){this.#n.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#n?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const l=this.#W.bind(this),c=this.#K.bind(this),h=this._uiManager._signal;for(const f of this.#e){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",this.#Y.bind(this,g),{signal:h}),f.setAttribute("data-l10n-id",Qt._l10nResizer[g])}}const n=this.#e[0];let r=0;for(const l of e){if(l===n)break;r++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(o!==r){if(o<r)for(let c=0;c<r-o;c++)this.#c.append(this.#c.firstElementChild);else if(o>r)for(let c=0;c<o-r;c++)this.#c.firstElementChild.before(this.#c.lastElementChild);let l=0;for(const c of e){const f=this.#e[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Qt._l10nResizer[f])}}this.#j(0),this.#x=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#W(t){Qt._resizerKeyboardManager.exec(this,t)}#K(t){this.#x&&t.relatedTarget?.parentNode!==this.#c&&this.#L()}#Y(t){this.#m=this.#x?t:""}#j(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#x&&this.#F(this.#m,{deltaX:t,deltaY:e,fromKeyboard:!0})}#L(){this.#x=!1,this.#j(-1),this.#I()}_stopResizingWithKeyboard(){this.#L(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(t){this.#g=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#b||=new Map;const{action:n}=t;let r=this.#b.get(n);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#b.delete(n),this.#b.size===0&&(this.#b=null)},Qt._telemetryTimeout),this.#b.set(n,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class EA extends Qt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const fv=3285377520,Ui=4294901760,ha=65535;class k2{constructor(t){this.h1=t?t&4294967295:fv,this.h2=t?t&4294967295:fv}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let y=0,A=t.length;y<A;y++){const S=t.charCodeAt(y);S<=255?e[n++]=S:(e[n++]=S>>>8,e[n++]=S&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=n>>2,o=n-r*4,l=new Uint32Array(e.buffer,0,r);let c=0,h=0,f=this.h1,g=this.h2;const p=3432918353,m=461845907,v=p&ha,b=m&ha;for(let y=0;y<r;y++)y&1?(c=l[y],c=c*p&Ui|c*v&ha,c=c<<15|c>>>17,c=c*m&Ui|c*b&ha,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[y],h=h*p&Ui|h*v&ha,h=h<<15|h>>>17,h=h*m&Ui|h*b&ha,g^=h,g=g<<13|g>>>19,g=g*5+3864292196);switch(c=0,o){case 3:c^=e[r*4+2]<<16;case 2:c^=e[r*4+1]<<8;case 1:c^=e[r*4],c=c*p&Ui|c*v&ha,c=c<<15|c>>>17,c=c*m&Ui|c*b&ha,r&1?f^=c:g^=c}this.h1=f,this.h2=g}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Ui|t*36045&ha,e=e*4283543511&Ui|((e<<16|t>>>16)*2950163797&Ui)>>>16,t^=e>>>1,t=t*444984403&Ui|t*60499&ha,e=e*3301882366&Ui|((e<<16|t>>>16)*3120437893&Ui)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const u0=Object.freeze({map:null,hash:"",transfer:void 0});class C0{#t=!1;#e=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=this.#n.get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return this.#n.get(t)}remove(t){const e=this.#n.get(t);if(e!==void 0&&(e instanceof Qt&&this.#i.delete(e.annotationElementId),this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#n.values())if(n instanceof Qt)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=this.#n.get(t);let r=!1;if(n!==void 0)for(const[o,l]of Object.entries(e))n[o]!==l&&(r=!0,n[o]=l);else r=!0,this.#n.set(t,e);r&&this.#s(),e instanceof Qt&&((this.#i||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#n.has(t)}get size(){return this.#n.size}#s(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new D2(this)}get serializable(){if(this.#n.size===0)return u0;const t=new Map,e=new k2,n=[],r=Object.create(null);let o=!1;for(const[l,c]of this.#n){const h=c instanceof Qt?c.serialize(!1,r):c;h&&(t.set(l,h),e.update(`${l}:${JSON.stringify(h)}`),o||=!!h.bitmap)}if(o)for(const l of t.values())l.bitmap&&n.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:u0}get editorStats(){let t=null;const e=new Map;let n=0,r=0;for(const o of this.#n.values()){if(!(o instanceof Qt)){o.popup&&(o.popup.deleted?r+=1:n+=1);continue}o.isCommentDeleted?r+=1:o.hasEditedComment&&(n+=1);const l=o.telemetryFinalData;if(!l)continue;const{type:c}=l;e.has(c)||e.set(c,Object.getPrototypeOf(o).constructor),t||=Object.create(null);const h=t[c]||=new Map;for(const[f,g]of Object.entries(l)){if(f==="type")continue;let p=h.get(f);p||(p=new Map,h.set(f,p));const m=p.get(g)??0;p.set(g,m+1)}}if((r>0||n>0)&&(t||=Object.create(null),t.comments={deleted:r,edited:n}),!t)return null;for(const[o,l]of e)t[o]=l.computeTelemetryFinalData(t[o]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const n=this.#i?.get(t);return n?(n.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#i?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#i)for(const e of this.#i.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class D2 extends C0{#t;constructor(t){super();const{map:e,hash:n,transfer:r}=t.serializable,o=structuredClone(e,r?{transfer:r}:null);this.#t={map:o,hash:n,transfer:r}}get print(){Ue("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return re(this,"modifiedIds",{ids:new Set,hash:""})}}class TA{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:n}){if(!(!t||this.#t.has(t.loadedName))){if(me(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:o,style:l}=t,c=new FontFace(r,o,l);this.addNativeFontFace(c);try{await c.load(),this.#t.add(r),n?.(t)}catch{ae(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}Ue("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(r){throw ae(`Failed to load font '${n.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const r=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return re(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return re(this,"isSyncFontLoadingSupported",Wn||_n.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(me(!r.done,"completeRequest() cannot be called twice."),r.done=!0;n.length>0&&n[0].done;){const o=n.shift();setTimeout(o.callback,0)}}const{loadingRequests:n}=this,r={done:!1,complete:e,callback:t};return n.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return re(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(D,P){return D.charCodeAt(P)<<24|D.charCodeAt(P+1)<<16|D.charCodeAt(P+2)<<8|D.charCodeAt(P+3)&255}function r(D,P,L,R){const V=D.substring(0,P),F=D.substring(P+L);return V+R+F}let o,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function g(D,P){if(++f>30){ae("Load test font never loaded."),P();return}if(h.font="30px "+D,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){P();return}setTimeout(g.bind(null,D,P))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=r(m,976,p.length,p);const b=16,y=1482184792;let A=n(m,b);for(o=0,l=p.length-3;o<l;o+=4)A=A-y+n(p,o)|0;o<p.length&&(A=A-y+n(p+"XXX",o)|0),m=r(m,b,4,sA(A));const S=`url(data:font/opentype;base64,${btoa(m)});`,w=`@font-face {font-family:"${p}";src:${S}}`;this.insertRule(w);const E=this._document.createElement("div");E.style.visibility="hidden",E.style.width=E.style.height="10px",E.style.position="absolute",E.style.top=E.style.left="0px";for(const D of[t.loadedName,p]){const P=this._document.createElement("span");P.textContent="Hi",P.style.fontFamily=D,E.append(P)}this._document.body.append(E),g(p,()=>{E.remove(),e.complete()})}}class CA{#t;constructor(t,e=null,n,r){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,n&&Object.assign(this,n),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${S2(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let r;try{r=t.get(n)}catch(l){ae(`getPathGenerator - ignoring character: "${l}".`)}const o=T2(r?.path);return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=o}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){re(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){re(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class uo{#t;#e;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,n={};let r=0;for(const f of uo.strings){const g=e.encode(t[f]);n[f]=g,r+=4+g.length}const o=new ArrayBuffer(r),l=new Uint8Array(o),c=new DataView(o);let h=0;for(const f of uo.strings){const g=n[f],p=g.length;c.setUint32(h,p),l.set(g,h+4),h+=4+p}return me(h===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}#n(t){me(t<uo.strings.length,"Invalid string index");let e=0;for(let r=0;r<t;r++)e+=this.#e.getUint32(e)+4;const n=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,n))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class ho{#t;#e;#i;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,n={};let r=0;for(const m of ho.strings){const v=e.encode(t[m]);n[m]=v,r+=4+v.length}r+=4;let o,l,c=1+r;t.style&&(o=e.encode(t.style.style),l=e.encode(t.style.weight),c+=4+o.length+4+l.length);const h=new ArrayBuffer(c),f=new Uint8Array(h),g=new DataView(h);let p=0;g.setUint8(p++,t.guessFallback?1:0),g.setUint32(p,0),p+=4,r=0;for(const m of ho.strings){const v=n[m],b=v.length;r+=4+b,g.setUint32(p,b),f.set(v,p+4),p+=4+b}return g.setUint32(p-r-4,r),t.style&&(g.setUint32(p,o.length),f.set(o,p+4),p+=4+o.length,g.setUint32(p,l.length),f.set(l,p+4),p+=4+l.length),me(p<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(p)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#n(t){me(t<ho.strings.length,"Invalid string index");let e=5;for(let r=0;r<t;r++)e+=this.#e.getUint32(e)+4;const n=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,n))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),n=this.#i.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const r=this.#e.getUint32(t),o=this.#i.decode(new Uint8Array(this.#t,t+4,r));return{style:n,weight:o}}}class Le{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#i=this.#e+1+8;static#n=this.#i+1+48;static#s=this.#n+1+6;#r;#a;#o;constructor({data:t,extra:e}){this.#r=t,this.#a=new TextDecoder,this.#o=new DataView(this.#r),e&&Object.assign(this,e)}#c(t){me(t<Le.bools.length,"Invalid boolean index");const e=Math.floor(t/4),n=t*2%8,r=this.#o.getUint8(e)>>n&3;return r===0?void 0:r===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return me(t<Le.numbers.length,"Invalid number index"),this.#o.getFloat64(Le.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Le.#e;if(this.#o.getUint8(t)===0)return;t+=1;const n=[];for(let r=0;r<4;r++)n.push(this.#o.getInt16(t,!0)),t+=2;return n}get fontMatrix(){let t=Le.#i;if(this.#o.getUint8(t)===0)return;t+=1;const n=[];for(let r=0;r<6;r++)n.push(this.#o.getFloat64(t,!0)),t+=8;return n}get defaultVMetrics(){let t=Le.#n;if(this.#o.getUint8(t)===0)return;t+=1;const n=[];for(let r=0;r<3;r++)n.push(this.#o.getInt16(t,!0)),t+=2;return n}#f(t){me(t<Le.strings.length,"Invalid string index");let e=Le.#s+4;for(let o=0;o<t;o++)e+=this.#o.getUint32(e)+4;const n=this.#o.getUint32(e),r=new Uint8Array(n);return r.set(new Uint8Array(this.#r,e+4,n)),this.#a.decode(r)}get fallbackName(){return this.#f(0)}get loadedName(){return this.#f(1)}get mimetype(){return this.#f(2)}get name(){return this.#f(3)}get data(){let t=Le.#s;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);t+=4+n;const r=this.#o.getUint32(t);t+=4+r;const o=this.#o.getUint32(t);if(o!==0)return new Uint8Array(this.#r,t+4,o)}clearData(){let t=Le.#s;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);t+=4+n;const r=this.#o.getUint32(t);t+=4+r;const o=this.#o.getUint32(t);new Uint8Array(this.#r,t+4,o).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Le.#s;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);t+=4+n;const r=this.#o.getUint32(t);if(r===0)return null;const o=new Uint8Array(r);return o.set(new Uint8Array(this.#r,t+4,r)),new uo(o.buffer)}get systemFontInfo(){let t=Le.#s;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);if(n===0)return null;const r=new Uint8Array(n);return r.set(new Uint8Array(this.#r,t+4,n)),new ho(r.buffer)}static write(t){const e=t.systemFontInfo?ho.write(t.systemFontInfo):null,n=t.cssFontInfo?uo.write(t.cssFontInfo):null,r=new TextEncoder,o={};let l=0;for(const y of Le.strings)o[y]=r.encode(t[y]),l+=4+o[y].length;const c=Le.#s+4+l+4+(e?e.byteLength:0)+4+(n?n.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(c),f=new Uint8Array(h),g=new DataView(h);let p=0;const m=Le.bools.length;let v=0,b=0;for(let y=0;y<m;y++){const A=t[Le.bools[y]];v|=(A===void 0?0:A?2:1)<<b,b+=2,(b===8||y===m-1)&&(g.setUint8(p++,v),v=0,b=0)}me(p===Le.#t,"FontInfo.write: Boolean properties offset mismatch");for(const y of Le.numbers)g.setFloat64(p,t[y]),p+=8;if(me(p===Le.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){g.setUint8(p++,4);for(const y of t.bbox)g.setInt16(p,y,!0),p+=2}else g.setUint8(p++,0),p+=8;if(me(p===Le.#i,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){g.setUint8(p++,6);for(const y of t.fontMatrix)g.setFloat64(p,y,!0),p+=8}else g.setUint8(p++,0),p+=48;if(me(p===Le.#n,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){g.setUint8(p++,1);for(const y of t.defaultVMetrics)g.setInt16(p,y,!0),p+=2}else g.setUint8(p++,0),p+=6;me(p===Le.#s,"FontInfo.write: DefaultVMetrics properties offset mismatch"),g.setUint32(Le.#s,0),p+=4;for(const y of Le.strings){const A=o[y],S=A.length;g.setUint32(p,S),f.set(A,p+4),p+=4+S}if(g.setUint32(Le.#s,p-Le.#s-4),!e)g.setUint32(p,0),p+=4;else{const y=e.byteLength;g.setUint32(p,y),me(p+4+y<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),p+4),p+=4+y}if(!n)g.setUint32(p,0),p+=4;else{const y=n.byteLength;g.setUint32(p,y),me(p+4+y<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(n),p+4),p+=4+y}return t.data===void 0?(g.setUint32(p,0),p+=4):(g.setUint32(p,t.data.length),f.set(t.data,p+4),p+=4+t.data.length),me(p<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(p)}}class An{static#t=0;static#e=1;static#i=2;static#n=3;static#s=4;static#r=8;static#a=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,n=null,r=[],o=[],l=[],c=[],h=null,f=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,n=t[2],l=t[3],e===1?r.push(...t[4],...t[5]):r.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,h=t[1],r=t[2],o=t[3],c=t[4]||[],n=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const g=Math.floor(r.length/2),p=Math.floor(o.length/3),m=l.length,v=c.length;let b=0;for(const P of c)b+=1,b=Math.ceil(b/4)*4,b+=4+P.coords.length*4,b+=4+P.colors.length*4,P.verticesPerRow!==void 0&&(b+=4);const y=20+g*8+p*3+m*8+(n?16:0)+(f?3:0)+b,A=new ArrayBuffer(y),S=new DataView(A),w=new Uint8Array(A);S.setUint8(An.#t,e),S.setUint8(An.#e,n?1:0),S.setUint8(An.#i,f?1:0),S.setUint8(An.#n,h),S.setUint32(An.#s,g,!0),S.setUint32(An.#r,p,!0),S.setUint32(An.#a,m,!0),S.setUint32(An.#o,v,!0);let E=20;new Float32Array(A,E,g*2).set(r),E+=g*8,w.set(o,E),E+=p*3;for(const[P,L]of l)S.setFloat32(E,P,!0),E+=4,S.setUint32(E,parseInt(L.slice(1),16),!0),E+=4;if(n)for(const P of n)S.setFloat32(E,P,!0),E+=4;f&&(w.set(f,E),E+=3);for(let P=0;P<c.length;P++){const L=c[P];S.setUint8(E,L.type),E+=1,E=Math.ceil(E/4)*4,S.setUint32(E,L.coords.length,!0),E+=4,new Int32Array(A,E,L.coords.length).set(L.coords),E+=L.coords.length*4,S.setUint32(E,L.colors.length,!0),E+=4,new Int32Array(A,E,L.colors.length).set(L.colors),E+=L.colors.length*4,L.verticesPerRow!==void 0&&(S.setUint32(E,L.verticesPerRow,!0),E+=4)}return A}getIR(){const t=this.view,e=this.data[An.#t],n=!!this.data[An.#e],r=!!this.data[An.#i],o=t.getUint32(An.#s,!0),l=t.getUint32(An.#r,!0),c=t.getUint32(An.#a,!0),h=t.getUint32(An.#o,!0);let f=20;const g=new Float32Array(this.buffer,f,o*2);f+=o*8;const p=new Uint8Array(this.buffer,f,l*3);f+=l*3;const m=[];for(let A=0;A<c;++A){const S=t.getFloat32(f,!0);f+=4;const w=t.getUint32(f,!0);f+=4,m.push([S,`#${w.toString(16).padStart(6,"0")}`])}let v=null;if(n){v=[];for(let A=0;A<4;++A)v.push(t.getFloat32(f,!0)),f+=4}let b=null;r&&(b=new Uint8Array(this.buffer,f,3),f+=3);const y=[];for(let A=0;A<h;++A){const S=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const w=t.getUint32(f,!0);f+=4;const E=new Int32Array(this.buffer,f,w);f+=w*4;const D=t.getUint32(f,!0);f+=4;const P=new Int32Array(this.buffer,f,D);f+=D*4;const L={type:S,coords:E,colors:P};S===r0.LATTICE&&(L.verticesPerRow=t.getUint32(f,!0),f+=4),y.push(L)}if(e===1)return["RadialAxial","axial",v,m,Array.from(g.slice(0,2)),Array.from(g.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",v,m,[g[0],g[1]],[g[3],g[4]],g[2],g[5]];if(e===3){const A=this.data[An.#n];let S=null;if(g.length>0){let w=g[0],E=g[0],D=g[1],P=g[1];for(let L=0;L<g.length;L+=2){const R=g[L],V=g[L+1];w=w>R?R:w,D=D>V?V:D,E=E<R?R:E,P=P<V?V:P}S=[w,D,E,P]}return["Mesh",A,g,p,y,S,v,b]}throw new Error(`Unsupported pattern kind: ${e}`)}}class kA{static write(t){let e,n;return _n.isFloat16ArraySupported?(n=new ArrayBuffer(t.length*2),e=new Float16Array(n)):(n=new ArrayBuffer(t.length*4),e=new Float32Array(n)),e.set(t),n}#t;constructor(t){this.#t=t}get path(){return _n.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function DA(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(Wn)return i;const t=URL.parse(i,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function OA(i){if(Wn&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return Yl(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i?.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Su(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const h0=i=>typeof i=="object"&&Number.isInteger(i?.num)&&i.num>=0&&Number.isInteger(i?.gen)&&i.gen>=0,RA=i=>typeof i=="object"&&typeof i?.name=="string",PA=hA.bind(null,h0,RA);class MA{#t=new Map;#e=Promise.resolve();postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,n)})}addEventListener(t,e,n=null){let r=null;if(n?.signal instanceof AbortSignal){const{signal:o}=n;if(o.aborted){ae("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);r=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}this.#t.set(e,r)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const wu={DATA:1,ERROR:2},fn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function dv(){}function oi(i){if(i instanceof wr||i instanceof s0||i instanceof rv||i instanceof Gu||i instanceof Hd)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||Ue('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new wr(i.message);case"InvalidPDFException":return new s0(i.message);case"PasswordException":return new rv(i.message,i.code);case"ResponseException":return new Gu(i.message,i.status,i.missing);case"UnknownErrorException":return new Hd(i.message,i.details)}return new Hd(i.message,i.toString())}class Tl{#t=new AbortController;constructor(t,e,n){this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const n=t.callbackId,r=this.callbackCapabilities[n];if(!r)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===wu.DATA)r.resolve(t.data);else if(t.callback===wu.ERROR)r.reject(oi(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,r=t.sourceName,o=this.comObj;Promise.try(e,t.data).then(function(l){o.postMessage({sourceName:n,targetName:r,callback:wu.DATA,callbackId:t.callbackId,data:l})},function(l){o.postMessage({sourceName:n,targetName:r,callback:wu.ERROR,callbackId:t.callbackId,reason:oi(l)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const r=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[r]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:e},n)}catch(l){o.reject(l)}return o.promise}sendWithStream(t,e,n,r){const o=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:t,streamId:o,data:e,desiredSize:f.desiredSize},r),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[o].pullCall=g,h.postMessage({sourceName:l,targetName:c,stream:fn.PULL,streamId:o,desiredSize:f.desiredSize}),g.promise},cancel:f=>{me(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[o].cancelCall=g,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:fn.CANCEL,streamId:o,reason:oi(f)}),g.promise}},n)}#i(t){const e=t.streamId,n=this.sourceName,r=t.sourceName,o=this.comObj,l=this,c=this.actionHandler[t.action],h={enqueue(f,g=1,p){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=g,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:r,stream:fn.ENQUEUE,streamId:e,chunk:f},p)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:r,stream:fn.CLOSE,streamId:e}),delete l.streamSinks[e])},error(f){me(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:r,stream:fn.ERROR,streamId:e,reason:oi(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(c,t.data,h).then(function(){o.postMessage({sourceName:n,targetName:r,stream:fn.START_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:n,targetName:r,stream:fn.START_COMPLETE,streamId:e,reason:oi(f)})})}#n(t){const e=t.streamId,n=this.sourceName,r=t.sourceName,o=this.comObj,l=this.streamControllers[e],c=this.streamSinks[e];switch(t.stream){case fn.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(oi(t.reason));break;case fn.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(oi(t.reason));break;case fn.PULL:if(!c){o.postMessage({sourceName:n,targetName:r,stream:fn.PULL_COMPLETE,streamId:e,success:!0});break}c.desiredSize<=0&&t.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=t.desiredSize,Promise.try(c.onPull||dv).then(function(){o.postMessage({sourceName:n,targetName:r,stream:fn.PULL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:n,targetName:r,stream:fn.PULL_COMPLETE,streamId:e,reason:oi(f)})});break;case fn.ENQUEUE:if(me(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case fn.CLOSE:if(me(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#s(l,e);break;case fn.ERROR:me(l,"error should have stream controller"),l.controller.error(oi(t.reason)),this.#s(l,e);break;case fn.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(oi(t.reason)),this.#s(l,e);break;case fn.CANCEL:if(!c)break;const h=oi(t.reason);Promise.try(c.onCancel||dv,h).then(function(){o.postMessage({sourceName:n,targetName:r,stream:fn.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:n,targetName:r,stream:fn.CANCEL_COMPLETE,streamId:e,reason:oi(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class O2{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Ue("Abstract method `_createCanvas` called.")}}class NA extends O2{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class R2{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Ue("Abstract method `_fetch` called.")}}class gv extends R2{async _fetch(t){const e=await ql(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Yl(e)}}class P2{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,r,o){return"none"}destroy(t=!1){}}class FA extends P2{#t;#e;#i;#n;#s;#r;#a=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#s=e}get#o(){return this.#e||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#i){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=this.#s.createElementNS(za,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#i=this.#s.createElementNS(za,"defs"),t.append(n),n.append(this.#i),this.#s.body.append(t)}return this.#i}#f(t){if(t.length===1){const h=t[0],f=new Array(256);for(let p=0;p<256;p++)f[p]=h[p]/255;const g=f.join(",");return[g,g,g]}const[e,n,r]=t,o=new Array(256),l=new Array(256),c=new Array(256);for(let h=0;h<256;h++)o[h]=e[h]/255,l[h]=n[h]/255,c[h]=r[h]/255;return[o.join(","),l.join(","),c.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(hh(e)?ae('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=_2(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[n,r,o]=this.#f(t),l=t.length===1?n:`${n}${r}${o}`;if(e=this.#o.get(l),e)return this.#o.set(t,e),e;const c=`g_${this.#n}_transfer_map_${this.#a++}`,h=this.#h(c);this.#o.set(t,h),this.#o.set(l,h);const f=this.#p(c);return this.#g(n,r,o,f),h}addHCMFilter(t,e){const n=`${t}-${e}`,r="base";let o=this.#c.get(r);if(o?.key===n||(o?(o.filter?.remove(),o.key=n,o.url="none",o.filter=null):(o={key:n,url:"none",filter:null},this.#c.set(r,o)),!t||!e))return o.url;const l=this.#x(t);t=Xt.makeHexColor(...l);const c=this.#x(e);if(e=Xt.makeHexColor(...c),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return o.url;const h=new Array(256);for(let v=0;v<=255;v++){const b=v/255;h[v]=b<=.03928?b/12.92:((b+.055)/1.055)**2.4}const f=h.join(","),g=`g_${this.#n}_hcm_filter`,p=o.filter=this.#p(g);this.#g(f,f,f,p),this.#m(p);const m=(v,b)=>{const y=l[v]/255,A=c[v]/255,S=new Array(b+1);for(let w=0;w<=b;w++)S[w]=y+w/b*(A-y);return S.join(",")};return this.#g(m(0,5),m(1,5),m(2,5),p),o.url=this.#h(g),o.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[n]=this.#f([t]),r=`alpha_${n}`;if(e=this.#o.get(r),e)return this.#o.set(t,e),e;const o=`g_${this.#n}_alpha_map_${this.#a++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(r,l);const c=this.#p(o);return this.#v(n,c),l}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let n,r;if(t?([n]=this.#f([t]),r=`luminosity_${n}`):r="luminosity",e=this.#o.get(r),e)return this.#o.set(t,e),e;const o=`g_${this.#n}_luminosity_map_${this.#a++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(r,l);const c=this.#p(o);return this.#d(c),t&&this.#v(n,c),l}addHighlightHCMFilter(t,e,n,r,o){const l=`${e}-${n}-${r}-${o}`;let c=this.#c.get(t);if(c?.key===l||(c?(c.filter?.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},this.#c.set(t,c)),!e||!n))return c.url;const[h,f]=[e,n].map(this.#x.bind(this));let g=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),p=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[m,v]=[r,o].map(this.#x.bind(this));p<g&&([g,p,m,v]=[p,g,v,m]),this.#l.style.color="";const b=(S,w,E)=>{const D=new Array(256),P=(p-g)/E,L=S/255,R=(w-S)/(255*E);let V=0;for(let F=0;F<=E;F++){const Z=Math.round(g+F*P),tt=L+F*R;for(let I=V;I<=Z;I++)D[I]=tt;V=Z+1}for(let F=V;F<256;F++)D[F]=D[V-1];return D.join(",")},y=`g_${this.#n}_hcm_${t}_filter`,A=c.filter=this.#p(y);return this.#m(A),this.#g(b(m[0],v[0],5),b(m[1],v[1],5),b(m[2],v[2],5),A),c.url=this.#h(y),c.url}destroy(t=!1){t&&this.#r?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#a=0)}#d(t){const e=this.#s.createElementNS(za,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#m(t){const e=this.#s.createElementNS(za,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#s.createElementNS(za,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,n){const r=this.#s.createElementNS(za,e);r.setAttribute("type","discrete"),r.setAttribute("tableValues",n),t.append(r)}#g(t,e,n,r){const o=this.#s.createElementNS(za,"feComponentTransfer");r.append(o),this.#u(o,"feFuncR",t),this.#u(o,"feFuncG",e),this.#u(o,"feFuncB",n)}#v(t,e){const n=this.#s.createElementNS(za,"feComponentTransfer");e.append(n),this.#u(n,"feFuncA",t)}#x(t){return this.#l.style.color=t,Zl(getComputedStyle(this.#l).getPropertyValue("color"))}}class M2{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Ue("Abstract method `_fetch` called.")}}class pv extends M2{async _fetch(t){const e=await ql(t,"arraybuffer");return new Uint8Array(e)}}class N2{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Ue("Abstract method `_fetch` called.")}}class mv extends N2{async _fetch(t){const e=await ql(t,"arraybuffer");return new Uint8Array(e)}}Wn&&ae("Please use the `legacy` build in Node.js environments.");async function k0(i){const e=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(e)}class LA extends P2{}class BA extends O2{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class IA extends R2{async _fetch(t){return k0(t)}}class UA extends M2{async _fetch(t){return k0(t)}}class zA extends N2{async _fetch(t){return k0(t)}}const Js="__forcedDependency",{floor:vv,ceil:yv}=Math;function Eu(i,t,e,n,r,o){i[t*4+0]=Math.min(i[t*4+0],e),i[t*4+1]=Math.min(i[t*4+1],n),i[t*4+2]=Math.max(i[t*4+2],r),i[t*4+3]=Math.max(i[t*4+3],o)}const f0=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class HA{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===f0}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Tu=(i,t)=>{if(!i)return;let e=i.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},i.set(t,e)),e};class jA{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Js]:[]};#i=new Map;#n=[];#s=[];#r=[[1,0,0,1,0,0]];#a=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#f=new Map;#h=new Map;#d;#m;#p;#u;#g;constructor(t,e,n=!1){this.#d=t.width,this.#m=t.height,this.#v(e),n&&(this.#g=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#v(t,this.#u)}#v(t,e){const n=new ArrayBuffer(t*4);this.#p=new Uint8ClampedArray(n),this.#u=new Uint32Array(n),e&&e.length>0?(this.#u.set(e),this.#u.fill(f0,e.length)):this.#u.fill(f0)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Js]:{__proto__:this.#e[Js]}},this.#a={__proto__:this.#a},this.#n.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#a=Object.getPrototypeOf(this.#a);const n=this.#n.pop();return n!==void 0&&(Tu(this.#g,t)?.dependencies.add(n),this.#u[t]=this.#u[n]),this}recordOpenMarker(t){return this.#n.push(t),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(Tu(this.#g,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#s.push(t),this}endMarkedContent(t){const e=this.#s.pop();return e!==void 0&&(Tu(this.#g,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#r.push(Xt.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordSimpleDataFromNamed(t,e,n){this.#t[t]=this.#i.get(e)??n}recordFutureForcedDependency(t,e){return this.recordIncrementalData(Js,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(Js,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,n,r,o,l){const c=Xt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform()),h=[1/0,1/0,-1/0,-1/0];Xt.axialAlignedBoundingBox([n,o,r,l],c,h);const f=Xt.intersect(this.#a,h);return f?(this.#a[0]=f[0],this.#a[1]=f[1],this.#a[2]=f[2],this.#a[3]=f[3]):(this.#a[0]=this.#a[1]=1/0,this.#a[2]=this.#a[3]=-1/0),this}recordBBox(t,e,n,r,o,l){const c=this.#a;if(c[0]===1/0)return this;const h=Xt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform());if(c[0]===-1/0)return Xt.axialAlignedBoundingBox([n,o,r,l],h,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return Xt.axialAlignedBoundingBox([n,o,r,l],h,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],c[3])),this}recordCharacterBBox(t,e,n,r=1,o=0,l=0,c){const h=n.bbox;let f,g;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(n),f!==!1&&(g=[0,0,0,0],Xt.axialAlignedBoundingBox(h,n.fontMatrix,g),(r!==1||o!==0||l!==0)&&Xt.scaleMinMax([r,0,0,-r,o,l],g),f)))return this.recordBBox(t,e,g[0],g[2],g[1],g[3]);if(!c)return this.recordFullPageBBox(t);const p=c();return h&&g&&f===void 0&&(f=g[0]<=o-p.actualBoundingBoxLeft&&g[2]>=o+p.actualBoundingBoxRight&&g[1]<=l-p.actualBoundingBoxAscent&&g[3]>=l+p.actualBoundingBoxDescent,this.#h.set(n,f),f)?this.recordBBox(t,e,g[0],g[2],g[1],g[3]):this.recordBBox(t,e,o-p.actualBoundingBoxLeft,o+p.actualBoundingBoxRight,l-p.actualBoundingBoxAscent,l+p.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#a[0]),this.#o[1]=Math.max(0,this.#a[1]),this.#o[2]=Math.min(this.#d,this.#a[2]),this.#o[3]=Math.min(this.#m,this.#a[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const n=this.#l,r=this.#t,o=this.#e;for(const l of e)l in this.#t?n.add(r[l]):l in o&&o[l].forEach(n.add,n);return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#l.add(this.#i.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[Js]),this.#g){const n=Tu(this.#g,t),{dependencies:r}=n;this.#l.forEach(r.add,r),this.#n.forEach(r.add,r),this.#s.forEach(r.add,r),r.delete(t),n.isRenderingOperation=!0}if(this.#c===t){const n=vv(this.#o[0]*256/this.#d),r=vv(this.#o[1]*256/this.#m),o=yv(this.#o[2]*256/this.#d),l=yv(this.#o[3]*256/this.#m);Eu(this.#p,t,n,r,o,l);for(const c of this.#l)c!==t&&Eu(this.#p,c,n,r,o,l);for(const c of this.#n)c!==t&&Eu(this.#p,c,n,r,o,l);for(const c of this.#s)c!==t&&Eu(this.#p,c,n,r,o,l);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const n=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const r of n)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#a[0]=Math.max(this.#a[0],this.#o[0]),this.#a[1]=Math.max(this.#a[1],this.#o[1]),this.#a[2]=Math.min(this.#a[2],this.#o[2]),this.#a[3]=Math.min(this.#a[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#f.get(t);return this.#f.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new HA(this.#u,this.#p)}takeDebugMetadata(){return this.#g}}class Vu{#t;#e;#i;#n=0;#s=0;constructor(t,e,n){if(t instanceof Vu&&t.#i===!!n)return t;this.#t=t,this.#e=e,this.#i=!!n}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#s++,this.#t.save(this.#e),this}restore(t){return this.#s>0&&(this.#t.restore(this.#e),this.#s--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,n){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#i||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,n,r,o,l){return this.#i||this.#t.recordClipBox(this.#e,e,n,r,o,l),this}recordBBox(t,e,n,r,o,l){return this.#i||this.#t.recordBBox(this.#e,e,n,r,o,l),this}recordCharacterBBox(t,e,n,r,o,l,c){return this.#i||this.#t.recordCharacterBBox(this.#e,e,n,r,o,l,c),this}recordFullPageBBox(t){return this.#i||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#i||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const zi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Fn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function d0(i,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],e,n),i.clip(r)}class D0{isModifyingCurrentTransform(){return!1}getPattern(){Ue("Abstract method `getPattern` called.")}}class GA extends D0{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let n,r=this._p0,o=this._p1;if(e&&(r=r.slice(),o=o.slice(),Xt.applyTransform(r,e),Xt.applyTransform(o,e)),this._type==="axial")n=t.createLinearGradient(r[0],r[1],o[0],o[1]);else if(this._type==="radial"){let l=this._r0,c=this._r1;if(e){const h=new Float32Array(2);Xt.singularValueDecompose2dScale(e,h),l*=h[0],c*=h[0]}n=t.createRadialGradient(r[0],r[1],l,o[0],o[1],c)}for(const l of this._colorStops)n.addColorStop(l[0],l[1]);return n}getPattern(t,e,n,r){let o;if(r===Fn.STROKE||r===Fn.FILL){if(this.isOriginBased()){let m=Xt.transform(n,e.baseTransform);this.matrix&&(m=Xt.transform(m,this.matrix));const v=.001,b=Math.hypot(m[0],m[1]),y=Math.hypot(m[2],m[3]),A=(m[0]*m[2]+m[1]*m[3])/(b*y);if(Math.abs(A)<v)if(this.isRadial()){if(Math.abs(b-y)<v)return this._createGradient(t,m)}else return this._createGradient(t,m)}const l=e.current.getClippedPathBoundingBox(r,$e(t))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=e.cachedCanvases.getCanvas("pattern",c,h),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-l[0],-l[1]),n=Xt.transform(n,[1,0,0,1,l[0],l[1]]),g.transform(...e.baseTransform),this.matrix&&g.transform(...this.matrix),d0(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),o=t.createPattern(f.canvas,"no-repeat");const p=new DOMMatrix(n);o.setTransform(p)}else d0(t,this._bbox),o=this._createGradient(t);return o}}function Vd(i,t,e,n,r,o,l,c){const h=t.coords,f=t.colors,g=i.data,p=i.width*4;let m;h[e+1]>h[n+1]&&(m=e,e=n,n=m,m=o,o=l,l=m),h[n+1]>h[r+1]&&(m=n,n=r,r=m,m=l,l=c,c=m),h[e+1]>h[n+1]&&(m=e,e=n,n=m,m=o,o=l,l=m);const v=(h[e]+t.offsetX)*t.scaleX,b=(h[e+1]+t.offsetY)*t.scaleY,y=(h[n]+t.offsetX)*t.scaleX,A=(h[n+1]+t.offsetY)*t.scaleY,S=(h[r]+t.offsetX)*t.scaleX,w=(h[r+1]+t.offsetY)*t.scaleY;if(b>=w)return;const E=f[o],D=f[o+1],P=f[o+2],L=f[l],R=f[l+1],V=f[l+2],F=f[c],Z=f[c+1],tt=f[c+2],I=Math.round(b),nt=Math.round(w);let O,rt,Q,J,_t,vt,Nt,M;for(let C=I;C<=nt;C++){if(C<A){const bt=C<b?0:(b-C)/(b-A);O=v-(v-y)*bt,rt=E-(E-L)*bt,Q=D-(D-R)*bt,J=P-(P-V)*bt}else{let bt;C>w?bt=1:A===w?bt=0:bt=(A-C)/(A-w),O=y-(y-S)*bt,rt=L-(L-F)*bt,Q=R-(R-Z)*bt,J=V-(V-tt)*bt}let X;C<b?X=0:C>w?X=1:X=(b-C)/(b-w),_t=v-(v-S)*X,vt=E-(E-F)*X,Nt=D-(D-Z)*X,M=P-(P-tt)*X;const U=Math.round(Math.min(O,_t)),j=Math.round(Math.max(O,_t));let ot=p*C+U*4;for(let bt=U;bt<=j;bt++)X=(O-bt)/(O-_t),X<0?X=0:X>1&&(X=1),g[ot++]=rt-(rt-vt)*X|0,g[ot++]=Q-(Q-Nt)*X|0,g[ot++]=J-(J-M)*X|0,g[ot++]=255}}function VA(i,t,e){const n=t.coords,r=t.colors;let o,l;switch(t.type){case r0.LATTICE:const c=t.verticesPerRow,h=Math.floor(n.length/c)-1,f=c-1;for(o=0;o<h;o++){let g=o*c;for(let p=0;p<f;p++,g++)Vd(i,e,n[g],n[g+1],n[g+c],r[g],r[g+1],r[g+c]),Vd(i,e,n[g+c+1],n[g+1],n[g+c],r[g+c+1],r[g+1],r[g+c])}break;case r0.TRIANGLES:for(o=0,l=n.length;o<l;o+=3)Vd(i,e,n[o],n[o+1],n[o+2],r[o],r[o+1],r[o+2]);break;default:throw new Error("illegal figure")}}class XA extends D0{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,g=Math.ceil(this._bounds[3])-h,p=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(g*t[1]*1.1)),3e3),v=f/p,b=g/m,y={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/v,scaleY:1/b},A=p+4,S=m+4,w=n.getCanvas("mesh",A,S),E=w.context,D=E.createImageData(p,m);if(e){const L=D.data;for(let R=0,V=L.length;R<V;R+=4)L[R]=e[0],L[R+1]=e[1],L[R+2]=e[2],L[R+3]=255}for(const L of this._figures)VA(D,L,y);return E.putImageData(D,2,2),{canvas:w.canvas,offsetX:c-2*v,offsetY:h-2*b,scaleX:v,scaleY:b}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,r){d0(t,this._bbox);const o=new Float32Array(2);if(r===Fn.SHADING)Xt.singularValueDecompose2dScale($e(t),o);else if(this.matrix){Xt.singularValueDecompose2dScale(this.matrix,o);const[c,h]=o;Xt.singularValueDecompose2dScale(e.baseTransform,o),o[0]*=c,o[1]*=h}else Xt.singularValueDecompose2dScale(e.baseTransform,o);const l=this._createMeshCanvas(o,r===Fn.SHADING?null:this._background,e.cachedCanvases);return r!==Fn.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class KA extends D0{getPattern(){return"hotpink"}}function WA(i){switch(i[0]){case"RadialAxial":return new GA(i);case"Mesh":return new XA(i);case"Dummy":return new KA}throw new Error(`Unknown IR type: ${i[0]}`)}const xv={COLORED:1,UNCOLORED:2};class O0{static MAX_PATTERN_SIZE=3e3;constructor(t,e,n,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=r}createPatternCanvas(t,e){const{bbox:n,operatorList:r,paintType:o,tilingType:l,color:c,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:g}=this;f=Math.abs(f),g=Math.abs(g),uh("TilingType: "+l);const p=n[0],m=n[1],v=n[2],b=n[3],y=v-p,A=b-m,S=new Float32Array(2);Xt.singularValueDecompose2dScale(this.matrix,S);const[w,E]=S;Xt.singularValueDecompose2dScale(this.baseTransform,S);const D=w*S[0],P=E*S[1];let L=y,R=A,V=!1,F=!1;const Z=Math.ceil(f*D),tt=Math.ceil(g*P),I=Math.ceil(y*D),nt=Math.ceil(A*P);Z>=I?L=f:V=!0,tt>=nt?R=g:F=!0;const O=this.getSizeAndScale(L,this.ctx.canvas.width,D),rt=this.getSizeAndScale(R,this.ctx.canvas.height,P),Q=t.cachedCanvases.getCanvas("pattern",O.size,rt.size),J=Q.context,_t=h.createCanvasGraphics(J,e);if(_t.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(_t,o,c),J.translate(-O.scale*p,-rt.scale*m),_t.transform(0,O.scale,0,0,rt.scale,0,0),J.save(),_t.dependencyTracker?.save(),this.clipBbox(_t,p,m,v,b),_t.baseTransform=$e(_t.ctx),_t.executeOperatorList(r),_t.endDrawing(),_t.dependencyTracker?.restore(),J.restore(),V||F){const vt=Q.canvas;V&&(L=f),F&&(R=g);const Nt=this.getSizeAndScale(L,this.ctx.canvas.width,D),M=this.getSizeAndScale(R,this.ctx.canvas.height,P),C=Nt.size,X=M.size,U=t.cachedCanvases.getCanvas("pattern-workaround",C,X),j=U.context,ot=V?Math.floor(y/f):0,bt=F?Math.floor(A/g):0;for(let Ot=0;Ot<=ot;Ot++)for(let Tt=0;Tt<=bt;Tt++)j.drawImage(vt,C*Ot,X*Tt,C,X,0,0,C,X);return{canvas:U.canvas,scaleX:Nt.scale,scaleY:M.scale,offsetX:p,offsetY:m}}return{canvas:Q.canvas,scaleX:O.scale,scaleY:rt.scale,offsetX:p,offsetY:m}}getSizeAndScale(t,e,n){const r=Math.max(O0.MAX_PATTERN_SIZE,e);let o=Math.ceil(t*n);return o>=r?o=r:n=o/t,{scale:n,size:o}}clipBbox(t,e,n,r,o){const l=r-e,c=o-n;t.ctx.rect(e,n,l,c),Xt.axialAlignedBoundingBox([e,n,r,o],$e(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const r=t.ctx,o=t.current;switch(e){case xv.COLORED:const{fillStyle:l,strokeStyle:c}=this.ctx;r.fillStyle=o.fillColor=l,r.strokeStyle=o.strokeColor=c;break;case xv.UNCOLORED:r.fillStyle=r.strokeStyle=n,o.fillColor=o.strokeColor=n;break;default:throw new rA(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,r,o){let l=n;r!==Fn.SHADING&&(l=Xt.transform(l,e.baseTransform),this.matrix&&(l=Xt.transform(l,this.matrix)));const c=this.createPatternCanvas(e,o);let h=new DOMMatrix(l);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const f=t.createPattern(c.canvas,"repeat");return f.setTransform(h),f}}function YA({src:i,srcPos:t=0,dest:e,width:n,height:r,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const c=_n.isLittleEndian?4278190080:255,[h,f]=l?[o,c]:[c,o],g=n>>3,p=n&7,m=i.length;e=new Uint32Array(e.buffer);let v=0;for(let b=0;b<r;b++){for(const A=t+g;t<A;t++){const S=t<m?i[t]:255;e[v++]=S&128?f:h,e[v++]=S&64?f:h,e[v++]=S&32?f:h,e[v++]=S&16?f:h,e[v++]=S&8?f:h,e[v++]=S&4?f:h,e[v++]=S&2?f:h,e[v++]=S&1?f:h}if(p===0)continue;const y=t<m?i[t++]:255;for(let A=0;A<p;A++)e[v++]=y&1<<7-A?f:h}return{srcPos:t,destPos:v}}const _v=16,bv=100,qA=15,Av=10,li=16,Xd=new DOMMatrix,Ai=new Float32Array(2),oo=new Float32Array([1/0,1/0,-1/0,-1/0]);function $A(i,t){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){t.save(),this.__originalSave()},i.restore=function(){t.restore(),this.__originalRestore()},i.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},i.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},i.transform=function(e,n,r,o,l,c){t.transform(e,n,r,o,l,c),this.__originalTransform(e,n,r,o,l,c)},i.setTransform=function(e,n,r,o,l,c){t.setTransform(e,n,r,o,l,c),this.__originalSetTransform(e,n,r,o,l,c)},i.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},i.rotate=function(e){t.rotate(e),this.__originalRotate(e)},i.clip=function(e){t.clip(e),this.__originalClip(e)},i.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},i.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},i.bezierCurveTo=function(e,n,r,o,l,c){t.bezierCurveTo(e,n,r,o,l,c),this.__originalBezierCurveTo(e,n,r,o,l,c)},i.rect=function(e,n,r,o){t.rect(e,n,r,o),this.__originalRect(e,n,r,o)},i.closePath=function(){t.closePath(),this.__originalClosePath()},i.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class ZA{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,e,n)):(r=this.canvasFactory.create(e,n),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Cu(i,t,e,n,r,o,l,c,h,f){const[g,p,m,v,b,y]=$e(i);if(p===0&&m===0){const w=l*g+b,E=Math.round(w),D=c*v+y,P=Math.round(D),L=(l+h)*g+b,R=Math.abs(Math.round(L)-E)||1,V=(c+f)*v+y,F=Math.abs(Math.round(V)-P)||1;return i.setTransform(Math.sign(g),0,0,Math.sign(v),E,P),i.drawImage(t,e,n,r,o,0,0,R,F),i.setTransform(g,p,m,v,b,y),[R,F]}if(g===0&&v===0){const w=c*m+b,E=Math.round(w),D=l*p+y,P=Math.round(D),L=(c+f)*m+b,R=Math.abs(Math.round(L)-E)||1,V=(l+h)*p+y,F=Math.abs(Math.round(V)-P)||1;return i.setTransform(0,Math.sign(p),Math.sign(m),0,E,P),i.drawImage(t,e,n,r,o,0,0,F,R),i.setTransform(g,p,m,v,b,y),[F,R]}i.drawImage(t,e,n,r,o,l,c,h,f);const A=Math.hypot(g,p),S=Math.hypot(m,v);return[A*h,S*f]}class Sv{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=a0;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=yn.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,n){n?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=oo.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Fn.FILL,e=null){const n=this.minMax.slice();if(t===Fn.STROKE){e||Ue("Stroke bounding box must include transform."),Xt.singularValueDecompose2dScale(e,Ai);const r=Ai[0]*this.lineWidth/2,o=Ai[1]*this.lineWidth/2;n[0]-=r,n[1]-=o,n[2]+=r,n[3]+=o}return n}updateClipFromPath(){const t=Xt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(oo,0)}getClippedPathBoundingBox(t=Fn.FILL,e=null){return Xt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function wv(i,t){if(t instanceof ImageData){i.putImageData(t,0,0);return}const e=t.height,n=t.width,r=e%li,o=(e-r)/li,l=r===0?o:o+1,c=i.createImageData(n,li);let h=0,f;const g=t.data,p=c.data;let m,v,b,y;if(t.kind===zu.GRAYSCALE_1BPP){const A=g.byteLength,S=new Uint32Array(p.buffer,0,p.byteLength>>2),w=S.length,E=n+7>>3,D=4294967295,P=_n.isLittleEndian?4278190080:255;for(m=0;m<l;m++){for(b=m<o?li:r,f=0,v=0;v<b;v++){const L=A-h;let R=0;const V=L>E?n:L*8-7,F=V&-8;let Z=0,tt=0;for(;R<F;R+=8)tt=g[h++],S[f++]=tt&128?D:P,S[f++]=tt&64?D:P,S[f++]=tt&32?D:P,S[f++]=tt&16?D:P,S[f++]=tt&8?D:P,S[f++]=tt&4?D:P,S[f++]=tt&2?D:P,S[f++]=tt&1?D:P;for(;R<V;R++)Z===0&&(tt=g[h++],Z=128),S[f++]=tt&Z?D:P,Z>>=1}for(;f<w;)S[f++]=0;i.putImageData(c,0,m*li)}}else if(t.kind===zu.RGBA_32BPP){for(v=0,y=n*li*4,m=0;m<o;m++)p.set(g.subarray(h,h+y)),h+=y,i.putImageData(c,0,v),v+=li;m<l&&(y=n*r*4,p.set(g.subarray(h,h+y)),i.putImageData(c,0,v))}else if(t.kind===zu.RGB_24BPP)for(b=li,y=n*b,m=0;m<l;m++){for(m>=o&&(b=r,y=n*b),f=0,v=y;v--;)p[f++]=g[h++],p[f++]=g[h++],p[f++]=g[h++],p[f++]=255;i.putImageData(c,0,m*li)}else throw new Error(`bad image kind: ${t.kind}`)}function Ev(i,t){if(t.bitmap){i.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,r=e%li,o=(e-r)/li,l=r===0?o:o+1,c=i.createImageData(n,li);let h=0;const f=t.data,g=c.data;for(let p=0;p<l;p++){const m=p<o?li:r;({srcPos:h}=YA({src:f,srcPos:h,dest:g,width:n,height:m,nonBlackColor:0})),i.putImageData(c,0,p*li)}}function _l(i,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)i[n]!==void 0&&(t[n]=i[n]);i.setLineDash!==void 0&&(t.setLineDash(i.getLineDash()),t.lineDashOffset=i.lineDashOffset)}function ku(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:t}=i;t!=="none"&&t!==""&&(i.filter="none")}function Tv(i,t){if(t)return!0;Xt.singularValueDecompose2dScale(i,Ai);const e=Math.fround(va.pixelRatio*_o.PDF_TO_CSS_UNITS);return Ai[0]<=e&&Ai[1]<=e}const JA=["butt","round","square"],QA=["miter","round","bevel"],tS={},Cv={};class fo{constructor(t,e,n,r,o,{optionalContentConfig:l,markedContentStack:c=null},h,f,g){this.ctx=t,this.current=new Sv(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=r,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new ZA(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=g??null}getObject(t,e,n=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):n}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:r=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...$e(this.compositeCtx))}this.ctx.save(),ku(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=$e(this.ctx)}executeOperatorList(t,e,n,r,o){const l=t.argsArray,c=t.fnArray;let h=e||0;const f=l.length;if(f===h)return h;const g=f-h>Av&&typeof n=="function",p=g?Date.now()+qA:0;let m=0;const v=this.commonObjs,b=this.objs;let y,A;for(;;){if(r!==void 0&&h===r.nextBreakPoint)return r.breakIt(h,n),h;if(!o||o(h))if(y=c[h],A=l[h]??null,y!==Bl.dependency)A===null?this[y](h):this[y](h,...A);else for(const S of A){this.dependencyTracker?.recordNamedData(S,h);const w=S.startsWith("g_")?v:b;if(!w.has(S))return w.get(S,n),h}if(h++,h===f)return h;if(g&&++m>Av){if(Date.now()>p)return n(),h;m=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const n=t.width??t.displayWidth,r=t.height??t.displayHeight;let o=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),c=n,h=r,f="prescale1",g,p;for(;o>2&&c>1||l>2&&h>1;){let m=c,v=h;o>2&&c>1&&(m=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),o/=c/m),l>2&&h>1&&(v=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/v),g=this.cachedCanvases.getCanvas(f,m,v),p=g.context,p.clearRect(0,0,m,v),p.drawImage(t,0,0,c,h,0,0,m,v),t=g.canvas,c=m,h=v,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:c,paintHeight:h}}_createMaskCanvas(t,e){const n=this.ctx,{width:r,height:o}=e,l=this.current.fillColor,c=this.current.patternFill,h=$e(n);let f,g,p,m;if((e.bitmap||e.data)&&e.count>1){const Z=e.bitmap||e.data.buffer;g=JSON.stringify(c?h:[h.slice(0,4),l]),f=this._cachedBitmapsMap.get(Z),f||(f=new Map,this._cachedBitmapsMap.set(Z,f));const tt=f.get(g);if(tt&&!c){const I=Math.round(Math.min(h[0],h[2])+h[4]),nt=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,zi.transformAndFill),{canvas:tt,offsetX:I,offsetY:nt}}p=tt}p||(m=this.cachedCanvases.getCanvas("maskCanvas",r,o),Ev(m.context,e));let v=Xt.transform(h,[1/r,0,0,-1/o,0,0]);v=Xt.transform(v,[1,0,0,1,0,-o]);const b=oo.slice();Xt.axialAlignedBoundingBox([0,0,r,o],v,b);const[y,A,S,w]=b,E=Math.round(S-y)||1,D=Math.round(w-A)||1,P=this.cachedCanvases.getCanvas("fillCanvas",E,D),L=P.context,R=y,V=A;L.translate(-R,-V),L.transform(...v),p||(p=this._scaleImage(m.canvas,ua(L)),p=p.img,f&&c&&f.set(g,p)),L.imageSmoothingEnabled=Tv($e(L),e.interpolate),Cu(L,p,0,0,p.width,p.height,0,0,r,o),L.globalCompositeOperation="source-in";const F=Xt.transform(ua(L),[1,0,0,1,-R,-V]);return L.fillStyle=c?l.getPattern(n,this,F,Fn.FILL,t):l,L.fillRect(0,0,r,o),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(g,P.canvas)),this.dependencyTracker?.recordDependencies(t,zi.transformAndFill),{canvas:P.canvas,offsetX:Math.round(R),offsetY:Math.round(V)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=JA[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=QA[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,n){this.dependencyTracker?.recordSimpleData("dash",t);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(e),r.lineDashOffset=n)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[n,r]of e)switch(n){case"LW":this.setLineWidth(t,r);break;case"LC":this.setLineCap(t,r);break;case"LJ":this.setLineJoin(t,r);break;case"ML":this.setMiterLimit(t,r);break;case"D":this.setDash(t,r[0],r[1]);break;case"RI":this.setRenderingIntent(t,r);break;case"FL":this.setFlatness(t,r);break;case"Font":this.setFont(t,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,n=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(r,e,n);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),_l(this.suspendedCtx,l),$A(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),_l(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,r){const o=r[0],l=r[1],c=r[2]-o,h=r[3]-l;c===0||h===0||(this.genericComposeSMask(e.context,n,c,h,e.subtype,e.backdrop,e.transferMap,o,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,r,o,l,c,h,f,g,p){let m=t.canvas,v=h-g,b=f-p;if(l)if(v<0||b<0||v+n>m.width||b+r>m.height){const A=this.cachedCanvases.getCanvas("maskExtension",n,r),S=A.context;S.drawImage(m,-v,-b),S.globalCompositeOperation="destination-atop",S.fillStyle=l,S.fillRect(0,0,n,r),S.globalCompositeOperation="source-over",m=A.canvas,v=b=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const A=new Path2D;A.rect(v,b,n,r),t.clip(A),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(v,b,n,r),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),o==="Alpha"&&c?e.filter=this.filterFactory.addAlphaFilter(c):o==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(c));const y=new Path2D;y.rect(h,f,n,r),e.clip(y),e.globalCompositeOperation="destination-in",e.drawImage(m,v,b,n,r,h,f,n,r),e.restore()}save(t){this.inSMaskMode&&_l(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&_l(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,n,r,o,l,c){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,n,r,o,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n,r){let[o]=n;if(!r){o||=n[0]=new Path2D,this[e](t,o);return}if(this.dependencyTracker!==null){const l=e===Bl.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,r[0]-l,r[2]+l,r[1]-l,r[3]+l).recordDependencies(t,["transform"])}o instanceof Path2D||(o=n[0]=T2(o)),Xt.axialAlignedBoundingBox(r,$e(this.ctx),this.current.minMax),this[e](t,o),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,n=!0){const r=this.ctx,o=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const l=o.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=o.getPattern(r,this,ua(r),Fn.STROKE,t),l){const c=new Path2D;c.addPath(e,r.getTransform().invertSelf().multiplySelf(l)),e=c}this.rescaleAndStroke(e,!1),r.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,zi.stroke),n&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Fn.STROKE,$e(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,n=!0){const r=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const f=o.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(t),r.save(),r.fillStyle=o.getPattern(r,this,ua(r),Fn.FILL,t),f){const g=new Path2D;g.addPath(e,r.getTransform().invertSelf().multiplySelf(f)),e=g}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(r.fill(e,"evenodd"),this.pendingEOFill=!1):r.fill(e)),this.dependencyTracker?.recordDependencies(t,zi.fill),c&&(r.restore(),this.dependencyTracker?.restore(t)),n&&this.consumePath(t,e,h)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,zi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=tS}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Cv}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;e!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",t),r.recordCloseMarker(t)}if(e!==void 0){const r=new Path2D,o=n.getTransform().invertSelf();for(const{transform:l,x:c,y:h,fontSize:f,path:g}of e)g&&r.addPath(g,new DOMMatrix(l).preMultiplySelf(o).translate(c,h).scale(f,-f));n.clip(r)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,n){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const r=this.commonObjs.get(e),o=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(o.fontMatrix=r.fontMatrix||a0,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&ae("Invalid font matrix for font "+e),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=r,this.current.fontSize=n,r.isType3Font)return;const l=r.loadedName||"sans-serif",c=r.systemFontInfo?.css||`"${l}", ${r.fallbackName}`;let h="normal";r.black?h="900":r.bold&&(h="bold");const f=r.italic?"italic":"normal";let g=n;n<_v?g=_v:n>bv&&(g=bv),this.current.fontSizeScale=n/g,this.ctx.font=`${f} ${h} ${g}px ${c}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=n}setLeadingMoveText(t,e,n){this.setLeading(t,-n),this.moveText(t,e,n)}setTextMatrix(t,e){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:n}=this;n.textMatrix=e,n.textMatrixScale=Math.hypot(e[0],e[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,n){const r=new Path2D;return r.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),r}paintChar(t,e,n,r,o,l){const c=this.ctx,h=this.current,f=h.font,g=h.textRenderingMode,p=h.fontSize/h.fontSizeScale,m=g&yn.FILL_STROKE_MASK,v=!!(g&yn.ADD_TO_PATH_FLAG),b=h.patternFill&&!f.missingFile,y=h.patternStroke&&!f.missingFile;let A;if((f.disableFontFace||v||b||y)&&!f.missingFile&&(A=f.getPathGenerator(this.commonObjs,e)),A&&(f.disableFontFace||b||y)){c.save(),c.translate(n,r),c.scale(p,-p),this.dependencyTracker?.recordCharacterBBox(t,c,f);let S;if(m===yn.FILL||m===yn.FILL_STROKE)if(o){S=c.getTransform(),c.setTransform(...o);const w=this.#i(A,S,o);c.fill(w)}else c.fill(A);if(m===yn.STROKE||m===yn.FILL_STROKE)if(l){S||=c.getTransform(),c.setTransform(...l);const{a:w,b:E,c:D,d:P}=S,L=Xt.inverseTransform(l),R=Xt.transform([w,E,D,P,0,0],L);Xt.singularValueDecompose2dScale(R,Ai),c.lineWidth*=Math.max(Ai[0],Ai[1])/p,c.stroke(this.#i(A,S,l))}else c.lineWidth/=p,c.stroke(A);c.restore()}else(m===yn.FILL||m===yn.FILL_STROKE)&&(c.fillText(e,n,r),this.dependencyTracker?.recordCharacterBBox(t,c,f,p,n,r,()=>c.measureText(e))),(m===yn.STROKE||m===yn.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,c,f,p,n,r,()=>c.measureText(e)).recordDependencies(t,zi.stroke),c.strokeText(e,n,r));v&&((this.pendingTextPaths||=[]).push({transform:$e(c),x:n,y:r,fontSize:p,path:A}),this.dependencyTracker?.recordCharacterBBox(t,c,f,p,n,r))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let r=3;r<e.length;r+=4)if(e[r]>0&&e[r]<255){n=!0;break}return re(this,"isFontSubpixelAAEnabled",n)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,zi.showText).resetBBox(t),this.current.textRenderingMode&yn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,r=n.font;if(r.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const o=n.fontSize;if(o===0){this.dependencyTracker?.recordOperation(t);return}const l=this.ctx,c=n.fontSizeScale,h=n.charSpacing,f=n.wordSpacing,g=n.fontDirection,p=n.textHScale*g,m=e.length,v=r.vertical,b=v?1:-1,y=r.defaultVMetrics,A=o*n.fontMatrix[0],S=n.textRenderingMode===yn.FILL&&!r.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),g>0?l.scale(p,-1):l.scale(p,1);let w,E;const D=n.textRenderingMode&yn.FILL_STROKE_MASK,P=D===yn.FILL||D===yn.FILL_STROKE,L=D===yn.STROKE||D===yn.FILL_STROKE;if(P&&n.patternFill){l.save();const tt=n.fillColor.getPattern(l,this,ua(l),Fn.FILL,t);w=$e(l),l.restore(),l.fillStyle=tt}if(L&&n.patternStroke){l.save();const tt=n.strokeColor.getPattern(l,this,ua(l),Fn.STROKE,t);E=$e(l),l.restore(),l.strokeStyle=tt}let R=n.lineWidth;const V=n.textMatrixScale;if(V===0||R===0?L&&(R=this.getSinglePixelWidth()):R/=V,c!==1&&(l.scale(c,c),R/=c),l.lineWidth=R,r.isInvalidPDFjsFont){const tt=[];let I=0;for(const O of e)tt.push(O.unicode),I+=O.width;const nt=tt.join("");if(l.fillText(nt,0,0),this.dependencyTracker!==null){const O=l.measureText(nt);this.dependencyTracker.recordBBox(t,this.ctx,-O.actualBoundingBoxLeft,O.actualBoundingBoxRight,-O.actualBoundingBoxAscent,O.actualBoundingBoxDescent).recordShowTextOperation(t)}n.x+=I*A*p,l.restore(),this.compose();return}let F=0,Z;for(Z=0;Z<m;++Z){const tt=e[Z];if(typeof tt=="number"){F+=b*tt*o/1e3;continue}let I=!1;const nt=(tt.isSpace?f:0)+h,O=tt.fontChar,rt=tt.accent;let Q,J,_t=tt.width;if(v){const M=tt.vmetric||y,C=-(tt.vmetric?M[1]:_t*.5)*A,X=M[2]*A;_t=M?-M[0]:_t,Q=C/c,J=(F+X)/c}else Q=F/c,J=0;let vt;if(r.remeasure&&_t>0){vt=l.measureText(O);const M=vt.width*1e3/o*c;if(_t<M&&this.isFontSubpixelAAEnabled){const C=_t/M;I=!0,l.save(),l.scale(C,1),Q/=C}else _t!==M&&(Q+=(_t-M)/2e3*o/c)}if(this.contentVisible&&(tt.isInFont||r.missingFile)){if(S&&!rt)l.fillText(O,Q,J),this.dependencyTracker?.recordCharacterBBox(t,l,vt?{bbox:null}:r,o/c,Q,J,()=>vt??l.measureText(O));else if(this.paintChar(t,O,Q,J,w,E),rt){const M=Q+o*rt.offset.x/c,C=J-o*rt.offset.y/c;this.paintChar(t,rt.fontChar,M,C,w,E)}}const Nt=v?_t*A-nt*g:_t*A+nt*g;F+=Nt,I&&l.restore()}v?n.y-=F:n.x+=F*p,l.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const n=this.ctx,r=this.current,o=r.font,l=r.fontSize,c=r.fontDirection,h=o.vertical?1:-1,f=r.charSpacing,g=r.wordSpacing,p=r.textHScale*c,m=r.fontMatrix||a0,v=e.length,b=r.textRenderingMode===yn.INVISIBLE;let y,A,S,w;if(b||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),r.textMatrix&&n.transform(...r.textMatrix),n.translate(r.x,r.y+r.textRise),n.scale(p,c);const E=this.dependencyTracker;for(this.dependencyTracker=E?new Vu(E,t):null,y=0;y<v;++y){if(A=e[y],typeof A=="number"){w=h*A*l/1e3,this.ctx.translate(w,0),r.x+=w*p;continue}const D=(A.isSpace?g:0)+f,P=o.charProcOperatorList[A.operatorListId];P?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...m),this.executeOperatorList(P),this.restore()):ae(`Type3 character "${A.operatorListId}" is not available.`);const L=[A.width,0];Xt.applyTransform(L,m),S=L[0]*l+D,n.translate(S,0),r.x+=S*p}n.restore(),E&&(this.dependencyTracker=E)}setCharWidth(t,e,n){}setCharWidthAndBounds(t,e,n,r,o,l,c){const h=new Path2D;h.rect(r,o,l-r,c-o),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,r,l,o,c).recordClipBox(t,this.ctx,r,l,o,c),this.endPath(t)}getColorN_Pattern(t,e){let n;if(e[0]==="TilingPattern"){const r=this.baseTransform||$e(this.ctx),o={createCanvasGraphics:(l,c)=>new fo(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Vu(this.dependencyTracker,c,!0):null)};n=new O0(e,this.ctx,o,r)}else n=this._getPattern(t,e[1],e[2]);return n}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,n=null){let r;return this.cachedPatterns.has(e)?r=this.cachedPatterns.get(e):(r=WA(this.getObject(t,e)),this.cachedPatterns.set(e,r)),n&&(r.matrix=n),r}shadingFill(t,e){if(!this.contentVisible)return;const n=this.ctx;this.save(t);const r=this._getPattern(t,e);n.fillStyle=r.getPattern(n,this,ua(n),Fn.SHADING,t);const o=ua(n);if(o){const{width:l,height:c}=n.canvas,h=oo.slice();Xt.axialAlignedBoundingBox([0,0,l,c],o,h);const[f,g,p,m]=h;this.ctx.fillRect(f,g,p-f,m-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,zi.transform).recordDependencies(t,zi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Ue("Should not call beginInlineImage")}beginImageData(){Ue("Should not call beginImageData")}paintFormXObjectBegin(t,e,n){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=$e(this.ctx),n)){Xt.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[r,o,l,c]=n,h=new Path2D;h.rect(r,o,l-r,c-o),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,r,l,o,c),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;e.isolated||uh("TODO: Support non-isolated groups."),e.knockout&&ae("Knockout groups not supported.");const r=$e(n);if(e.matrix&&n.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let o=oo.slice();Xt.axialAlignedBoundingBox(e.bbox,$e(n),o);const l=[0,0,n.canvas.width,n.canvas.height];o=Xt.intersect(o,l)||[0,0,0,0];const c=Math.floor(o[0]),h=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-c,1),g=Math.max(Math.ceil(o[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,g]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(p,f,g),v=m.context;v.translate(-c,-h),v.transform(...r);let b=new Path2D;const[y,A,S,w]=e.bbox;if(b.rect(y,A,S-y,w-A),e.matrix){const E=new Path2D;E.addPath(b,new DOMMatrix(e.matrix)),b=E}v.clip(b),e.smask&&this.smaskStack.push({canvas:m.canvas,context:v,offsetX:c,offsetY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),_l(n,v),this.ctx=v,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=$e(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...o);const l=oo.slice();Xt.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],o,l),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,e,n,r,o,l){if(this.#t(),ku(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(l&&this.annotationCanvasMap){r=r.slice(),r[4]-=n[0],r[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,Xt.singularValueDecompose2dScale($e(this.ctx),Ai);const{viewportScale:f}=this,g=Math.ceil(c*this.outputScaleX*f),p=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,p);const{canvas:m,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(Ai[0],0,0,-Ai[1],0,h*Ai[1]),ku(this.ctx)}else{ku(this.ctx),this.endPath(t);const f=new Path2D;f.rect(n[0],n[1],c,h),this.ctx.clip(f)}}this.current=new Sv(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...r),this.transform(t,...o)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const n=e.count;e=this.getObject(t,e.data,e),e.count=n;const r=this.ctx,o=this._createMaskCanvas(t,e),l=o.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(l,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,o.offsetX,o.offsetX+l.width,o.offsetY,o.offsetY+l.height).recordOperation(t),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n,r=0,o=0,l,c){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const h=this.ctx;h.save();const f=$e(h);h.transform(n,r,o,l,0,0);const g=this._createMaskCanvas(t,e);h.setTransform(1,0,0,1,g.offsetX-f[4],g.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let p=0,m=c.length;p<m;p+=2){const v=Xt.transform(f,[n,r,o,l,c[p],c[p+1]]);h.drawImage(g.canvas,v[4],v[5]),this.dependencyTracker?.recordBBox(t,this.ctx,v[4],v[4]+g.canvas.width,v[5],v[5]+g.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx,r=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,zi.transformAndFill);for(const l of e){const{data:c,width:h,height:f,transform:g}=l,p=this.cachedCanvases.getCanvas("maskCanvas",h,f),m=p.context;m.save();const v=this.getObject(t,c,l);Ev(m,v),m.globalCompositeOperation="source-in",m.fillStyle=o?r.getPattern(m,this,ua(n),Fn.FILL,t):r,m.fillRect(0,0,h,f),m.restore(),n.save(),n.transform(...g),n.scale(1,-1),Cu(n,p.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,n,0,h,0,f),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const n=this.getObject(t,e);if(!n){ae("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,n)}paintImageXObjectRepeat(t,e,n,r,o){if(!this.contentVisible)return;const l=this.getObject(t,e);if(!l){ae("Dependent image isn't ready yet");return}const c=l.width,h=l.height,f=[];for(let g=0,p=o.length;g<p;g+=2)f.push({transform:[n,0,0,r,o[g],o[g+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(t,l,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:r}=t,o=this.cachedCanvases.getCanvas("inlineImage",n,r),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",o.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const n=e.width,r=e.height,o=this.ctx;this.save(t);const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/n,-1/r);let c;if(e.bitmap)c=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)c=e;else{const g=this.cachedCanvases.getCanvas("inlineImage",n,r).context;wv(g,e),c=this.applyTransferMapsToCanvas(g)}const h=this._scaleImage(c,ua(o));o.imageSmoothingEnabled=Tv($e(o),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,o,0,n,-r,0).recordDependencies(t,zi.imageXObject).recordOperation(t),Cu(o,h.img,0,0,h.paintWidth,h.paintHeight,0,-r,n,r),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,n){if(!this.contentVisible)return;const r=this.ctx;let o;if(e.bitmap)o=e.bitmap;else{const l=e.width,c=e.height,f=this.cachedCanvases.getCanvas("inlineImage",l,c).context;wv(f,e),o=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const l of n)r.save(),r.transform(...l.transform),r.scale(1,-1),Cu(r,o,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,zi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,n){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,n){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,n){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const o=this.ctx;this.pendingClip?(r||(this.pendingClip===Cv?o.clip(e,"evenodd"):o.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=$e(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:r,d:o}=this.ctx.getTransform();let l,c;if(n===0&&r===0){const h=Math.abs(e),f=Math.abs(o);if(h===f)if(t===0)l=c=1/h;else{const g=h*t;l=c=g<1?1/g:1}else if(t===0)l=1/h,c=1/f;else{const g=h*t,p=f*t;l=g<1?1/g:1,c=p<1?1/p:1}}else{const h=Math.abs(e*o-n*r),f=Math.hypot(e,n),g=Math.hypot(r,o);if(t===0)l=g/h,c=f/h;else{const p=t*h;l=g>p?g/p:1,c=f>p?f/p:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:r}}=this,[o,l]=this.getScaleForStroking();if(o===l){n.lineWidth=(r||1)*o,n.stroke(t);return}const c=n.getLineDash();e&&n.save(),n.scale(o,l),Xd.a=1/o,Xd.d=1/l;const h=new Path2D;if(h.addPath(t,Xd),c.length>0){const f=Math.max(o,l);n.setLineDash(c.map(g=>g/f)),n.lineDashOffset/=f}n.lineWidth=r||1,n.stroke(h),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const i in Bl)fo.prototype[i]!==void 0&&(fo.prototype[Bl[i]]=fo.prototype[i]);class ts{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class eS{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const io=Symbol("INTERNAL");class nS{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:n,usage:r,rbGroups:o}){this.#t=!!(t&xi.DISPLAY),this.#e=!!(t&xi.PRINT),this.name=e,this.intent=n,this.usage=r,this.rbGroups=o}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,n=!1){t!==io&&Ue("Internal method `_setVisible` called."),this.#i=n,this.#n=e}}class iS{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=xi.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const n of t.groups)this.#e.set(n.id,new nS(e,n));if(t.baseState==="OFF")for(const n of this.#e.values())n._setVisible(io,!1);for(const n of t.on)this.#e.get(n)._setVisible(io,!0);for(const n of t.off)this.#e.get(n)._setVisible(io,!1);this.#i=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let r=1;r<e;r++){const o=t[r];let l;if(Array.isArray(o))l=this.#s(o);else if(this.#e.has(o))l=this.#e.get(o).visible;else return ae(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return uh("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(ae(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return ae(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return ae(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return ae(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return ae(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return ae(`Unknown optional content policy ${t.policy}.`),!0}return ae(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){const r=this.#e.get(t);if(!r){ae(`Optional content group not found: ${t}`);return}if(n&&e&&r.rbGroups.length)for(const o of r.rbGroups)for(const l of o)l!==t&&this.#e.get(l)?._setVisible(io,!1,!0);r._setVisible(io,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let n;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":n=r;continue}const o=this.#e.get(r);if(o)switch(n){case"ON":this.setVisibility(r,!0,e);break;case"OFF":this.setVisibility(r,!1,e);break;case"Toggle":this.setVisibility(r,!o.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new k2;for(const[e,n]of this.#e)t.update(`${e}:${n.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class aS{constructor(t,{disableRange:e=!1,disableStream:n=!1}){me(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:o,progressiveDone:l,contentDispositionFilename:c}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,o?.length>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const r=this._rangeReaders.some(function(o){return o._begin!==t?!1:(o._enqueue(n),!0)});me(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){me(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new rS(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new sS(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class rS{constructor(t,e,n=!1,r=null){this._stream=t,this._done=n||!1,this._filename=w0(r)?r:null,this._queuedChunks=e||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class sS{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function oS(i){let t=!0,e=n("filename\\*","i").exec(i);if(e){e=e[1];let g=c(e);return g=unescape(g),g=h(g),g=f(g),o(g)}if(e=l(i),e){const g=f(e);return o(g)}if(e=n("filename","i").exec(i),e){e=e[1];let g=c(e);return g=f(g),o(g)}function n(g,p){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function r(g,p){if(g){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const m=new TextDecoder(g,{fatal:!0}),v=Yl(p);p=m.decode(v),t=!1}catch{}}return p}function o(g){return t&&/[\x80-\xff]/.test(g)&&(g=r("utf-8",g),t&&(g=r("iso-8859-1",g))),g}function l(g){const p=[];let m;const v=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=v.exec(g))!==null;){let[,y,A,S]=m;if(y=parseInt(y,10),y in p){if(y===0)break;continue}p[y]=[A,S]}const b=[];for(let y=0;y<p.length&&y in p;++y){let[A,S]=p[y];S=c(S),A&&(S=unescape(S),y===0&&(S=h(S))),b.push(S)}return b.join("")}function c(g){if(g.startsWith('"')){const p=g.slice(1).split('\\"');for(let m=0;m<p.length;++m){const v=p[m].indexOf('"');v!==-1&&(p[m]=p[m].slice(0,v),p.length=m+1),p[m]=p[m].replaceAll(/\\(.)/g,"$1")}g=p.join('"')}return g}function h(g){const p=g.indexOf("'");if(p===-1)return g;const m=g.slice(0,p),b=g.slice(p+1).replace(/^[^']*'/,"");return r(m,b)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,m,v,b){if(v==="q"||v==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,A){return String.fromCharCode(parseInt(A,16))}),r(m,b);try{b=atob(b)}catch{}return r(m,b)})}return""}function F2(i,t){const e=new Headers;if(!i||!t||typeof t!="object")return e;for(const n in t){const r=t[n];r!==void 0&&e.append(n,r)}return e}function dh(i){return URL.parse(i)?.origin??null}function L2({responseHeaders:i,isHttp:t,rangeChunkSize:e,disableRange:n}){const r={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(i.get("Content-Length"),10);return!Number.isInteger(o)||(r.suggestedLength=o,o<=2*e)||n||!t||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function B2(i){const t=i.get("Content-Disposition");if(t){let e=oS(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(w0(e))return e}return null}function Ql(i,t){return new Gu(`Unexpected server response (${i}) while retrieving PDF "${t}".`,i,i===404||i===0&&t.startsWith("file:"))}function I2(i){return i===200||i===206}function U2(i,t,e){return{method:"GET",headers:i,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function z2(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(ae(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class lS{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=F2(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return me(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new cS(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new uS(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class cS{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),r=e.url;fetch(r,U2(n,this._withCredentials,this._abortController)).then(o=>{if(t._responseOrigin=dh(o.url),!I2(o.status))throw Ql(o.status,r);this._reader=o.body.getReader(),this._headersCapability.resolve();const l=o.headers,{allowRangeRequests:c,suggestedLength:h}=L2({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=B2(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new wr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:z2(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class uS{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const o=new Headers(t.headers);o.append("Range",`bytes=${e}-${n-1}`);const l=r.url;fetch(l,U2(o,this._withCredentials,this._abortController)).then(c=>{const h=dh(c.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!I2(c.status))throw Ql(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:z2(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Kd=200,Wd=206;function hS(i){const t=i.response;return typeof t!="string"?t:Yl(t).buffer}class fS{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=F2(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[o,l]of this.headers)e.setRequestHeader(o,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=Wd):r.expectedStatus=Kd,e.responseType="arraybuffer",me(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){const n=this.pendingRequests[t];n&&n.onProgress?.(e)}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){n.onError(r.status);return}const o=r.status||Kd;if(!(o===Kd&&n.expectedStatus===Wd)&&o!==n.expectedStatus){n.onError(r.status);return}const c=hS(r);if(o===Wd){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?n.onDone({begin:parseInt(f[1],10),chunk:c}):(ae('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class dS{constructor(t){this._source=t,this._manager=new fS(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return me(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new gS(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new pS(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class gS{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=dh(e.responseURL);const n=e.getAllResponseHeaders(),r=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:l}=L2({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=B2(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Ql(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class pS{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=dh(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=Ql(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const mS=/^[a-z][a-z0-9\-+.]+:/i;function vS(i){if(mS.test(i))return new URL(i);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(i))}class yS{constructor(t){this.source=t,this.url=vS(t.url),me(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return me(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new xS(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new _S(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class xS{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=Ql(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new wr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class _S{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const bl=Symbol("INITIAL_DATA");class H2{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:bl}}get(t,e=null){if(e){const r=this.#e(t);return r.promise.then(()=>e(r.data)),null}const n=this.#t[t];if(!n||n.data===bl)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=this.#t[t];return!!e&&e.data!==bl}delete(t){const e=this.#t[t];return!e||e.data===bl?!1:(delete this.#t[t],!0)}resolve(t,e=null){const n=this.#e(t);n.data=e,n.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==bl&&(yield[t,e])}}}const bS=1e5,kv=30;class _i{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#s=null;#r=null;#a=0;#o=0;#c=null;#l=null;#f=0;#h=0;#d=Object.create(null);#m=[];#p=null;#u=[];#g=new WeakMap;#v=null;static#x=new Map;static#y=new Map;static#E=new WeakMap;static#S=null;static#b=new Set;constructor({textContentSource:t,container:e,viewport:n}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=n.scale*va.pixelRatio,this.#f=n.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:o,pageX:l,pageY:c}=n.rawDims;this.#v=[1,0,0,-1,-l,c+o],this.#o=r,this.#a=o,_i.#D(),e.style.setProperty("--min-font-size",_i.#S),ns(e,n),this.#t.promise.finally(()=>{_i.#b.delete(this),this.#r=null,this.#d=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=_n.platform;return re(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:n})=>{if(n){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#d,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#c=this.#p.getReader(),_i.#b.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const n=t.scale*va.pixelRatio,r=t.rotation;if(r!==this.#f&&(e?.(),this.#f=r,ns(this.#l,{rotation:r})),n!==this.#h){e?.(),this.#h=n;const o={div:null,properties:null,ctx:_i.#O(this.#s)};for(const l of this.#u)o.properties=this.#g.get(l),o.div=l,this.#w(o)}}cancel(){const t=new wr("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#C(t){if(this.#i)return;this.#r.ctx??=_i.#O(this.#s);const e=this.#u,n=this.#m;for(const r of t){if(e.length>bS){ae("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const o=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id&&this.#e.setAttribute("id",`${r.id}`),o.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}n.push(r.str),this.#_(r)}}#_(t){const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const r=Xt.transform(this.#v,t.transform);let o=Math.atan2(r[1],r[0]);const l=this.#d[t.fontName];l.vertical&&(o+=Math.PI/2);let c=this.#n&&l.fontSubstitution||l.fontFamily;c=_i.fontFamilyMap.get(c)||c;const h=Math.hypot(r[2],r[3]),f=h*_i.#B(c,l,this.#s);let g,p;o===0?(g=r[4],p=r[5]-f):(g=r[4]+f*Math.sin(o),p=r[5]-f*Math.cos(o));const m=e.style;m.left=`${(100*g/this.#o).toFixed(2)}%`,m.top=`${(100*p/this.#a).toFixed(2)}%`,m.setProperty("--font-height",`${h.toFixed(2)}px`),m.fontFamily=c,n.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),o!==0&&(n.angle=o*(180/Math.PI));let v=!1;if(t.str.length>1)v=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const b=Math.abs(t.transform[0]),y=Math.abs(t.transform[3]);b!==y&&Math.max(b,y)/Math.min(b,y)>1.5&&(v=!0)}if(v&&(n.canvasWidth=l.vertical?t.height:t.width),this.#g.set(e,n),this.#r.div=e,this.#r.properties=n,this.#w(this.#r),n.hasText&&this.#e.append(e),n.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),this.#e.append(b)}}#w(t){const{div:e,properties:n,ctx:r}=t,{style:o}=e;if(n.canvasWidth!==0&&n.hasText){const{fontFamily:l}=o,{canvasWidth:c,fontSize:h}=n;_i.#k(r,h*this.#h,l);const{width:f}=r.measureText(e.textContent);f>0&&o.setProperty("--scale-x",c*this.#h/f)}n.angle!==0&&o.setProperty("--rotate",`${n.angle}deg`)}static cleanup(){if(!(this.#b.size>0)){this.#x.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#O(t=null){let e=this.#y.get(t||="");if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,e),this.#E.set(e,{size:0,family:""})}return e}static#k(t,e,n){const r=this.#E.get(t);e===r.size&&n===r.family||(t.font=`${e}px ${n}`,r.size=e,r.family=n)}static#D(){if(this.#S!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#S=t.getBoundingClientRect().height,t.remove()}static#B(t,e,n){const r=this.#x.get(t);if(r)return r;const o=this.#O(n);o.canvas.width=o.canvas.height=kv,this.#k(o,kv,t);const l=o.measureText(""),c=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return c?f=c/(c+h):(_n.platform.isFirefox&&ae("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#x.set(t,f),f}}const AS=100;function R0(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const t=new P0,{docId:e}=t,n=i.url?DA(i.url):null,r=i.data?OA(i.data):null,o=i.httpHeaders||null,l=i.withCredentials===!0,c=i.password??null,h=i.range instanceof j2?i.range:null,f=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let g=i.worker instanceof Ul?i.worker:null;const p=i.verbosity,m=typeof i.docBaseUrl=="string"&&!hh(i.docBaseUrl)?i.docBaseUrl:null,v=Su(i.cMapUrl),b=i.cMapPacked!==!1,y=i.CMapReaderFactory||(Wn?IA:gv),A=Su(i.iccUrl),S=Su(i.standardFontDataUrl),w=i.StandardFontDataFactory||(Wn?UA:pv),E=Su(i.wasmUrl),D=i.WasmFactory||(Wn?zA:mv),P=i.stopAtErrors!==!0,L=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,R=i.isEvalSupported!==!1,V=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!Wn,F=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!Wn&&(_n.platform.isFirefox||!globalThis.chrome),Z=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,tt=typeof i.disableFontFace=="boolean"?i.disableFontFace:Wn,I=i.fontExtraProperties===!0,nt=i.enableXfa===!0,O=i.ownerDocument||globalThis.document,rt=i.disableRange===!0,Q=i.disableStream===!0,J=i.disableAutoFetch===!0,_t=i.pdfBug===!0,vt=i.CanvasFactory||(Wn?BA:NA),Nt=i.FilterFactory||(Wn?LA:FA),M=i.enableHWA===!0,C=i.useWasm!==!1,X=h?h.length:i.length??NaN,U=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!Wn&&!tt,j=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(y===gv&&w===pv&&D===mv&&v&&S&&E&&El(v,document.baseURI)&&El(S,document.baseURI)&&El(E,document.baseURI)),ot=null;nA(p);const bt={canvasFactory:new vt({ownerDocument:O,enableHWA:M}),filterFactory:new Nt({docId:e,ownerDocument:O}),cMapReaderFactory:j?null:new y({baseUrl:v,isCompressed:b}),standardFontDataFactory:j?null:new w({baseUrl:S}),wasmFactory:j?null:new D({baseUrl:E})};g||(g=Ul.create({verbosity:p,port:ts.workerPort}),t._worker=g);const Ot={docId:e,apiVersion:"5.4.530",data:r,password:c,disableAutoFetch:J,rangeChunkSize:f,length:X,docBaseUrl:m,enableXfa:nt,evaluatorOptions:{maxImageSize:L,disableFontFace:tt,ignoreErrors:P,isEvalSupported:R,isOffscreenCanvasSupported:V,isImageDecoderSupported:F,canvasMaxAreaInBytes:Z,fontExtraProperties:I,useSystemFonts:U,useWasm:C,useWorkerFetch:j,cMapUrl:v,iccUrl:A,standardFontDataUrl:S,wasmUrl:E}},Tt={ownerDocument:O,pdfBug:_t,styleElement:ot,loadingParams:{disableAutoFetch:J,enableXfa:nt}};return g.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const Mt=g.messageHandler.sendWithPromise("GetDocRequest",Ot,r?[r.buffer]:null);let Zt;if(h)Zt=new aS(h,{disableRange:rt,disableStream:Q});else if(!r){if(!n)throw new Error("getDocument - no `url` parameter provided.");const te=El(n)?lS:Wn?yS:dS;Zt=new te({url:n,length:X,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:rt,disableStream:Q})}return Mt.then(te=>{if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const ve=new Tl(e,te,g.port),k=new ES(ve,t,Zt,Tt,bt,M);t._transport=k,ve.send("Ready",null)})}).catch(t._capability.reject),t}class P0{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${P0.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class j2{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#s=[];constructor(t,e,n=!1,r=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=r}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const n of this.#s)n(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const n of this.#n)n(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Ue("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class SS{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return re(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class wS{#t=!1;constructor(t,e,n,r=!1){this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=r?new ov:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new H2,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:o=!1}={}){return new $l({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:r,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return re(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:n,intent:r="display",annotationMode:o=_r.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:g=null,printAnnotationStorage:p=null,isEditing:m=!1,recordOperations:v=!1,operationsFilter:b=null}){this._stats?.time("Overall");const y=this._transport.getRenderingIntent(r,o,p,m),{renderingIntent:A,cacheKey:S}=y;this.#t=!1,h||=this._transport.getOptionalContentConfig(A);let w=this._intentStates.get(S);w||(w=Object.create(null),this._intentStates.set(S,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const E=!!(A&xi.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(y));const D=!!(this._pdfBug&&globalThis.StepperManager?.enabled),P=!this.recordedBBoxes&&(v||D),L=F=>{if(w.renderTasks.delete(R),P){const Z=R.gfx?.dependencyTracker.take();Z&&(R.stepper&&R.stepper.setOperatorBBoxes(Z,R.gfx.dependencyTracker.takeDebugMetadata()),v&&(this.recordedBBoxes=Z))}E&&(this.#t=!0),this.#e(),F?(R.capability.reject(F),this._abortOperatorList({intentState:w,reason:F instanceof Error?F:new Error(F)})):R.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},R=new lo({callback:L,params:{canvas:e,canvasContext:t,dependencyTracker:P?new jA(e,w.operatorList.length,D):null,viewport:n,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!E,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA,operationsFilter:b});(w.renderTasks||=new Set).add(R);const V=R.task;return Promise.all([w.displayReadyCapability.promise,h]).then(([F,Z])=>{if(this.destroyed){L();return}if(this._stats?.time("Rendering"),!(Z.renderingIntent&A))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");R.initializeGraphics({transparency:F,optionalContentConfig:Z}),R.operatorListChanged()}).catch(L),V}getOperatorList({intent:t="display",annotationMode:e=_r.ENABLE,printAnnotationStorage:n=null,isEditing:r=!1}={}){function o(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,e,n,r,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Il.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,r){function o(){l.read().then(function({value:h,done:f}){if(f){n(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),o()},r)}const l=e.getReader(),c={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new ov),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const n=this._intentStates.get(e);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let n=0,r=t.length;n<r;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:r}){const{map:o,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:o,modifiedIds:r},l).getReader(),f=this._intentStates.get(e);f.streamReader=h;const g=()=>{h.read().then(({value:p,done:m})=>{if(m){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,f),g())},p=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const m of f.renderTasks)m.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(p);else if(f.opListReadCapability)f.opListReadCapability.reject(p);else throw p}})};g()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof S0){let r=AS;e.extraDelay>0&&e.extraDelay<1e3&&(r+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},r);return}}if(t.streamReader.cancel(new wr(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,o]of this._intentStates)if(o===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var br,Ji,ja,Zr,oh,Jr,Qr,Zn,Hu,G2,V2,Cl,xo,ju;const qe=class qe{constructor({name:t=null,port:e=null,verbosity:n=iA()}={}){la(this,Zn);la(this,br,Promise.withResolvers());la(this,Ji,null);la(this,ja,null);la(this,Zr,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,e){if(Ye(qe,Qr).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Ye(qe,Qr).set(e,this),ca(this,Zn,G2).call(this,e)}else ca(this,Zn,V2).call(this)}get promise(){return Ye(this,br).promise}get port(){return Ye(this,ja)}get messageHandler(){return Ye(this,Ji)}destroy(){this.destroyed=!0,Ye(this,Zr)?.terminate(),si(this,Zr,null),Ye(qe,Qr).delete(Ye(this,ja)),si(this,ja,null),Ye(this,Ji)?.destroy(),si(this,Ji,null)}static create(t){const e=Ye(this,Qr).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new qe(t)}static get workerSrc(){if(ts.workerSrc)return ts.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return re(this,"_setupFakeWorkerGlobal",(async()=>Ye(this,xo,ju)?Ye(this,xo,ju):(await import(this.workerSrc)).WorkerMessageHandler)())}};br=new WeakMap,Ji=new WeakMap,ja=new WeakMap,Zr=new WeakMap,oh=new WeakMap,Jr=new WeakMap,Qr=new WeakMap,Zn=new WeakSet,Hu=function(){Ye(this,br).resolve(),Ye(this,Ji).send("configure",{verbosity:this.verbosity})},G2=function(t){si(this,ja,t),si(this,Ji,new Tl("main","worker",t)),Ye(this,Ji).on("ready",()=>{}),ca(this,Zn,Hu).call(this)},V2=function(){if(Ye(qe,Jr)||Ye(qe,xo,ju)){ca(this,Zn,Cl).call(this);return}let{workerSrc:t}=qe;try{qe._isSameOrigin(window.location,t)||(t=qe._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new Tl("main","worker",e),r=()=>{o.abort(),n.destroy(),e.terminate(),this.destroyed?Ye(this,br).reject(new Error("Worker was destroyed")):ca(this,Zn,Cl).call(this)},o=new AbortController;e.addEventListener("error",()=>{Ye(this,Zr)||r()},{signal:o.signal}),n.on("test",c=>{if(o.abort(),this.destroyed||!c){r();return}si(this,Ji,n),si(this,ja,e),si(this,Zr,e),ca(this,Zn,Hu).call(this)}),n.on("ready",c=>{if(o.abort(),this.destroyed){r();return}try{l()}catch{ca(this,Zn,Cl).call(this)}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{uh("The worker has been disabled.")}ca(this,Zn,Cl).call(this)},Cl=function(){Ye(qe,Jr)||(ae("Setting up fake worker."),si(qe,Jr,!0)),qe._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Ye(this,br).reject(new Error("Worker was destroyed"));return}const e=new MA;si(this,ja,e);const n=`fake${W1(qe,oh)._++}`,r=new Tl(n+"_worker",n,e);t.setup(r,e),si(this,Ji,new Tl(n,n+"_worker",e)),ca(this,Zn,Hu).call(this)}).catch(t=>{Ye(this,br).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},xo=new WeakSet,ju=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},la(qe,xo),la(qe,oh,0),la(qe,Jr,!1),la(qe,Qr,new WeakMap),Wn&&(si(qe,Jr,!0),ts.workerSrc||="./pdf.worker.mjs"),qe._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(!n?.origin||n.origin==="null")return!1;const r=new URL(e,n);return n.origin===r.origin},qe._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},qe.fromPort=t=>{if(pA("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return qe.create(t)};let Ul=qe;class ES{#t=new Map;#e=new Map;#i=new Map;#n=new Map;#s=null;constructor(t,e,n,r,o,l){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new H2,this.fontLoader=new TA({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#r(t,e=null){const n=this.#t.get(t);if(n)return n;const r=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,r),r}get annotationStorage(){return re(this,"annotationStorage",new C0)}getRenderingIntent(t,e=_r.ENABLE,n=null,r=!1,o=!1){let l=xi.DISPLAY,c=u0;switch(t){case"any":l=xi.ANY;break;case"display":break;case"print":l=xi.PRINT;break;default:ae(`getRenderingIntent - invalid intent: ${t}`)}const h=l&xi.PRINT&&n instanceof D2?n:this.annotationStorage;switch(e){case _r.DISABLE:l+=xi.ANNOTATIONS_DISABLE;break;case _r.ENABLE:break;case _r.ENABLE_FORMS:l+=xi.ANNOTATIONS_FORMS;break;case _r.ENABLE_STORAGE:l+=xi.ANNOTATIONS_STORAGE,c=h.serializable;break;default:ae(`getRenderingIntent - invalid annotationMode: ${e}`)}r&&(l+=xi.IS_EDITING),o&&(l+=xi.OPLIST);const{ids:f,hash:g}=h.modifiedIds,p=[l,c.hash,g];return{renderingIntent:l,cacheKey:p.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of this.#e.values())t.push(n._destroy());this.#e.clear(),this.#i.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),_i.cleanup(),this._networkStream?.cancelAllRequests(new wr("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,r)=>{me(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},r.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){r.close();return}me(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{this._fullReader.cancel(o),r.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:o,contentLength:l}=this._fullReader;return(!r||!o)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{e.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:r,isRangeSupported:o,contentLength:l}}),t.on("GetRangeReader",(n,r)=>{me(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){r.close();return}r.onPull=()=>{o.read().then(function({value:l,done:c}){if(c){r.close();return}me(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{o.cancel(l),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new SS(n,this))}),t.on("DocException",n=>{e._capability.reject(oi(n))}),t.on("PasswordRequest",n=>{this.#s=Promise.withResolvers();try{if(!e.onPassword)throw oi(n);const r=o=>{o instanceof Error?this.#s.reject(o):this.#s.resolve({password:o})};e.onPassword(r,n.code)}catch(r){this.#s.reject(r)}return this.#s.promise}),t.on("DataLoaded",n=>{e.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,r,o])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(r){case"Font":if("error"in o){const p=o.error;ae(`Error during font loading: ${p}`),this.commonObjs.resolve(n,p);break}const l=new Le(o),c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(p,m)=>globalThis.FontInspector.fontAdded(p,m):null,h=new CA(l,c,o.extra,o.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:f}=o;me(f,"The imageRef must be defined.");for(const p of this.#e.values())for(const[,m]of p.objs)if(m?.ref===f)return m.dataLen?(this.commonObjs.resolve(n,structuredClone(m)),m.dataLen):null;break;case"FontPath":this.commonObjs.resolve(n,new kA(o));break;case"Image":this.commonObjs.resolve(n,o);break;case"Pattern":const g=new An(o);this.commonObjs.resolve(n,g.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([n,r,o,l])=>{if(this.destroyed)return;const c=this.#e.get(r);if(!c.objs.has(n)){if(c._intentStates.size===0){l?.bitmap?.close();return}switch(o){case"Image":case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",n=>{this.destroyed||e.onProgress?.({loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[n.type];if(!r)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ae("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=this.#i.get(e);if(n)return n;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#n.set(o.refStr,t);const l=new wS(e,o,this,this._params.pdfBug);return this.#e.set(e,l),l});return this.#i.set(e,r),r}getPageIndex(t){return h0(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#r("GetOptionalContentConfig").then(e=>new iS(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new eS(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:r[2]}));return this.#t.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),_i.cleanup()}}cachedPageNumber(t){if(!h0(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#n.get(e)??null}}class TS{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class lo{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:n,commonObjs:r,annotationCanvasMap:o,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:p=!1,pageColors:m=null,enableHWA:v=!1,operationsFilter:b=null}){this.callback=t,this.params=e,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=p,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new TS(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=v,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=b}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(lo.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");lo.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:r,background:o,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new fo(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:r,viewport:n,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),lo.#e.delete(this._canvas),t||=new S0(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),lo.#e.delete(this._canvas),this.callback())))}}const CS="5.4.530",kS="50cc4adac";class ji{#t=null;#e=null;#i;#n=null;#s=!1;#r=!1;#a=null;#o;#c=null;#l=null;static#f=null;static get _keyboardManager(){return re(this,"_keyboardManager",new Jl([[["Escape","mac+Escape"],ji.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ji.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ji.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ji.prototype._moveToPrevious],[["Home","mac+Home"],ji.prototype._moveToBeginning],[["End","mac+End"],ji.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#a=t):this.#r=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#i=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",ji.#f||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#a&&(t.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#p.bind(this),{signal:e}),t.addEventListener("keydown",this.#m.bind(this),{signal:e});const n=this.#e=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#i,t.append(n),t}renderMainDropdown(){const t=this.#n=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",Vi,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(t.id=`${this.#a.id}_colorpicker_dropdown`);for(const[n,r]of this.#l.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",r),o.title=n,o.setAttribute("data-l10n-id",ji.#f[n]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=r,o.ariaSelected=r===this.#i,o.addEventListener("click",this.#d.bind(this,r),{signal:e}),t.append(o)}return t.addEventListener("keydown",this.#m.bind(this),{signal:e}),t}#d(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:pe.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const e=t.target.getAttribute("data-color");e&&this.#d(e,t)}_moveToNext(t){if(!this.#g){this.#p(t);return}if(t.target===this.#t){this.#n.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstElementChild||t.target===this.#t){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#g){this.#p(t);return}this.#n.firstElementChild?.focus()}_moveToEnd(t){if(!this.#g){this.#p(t);return}this.#n.lastElementChild?.focus()}#m(t){ji._keyboardManager.exec(this,t)}#p(t){if(this.#g){this.hideDropdown();return}if(this.#s=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#h();this.#t.append(e)}#u(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#g(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#g){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#l.highlightColors.values();for(const n of this.#n.children)n.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}}class zl{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,zl.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,color:n}=this.#e,r=this.#t=document.createElement("input");return r.type="color",r.value=n||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",zl.#n[t]),r.addEventListener("input",()=>{this.#i.updateParams(e,r.value)},{signal:this.#i._signal}),r}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function Dv(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function Al(i){return Math.max(0,Math.min(255,255*i))}class Ov{static CMYK_G([t,e,n,r]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Al(t),[t,t,t]}static G_HTML([t]){const e=Dv(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(Al)}static RGB_HTML(t){return`#${t.map(Dv).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,n+r),1-Math.min(1,e+r)]}static CMYK_rgb([t,e,n,r]){return[Al(1-Math.min(1,t+r)),Al(1-Math.min(1,n+r)),Al(1-Math.min(1,e+r))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const r=1-t,o=1-e,l=1-n,c=Math.min(r,o,l);return["CMYK",r,o,l,c]}}class DS{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${e}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${e}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Ue("Abstract method `_createSVG` called.")}}class Xu extends DS{_createSVG(t){return document.createElementNS(za,t)}}const OS=9,is=new WeakSet,RS=new Date().getTimezoneOffset()*60*1e3;class Yd{static create(t){switch(t.data.annotationType){case gn.LINK:return new M0(t);case gn.TEXT:return new MS(t);case gn.WIDGET:switch(t.data.fieldType){case"Tx":return new NS(t);case"Btn":return t.data.radioButton?new X2(t):t.data.checkBox?new LS(t):new BS(t);case"Ch":return new IS(t);case"Sig":return new FS(t)}return new ls(t);case gn.POPUP:return new g0(t);case gn.FREETEXT:return new K2(t);case gn.LINE:return new zS(t);case gn.SQUARE:return new HS(t);case gn.CIRCLE:return new jS(t);case gn.POLYLINE:return new W2(t);case gn.CARET:return new VS(t);case gn.INK:return new N0(t);case gn.POLYGON:return new GS(t);case gn.HIGHLIGHT:return new Y2(t);case gn.UNDERLINE:return new XS(t);case gn.SQUIGGLY:return new KS(t);case gn.STRIKEOUT:return new WS(t);case gn.STAMP:return new q2(t);case gn.FILEATTACHMENT:return new YS(t);default:return new Ze(t)}}}class Ze{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ze._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:n,rect:r}=this.data;let o=-1/0,l=-1/0;if(e?.length>=8){for(let c=0;c<e.length;c+=8)e[c+1]>l?(l=e[c+1],o=e[c+2]):e[c+1]===l&&(o=Math.max(o,e[c+2]));return[o,l]}if(n?.length>=1){for(const c of n)for(let h=0,f=c.length;h<f;h+=2)c[h+1]>l?(l=c[h+1],o=c[h]):c[h+1]===l&&(o=Math.max(o,c[h]));if(o!==1/0)return[o,l]}return r?[r[2],r[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:n,pageHeight:r,pageX:o,pageY:l}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-o)/n,t[1]=100*(t[1]-l)/r,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Ll}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,n={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:n})||this.annotationStorage.setValue(`${Ll}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:n}=t;e&&this.#n(e);let r=this.#i?.popup||this.popup;!r&&n?.text&&(this._createPopup(n),r=this.#i.popup),r&&(r.updateEdited(t),n?.deleted&&(r.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#n(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#n(t){const{container:{style:e},data:{rect:n,rotation:r},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:c,pageY:h}}}}=this;n?.splice(0,4,...t),e.left=`${100*(t[0]-c)/o}%`,e.top=`${100*(l-t[3]+h)/l}%`,r===0?(e.width=`${100*(t[2]-t[0])/o}%`,e.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(r)}_createContainer(t){const{data:e,parent:{page:n,viewport:r}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",e.id),!(this instanceof ls)&&!(this instanceof M0)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(o.title=e.alternativeText),e.noRotate&&o.classList.add("norotate"),!e.rect||this instanceof g0){const{rotation:y}=e;return!e.hasOwnCanvas&&y!==0&&this.setRotation(y,o),o}const{width:c,height:h}=this;if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const y=e.borderStyle.horizontalCornerRadius,A=e.borderStyle.verticalCornerRadius;if(y>0||A>0){const w=`calc(${y}px * var(--total-scale-factor)) / calc(${A}px * var(--total-scale-factor))`;l.borderRadius=w}else if(this instanceof X2){const w=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=w}switch(e.borderStyle.style){case no.SOLID:l.borderStyle="solid";break;case no.DASHED:l.borderStyle="dashed";break;case no.BEVELED:ae("Unimplemented border style: beveled");break;case no.INSET:ae("Unimplemented border style: inset");break;case no.UNDERLINE:l.borderBottomStyle="solid";break}const S=e.borderColor||null;S?(this.#e=!0,l.borderColor=Xt.makeHexColor(S[0]|0,S[1]|0,S[2]|0)):l.borderWidth=0}const f=Xt.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:g,pageHeight:p,pageX:m,pageY:v}=r.rawDims;l.left=`${100*(f[0]-m)/g}%`,l.top=`${100*(f[1]-v)/p}%`;const{rotation:b}=e;return e.hasOwnCanvas||b===0?(l.width=`${100*c/g}%`,l.height=`${100*h/p}%`):this.setRotation(b,o),o}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims;let{width:o,height:l}=this;t%180!==0&&([o,l]=[l,o]),e.style.width=`${100*o/n}%`,e.style.height=`${100*l/r}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,r)=>{const o=r.detail[e],l=o[0],c=o.slice(1);r.target.style[n]=Ov[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:Ov[`${l}_rgb`](c)})};return re(this,"_commonActions",{display:e=>{const{display:n}=e.detail,r=n%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const r of Object.keys(e.detail))(t[r]||n[r])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[r,o]of Object.entries(e)){const l=n[r];if(l){const c={detail:{[r]:o},target:t};l(c),delete e[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,r,o]=this.data.rect.map(y=>Math.fround(y));if(t.length===8){const[y,A,S,w]=t.subarray(2,6);if(r===y&&o===A&&e===S&&n===w)return}const{style:l}=this.container;let c;if(this.#e){const{borderColor:y,borderWidth:A}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${y}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const h=r-e,f=o-n,{svgFactory:g}=this,p=g.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0),p.role="none";const m=g.createElement("defs");p.append(m);const v=g.createElement("clipPath"),b=`clippath_${this.data.id}`;v.setAttribute("id",b),v.setAttribute("clipPathUnits","objectBoundingBox"),m.append(v);for(let y=2,A=t.length;y<A;y+=8){const S=t[y],w=t[y+1],E=t[y+2],D=t[y+3],P=g.createElement("rect"),L=(E-e)/h,R=(o-w)/f,V=(S-E)/h,F=(w-D)/f;P.setAttribute("x",L),P.setAttribute("y",R),P.setAttribute("width",V),P.setAttribute("height",F),v.append(P),c?.push(`<rect vector-effect="non-scaling-stroke" x="${L}" y="${R}" width="${V}" height="${F}"/>`)}this.#e&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(p),this.container.style.clipPath=`url(#${b})`}_createPopup(t=null){const{data:e}=this;let n,r;t?(n={str:t.text},r=t.date):(n=e.contentsObj,r=e.modificationDate),this.#i=new g0({data:{color:e.color,titleObj:e.titleObj,modificationDate:r,contentsObj:n,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){Ue("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:o,id:l,exportValues:c}of r){if(o===-1||l===e)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!is.has(f)){ae(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:f})}return n}for(const r of document.getElementsByName(t)){const{exportValue:o}=r,l=r.getAttribute("data-element-id");l!==e&&is.has(r)&&n.push({id:l,exportValue:o,domElement:r})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class PS extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class M0 extends Ze{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let r=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(n,t.action,t.overlaidText),r=!0):t.attachment?(this.#e(n,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(this.#i(n,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(n,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),r=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(n,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=n,this.container.append(n)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,n=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),n&&(t.title=n)}_bindNamedAction(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),n&&(t.title=n),this.#t()}#e(t,e,n="",r=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:n&&(t.title=n),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,r),!1),this.#t()}#i(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),n&&(t.title=n),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(e.actions)){const o=n.get(r);o&&(t[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:r}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){ae('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{n?.();const{fields:r,refs:o,include:l}=e,c=[];if(r.length!==0||o.length!==0){const g=new Set(o);for(const p of r){const m=this._fieldObjects[p]||[];for(const{id:v}of m)g.add(v)}for(const p of Object.values(this._fieldObjects))for(const m of p)g.has(m.id)===l&&c.push(m)}else for(const g of Object.values(this._fieldObjects))c.push(...g);const h=this.annotationStorage,f=[];for(const g of c){const{id:p}=g;switch(f.push(p),g.type){case"text":{const v=g.defaultValue||"";h.setValue(p,{value:v});break}case"checkbox":case"radiobutton":{const v=g.defaultValue===g.exportValues;h.setValue(p,{value:v});break}case"combobox":case"listbox":{const v=g.defaultValue||"";h.setValue(p,{value:v});break}default:continue}const m=document.querySelector(`[data-element-id="${p}"]`);if(m){if(!is.has(m)){ae(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class MS extends Ze{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class ls extends Ze{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return _n.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,r,o){n.includes("mouse")?t.addEventListener(n,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(n,l=>{if(n==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:o(l)}})})}_setEventListeners(t,e,n,r){for(const[o,l]of n)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,o,l,r),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Xt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||OS,o=t.style;let l;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),g=Math.round(f/(zd*r))||1,p=f/g;l=Math.min(r,h(p/zd))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(r,h(f/zd))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=Xt.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class NS extends ls{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,r){const o=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=n),o.setValue(l.id,{[r]:n})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const r=t.getValue(e,{value:this.data.fieldValue});let o=r.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=r.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),is.add(n),this.contentElement=n,n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:f,datetimeType:g,timeStep:p}=this.data,m=!!g&&this.enableScripting;f&&(n.title=f),this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",b=>{t.setValue(e,{value:b.target.value}),this.setPropertyOnSiblings(n,"value",b.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",b=>{const y=this.data.defaultFieldValue??"";n.value=h.userValue=y,h.formattedValue=null});let v=b=>{const{formattedValue:y}=h;y!=null&&(b.target.value=y),b.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",y=>{if(h.focused)return;const{target:A}=y;if(m&&(A.type=g,p&&(A.step=p)),h.userValue){const S=h.userValue;if(m)if(g==="time"){const w=new Date(S),E=[w.getHours(),w.getMinutes(),w.getSeconds()];A.value=E.map(D=>D.toString().padStart(2,"0")).join(":")}else A.value=new Date(S-RS).toISOString().split(g==="date"?"T":".",1)[0];else A.value=S}h.lastCommittedValue=A.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",y=>{this.showElementAndHideCanvas(y.target);const A={value(S){h.userValue=S.detail.value??"",m||t.setValue(e,{value:h.userValue.toString()}),S.target.value=h.userValue},formattedValue(S){const{formattedValue:w}=S.detail;h.formattedValue=w,w!=null&&S.target!==document.activeElement&&(S.target.value=w);const E={formattedValue:w};m&&(E.value=w),t.setValue(e,E)},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{const{charLimit:w}=S.detail,{target:E}=S;if(w===0){E.removeAttribute("maxLength");return}E.setAttribute("maxLength",w);let D=h.userValue;!D||D.length<=w||(D=D.slice(0,w),E.value=h.userValue=D,t.setValue(e,{value:D}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:D,willCommit:!0,commitKey:1,selStart:E.selectionStart,selEnd:E.selectionEnd}}))}};this._dispatchEventFromSandbox(A,y)}),n.addEventListener("keydown",y=>{h.commitKey=1;let A=-1;if(y.key==="Escape"?A=0:y.key==="Enter"&&!this.data.multiLine?A=2:y.key==="Tab"&&(h.commitKey=3),A===-1)return;const{value:S}=y.target;h.lastCommittedValue!==S&&(h.lastCommittedValue=S,h.userValue=S,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:S,willCommit:!0,commitKey:A,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}))});const b=v;v=null,n.addEventListener("blur",y=>{if(!h.focused||!y.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:A}=y;let{value:S}=A;if(m){if(S&&g==="time"){const w=S.split(":").map(E=>parseInt(E,10));S=new Date(2e3,0,1,w[0],w[1],w[2]||0).valueOf(),A.step=""}else S.includes("T")||(S=`${S}T00:00`),S=new Date(S).valueOf();A.type="text"}h.userValue=S,h.lastCommittedValue!==S&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:S,willCommit:!0,commitKey:h.commitKey,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}),b(y)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",y=>{h.lastCommittedValue=null;const{data:A,target:S}=y,{value:w,selectionStart:E,selectionEnd:D}=S;let P=E,L=D;switch(y.inputType){case"deleteWordBackward":{const R=w.substring(0,E).match(/\w*[^\w]*$/);R&&(P-=R[0].length);break}case"deleteWordForward":{const R=w.substring(E).match(/^[^\w]*\w*/);R&&(L+=R[0].length);break}case"deleteContentBackward":E===D&&(P-=1);break;case"deleteContentForward":E===D&&(L+=1);break}y.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:w,change:A||"",willCommit:!1,selStart:P,selEnd:L}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],y=>y.target.value)}if(v&&n.addEventListener("blur",v),this.data.comb){const y=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${y}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class FS extends ls{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class LS extends ls{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let r=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return is.add(o),o.setAttribute("data-element-id",n),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=e.fieldName,r&&o.setAttribute("checked",!0),o.setAttribute("exportValue",e.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,n)){const g=h&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=g),t.setValue(f.id,{value:g})}t.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const c=e.defaultFieldValue||"Off";l.target.checked=c===e.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class X2 extends ls{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let r=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof r=="string"&&(r=r!==e.buttonValue,t.setValue(n,{value:r})),r)for(const l of this._getElementsByName(e.fieldName,n))t.setValue(l.id,{value:!1});const o=document.createElement("input");if(is.add(o),o.setAttribute("data-element-id",n),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=e.fieldName,r&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,n))t.setValue(f.id,{value:!1});t.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const c=e.defaultFieldValue;l.target.checked=c!=null&&c===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;o.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const g=l===f.detail.value;for(const p of this._getElementsByName(f.target.name)){const m=g&&p.id===n;p.domElement&&(p.domElement.checked=m),t.setValue(p.id,{value:m})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class BS extends M0{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class IS extends ls{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),r=document.createElement("select");is.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",g=>{const p=this.data.defaultFieldValue;for(const m of r.options)m.selected=m.value===p});for(const g of this.data.options){const p=document.createElement("option");p.textContent=g.displayValue,p.value=g.exportValue,n.value.includes(g.exportValue)&&(p.setAttribute("selected",!0),o=!1),r.append(p)}let l=null;if(o){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),r.prepend(g),l=()=>{g.remove(),r.removeEventListener("input",l),l=null},r.addEventListener("input",l)}const c=g=>{const p=g?"value":"textContent",{options:m,multiple:v}=r;return v?Array.prototype.filter.call(m,b=>b.selected).map(b=>b[p]):m.selectedIndex===-1?null:m[m.selectedIndex][p]};let h=c(!1);const f=g=>{const p=g.target.options;return Array.prototype.map.call(p,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",g=>{const p={value(m){l?.();const v=m.detail.value,b=new Set(Array.isArray(v)?v:[v]);for(const y of r.options)y.selected=b.has(y.value);t.setValue(e,{value:c(!0)}),h=c(!1)},multipleSelection(m){r.multiple=!0},remove(m){const v=r.options,b=m.detail.remove;v[b].selected=!1,r.remove(b),v.length>0&&Array.prototype.findIndex.call(v,A=>A.selected)===-1&&(v[0].selected=!0),t.setValue(e,{value:c(!0),items:f(m)}),h=c(!1)},clear(m){for(;r.length!==0;)r.remove(0);t.setValue(e,{value:null,items:[]}),h=c(!1)},insert(m){const{index:v,displayValue:b,exportValue:y}=m.detail.insert,A=r.children[v],S=document.createElement("option");S.textContent=b,S.value=y,A?A.before(S):r.append(S),t.setValue(e,{value:c(!0),items:f(m)}),h=c(!1)},items(m){const{items:v}=m.detail;for(;r.length!==0;)r.remove(0);for(const b of v){const{displayValue:y,exportValue:A}=b,S=document.createElement("option");S.textContent=y,S.value=A,r.append(S)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(e,{value:c(!0),items:f(m)}),h=c(!1)},indices(m){const v=new Set(m.detail.indices);for(const b of m.target.options)b.selected=v.has(b.index);t.setValue(e,{value:c(!0)}),h=c(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(p,g)}),r.addEventListener("input",g=>{const p=c(!0),m=c(!1);t.setValue(e,{value:p}),g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:m,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):r.addEventListener("input",function(g){t.setValue(e,{value:c(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class g0 extends Ze{constructor(t){const{data:e,elements:n,parent:r}=t,o=!!r._commentManager;if(super(t,{isRenderable:!o&&Ze._hasPopupData(e)}),this.elements=n,o&&Ze._hasPopupData(e)){const l=this.popup=this.#t();for(const c of n)c.popup=l}else this.popup=null}#t(){return new US({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),n=[];for(const r of this.elements)r.popup=e,r.container.ariaHasPopup="dialog",n.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(r=>`${so}${r}`).join(",")),this.container}}class US{#t=null;#e=this.#V.bind(this);#i=this.#U.bind(this);#n=this.#M.bind(this);#s=this.#A.bind(this);#r=null;#a=null;#o=null;#c=null;#l=null;#f=null;#h=null;#d=!1;#m=null;#p=null;#u=null;#g=null;#v=null;#x=null;#y=null;#E=null;#S=null;#b=null;#C=!1;#_=null;#w=null;constructor({container:t,color:e,elements:n,titleObj:r,modificationDate:o,contentsObj:l,richText:c,parent:h,rect:f,parentRect:g,open:p,commentManager:m=null}){this.#a=t,this.#S=r,this.#o=l,this.#E=c,this.#f=h,this.#r=e,this.#y=f,this.#h=g,this.#l=n,this.#t=m,this.#_=n[0],this.#c=o0.toDateObject(o),this.trigger=n.flatMap(v=>v.getElementsToTriggerPopup()),m||(this.#O(),this.#a.hidden=!0,p&&this.#A())}#O(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const e of this.trigger)e.addEventListener("click",this.#s,{signal:t}),e.addEventListener("pointerenter",this.#n,{signal:t}),e.addEventListener("pointerleave",this.#i,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#k(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#v=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#g){this.#g.parentNode||this.#_.container.after(this.#g);return}if(this.#v||this.#k(),!this.#v)return;const{signal:t}=this.#p=new AbortController,e=this.#_.hasOwnCommentButton,n=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},r=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},o=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#g=this.#_.container;for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",n,{signal:t}),l.addEventListener("pointerenter",r,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),l.classList.add("popupTriggerArea")}else{const l=this.#g=document.createElement("button");l.className="annotationCommentButton";const c=this.#_.container;l.style.zIndex=c.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#B(),this.#D(),l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",n,{signal:t}),l.addEventListener("pointerenter",r,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),c.after(l)}}#D(){if(this.#_.extraPopupElement&&!this.#_.editor)return;this.#g||this.renderCommentButton();const[t,e]=this.#v,{style:n}=this.#g;n.left=`calc(${t}%)`,n.top=`calc(${e}% - var(--comment-button-dim))`}#B(){this.#_.extraPopupElement||(this.#g||this.renderCommentButton(),this.#g.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#_.commentData;return t?this.#f._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#g?.focus()},0)}getData(){const{richText:t,color:e,opacity:n,creationDate:r,modificationDate:o}=this.#_.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:n,creationDate:r,modificationDate:o}}get elementBeforePopup(){return this.#g}get comment(){return this.#w||=this.#_.commentText,this.#w}set comment(t){t!==this.comment&&(this.#_.commentText=this.#w=t)}focus(){this.#_.container?.focus()}get parentBoundingClientRect(){return this.#_.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#g&&(this.#g.classList.toggle("selected",t),this.#g.ariaExpanded=e)}setSelectedCommentButton(t){this.#g.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#x)return this.#x;const{x:t,y:e,height:n}=this.#g.getBoundingClientRect(),{x:r,y:o,width:l,height:c}=this.#_.layer.getBoundingClientRect();return[(t-r)/l,(e+n-o)/c]}set commentPopupPosition(t){this.#x=t}hasDefaultPopupPosition(){return this.#x===null}get commentButtonPosition(){return this.#v}get commentButtonWidth(){return this.#g.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,n]=this.#x||this.commentButtonPosition.map(f=>f/100),r=this.parentBoundingClientRect,{x:o,y:l,width:c,height:h}=r;this.#t.showDialog(null,this,o+e*c,l+n*h,{...t,parentDimensions:r})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#r){const n=t.style.outlineColor=Xt.makeHexColor(...this.#r);t.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#S?.str){const n=document.createElement("span");n.className="title",e.append(n),{dir:n.dir,str:n.textContent}=this.#S}if(t.append(e),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),e.append(n)}E2({html:this.#P||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#a.append(t)}get#P(){const t=this.#E,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#E.html||null}get#N(){return this.#P?.attributes?.style?.fontSize||0}get#I(){return this.#P?.attributes?.style?.color||null}#F(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},r={style:{color:this.#I,fontSize:this.#N?`calc(${this.#N}px * var(--total-scale-factor))`:""}};for(const o of t.split(`
`))e.push({name:"span",value:o,attributes:r});return n}#V(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#d)&&this.#A()}updateEdited({rect:t,popup:e,deleted:n}){if(this.#t){n?(this.remove(),this.#w=null):e&&(e.deleted?this.remove():(this.#B(),this.#w=e.text)),t&&(this.#v=null,this.#k(),this.#D());return}if(n||e?.deleted){this.remove();return}this.#O(),this.#b||={contentsObj:this.#o,richText:this.#E},t&&(this.#u=null),e&&e.text&&(this.#E=this.#F(e.text),this.#c=o0.toDateObject(e.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#b&&({contentsObj:this.#o,richText:this.#E}=this.#b,this.#b=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#p?.abort(),this.#p=null,this.#m?.remove(),this.#m=null,this.#C=!1,this.#d=!1,this.#g?.remove(),this.#g=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:r,pageY:o}}}=this.#f;let l=!!this.#h,c=l?this.#h:this.#y;for(const b of this.#l)if(!c||Xt.intersect(b.data.rect,c)!==null){c=b.data.rect,l=!0;break}const h=Xt.normalizeRect([c[0],t[3]-c[1]+t[1],c[2],t[3]-c[3]+t[1]]),g=l?c[2]-c[0]+5:0,p=h[0]+g,m=h[1];this.#u=[100*(p-r)/e,100*(m-o)/n];const{style:v}=this.#a;v.left=`${this.#u[0]}%`,v.top=`${this.#u[1]}%`}#A(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#d=!this.#d,this.#d?(this.#M(),this.#a.addEventListener("click",this.#s),this.#a.addEventListener("keydown",this.#e)):(this.#U(),this.#a.removeEventListener("click",this.#s),this.#a.removeEventListener("keydown",this.#e))}#M(){this.#m||this.render(),this.isVisible?this.#d&&this.#a.classList.add("focused"):(this.#T(),this.#a.hidden=!1,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)+1e3)}#U(){this.#a.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#a.hidden=!0,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#a.hidden=!0)}maybeShow(){this.#t||(this.#O(),this.#C&&(this.#m||this.#M(),this.#C=!1,this.#a.hidden=!1))}get isVisible(){return this.#t?!1:this.#a.hidden===!1}}class K2 extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=se.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class zS extends Ze{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:n}=this,r=this.svgFactory.create(e,n,!0),o=this.#t=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class HS extends Ze{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:n}=this,r=this.svgFactory.create(e,n,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",e-o),l.setAttribute("height",n-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class jS extends Ze{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:n}=this,r=this.svgFactory.create(e,n,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",e/2),l.setAttribute("cy",n/2),l.setAttribute("rx",e/2-o/2),l.setAttribute("ry",n/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class W2 extends Ze{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:n,popupRef:r},width:o,height:l}=this;if(!e)return this.container;const c=this.svgFactory.create(o,l,!0);let h=[];for(let g=0,p=e.length;g<p;g+=2){const m=e[g]-t[0],v=t[3]-e[g+1];h.push(`${m},${v}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),c.append(f),this.container.append(c),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class GS extends W2{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class VS extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class N0 extends Ze{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?se.HIGHLIGHT:se.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:n,borderStyle:r,popupRef:o}}=this,{transform:l,width:c,height:h}=this.#i(e,t),f=this.svgFactory.create(c,h,!0),g=this.#t=this.svgFactory.createElement("svg:g");f.append(g),g.setAttribute("stroke-width",r.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",l);for(let p=0,m=n.length;p<m;p++){const v=this.svgFactory.createElement(this.svgElementName);this.#e.push(v),v.setAttribute("points",n[p].join(",")),g.append(v)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:n,rect:r}=t,o=this.#t;if(e>=0&&o.setAttribute("stroke-width",e||1),n)for(let l=0,c=this.#e.length;l<c;l++)this.#e[l].setAttribute("points",n[l].join(","));if(r){const{transform:l,width:c,height:h}=this.#i(this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Y2 extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=se.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class XS extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class KS extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class WS extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class q2 extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=se.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class YS extends Ze{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let n;e.hasAppearance||e.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#e.bind(this)),this.#t=n;const{isMac:r}=_n.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class F0{#t=null;#e=null;#i=null;#n=new Map;#s=null;#r=null;#a=[];#o=!1;constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:r,page:o,viewport:l,structTreeLayer:c,commentManager:h,linkService:f,annotationStorage:g}){this.div=t,this.#t=e,this.#e=n,this.#s=c||null,this.#r=f||null,this.#i=g||new C0,this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=h||null}hasEditableAnnotations(){return this.#n.size>0}async render(t){const{annotations:e}=t,n=this.div;ns(n,this.viewport);const r=new Map,o=[],l={data:null,layer:n,linkService:this.#r,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Xu,annotationStorage:this.#i,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const c of e){if(c.noHTML)continue;const h=c.annotationType===gn.POPUP;if(h){const p=r.get(c.id);if(!p)continue;if(!this._commentManager){o.push(c);continue}l.elements=p}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;l.data=c;const f=Yd.create(l);if(!f.isRenderable)continue;if(!h&&(this.#a.push(f),c.popupRef)){const p=r.get(c.popupRef);p?p.push(f):r.set(c.popupRef,[f])}const g=f.render();c.hidden&&(g.style.visibility="hidden"),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const c of o){const h=l.elements=r.get(c.id);l.data=c;const f=Yd.create(l);if(!f.isRenderable)continue;const g=f.render();f.contentElement.id=`${so}${c.id}`,c.hidden&&(g.style.visibility="hidden"),h.at(-1).container.after(g)}this.#l()}async#c(){if(this.#a.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:n,data:{id:r}}of this.#a){const o=n.id=`${so}${r}`;t.push(this.#s?.getAriaAttributes(o).then(l=>{if(l)for(const[c,h]of l)n.setAttribute(c,h)}))}}this.#a.sort(({data:{rect:[n,r,o,l]}},{data:{rect:[c,h,f,g]}})=>{if(n===o&&r===l)return 1;if(c===f&&h===g)return-1;const p=l,m=r,v=(r+l)/2,b=g,y=h,A=(h+g)/2;if(v>=b&&A<=m)return-1;if(A>=p&&v<=y)return 1;const S=(n+o)/2,w=(c+f)/2;return S-w});const e=document.createDocumentFragment();for(const n of this.#a)e.append(n.container),this._commentManager?(n.extraPopupElement?.popup||n.popup)?.renderCommentButton():n.extraPopupElement&&e.append(n.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),this.#t)for(const n of this.#a)this.#t.addPointerInTextLayer(n.contentElement,!1)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#r,svgFactory:new Xu,parent:this};for(const n of t){n.borderStyle||=F0._defaultBorderStyle,e.data=n;const r=Yd.create(e);r.isRenderable&&(r.render(),r.contentElement.id=`${so}${n.id}`,this.#a.push(r))}await this.#c()}update({viewport:t}){const e=this.div;this.viewport=t,ns(e,{rotation:t.rotation}),this.#l(),e.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[e,n]of this.#e){const r=t.querySelector(`[data-annotation-id="${e}"]`);if(!r)continue;n.className="annotationContent";const{firstChild:o}=r;o?o.nodeName==="CANVAS"?o.replaceWith(n):o.classList.contains("annotationContent")?o.after(n):o.before(n):r.append(n);const l=this.#n.get(e);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,r.id,n),l._hasNoCanvas=!1):l.canvas=n)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:n,rotation:r}=t,o=new PS({data:{id:n,rect:t.getPDFRect(),rotation:r},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#i});return o.render(),o.contentElement.id=`${so}${n}`,o.createOrUpdatePopup(),this.#a.push(o),o}removeAnnotation(t){const e=this.#a.findIndex(r=>r.data.id===t);if(e<0)return;const[n]=this.#a.splice(e,1);this.#t?.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return re(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:no.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Du=/\r\n?|\n/g;class Sn extends Qt{#t="";#e=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Sn.prototype,e=o=>o.isEmpty(),n=Er.TRANSLATE_SMALL,r=Er.TRANSLATE_BIG;return re(this,"_keyboardManager",new Jl([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:e}]]))}static _type="freetext";static _editorType=se.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Sn._defaultColor||Qt._defaultLineColor,this.#n=t.fontSize||Sn._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,e){Qt.initialize(t,e);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case pe.FREETEXT_SIZE:Sn._defaultFontSize=e;break;case pe.FREETEXT_COLOR:Sn._defaultColor=e;break}}updateParams(t,e){switch(t){case pe.FREETEXT_SIZE:this.#s(e);break;case pe.FREETEXT_COLOR:this.#r(e);break}}static get defaultPropertiesToUpdate(){return[[pe.FREETEXT_SIZE,Sn._defaultFontSize],[pe.FREETEXT_COLOR,Sn._defaultColor||Qt._defaultLineColor]]}get propertiesToUpdate(){return[[pe.FREETEXT_SIZE,this.#n],[pe.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new zl(this),[["colorPicker",this._colorPicker]]}get colorType(){return pe.FREETEXT_COLOR}#s(t){const e=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#n)*this.parentScale),this.#n=r,this.#o()},n=this.#n;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:pe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(t){const e=r=>{this.color=r,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:pe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Sn._internalPadding*t,-(Sn._internalPadding+this.#n)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#a(){const t=[];this.editorDiv.normalize();let e=null;for(const n of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(t.push(Sn.#c(n)),e=n);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,l=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),n=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#a().trimEnd();if(t===e)return;const n=r=>{if(this.#t=r,!r){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{n(e)},undo:()=>{n(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Sn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[f,g]=this.pageDimensions,[p,m]=this.pageTranslation;let v,b;switch(this.rotation){case 0:v=t+(l[0]-p)/f,b=e+this.height-(l[1]-m)/g;break;case 90:v=t+(l[0]-p)/f,b=e-(l[1]-m)/g,[c,h]=[h,-c];break;case 180:v=t-this.width+(l[0]-p)/f,b=e-(l[1]-m)/g,[c,h]=[-c,-h];break;case 270:v=t+(l[0]-p-this.height*g)/f,b=e+(l[1]-m-this.width*f)/g,[c,h]=[-h,c];break}this.setAt(v*r,b*o,c,h)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Du,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:n}=e;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const r=Sn.#h(e.getData("text")||"").replaceAll(Du,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!r.includes(`
`)){l.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:h}=l,f=[],g=[];if(c.nodeType===Node.TEXT_NODE){const v=c.parentElement;if(g.push(c.nodeValue.slice(h).replaceAll(Du,"")),v!==this.editorDiv){let b=f;for(const y of this.editorDiv.childNodes){if(y===v){b=g;continue}b.push(Sn.#c(y))}}f.push(c.nodeValue.slice(0,h).replaceAll(Du,""))}else if(c===this.editorDiv){let v=f,b=0;for(const y of this.editorDiv.childNodes)b++===h&&(v=g),v.push(Sn.#c(y))}this.#t=`${f.join(`
`)}${r}${g.join(`
`)}`,this.#l();const p=new Range;let m=Math.sumPrecise(f.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const b=v.nodeValue.length;if(m<=b){p.setStart(v,m),p.setEnd(v,m);break}m-=b}o.removeAllRanges(),o.addRange(p)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#f(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Sn._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,n){let r=null;if(t instanceof K2){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:f,id:g,popupRef:p,richText:m,contentsObj:v,creationDate:b,modificationDate:y},textContent:A,textPosition:S,parent:{page:{pageNumber:w}}}=t;if(!A||A.length===0)return null;r=t={annotationType:se.FREETEXT,color:Array.from(c),fontSize:l,value:A.join(`
`),position:S,pageIndex:w-1,rect:h.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:p,comment:v?.str||null,richText:m,creationDate:b,modificationDate:y}}const o=await super.deserialize(t,e,n);return o.#n=t.fontSize,o.color=Xt.makeHexColor(...t.color),o.#t=Sn.#h(t.value),o._initialData=r,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Qt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(t),{color:e,fontSize:this.#n,value:this.#f()});return this.addComment(n),t?(n.isCopy=!0,n):this.annotationElementId&&!this.#d(n)?null:(n.id=this.annotationElementId,n)}#d(t){const{value:e,fontSize:n,color:r,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some((l,c)=>l!==r[c])||t.pageIndex!==o}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:n}=e;n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,e.replaceChildren();for(const r of this.#t.split(`
`)){const o=document.createElement("div");o.append(r?document.createTextNode(r):document.createElement("br")),e.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Kt{static PRECISION=1e-4;toSVGPath(){Ue("Abstract method `toSVGPath` must be implemented.")}get box(){Ue("Abstract getter `box` must be implemented.")}serialize(t,e){Ue("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,r,o,l){l||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c]*r,l[c+1]=n+t[c+1]*o;return l}static _rescaleAndSwap(t,e,n,r,o,l){l||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c+1]*r,l[c+1]=n+t[c]*o;return l}static _translate(t,e,n,r){r||=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o+=2)r[o]=e+t[o],r[o+1]=n+t[o+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,r,o){switch(o){case 90:return[1-e/n,t/r];case 180:return[1-t/n,1-e/r];case 270:return[e/n,1-t/r];default:return[t/n,e/r]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,r,o,l){return[(t+5*n)/6,(e+5*r)/6,(5*n+o)/6,(5*r+l)/6,(n+o)/2,(r+l)/2]}}class $r{#t;#e=[];#i;#n;#s=[];#r=new Float32Array(18);#a;#o;#c;#l;#f;#h;#d=[];static#m=8;static#p=2;static#u=$r.#m+$r.#p;constructor({x:t,y:e},n,r,o,l,c=0){this.#t=n,this.#h=o*r,this.#n=l,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=c,this.#l=$r.#m*r,this.#c=$r.#u*r,this.#f=r,this.#d.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#g(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[n,r,o,l]=this.#t;return[(this.#a+(t[0]-e[0])/2-n)/o,(this.#o+(t[1]-e[1])/2-r)/l,(this.#a+(e[0]-t[0])/2-n)/o,(this.#o+(e[1]-t[1])/2-r)/l]}add({x:t,y:e}){this.#a=t,this.#o=e;const[n,r,o,l]=this.#t;let[c,h,f,g]=this.#r.subarray(8,12);const p=t-f,m=e-g,v=Math.hypot(p,m);if(v<this.#c)return!1;const b=v-this.#l,y=b/v,A=y*p,S=y*m;let w=c,E=h;c=f,h=g,f+=A,g+=S,this.#d?.push(t,e);const D=-S/b,P=A/b,L=D*this.#h,R=P*this.#h;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+L,g+R],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-L,g-R],16),isNaN(this.#r[6])?(this.#s.length===0&&(this.#r.set([c+L,h+R],2),this.#s.push(NaN,NaN,NaN,NaN,(c+L-n)/o,(h+R-r)/l),this.#r.set([c-L,h-R],14),this.#e.push(NaN,NaN,NaN,NaN,(c-L-n)/o,(h-R-r)/l)),this.#r.set([w,E,c,h,f,g],6),!this.isEmpty()):(this.#r.set([w,E,c,h,f,g],6),Math.abs(Math.atan2(E-h,w-c)-Math.atan2(S,A))<Math.PI/2?([c,h,f,g]=this.#r.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((c+f)/2-n)/o,((h+g)/2-r)/l),[c,h,w,E]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((w+c)/2-n)/o,((E+h)/2-r)/l),!0):([w,E,c,h,f,g]=this.#r.subarray(0,6),this.#s.push(((w+5*c)/6-n)/o,((E+5*h)/6-r)/l,((5*c+f)/6-n)/o,((5*h+g)/6-r)/l,((c+f)/2-n)/o,((h+g)/2-r)/l),[f,g,c,h,w,E]=this.#r.subarray(12,18),this.#e.push(((w+5*c)/6-n)/o,((E+5*h)/6-r)/l,((5*c+f)/6-n)/o,((5*h+g)/6-r)/l,((c+f)/2-n)/o,((h+g)/2-r)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#v();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?n.push(`L${t[r+4]} ${t[r+5]}`):n.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#y(n);for(let r=e.length-6;r>=6;r-=6)isNaN(e[r])?n.push(`L${e[r+4]} ${e[r+5]}`):n.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);return this.#x(n),n.join(" ")}#v(){const[t,e,n,r]=this.#t,[o,l,c,h]=this.#g();return`M${(this.#r[2]-t)/n} ${(this.#r[3]-e)/r} L${(this.#r[4]-t)/n} ${(this.#r[5]-e)/r} L${o} ${l} L${c} ${h} L${(this.#r[16]-t)/n} ${(this.#r[17]-e)/r} L${(this.#r[14]-t)/n} ${(this.#r[15]-e)/r} Z`}#x(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#y(t){const[e,n,r,o]=this.#t,l=this.#r.subarray(4,6),c=this.#r.subarray(16,18),[h,f,g,p]=this.#g();t.push(`L${(l[0]-e)/r} ${(l[1]-n)/o} L${h} ${f} L${g} ${p} L${(c[0]-e)/r} ${(c[1]-n)/o}`)}newFreeDrawOutline(t,e,n,r,o,l){return new $2(t,e,n,r,o,l)}getOutlines(){const t=this.#s,e=this.#e,n=this.#r,[r,o,l,c]=this.#t,h=new Float32Array((this.#d?.length??0)+2);for(let p=0,m=h.length-2;p<m;p+=2)h[p]=(this.#d[p]-r)/l,h[p+1]=(this.#d[p+1]-o)/c;if(h[h.length-2]=(this.#a-r)/l,h[h.length-1]=(this.#o-o)/c,isNaN(n[6])&&!this.isEmpty())return this.#E(h);const f=new Float32Array(this.#s.length+24+this.#e.length);let g=t.length;for(let p=0;p<g;p+=2){if(isNaN(t[p])){f[p]=f[p+1]=NaN;continue}f[p]=t[p],f[p+1]=t[p+1]}g=this.#b(f,g);for(let p=e.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(e[p+m])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=e[p+m],f[g+1]=e[p+m+1],g+=2}return this.#S(f,g),this.newFreeDrawOutline(f,h,this.#t,this.#f,this.#i,this.#n)}#E(t){const e=this.#r,[n,r,o,l]=this.#t,[c,h,f,g]=this.#g(),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(e[2]-n)/o,(e[3]-r)/l,NaN,NaN,NaN,NaN,(e[4]-n)/o,(e[5]-r)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(e[16]-n)/o,(e[17]-r)/l,NaN,NaN,NaN,NaN,(e[14]-n)/o,(e[15]-r)/l],0),this.newFreeDrawOutline(p,t,this.#t,this.#f,this.#i,this.#n)}#S(t,e){const n=this.#e;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6}#b(t,e){const n=this.#r.subarray(4,6),r=this.#r.subarray(16,18),[o,l,c,h]=this.#t,[f,g,p,m]=this.#g();return t.set([NaN,NaN,NaN,NaN,(n[0]-o)/c,(n[1]-l)/h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(r[0]-o)/c,(r[1]-l)/h],e),e+=24}}class $2 extends Kt{#t;#e=new Float32Array(4);#i;#n;#s;#r;#a;constructor(t,e,n,r,o,l){super(),this.#a=t,this.#s=e,this.#t=n,this.#r=r,this.#i=o,this.#n=l,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(l);const[c,h,f,g]=this.#e;for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-c)/f,t[p+1]=(t[p+1]-h)/g;for(let p=0,m=e.length;p<m;p+=2)e[p]=(e[p]-c)/f,e[p+1]=(e[p+1]-h)/g}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let e=6,n=this.#a.length;e<n;e+=6){if(isNaN(this.#a[e])){t.push(`L${this.#a[e+4]} ${this.#a[e+5]}`);continue}t.push(`C${this.#a[e]} ${this.#a[e+1]} ${this.#a[e+2]} ${this.#a[e+3]} ${this.#a[e+4]} ${this.#a[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,n,r],o){const l=n-t,c=r-e;let h,f;switch(o){case 0:h=Kt._rescale(this.#a,t,r,l,-c),f=Kt._rescale(this.#s,t,r,l,-c);break;case 90:h=Kt._rescaleAndSwap(this.#a,t,e,l,c),f=Kt._rescaleAndSwap(this.#s,t,e,l,c);break;case 180:h=Kt._rescale(this.#a,n,e,-l,c),f=Kt._rescale(this.#s,n,e,-l,c);break;case 270:h=Kt._rescaleAndSwap(this.#a,n,r,-l,-c),f=Kt._rescaleAndSwap(this.#s,n,r,-l,-c);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(t){const e=this.#a;let n=e[4],r=e[5];const o=[n,r,n,r];let l=n,c=r,h=n,f=r;const g=t?Math.max:Math.min,p=new Float32Array(4);for(let v=6,b=e.length;v<b;v+=6){const y=e[v+4],A=e[v+5];isNaN(e[v])?(Xt.pointBoundingBox(y,A,o),c>A?(l=y,c=A):c===A&&(l=g(l,y)),f<A?(h=y,f=A):f===A&&(h=g(h,y))):(p[0]=p[1]=1/0,p[2]=p[3]=-1/0,Xt.bezierBoundingBox(n,r,...e.slice(v,v+6),p),Xt.rectBoundingBox(p[0],p[1],p[2],p[3],o),c>p[1]?(l=p[0],c=p[1]):c===p[1]&&(l=g(l,p[0])),f<p[3]?(h=p[2],f=p[3]):f===p[3]&&(h=g(h,p[2]))),n=y,r=A}const m=this.#e;m[0]=o[0]-this.#i,m[1]=o[1]-this.#i,m[2]=o[2]-o[0]+2*this.#i,m[3]=o[3]-o[1]+2*this.#i,this.firstPoint=[l,c],this.lastPoint=[h,f]}get box(){return this.#e}newOutliner(t,e,n,r,o,l=0){return new $r(t,e,n,r,o,l)}getNewOutline(t,e){const[n,r,o,l]=this.#e,[c,h,f,g]=this.#t,p=o*f,m=l*g,v=n*f+c,b=r*g+h,y=this.newOutliner({x:this.#s[0]*p+v,y:this.#s[1]*m+b},this.#t,this.#r,t,this.#n,e??this.#i);for(let A=2;A<this.#s.length;A+=2)y.add({x:this.#s[A]*p+v,y:this.#s[A+1]*m+b});return y.getOutlines()}}class p0{#t;#e;#i;#n=[];#s=[];constructor(t,e=0,n=0,r=!0){const o=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:y,y:A,width:S,height:w}of t){const E=Math.floor((y-e)/l)*l,D=Math.ceil((y+S+e)/l)*l,P=Math.floor((A-e)/l)*l,L=Math.ceil((A+w+e)/l)*l,R=[E,P,L,!0],V=[D,P,L,!1];this.#n.push(R,V),Xt.rectBoundingBox(E,P,D,L,o)}const c=o[2]-o[0]+2*n,h=o[3]-o[1]+2*n,f=o[0]-n,g=o[1]-n;let p=r?-1/0:1/0,m=1/0;const v=this.#n.at(r?-1:-2),b=[v[0],v[2]];for(const y of this.#n){const[A,S,w,E]=y;!E&&r?S<m?(m=S,p=A):S===m&&(p=Math.max(p,A)):E&&!r&&(S<m?(m=S,p=A):S===m&&(p=Math.min(p,A))),y[0]=(A-f)/c,y[1]=(S-g)/h,y[2]=(w-g)/h}this.#t=new Float32Array([f,g,c,h]),this.#e=[p,m],this.#i=b}getOutlines(){this.#n.sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#r(t)}#r(t){const e=[],n=new Set;for(const l of t){const[c,h,f]=l;e.push([c,h,l],[c,f,l])}e.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=e.length;l<c;l+=2){const h=e[l][2],f=e[l+1][2];h.push(f),f.push(h),n.add(h),n.add(f)}const r=[];let o;for(;n.size>0;){const l=n.values().next().value;let[c,h,f,g,p]=l;n.delete(l);let m=c,v=h;for(o=[c,f],r.push(o);;){let b;if(n.has(g))b=g;else if(n.has(p))b=p;else break;n.delete(b),[c,h,f,g,p]=b,m!==c&&(o.push(m,v,c,v===h?h:f),m=c),v=v===h?f:h}o.push(m,v)}return new qS(r,this.#t,this.#e,this.#i)}#a(t){const e=this.#s;let n=0,r=e.length-1;for(;n<=r;){const o=n+r>>1,l=e[o][0];if(l===t)return o;l<t?n=o+1:r=o-1}return r+1}#o([,t,e]){const n=this.#a(t);this.#s.splice(n,0,[t,e])}#c([,t,e]){const n=this.#a(t);for(let r=n;r<this.#s.length;r++){const[o,l]=this.#s[r];if(o!==t)break;if(o===t&&l===e){this.#s.splice(r,1);return}}for(let r=n-1;r>=0;r--){const[o,l]=this.#s[r];if(o!==t)break;if(o===t&&l===e){this.#s.splice(r,1);return}}}#l(t){const[e,n,r]=t,o=[[e,n,r]],l=this.#a(r);for(let c=0;c<l;c++){const[h,f]=this.#s[c];for(let g=0,p=o.length;g<p;g++){const[,m,v]=o[g];if(!(f<=m||v<=h)){if(m>=h){if(v>f)o[g][1]=f;else{if(p===1)return[];o.splice(g,1),g--,p--}continue}o[g][2]=h,v>f&&o.push([e,f,v])}}}return o}}class qS extends Kt{#t;#e;constructor(t,e,n,r){super(),this.#e=t,this.#t=e,this.firstPoint=n,this.lastPoint=r}toSVGPath(){const t=[];for(const e of this.#e){let[n,r]=e;t.push(`M${n} ${r}`);for(let o=2;o<e.length;o+=2){const l=e[o],c=e[o+1];l===n?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${l}`),n=l)}t.push("Z")}return t.join(" ")}serialize([t,e,n,r],o){const l=[],c=n-t,h=r-e;for(const f of this.#e){const g=new Array(f.length);for(let p=0;p<f.length;p+=2)g[p]=t+f[p]*c,g[p+1]=r-f[p+1]*h;l.push(g)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class m0 extends $r{newFreeDrawOutline(t,e,n,r,o,l){return new $S(t,e,n,r,o,l)}}class $S extends $2{newOutliner(t,e,n,r,o,l=0){return new m0(t,e,n,r,o,l)}}class on extends Qt{#t=null;#e=0;#i;#n=null;#s=null;#r=null;#a=null;#o=0;#c=null;#l=null;#f=null;#h=!1;#d=null;#m=null;#p=null;#u="";#g;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=se.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=on.prototype;return re(this,"_keyboardManager",new Jl([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||on._defaultColor,this.#g=t.thickness||on._defaultThickness,this.opacity=t.opacity||on._defaultOpacity,this.#i=t.boxes||null,this.#v=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#y(t),this.#_()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#o=t.focusOffset,this.#x(),this.#_(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#g,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#x(){const t=new p0(this.#i,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new p0(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{firstPoint:n}=this.#l;this.#d=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:r}=this.#r;this.#m=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:e,clipPathId:n}){this.#l=t;const r=1.5;if(this.#r=t.getNewOutline(this.#g/2+r,.0025),e>=0)this.#f=e,this.#n=n,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#f,{bbox:on.#w(this.#l.box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:on.#w(this.#r.box,p),path:{d:this.#r.toSVGPath()}})}const[o,l,c,h]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=c,this.height=h;break;case 90:{const[p,m]=this.parentDimensions;this.x=l,this.y=1-o,this.width=c*m/p,this.height=h*p/m;break}case 180:this.x=1-o,this.y=1-l,this.width=c,this.height=h;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-l,this.y=o,this.width=c*m/p,this.height=h*p/m;break}}const{firstPoint:f}=t;this.#d=[(f[0]-o)/c,(f[1]-l)/h];const{lastPoint:g}=this.#r;this.#m=[(g[0]-o)/c,(g[1]-l)/h]}static initialize(t,e){Qt.initialize(t,e),on._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case pe.HIGHLIGHT_COLOR:on._defaultColor=e;break;case pe.HIGHLIGHT_THICKNESS:on._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#d}updateParams(t,e){switch(t){case pe.HIGHLIGHT_COLOR:this.#E(e);break;case pe.HIGHLIGHT_THICKNESS:this.#S(e);break}}static get defaultPropertiesToUpdate(){return[[pe.HIGHLIGHT_COLOR,on._defaultColor],[pe.HIGHLIGHT_THICKNESS,on._defaultThickness]]}get propertiesToUpdate(){return[[pe.HIGHLIGHT_COLOR,this.color||on._defaultColor],[pe.HIGHLIGHT_THICKNESS,this.#g||on._defaultThickness],[pe.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#f,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#s?.updateColor(this.color),super.onUpdatedColor()}#E(t){const e=(o,l)=>{this.color=o,this.opacity=l,this.onUpdatedColor()},n=this.color,r=this.opacity;this.addCommands({cmd:e.bind(this,t,on._defaultOpacity),undo:e.bind(this,n,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:pe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#S(t){const e=this.#g,n=r=>{this.#g=r,this.#b(r)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:pe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#s=new ji({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#_(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#_(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#b(t){this.#h&&(this.#y({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#f===null||!this.parent||(this.parent.drawLayer.remove(this.#f),this.#f=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#_(t=this.parent){this.#f===null&&({id:this.#f,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#w([t,e,n,r],o){switch(o){case 90:return[1-e-r,t,r,n];case 180:return[1-t-n,1-e-r,n,r];case 270:return[e,1-t-n,r,n]}return[t,e,n,r]}rotate(t){const{drawLayer:e}=this.parent;let n;this.#h?(t=(t-this.rotation+360)%360,n=on.#w(this.#l.box,t)):n=on.#w([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#f,{bbox:n,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:on.#w(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#O.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n,this.setDims(),C2(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#O(t){on._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#k(!0);break;case 1:case 3:this.#k(!1);break}}#k(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#a,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#h||this.#k(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#f,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#D(){return this.#h?this.rotation:0}#B(){if(this.#h)return null;const[t,e]=this.pageDimensions,[n,r]=this.pageTranslation,o=this.#i,l=new Float32Array(o.length*8);let c=0;for(const{x:h,y:f,width:g,height:p}of o){const m=h*t+n,v=(1-f)*e+r;l[c]=l[c+4]=m,l[c+1]=l[c+3]=v,l[c+2]=l[c+6]=m+g*t,l[c+5]=l[c+7]=v-p*e,c+=8}return l}#P(t){return this.#l.serialize(t,this.#D())}static startHighlighting(t,e,{target:n,x:r,y:o}){const{x:l,y:c,width:h,height:f}=n.getBoundingClientRect(),g=new AbortController,p=t.combinedSignal(g),m=v=>{g.abort(),this.#I(t,v)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",tn,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Vi,{signal:p}),n.addEventListener("pointermove",this.#N.bind(this,t),{signal:p}),this._freeHighlight=new m0({x:r,y:o},[l,c,h,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#N(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#I(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,n){let r=null;if(t instanceof Y2){const{data:{quadPoints:b,rect:y,rotation:A,id:S,color:w,opacity:E,popupRef:D,richText:P,contentsObj:L,creationDate:R,modificationDate:V},parent:{page:{pageNumber:F}}}=t;r=t={annotationType:se.HIGHLIGHT,color:Array.from(w),opacity:E,quadPoints:b,boxes:null,pageIndex:F-1,rect:y.slice(0),rotation:A,annotationElementId:S,id:S,deleted:!1,popupRef:D,richText:P,comment:L?.str||null,creationDate:R,modificationDate:V}}else if(t instanceof N0){const{data:{inkLists:b,rect:y,rotation:A,id:S,color:w,borderStyle:{rawWidth:E},popupRef:D,richText:P,contentsObj:L,creationDate:R,modificationDate:V},parent:{page:{pageNumber:F}}}=t;r=t={annotationType:se.HIGHLIGHT,color:Array.from(w),thickness:E,inkLists:b,boxes:null,pageIndex:F-1,rect:y.slice(0),rotation:A,annotationElementId:S,id:S,deleted:!1,popupRef:D,richText:P,comment:L?.str||null,creationDate:R,modificationDate:V}}const{color:o,quadPoints:l,inkLists:c,opacity:h}=t,f=await super.deserialize(t,e,n);f.color=Xt.makeHexColor(...o),f.opacity=h||1,c&&(f.#g=t.thickness),f._initialData=r,t.comment&&f.setCommentData(t);const[g,p]=f.pageDimensions,[m,v]=f.pageTranslation;if(l){const b=f.#i=[];for(let y=0;y<l.length;y+=8)b.push({x:(l[y]-m)/g,y:1-(l[y+1]-v)/p,width:(l[y+2]-l[y])/g,height:(l[y+1]-l[y+5])/p});f.#x(),f.#_(),f.rotate(f.rotation)}else if(c){f.#h=!0;const b=c[0],y={x:b[0]-m,y:p-(b[1]-v)},A=new m0(y,[0,0,g,p],1,f.#g/2,!0,.001);for(let E=0,D=b.length;E<D;E+=2)y.x=b[E]-m,y.y=p-(b[E+1]-v),A.add(y);const{id:S,clipPathId:w}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:A.toSVGPath()}},!0,!0);f.#y({highlightOutlines:A.getOutlines(),highlightId:S,clipPathId:w}),f.#_(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=Qt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(t);return Object.assign(n,{color:e,opacity:this.opacity,thickness:this.#g,quadPoints:this.#B(),outlines:this.#P(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#F(n)?null:(n.id=this.annotationElementId,n)}#F(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((n,r)=>n!==e[r])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Z2{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Ue("Not implemented")}}class Se extends Qt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#s=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#r(t),this.#c())}#r({drawOutlines:t,drawId:e,drawingOptions:n}){this.#t=t,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#a(t,this.parent),this.#h(t.box)}#a(t,e){const{id:n}=e.drawLayer.draw(Se._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(t,e){const n=new Set(Object.keys(t));for(const[r,o]of Object.entries(e))n.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){Ue("Not implemented")}static get typesMap(){Ue("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,e),this._currentParent&&(Se.#i.updateProperty(n,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[n,r]of this.typesMap)t.push([n,e[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[n,r]of this.constructor.typesMap)t.push([n,e[r]]);return t}_updateProperty(t,e,n){const r=this._drawingOptions,o=r[e],l=c=>{r.updateProperty(e,c);const h=this.#t.updateProperty(e,c);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#f()),{bbox:this.#d()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#f()),{bbox:this.#d()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#d()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#f(),this.parentDimensions),{bbox:this.#d()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#a(this.#t,t)}}#l([t,e,n,r]){const{parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[e,1-t,n*(l/o),r*(o/l)];case 180:return[1-t,1-e,n,r];case 270:return[1-e,t,n*(l/o),r*(o/l)];default:return[t,e,n,r]}}#f(){const{x:t,y:e,width:n,height:r,parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[1-e,t,n*(o/l),r*(l/o)];case 180:return[1-t,1-e,n,r];case 270:return[e,1-t,n*(o/l),r*(l/o)];default:return[t,e,n,r]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#d(){const{x:t,y:e,width:n,height:r,rotation:o,parentRotation:l,parentDimensions:[c,h]}=this;switch((o*4+l)/90){case 1:return[1-e-r,t,r,n];case 2:return[1-t-n,1-e-r,n,r];case 3:return[e,1-t-n,r,n];case 4:return[t,e-n*(c/h),r*(h/c),n*(c/h)];case 5:return[1-e,t,n*(c/h),r*(h/c)];case 6:return[1-t-r*(h/c),1-e,r*(h/c),n*(c/h)];case 7:return[e-n*(c/h),1-t-r*(h/c),n*(c/h),r*(h/c)];case 8:return[t-n,e-r,n,r];case 9:return[1-e,t-n,r,n];case 10:return[1-t,1-e,n,r];case 11:return[e-r,1-t,r,n];case 12:return[t-r*(h/c),e,r*(h/c),n*(c/h)];case 13:return[1-e-n*(c/h),t-r*(h/c),n*(c/h),r*(h/c)];case 14:return[1-t,1-e-n*(c/h),r*(h/c),n*(c/h)];case 15:return[e,1-t,n*(c/h),r*(h/c)];default:return[t,e,n,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties({bbox:this.#d()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const n=super.render();n.classList.add("draw");const r=document.createElement("div");return n.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),n}static createDrawerInstance(t,e,n,r,o){Ue("Not implemented")}static startDrawing(t,e,n,r){const{target:o,offsetX:l,offsetY:c,pointerId:h,pointerType:f}=r;if(we.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:g}}=t,{width:p,height:m}=o.getBoundingClientRect(),v=Se.#n=new AbortController,b=t.combinedSignal(v);if(we.setPointer(f,h),window.addEventListener("pointerup",y=>{we.isSamePointerIdOrRemove(y.pointerId)&&this._endDraw(y)},{signal:b}),window.addEventListener("pointercancel",y=>{we.isSamePointerIdOrRemove(y.pointerId)&&this._currentParent.endDrawingSession()},{signal:b}),window.addEventListener("pointerdown",y=>{we.isSamePointerType(y.pointerType)&&(we.initializeAndAddPointerId(y.pointerId),Se.#i.isCancellable()&&(Se.#i.removeLastElement(),Se.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",Vi,{signal:b}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:b}),o.addEventListener("touchmove",y=>{we.isSameTimeStamp(y.timeStamp)&&tn(y)},{signal:b}),t.toggleDrawing(),e._editorUndoBar?.hide(),Se.#i){t.drawLayer.updateProperties(this._currentDrawId,Se.#i.startNew(l,c,p,m,g));return}e.updateUIForDefaultProperties(this),Se.#i=this.createDrawerInstance(l,c,p,m,g),Se.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Se.#s.toSVGProperties(),Se.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(we.isSameTimeStamp(t.timeStamp),!Se.#i)return;const{offsetX:e,offsetY:n,pointerId:r}=t;if(we.isSamePointerId(r)){if(we.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Se.#i.add(e,n)),we.setTimeStamp(t.timeStamp),tn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Se.#i=null,Se.#s=null,we.clearTimeStamp()),Se.#n&&(Se.#n.abort(),Se.#n=null,we.clearPointerIds())}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Se.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=Se.#i,r=this._currentDrawId,o=n.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(r,n.setLastElement(o))},undo:()=>{e.drawLayer.updateProperties(r,n.removeLastElement())},mustExec:!1,type:pe.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(pe.DRAW_STEP),!Se.#i.isEmpty()){const{pageDimensions:[n,r],scale:o}=e,l=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Se.#i.getOutlines(n*o,r*o,o,this._INNER_MARGIN),drawingOptions:Se.#s,mustBeCommitted:!t});return this._cleanup(!0),l}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,n,r,o,l){Ue("Not implemented")}static async deserialize(t,e,n){const{rawDims:{pageWidth:r,pageHeight:o,pageX:l,pageY:c}}=e.viewport,h=this.deserializeDraw(l,c,r,o,this._INNER_MARGIN,t),f=await super.deserialize(t,e,n);return f.createDrawingOptions(t),f.#r({drawOutlines:h}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,n]=this.pageTranslation,[r,o]=this.pageDimensions;return this.#t.serialize([e,n,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class ZS{#t=new Float64Array(6);#e;#i;#n;#s;#r;#a="";#o=0;#c=new tc;#l;#f;constructor(t,e,n,r,o,l){this.#l=n,this.#f=r,this.#n=o,this.#s=l,[t,e]=this.#h(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#i=[{line:c,points:this.#r}],this.#t.set(c,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#h(t,e){return Kt._normalizePoint(t,e,this.#l,this.#f,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#h(t,e);const[n,r,o,l]=this.#t.subarray(2,6),c=t-o,h=e-l;return Math.hypot(this.#l*c,this.#f*h)<=2?null:(this.#r.push(t,e),isNaN(n)?(this.#t.set([o,l,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([n,r,o,l,t,e],0),this.#e.push(...Kt.createBezierPoints(n,r,o,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,r,o){this.#l=n,this.#f=r,this.#n=o,[t,e]=this.#h(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const c=this.#i.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#i.push({line:l,points:this.#r}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#a="";for(let t=0,e=this.#i.length;t<e;t++){const{line:n,points:r}=this.#i[t];this.#e=n,this.#r=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=Kt.svgRound(this.#e[4]),e=Kt.svgRound(this.#e[5]);if(this.#r.length===2)return this.#a=`${this.#a} M ${t} ${e} Z`,this.#a;if(this.#r.length<=6){const r=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,r)} M ${t} ${e}`,this.#o=6}if(this.#r.length===4){const r=Kt.svgRound(this.#e[10]),o=Kt.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${r} ${o}`,this.#o=12,this.#a}const n=[];this.#o===0&&(n.push(`M ${t} ${e}`),this.#o=6);for(let r=this.#o,o=this.#e.length;r<o;r+=6){const[l,c,h,f,g,p]=this.#e.slice(r,r+6).map(Kt.svgRound);n.push(`C${l} ${c} ${h} ${f} ${g} ${p}`)}return this.#a+=n.join(" "),this.#o=this.#e.length,this.#a}getOutlines(t,e,n,r){const o=this.#i.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#i,t,e,n,this.#n,this.#s,r),this.#t=null,this.#e=null,this.#i=null,this.#a=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class tc extends Kt{#t;#e=0;#i;#n;#s;#r;#a;#o;#c;build(t,e,n,r,o,l,c){this.#s=e,this.#r=n,this.#a=r,this.#o=o,this.#c=l,this.#i=c??0,this.#n=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${Kt.svgRound(e[4])} ${Kt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${Kt.svgRound(e[10])} ${Kt.svgRound(e[11])}`);continue}for(let n=6,r=e.length;n<r;n+=6){const[o,l,c,h,f,g]=e.subarray(n,n+6).map(Kt.svgRound);t.push(`C${o} ${l} ${c} ${h} ${f} ${g}`)}}return t.join("")}serialize([t,e,n,r],o){const l=[],c=[],[h,f,g,p]=this.#f();let m,v,b,y,A,S,w,E,D;switch(this.#o){case 0:D=Kt._rescale,m=t,v=e+r,b=n,y=-r,A=t+h*n,S=e+(1-f-p)*r,w=t+(h+g)*n,E=e+(1-f)*r;break;case 90:D=Kt._rescaleAndSwap,m=t,v=e,b=n,y=r,A=t+f*n,S=e+h*r,w=t+(f+p)*n,E=e+(h+g)*r;break;case 180:D=Kt._rescale,m=t+n,v=e,b=-n,y=r,A=t+(1-h-g)*n,S=e+f*r,w=t+(1-h)*n,E=e+(f+p)*r;break;case 270:D=Kt._rescaleAndSwap,m=t+n,v=e+r,b=-n,y=-r,A=t+(1-f-p)*n,S=e+(1-h-g)*r,w=t+(1-f)*n,E=e+(1-h)*r;break}for(const{line:P,points:L}of this.#n)l.push(D(P,m,v,b,y,o?new Array(P.length):null)),c.push(D(L,m,v,b,y,o?new Array(L.length):null));return{lines:l,points:c,rect:[A,S,w,E]}}static deserialize(t,e,n,r,o,{paths:{lines:l,points:c},rotation:h,thickness:f}){const g=[];let p,m,v,b,y;switch(h){case 0:y=Kt._rescale,p=-t/n,m=e/r+1,v=1/n,b=-1/r;break;case 90:y=Kt._rescaleAndSwap,p=-e/r,m=-t/n,v=1/r,b=1/n;break;case 180:y=Kt._rescale,p=t/n+1,m=-e/r,v=-1/n,b=1/r;break;case 270:y=Kt._rescaleAndSwap,p=e/r+1,m=t/n+1,v=-1/r,b=-1/n;break}if(!l){l=[];for(const S of c){const w=S.length;if(w===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1]]));continue}if(w===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1],NaN,NaN,NaN,NaN,S[2],S[3]]));continue}const E=new Float32Array(3*(w-2));l.push(E);let[D,P,L,R]=S.subarray(0,4);E.set([NaN,NaN,NaN,NaN,D,P],0);for(let V=4;V<w;V+=2){const F=S[V],Z=S[V+1];E.set(Kt.createBezierPoints(D,P,L,R,F,Z),(V-2)*3),[D,P,L,R]=[L,R,F,Z]}}}for(let S=0,w=l.length;S<w;S++)g.push({line:y(l[S].map(E=>E??NaN),p,m,v,b),points:y(c[S].map(E=>E??NaN),p,m,v,b)});const A=new this.prototype.constructor;return A.build(g,n,r,1,h,f,o),A}#l(t=this.#c){const e=this.#i+t/2*this.#a;return this.#o%180===0?[e/this.#s,e/this.#r]:[e/this.#r,e/this.#s]}#f(){const[t,e,n,r]=this.#t,[o,l]=this.#l(0);return[t+o,e+l,n-2*o,r-2*l]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#n){if(r.length<=12){for(let c=4,h=r.length;c<h;c+=6)Xt.pointBoundingBox(r[c],r[c+1],t);continue}let o=r[4],l=r[5];for(let c=6,h=r.length;c<h;c+=6){const[f,g,p,m,v,b]=r.subarray(c,c+6);Xt.bezierBoundingBox(o,l,f,g,p,m,v,b,t),o=v,l=b}}const[e,n]=this.#l();t[0]=Yn(t[0]-e,0,1),t[1]=Yn(t[1]-n,0,1),t[2]=Yn(t[2]+e,0,1),t[3]=Yn(t[3]+n,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#d(e):null}#d(t){const[e,n]=this.#l();this.#c=t;const[r,o]=this.#l(),[l,c]=[r-e,o-n],h=this.#t;return h[0]-=l,h[1]-=c,h[2]+=2*l,h[3]+=2*c,h}updateParentDimensions([t,e],n){const[r,o]=this.#l();this.#s=t,this.#r=e,this.#a=n;const[l,c]=this.#l(),h=l-r,f=c-o,g=this.#t;return g[0]-=h,g[1]-=f,g[2]+=2*h,g[3]+=2*f,g}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(Kt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Kt.svgRound(t)} ${Kt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let n=0,r=0,o=0,l=0,c=0,h=0;switch(this.#e){case 90:r=e/t,o=-t/e,c=t;break;case 180:n=-1,l=-1,c=t,h=e;break;case 270:r=-e/t,o=t/e,h=e;break;default:return""}return`matrix(${n} ${r} ${o} ${l} ${Kt.svgRound(c)} ${Kt.svgRound(h)})`}getPathResizingSVGProperties([t,e,n,r]){const[o,l]=this.#l(),[c,h,f,g]=this.#t;if(Math.abs(f-o)<=Kt.PRECISION||Math.abs(g-l)<=Kt.PRECISION){const y=t+n/2-(c+f/2),A=e+r/2-(h+g/2);return{path:{"transform-origin":`${Kt.svgRound(t)} ${Kt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${y} ${A})`}}}const p=(n-2*o)/(f-2*o),m=(r-2*l)/(g-2*l),v=f/n,b=g/r;return{path:{"transform-origin":`${Kt.svgRound(c)} ${Kt.svgRound(h)}`,transform:`${this.rotationTransform} scale(${v} ${b}) translate(${Kt.svgRound(o)} ${Kt.svgRound(l)}) scale(${p} ${m}) translate(${Kt.svgRound(-o)} ${Kt.svgRound(-l)})`}}}getPathResizedSVGProperties([t,e,n,r]){const[o,l]=this.#l(),c=this.#t,[h,f,g,p]=c;if(c[0]=t,c[1]=e,c[2]=n,c[3]=r,Math.abs(g-o)<=Kt.PRECISION||Math.abs(p-l)<=Kt.PRECISION){const A=t+n/2-(h+g/2),S=e+r/2-(f+p/2);for(const{line:w,points:E}of this.#n)Kt._translate(w,A,S,w),Kt._translate(E,A,S,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Kt.svgRound(t)} ${Kt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(n-2*o)/(g-2*o),v=(r-2*l)/(p-2*l),b=-m*(h+o)+t+o,y=-v*(f+l)+e+l;if(m!==1||v!==1||b!==0||y!==0)for(const{line:A,points:S}of this.#n)Kt._rescale(A,b,y,m,v,A),Kt._rescale(S,b,y,m,v,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Kt.svgRound(t)} ${Kt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],n){const[r,o]=n,l=this.#t,c=t-l[0],h=e-l[1];if(this.#s===r&&this.#r===o)for(const{line:f,points:g}of this.#n)Kt._translate(f,c,h,f),Kt._translate(g,c,h,g);else{const f=this.#s/r,g=this.#r/o;this.#s=r,this.#r=o;for(const{line:p,points:m}of this.#n)Kt._rescale(p,c,h,f,g,p),Kt._rescale(m,c,h,f,g,m);l[2]*=f,l[3]*=g}return l[0]=t,l[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Kt.svgRound(t)} ${Kt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Kt.svgRound(t[0])} ${Kt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class gh extends Z2{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Qt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new gh(this._viewParameters);return t.updateAll(this),t}}class L0 extends Se{static _type="ink";static _editorType=se.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Qt.initialize(t,e),this._defaultDrawingOptions=new gh(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return re(this,"typesMap",new Map([[pe.INK_THICKNESS,"stroke-width"],[pe.INK_COLOR,"stroke"],[pe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,n,r,o){return new ZS(t,e,n,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,n,r,o,l){return tc.deserialize(t,e,n,r,o,l)}static async deserialize(t,e,n){let r=null;if(t instanceof N0){const{data:{inkLists:l,rect:c,rotation:h,id:f,color:g,opacity:p,borderStyle:{rawWidth:m},popupRef:v,richText:b,contentsObj:y,creationDate:A,modificationDate:S},parent:{page:{pageNumber:w}}}=t;r=t={annotationType:se.INK,color:Array.from(g),thickness:m,opacity:p,paths:{points:l},boxes:null,pageIndex:w-1,rect:c.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:v,richText:b,comment:y?.str||null,creationDate:A,modificationDate:S}}const o=await super.deserialize(t,e,n);return o._initialData=r,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||=new zl(this),[["colorPicker",this._colorPicker]]}get colorType(){return pe.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:n}=this;e.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:n}){this._drawingOptions=L0.getDefaultDrawingOptions({stroke:Xt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:n}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":o,"stroke-width":l}}=this,c=Object.assign(super.serialize(t),{color:Qt._colorManager.convert(r),opacity:o,thickness:l,paths:{lines:e,points:n}});return this.addComment(c),t?(c.isCopy=!0,c):this.annotationElementId&&!this.#t(c)?null:(c.id=this.annotationElementId,c)}#t(t){const{color:e,thickness:n,opacity:r,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,c)=>l!==e[c])||t.thickness!==n||t.opacity!==r||t.pageIndex!==o}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:n}=this.serializeDraw(!1);return t.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class v0 extends tc{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Ou=8,Sl=3;class ao{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,n,r){return n-=t,r-=e,n===0?r>0?0:4:n===1?r+6:2-r}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,n,r,o,l,c){const h=this.#e(n,r,o,l);for(let f=0;f<8;f++){const g=(-f+h-c+16)%8,p=this.#i[2*g],m=this.#i[2*g+1];if(t[(n+p)*e+(r+m)]!==0)return g}return-1}static#s(t,e,n,r,o,l,c){const h=this.#e(n,r,o,l);for(let f=0;f<8;f++){const g=(f+h+c+16)%8,p=this.#i[2*g],m=this.#i[2*g+1];if(t[(n+p)*e+(r+m)]!==0)return g}return-1}static#r(t,e,n,r){const o=t.length,l=new Int32Array(o);for(let g=0;g<o;g++)l[g]=t[g]<=r?1:0;for(let g=1;g<n-1;g++)l[g*e]=l[g*e+e-1]=0;for(let g=0;g<e;g++)l[g]=l[e*n-1-g]=0;let c=1,h;const f=[];for(let g=1;g<n-1;g++){h=1;for(let p=1;p<e-1;p++){const m=g*e+p,v=l[m];if(v===0)continue;let b=g,y=p;if(v===1&&l[m-1]===0)c+=1,y-=1;else if(v>=1&&l[m+1]===0)c+=1,y+=1,v>1&&(h=v);else{v!==1&&(h=Math.abs(v));continue}const A=[p,g],S=y===p+1,w={isHole:S,points:A,id:c,parent:0};f.push(w);let E;for(const tt of f)if(tt.id===h){E=tt;break}E?E.isHole?w.parent=S?E.parent:h:w.parent=S?h:E.parent:w.parent=S?h:0;const D=this.#n(l,e,g,p,b,y,0);if(D===-1){l[m]=-c,l[m]!==1&&(h=Math.abs(l[m]));continue}let P=this.#i[2*D],L=this.#i[2*D+1];const R=g+P,V=p+L;b=R,y=V;let F=g,Z=p;for(;;){const tt=this.#s(l,e,F,Z,b,y,1);P=this.#i[2*tt],L=this.#i[2*tt+1];const I=F+P,nt=Z+L;A.push(nt,I);const O=F*e+Z;if(l[O+1]===0?l[O]=-c:l[O]===1&&(l[O]=c),I===g&&nt===p&&F===R&&Z===V){l[m]!==1&&(h=Math.abs(l[m]));break}else b=F,y=Z,F=I,Z=nt}}}return f}static#a(t,e,n,r){if(n-e<=4){for(let R=e;R<n-2;R+=2)r.push(t[R],t[R+1]);return}const o=t[e],l=t[e+1],c=t[n-4]-o,h=t[n-3]-l,f=Math.hypot(c,h),g=c/f,p=h/f,m=g*l-p*o,v=h/c,b=1/f,y=Math.atan(v),A=Math.cos(y),S=Math.sin(y),w=b*(Math.abs(A)+Math.abs(S)),E=b*(1-w+w**2),D=Math.max(Math.atan(Math.abs(S+A)*E),Math.atan(Math.abs(S-A)*E));let P=0,L=e;for(let R=e+2;R<n-2;R+=2){const V=Math.abs(m-g*t[R+1]+p*t[R]);V>P&&(L=R,P=V)}P>(f*D)**2?(this.#a(t,e,L+2,r),this.#a(t,L,n,r)):r.push(o,l)}static#o(t){const e=[],n=t.length;return this.#a(t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e}static#c(t,e,n,r,o,l){const c=new Float32Array(l**2),h=-2*r**2,f=l>>1;for(let y=0;y<l;y++){const A=(y-f)**2;for(let S=0;S<l;S++)c[y*l+S]=Math.exp((A+(S-f)**2)/h)}const g=new Float32Array(256),p=-2*o**2;for(let y=0;y<256;y++)g[y]=Math.exp(y**2/p);const m=t.length,v=new Uint8Array(m),b=new Uint32Array(256);for(let y=0;y<n;y++)for(let A=0;A<e;A++){const S=y*e+A,w=t[S];let E=0,D=0;for(let L=0;L<l;L++){const R=y+L-f;if(!(R<0||R>=n))for(let V=0;V<l;V++){const F=A+V-f;if(F<0||F>=e)continue;const Z=t[R*e+F],tt=c[L*l+V]*g[Math.abs(Z-w)];E+=Z*tt,D+=tt}}const P=v[S]=Math.round(E/D);b[P]++}return[v,b]}static#l(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e}static#f(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let r=-1/0,o=1/0;for(let c=0,h=n.length;c<h;c++){const f=n[c]=t[c<<2];r=Math.max(r,f),o=Math.min(o,f)}const l=255/(r-o);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-o)*l;return n}static#h(t){let e,n=-1/0,r=-1/0;const o=t.findIndex(h=>h!==0);let l=o,c=o;for(e=o;e<256;e++){const h=t[e];h>n&&(e-l>r&&(r=e-l,c=e-1),n=h,l=e)}for(e=c-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#d(t){const e=t,{width:n,height:r}=t,{maxDim:o}=this.#t;let l=n,c=r;if(n>o||r>o){let m=n,v=r,b=Math.log2(Math.max(n,r)/o);const y=Math.floor(b);b=b===y?y-1:y;for(let S=0;S<b;S++){l=Math.ceil(m/2),c=Math.ceil(v/2);const w=new OffscreenCanvas(l,c);w.getContext("2d").drawImage(t,0,0,m,v,0,0,l,c),m=l,v=c,t!==e&&t.close(),t=w.transferToImageBitmap()}const A=Math.min(o/l,o/c);l=Math.round(l*A),c=Math.round(c*A)}const f=new OffscreenCanvas(l,c).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,c),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,l,c);const g=f.getImageData(0,0,l,c).data;return[this.#f(g),l,c]}static extractContoursFromText(t,{fontFamily:e,fontStyle:n,fontWeight:r},o,l,c,h){let f=new OffscreenCanvas(1,1),g=f.getContext("2d",{alpha:!1});const p=200,m=g.font=`${n} ${r} ${p}px ${e}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:b,actualBoundingBoxAscent:y,actualBoundingBoxDescent:A,fontBoundingBoxAscent:S,fontBoundingBoxDescent:w,width:E}=g.measureText(t),D=1.5,P=Math.ceil(Math.max(Math.abs(v)+Math.abs(b)||0,E)*D),L=Math.ceil(Math.max(Math.abs(y)+Math.abs(A)||p,Math.abs(S)+Math.abs(w)||p)*D);f=new OffscreenCanvas(P,L),g=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=m,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,P,L),g.fillStyle="black",g.fillText(t,P*(D-1)/2,L*(3-D)/2);const R=this.#f(g.getImageData(0,0,P,L).data),V=this.#l(R),F=this.#h(V),Z=this.#r(R,P,L,F);return this.processDrawnLines({lines:{curves:Z,width:P,height:L},pageWidth:o,pageHeight:l,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,e,n,r,o){const[l,c,h]=this.#d(t),[f,g]=this.#c(l,c,h,Math.hypot(c,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),p=this.#h(g),m=this.#r(f,c,h,p);return this.processDrawnLines({lines:{curves:m,width:c,height:h},pageWidth:e,pageHeight:n,rotation:r,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:r,innerMargin:o,mustSmooth:l,areContours:c}){r%180!==0&&([e,n]=[n,e]);const{curves:h,width:f,height:g}=t,p=t.thickness??0,m=[],v=Math.min(e/f,n/g),b=v/e,y=v/n,A=[];for(const{points:w}of h){const E=l?this.#o(w):w;if(!E)continue;A.push(E);const D=E.length,P=new Float32Array(D),L=new Float32Array(3*(D===2?2:D-2));if(m.push({line:L,points:P}),D===2){P[0]=E[0]*b,P[1]=E[1]*y,L.set([NaN,NaN,NaN,NaN,P[0],P[1]],0);continue}let[R,V,F,Z]=E;R*=b,V*=y,F*=b,Z*=y,P.set([R,V,F,Z],0),L.set([NaN,NaN,NaN,NaN,R,V],0);for(let tt=4;tt<D;tt+=2){const I=P[tt]=E[tt]*b,nt=P[tt+1]=E[tt+1]*y;L.set(Kt.createBezierPoints(R,V,F,Z,I,nt),(tt-2)*3),[R,V,F,Z]=[F,Z,I,nt]}}if(m.length===0)return null;const S=c?new v0:new tc;return S.build(m,e,n,1,r,c?0:p,o),{outline:S,newCurves:A,areContours:c,thickness:p,width:f,height:g}}static async compressSignature({outlines:t,areContours:e,thickness:n,width:r,height:o}){let l=1/0,c=-1/0,h=0;for(const E of t){h+=E.length;for(let D=2,P=E.length;D<P;D++){const L=E[D]-E[D-2];l=Math.min(l,L),c=Math.max(c,L)}}let f;l>=-128&&c<=127?f=Int8Array:l>=-32768&&c<=32767?f=Int16Array:f=Int32Array;const g=t.length,p=Ou+Sl*g,m=new Uint32Array(p);let v=0;m[v++]=p*Uint32Array.BYTES_PER_ELEMENT+(h-2*g)*f.BYTES_PER_ELEMENT,m[v++]=0,m[v++]=r,m[v++]=o,m[v++]=e?0:1,m[v++]=Math.max(0,Math.floor(n??0)),m[v++]=g,m[v++]=f.BYTES_PER_ELEMENT;for(const E of t)m[v++]=E.length-2,m[v++]=E[0],m[v++]=E[1];const b=new CompressionStream("deflate-raw"),y=b.writable.getWriter();await y.ready,y.write(m);const A=f.prototype.constructor;for(const E of t){const D=new A(E.length-2);for(let P=2,L=E.length;P<L;P++)D[P-2]=E[P]-E[P-2];y.write(D)}y.close();const S=await new Response(b.readable).arrayBuffer(),w=new Uint8Array(S);return S2(w)}static async decompressSignature(t){try{const e=fA(t),{readable:n,writable:r}=new DecompressionStream("deflate-raw"),o=r.getWriter();await o.ready,o.write(e).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,c=0;for await(const E of n)l||=new Uint8Array(new Uint32Array(E.buffer,0,4)[0]),l.set(E,c),c+=E.length;const h=new Uint32Array(l.buffer,0,l.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const g=h[2],p=h[3],m=h[4]===0,v=h[5],b=h[6],y=h[7],A=[],S=(Ou+Sl*b)*Uint32Array.BYTES_PER_ELEMENT;let w;switch(y){case Int8Array.BYTES_PER_ELEMENT:w=new Int8Array(l.buffer,S);break;case Int16Array.BYTES_PER_ELEMENT:w=new Int16Array(l.buffer,S);break;case Int32Array.BYTES_PER_ELEMENT:w=new Int32Array(l.buffer,S);break}c=0;for(let E=0;E<b;E++){const D=h[Sl*E+Ou],P=new Float32Array(D+2);A.push(P);for(let L=0;L<Sl-1;L++)P[L]=h[Sl*E+Ou+L+1];for(let L=0;L<D;L++)P[L+2]=P[L]+w[c++]}return{areContours:m,thickness:v,outlines:A,width:g,height:p}}catch(e){return ae(`decompressSignature: ${e}`),null}}}class B0 extends Z2{constructor(){super(),super.updateProperties({fill:Qt._defaultLineColor,"stroke-width":0})}clone(){const t=new B0;return t.updateAll(this),t}}class I0 extends gh{constructor(t){super(t),super.updateProperties({stroke:Qt._defaultLineColor,"stroke-width":1})}clone(){const t=new I0(this._viewParameters);return t.updateAll(this),t}}class ga extends Se{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=se.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Qt.initialize(t,e),this._defaultDrawingOptions=new B0,this._defaultDrawnSignatureOptions=new I0(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return re(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:r,mustSmooth:o,areContours:l,description:c,uuid:h,heightInPage:f}=this.#i,{rawDims:{pageWidth:g,pageHeight:p},rotation:m}=this.parent.viewport,v=ao.processDrawnLines({lines:r,pageWidth:g,pageHeight:p,rotation:m,innerMargin:ga._INNER_MARGIN,mustSmooth:o,areContours:l});this.addSignature(v,f,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:n,width:r,height:o}=this.#i,l=Math.max(r,o),c=ao.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:n,width:r,height:o},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,n,r){const{x:o,y:l}=this,{outline:c}=this.#i=t;this.#t=c instanceof v0,this.description=n;let h;this.#t?h=ga.getDefaultDrawingOptions():(h=ga._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[,f]=this.pageDimensions;let g=e/f;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(),this.x=o,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:r}=this.parent.viewport;return ao.process(t,e,n,r,ga._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:n,pageHeight:r},rotation:o}=this.parent.viewport;return ao.extractContoursFromText(t,e,n,r,o,ga._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:r}=this.parent.viewport;return ao.processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:r,innerMargin:ga._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=ga.getDefaultDrawingOptions():(this._drawingOptions=ga._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:n}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:r});return this.addComment(o),t?(o.paths={lines:e,points:n},o.uuid=this.#n,o.isCopy=!0):o.lines=e,this.#e&&(o.accessibilityData={type:"Figure",alt:this.#e}),o}static deserializeDraw(t,e,n,r,o,l){return l.areContours?v0.deserialize(t,e,n,r,o,l):tc.deserialize(t,e,n,r,o,l)}static async deserialize(t,e,n){const r=await super.deserialize(t,e,n);return r.#t=t.areContours,r.description=t.accessibilityData?.alt||"",r.#n=t.uuid,r}}class JS extends Qt{#t=null;#e=null;#i=null;#n=null;#s=null;#r="";#a=null;#o=!1;#c=null;#l=!1;#f=!1;static _type="stamp";static _editorType=se.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Qt.initialize(t,e)}static isHandlingMimeForPasting(t){return l0.includes(t)}static paste(t,e){e.pasteEditor({mode:se.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#r=t.file.name),this.#p()}#d(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:r,width:o,height:l,channels:r.length/(o*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),e&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(n=>this.#h(n,!0)).finally(()=>this.#d());return}if(this.#n){const n=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(n).then(r=>this.#h(r)).finally(()=>this.#d());return}if(this.#s){const n=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(n).then(r=>this.#h(r)).finally(()=>this.#d());return}const t=document.createElement("input");t.type="file",t.accept=l0.join(",");const e=this._uiManager._signal;this.#i=new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}n()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:e})}).finally(()=>this.#d()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#s||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:n,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#e=n,r&&(this.#t=r),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#g()},t)}#p(){const{div:t}=this;let{width:e,height:n}=this.#t;const[r,o]=this.pageDimensions,l=.75;if(this.width)e=this.width*r,n=this.height*o;else if(e>l*r||n>l*o){const h=Math.min(l*r/e,l*o/n);e*=h,n*=h}this._uiManager.enableWaiting(!1);const c=this.#a=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=e/r,this.height=n/o,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#g(),this.#f||(this.parent.addUndoableEditor(this),this.#f=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,n=!1){t||(t=224);const{width:r,height:o}=this.#t,l=new va;let c=this.#t,h=r,f=o,g=null;if(e){if(r>e||o>e){const L=Math.min(e/r,e/o);h=Math.floor(r*L),f=Math.floor(o*L)}g=document.createElement("canvas");const m=g.width=Math.ceil(h*l.sx),v=g.height=Math.ceil(f*l.sy);this.#l||(c=this.#u(m,v));const b=g.getContext("2d");b.filter=this._uiManager.hcmFilter;let y="white",A="#cfcfd8";this._uiManager.hcmFilter!=="none"?A="black":yA.isDarkMode&&(y="#8f8f9d",A="#42414d");const S=15,w=S*l.sx,E=S*l.sy,D=new OffscreenCanvas(w*2,E*2),P=D.getContext("2d");P.fillStyle=y,P.fillRect(0,0,w*2,E*2),P.fillStyle=A,P.fillRect(0,0,w,E),P.fillRect(w,E,w,E),b.fillStyle=b.createPattern(D,"repeat"),b.fillRect(0,0,m,v),b.drawImage(c,0,0,c.width,c.height,0,0,m,v)}let p=null;if(n){let m,v;if(l.symmetric&&c.width<t&&c.height<t)m=c.width,v=c.height;else if(c=this.#t,r>t||o>t){const A=Math.min(t/r,t/o);m=Math.floor(r*A),v=Math.floor(o*A),this.#l||(c=this.#u(m,v))}const y=new OffscreenCanvas(m,v).getContext("2d",{willReadFrequently:!0});y.drawImage(c,0,0,c.width,c.height,0,0,m,v),p={width:m,height:v,data:y.getImageData(0,0,m,v).data}}return{canvas:g,width:h,height:f,imageData:p}}#u(t,e){const{width:n,height:r}=this.#t;let o=n,l=r,c=this.#t;for(;o>2*t||l>2*e;){const h=o,f=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const g=new OffscreenCanvas(o,l);g.getContext("2d").drawImage(c,0,0,h,f,0,0,o,l),c=g.transferToImageBitmap()}return c}#g(){const[t,e]=this.parentDimensions,{width:n,height:r}=this,o=new va,l=Math.ceil(n*t*o.sx),c=Math.ceil(r*e*o.sy),h=this.#a;if(!h||h.width===l&&h.height===c)return;h.width=l,h.height=c;const f=this.#l?this.#t:this.#u(l,c),g=h.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(f,0,0,f.width,f.height,0,0,l,c)}#v(t){if(t){if(this.#l){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,n]=this.pageDimensions,r=Math.round(this.width*e*_o.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*_o.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(r,o);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,o),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,n){let r=null,o=!1;if(t instanceof q2){const{data:{rect:y,rotation:A,id:S,structParent:w,popupRef:E,richText:D,contentsObj:P,creationDate:L,modificationDate:R},container:V,parent:{page:{pageNumber:F}},canvas:Z}=t;let tt,I;Z?(delete t.canvas,{id:tt,bitmap:I}=n.imageManager.getFromCanvas(V.id,Z),Z.remove()):(o=!0,t._hasNoCanvas=!0);const nt=(await e._structTree.getAriaAttributes(`${so}${S}`))?.get("aria-label")||"";r=t={annotationType:se.STAMP,bitmapId:tt,bitmap:I,pageIndex:F-1,rect:y.slice(0),rotation:A,annotationElementId:S,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:nt},isSvg:!1,structParent:w,popupRef:E,richText:D,comment:P?.str||null,creationDate:L,modificationDate:R}}const l=await super.deserialize(t,e,n),{rect:c,bitmap:h,bitmapUrl:f,bitmapId:g,isSvg:p,accessibilityData:m}=t;o?(n.addMissingCanvas(t.id,l),l.#o=!0):g&&n.imageManager.isValidId(g)?(l.#e=g,h&&(l.#t=h)):l.#n=f,l.#l=p;const[v,b]=l.pageDimensions;return l.width=(c[2]-c[0])/v,l.height=(c[3]-c[1])/b,m&&(l.altTextData=m),l._initialData=r,t.comment&&l.setCommentData(t),l.#f=!!r,l}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(n),t)return n.bitmapUrl=this.#v(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(n.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=this.#x(n);return c.isSame?null:(c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(e===null)return n;e.stamps||=new Map;const l=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:l,serialized:n}),n.bitmap=this.#v(!1);else if(this.#l){const c=e.stamps.get(this.#e);l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=this.#v(!1))}return n}#x(t){const{pageIndex:e,accessibilityData:{altText:n}}=this._initialData,r=t.pageIndex===e,o=(t.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Ha{#t;#e=!1;#i=null;#n=null;#s=null;#r=new Map;#a=!1;#o=!1;#c=!1;#l=null;#f=null;#h=null;#d=null;#m=null;#p=-1;#u;static _initialized=!1;static#g=new Map([Sn,L0,JS,on,ga].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:r,accessibilityManager:o,annotationLayer:l,drawLayer:c,textLayer:h,viewport:f,l10n:g}){const p=[...Ha.#g.values()];if(!Ha._initialized){Ha._initialized=!0;for(const m of p)m.initialize(g,t)}t.registerEditorTypes(p),this.#u=t,this.pageIndex=e,this.div=n,this.#t=o,this.#i=l,this.viewport=f,this.#h=h,this.drawLayer=c,this._structTree=r,this.#u.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===se.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#b(),t){case se.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case se.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case se.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===se.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const n of Ha.#g.values())e.toggle(`${n._type}Editing`,t===n._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.togglePointerEvents(t)}get#v(){return this.#r.size!==0?this.#r.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const n of this.#v)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#u.removeChangedExistingAnnotation(n),t.add(n.annotationElementId));const e=this.#i;if(e)for(const n of e.getEditableAnnotations()){if(n.hide(),this.#u.isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const r=await this.deserialize(n);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const r=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",o=>{const{clientX:c,clientY:h,timeStamp:f}=o,g=this.#p;if(f-g>500){this.#p=f;return}this.#p=-1;const{classList:p}=this.div;p.toggle("getElements",!0);const m=document.elementsFromPoint(c,h);if(p.toggle("getElements",!1),!this.div.contains(m[0]))return;let v;const b=new RegExp(`^${Ll}[0-9]+$`);for(const A of m)if(b.test(A.id)){v=A.id;break}if(!v)return;const y=this.#r.get(v);y?.annotationElementId===null&&(o.stopPropagation(),o.preventDefault(),y.dblclick(o))},{signal:r,capture:!0})}const t=this.#i,e=[];if(t){const r=new Map,o=new Map;for(const c of this.#v){if(c.disableEditing(),!c.annotationElementId){e.push(c);continue}if(c.serialize()!==null){r.set(c.annotationElementId,c);continue}else o.set(c.annotationElementId,c);this.getEditableAnnotation(c.annotationElementId)?.show(),c.remove()}const l=t.getEditableAnnotations();for(const c of l){const{id:h}=c.data;if(this.#u.isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let f=o.get(h);if(f){f.resetAnnotationElement(c),f.show(!1),c.show();continue}f=r.get(h),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(c)&&f.show(!1)),c.show()}}this.#b(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const r of Ha.#g.values())n.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(e),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#d){this.#d=new AbortController;const t=this.#u.combinedSignal(this.#d);this.#h.div.addEventListener("pointerdown",this.#x.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#d&&(this.#d.abort(),this.#d=null,this.#h.div.classList.remove("highlighting"))}#x(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:n}=_n.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),on.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),Qt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getEditorByUID(t){for(const e of this.#r.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#y(){return Ha.#g.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const e=this.#y;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:n,offsetY:r}=this.#S(),o=this.getNextId(),l=this.#E({parent:this,id:o,x:n,y:r,uiManager:this.#u,isCentered:!0,...e});l&&this.add(l)}async deserialize(t){return await Ha.#g.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,n={}){const r=this.getNextId(),o=this.#E({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...n});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}#S(){const{x:t,y:e,width:n,height:r}=this.boundingClientRect,o=Math.max(0,t),l=Math.max(0,e),c=Math.min(window.innerWidth,t+n),h=Math.min(window.innerHeight,e+r),f=(o+c)/2-t,g=(l+h)/2-e,[p,m]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:p,offsetY:m}}addNewEditor(t={}){this.createAndAddNewEditor(this.#S(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=_n.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#a||(this.#a=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const n=this.#u.getMode();if(n===se.STAMP||n===se.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===se.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:e}=_n.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#a=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const n=this.#u.getActive();this.#e=!n||n.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#y.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#f=null,this.commitOrRemove())},{signal:e}),this.#y.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#f=e);return}this.#f&&setTimeout(()=>{this.#f?.focus(),this.#f=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#f=null,this.#y.endDrawing(t)):null}findNewParent(t,e,n){const r=this.#u.findParent(e,n);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#u.removeLayer(this)}#b(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,ns(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#b();const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,ns(this.div,{rotation:n}),e!==n)for(const r of this.#r.values())r.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class Pn{#t=null;#e=new Map;#i=new Map;static#n=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return re(this,"_svgFactory",new Xu)}static#s(t,[e,n,r,o]){const{style:l}=t;l.top=`${100*n}%`,l.left=`${100*e}%`,l.width=`${100*r}%`,l.height=`${100*o}%`}#r(){const t=Pn._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,e){const n=Pn._svgFactory.createElement("clipPath");t.append(n);const r=`clip_${e}`;n.setAttribute("id",r),n.setAttribute("clipPathUnits","objectBoundingBox");const o=Pn._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${e}`),o.classList.add("clip"),r}#o(t,e){for(const[n,r]of Object.entries(e))r===null?t.removeAttribute(n):t.setAttribute(n,r)}draw(t,e=!1,n=!1){const r=Pn.#n++,o=this.#r(),l=Pn._svgFactory.createElement("defs");o.append(l);const c=Pn._svgFactory.createElement("path");l.append(c);const h=`path_p${this.pageIndex}_${r}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(r,c);const f=n?this.#a(l,h):null,g=Pn._svgFactory.createElement("use");return o.append(g),g.setAttribute("href",`#${h}`),this.updateProperties(o,t),this.#e.set(r,o),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,e){const n=Pn.#n++,r=this.#r(),o=Pn._svgFactory.createElement("defs");r.append(o);const l=Pn._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const p=Pn._svgFactory.createElement("mask");o.append(p),h=`mask_p${this.pageIndex}_${n}`,p.setAttribute("id",h),p.setAttribute("maskUnits","objectBoundingBox");const m=Pn._svgFactory.createElement("rect");p.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const v=Pn._svgFactory.createElement("use");p.append(v),v.setAttribute("href",`#${c}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const f=Pn._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const g=f.cloneNode();return r.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(n,r),n}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:n,bbox:r,rootClass:o,path:l}=e,c=typeof t=="number"?this.#e.get(t):t;if(c){if(n&&this.#o(c,n),r&&Pn.#s(c,r),o){const{classList:h}=c;for(const[f,g]of Object.entries(o))h.toggle(f,g)}if(l){const f=c.firstElementChild.firstElementChild;this.#o(f,l)}}}updateParent(t,e){if(e===this)return;const n=this.#e.get(t);n&&(e.#t.append(n),this.#e.delete(t),e.#e.set(t,n))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:p0};globalThis.pdfjsLib={AbortException:wr,AnnotationEditorLayer:Ha,AnnotationEditorParamsType:pe,AnnotationEditorType:se,AnnotationEditorUIManager:Er,AnnotationLayer:F0,AnnotationMode:_r,AnnotationType:gn,applyOpacity:_A,build:kS,ColorPicker:ji,createValidAbsoluteUrl:x2,CSSConstants:xA,DOMSVGFactory:Xu,DrawLayer:Pn,FeatureTest:_n,fetchData:ql,findContrastColor:bA,getDocument:R0,getFilenameFromUrl:dA,getPdfFilenameFromUrl:gA,getRGB:Zl,getUuid:A2,getXfaPageViewport:mA,GlobalWorkerOptions:ts,ImageKind:zu,InvalidPDFException:s0,isDataScheme:hh,isPdfFile:w0,isValidExplicitDest:PA,MathClamp:Yn,noContextMenu:Vi,normalizeUnicode:uA,OPS:Bl,OutputScale:va,PasswordResponses:eA,PDFDataRangeTransport:j2,PDFDateString:o0,PDFWorker:Ul,PermissionFlag:tA,PixelsPerInch:_o,RenderingCancelledException:S0,renderRichText:E2,ResponseException:Gu,setLayerDimensions:ns,shadow:re,SignatureExtractor:ao,stopEvent:tn,SupportedImageMimeTypes:l0,TextLayer:_i,TouchManager:fh,updateUrlHash:_2,Util:Xt,VerbosityLevel:lh,version:CS,XfaLayer:w2};function Ru(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var qd={exports:{}};var Rv;function QS(){return Rv||(Rv=1,(function(i,t){(function(e){i.exports=e()})(function(){return(function e(n,r,o){function l(f,g){if(!r[f]){if(!n[f]){var p=typeof Ru=="function"&&Ru;if(!g&&p)return p(f,!0);if(c)return c(f,!0);var m=new Error("Cannot find module '"+f+"'");throw m.code="MODULE_NOT_FOUND",m}var v=r[f]={exports:{}};n[f][0].call(v.exports,function(b){var y=n[f][1][b];return l(y||b)},v,v.exports,e,n,r,o)}return r[f].exports}for(var c=typeof Ru=="function"&&Ru,h=0;h<o.length;h++)l(o[h]);return l})({1:[function(e,n,r){var o=e("./utils"),l=e("./support"),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(h){for(var f,g,p,m,v,b,y,A=[],S=0,w=h.length,E=w,D=o.getTypeOf(h)!=="string";S<h.length;)E=w-S,p=D?(f=h[S++],g=S<w?h[S++]:0,S<w?h[S++]:0):(f=h.charCodeAt(S++),g=S<w?h.charCodeAt(S++):0,S<w?h.charCodeAt(S++):0),m=f>>2,v=(3&f)<<4|g>>4,b=1<E?(15&g)<<2|p>>6:64,y=2<E?63&p:64,A.push(c.charAt(m)+c.charAt(v)+c.charAt(b)+c.charAt(y));return A.join("")},r.decode=function(h){var f,g,p,m,v,b,y=0,A=0,S="data:";if(h.substr(0,S.length)===S)throw new Error("Invalid base64 input, it looks like a data url.");var w,E=3*(h=h.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(h.charAt(h.length-1)===c.charAt(64)&&E--,h.charAt(h.length-2)===c.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=l.uint8array?new Uint8Array(0|E):new Array(0|E);y<h.length;)f=c.indexOf(h.charAt(y++))<<2|(m=c.indexOf(h.charAt(y++)))>>4,g=(15&m)<<4|(v=c.indexOf(h.charAt(y++)))>>2,p=(3&v)<<6|(b=c.indexOf(h.charAt(y++))),w[A++]=f,v!==64&&(w[A++]=g),b!==64&&(w[A++]=p);return w}},{"./support":30,"./utils":32}],2:[function(e,n,r){var o=e("./external"),l=e("./stream/DataWorker"),c=e("./stream/Crc32Probe"),h=e("./stream/DataLengthProbe");function f(g,p,m,v,b){this.compressedSize=g,this.uncompressedSize=p,this.crc32=m,this.compression=v,this.compressedContent=b}f.prototype={getContentWorker:function(){var g=new l(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new h("data_length")),p=this;return g.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),g},getCompressedWorker:function(){return new l(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(g,p,m){return g.pipe(new c).pipe(new h("uncompressedSize")).pipe(p.compressWorker(m)).pipe(new h("compressedSize")).withStreamInfo("compression",p)},n.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,n,r){var o=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,n,r){var o=e("./utils"),l=(function(){for(var c,h=[],f=0;f<256;f++){c=f;for(var g=0;g<8;g++)c=1&c?3988292384^c>>>1:c>>>1;h[f]=c}return h})();n.exports=function(c,h){return c!==void 0&&c.length?o.getTypeOf(c)!=="string"?(function(f,g,p,m){var v=l,b=m+p;f^=-1;for(var y=m;y<b;y++)f=f>>>8^v[255&(f^g[y])];return-1^f})(0|h,c,c.length,0):(function(f,g,p,m){var v=l,b=m+p;f^=-1;for(var y=m;y<b;y++)f=f>>>8^v[255&(f^g.charCodeAt(y))];return-1^f})(0|h,c,c.length,0):0}},{"./utils":32}],5:[function(e,n,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,n,r){var o=null;o=typeof Promise<"u"?Promise:e("lie"),n.exports={Promise:o}},{lie:37}],7:[function(e,n,r){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=e("pako"),c=e("./utils"),h=e("./stream/GenericWorker"),f=o?"uint8array":"array";function g(p,m){h.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=m,this.meta={}}r.magic="\b\0",c.inherits(g,h),g.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(c.transformTo(f,p.data),!1)},g.prototype.flush=function(){h.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},g.prototype.cleanUp=function(){h.prototype.cleanUp.call(this),this._pako=null},g.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(m){p.push({data:m,meta:p.meta})}},r.compressWorker=function(p){return new g("Deflate",p)},r.uncompressWorker=function(){return new g("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,n,r){function o(v,b){var y,A="";for(y=0;y<b;y++)A+=String.fromCharCode(255&v),v>>>=8;return A}function l(v,b,y,A,S,w){var E,D,P=v.file,L=v.compression,R=w!==f.utf8encode,V=c.transformTo("string",w(P.name)),F=c.transformTo("string",f.utf8encode(P.name)),Z=P.comment,tt=c.transformTo("string",w(Z)),I=c.transformTo("string",f.utf8encode(Z)),nt=F.length!==P.name.length,O=I.length!==Z.length,rt="",Q="",J="",_t=P.dir,vt=P.date,Nt={crc32:0,compressedSize:0,uncompressedSize:0};b&&!y||(Nt.crc32=v.crc32,Nt.compressedSize=v.compressedSize,Nt.uncompressedSize=v.uncompressedSize);var M=0;b&&(M|=8),R||!nt&&!O||(M|=2048);var C=0,X=0;_t&&(C|=16),S==="UNIX"?(X=798,C|=(function(j,ot){var bt=j;return j||(bt=ot?16893:33204),(65535&bt)<<16})(P.unixPermissions,_t)):(X=20,C|=(function(j){return 63&(j||0)})(P.dosPermissions)),E=vt.getUTCHours(),E<<=6,E|=vt.getUTCMinutes(),E<<=5,E|=vt.getUTCSeconds()/2,D=vt.getUTCFullYear()-1980,D<<=4,D|=vt.getUTCMonth()+1,D<<=5,D|=vt.getUTCDate(),nt&&(Q=o(1,1)+o(g(V),4)+F,rt+="up"+o(Q.length,2)+Q),O&&(J=o(1,1)+o(g(tt),4)+I,rt+="uc"+o(J.length,2)+J);var U="";return U+=`
\0`,U+=o(M,2),U+=L.magic,U+=o(E,2),U+=o(D,2),U+=o(Nt.crc32,4),U+=o(Nt.compressedSize,4),U+=o(Nt.uncompressedSize,4),U+=o(V.length,2),U+=o(rt.length,2),{fileRecord:p.LOCAL_FILE_HEADER+U+V+rt,dirRecord:p.CENTRAL_FILE_HEADER+o(X,2)+U+o(tt.length,2)+"\0\0\0\0"+o(C,4)+o(A,4)+V+rt+tt}}var c=e("../utils"),h=e("../stream/GenericWorker"),f=e("../utf8"),g=e("../crc32"),p=e("../signature");function m(v,b,y,A){h.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=y,this.encodeFileName=A,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}c.inherits(m,h),m.prototype.push=function(v){var b=v.meta.percent||0,y=this.entriesCount,A=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,h.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:y?(b+100*(y-A-1))/y:100}}))},m.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var b=this.streamFiles&&!v.file.dir;if(b){var y=l(v,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:y.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(v){this.accumulate=!1;var b=this.streamFiles&&!v.file.dir,y=l(v,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(y.dirRecord),b)this.push({data:(function(A){return p.DATA_DESCRIPTOR+o(A.crc32,4)+o(A.compressedSize,4)+o(A.uncompressedSize,4)})(v),meta:{percent:100}});else for(this.push({data:y.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var v=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var y=this.bytesWritten-v,A=(function(S,w,E,D,P){var L=c.transformTo("string",P(D));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(S,2)+o(S,2)+o(w,4)+o(E,4)+o(L.length,2)+L})(this.dirRecords.length,y,v,this.zipComment,this.encodeFileName);this.push({data:A,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(v){this._sources.push(v);var b=this;return v.on("data",function(y){b.processChunk(y)}),v.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),v.on("error",function(y){b.error(y)}),this},m.prototype.resume=function(){return!!h.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(v){var b=this._sources;if(!h.prototype.error.call(this,v))return!1;for(var y=0;y<b.length;y++)try{b[y].error(v)}catch{}return!0},m.prototype.lock=function(){h.prototype.lock.call(this);for(var v=this._sources,b=0;b<v.length;b++)v[b].lock()},n.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,n,r){var o=e("../compressions"),l=e("./ZipFileWorker");r.generateWorker=function(c,h,f){var g=new l(h.streamFiles,f,h.platform,h.encodeFileName),p=0;try{c.forEach(function(m,v){p++;var b=(function(w,E){var D=w||E,P=o[D];if(!P)throw new Error(D+" is not a valid compression method !");return P})(v.options.compression,h.compression),y=v.options.compressionOptions||h.compressionOptions||{},A=v.dir,S=v.date;v._compressWorker(b,y).withStreamInfo("file",{name:m,dir:A,date:S,comment:v.comment||"",unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions}).pipe(g)}),g.entriesCount=p}catch(m){g.error(m)}return g}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,n,r){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new o;for(var c in this)typeof this[c]!="function"&&(l[c]=this[c]);return l}}(o.prototype=e("./object")).loadAsync=e("./load"),o.support=e("./support"),o.defaults=e("./defaults"),o.version="3.10.1",o.loadAsync=function(l,c){return new o().loadAsync(l,c)},o.external=e("./external"),n.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,n,r){var o=e("./utils"),l=e("./external"),c=e("./utf8"),h=e("./zipEntries"),f=e("./stream/Crc32Probe"),g=e("./nodejsUtils");function p(m){return new l.Promise(function(v,b){var y=m.decompressed.getContentWorker().pipe(new f);y.on("error",function(A){b(A)}).on("end",function(){y.streamInfo.crc32!==m.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):v()}).resume()})}n.exports=function(m,v){var b=this;return v=o.extend(v||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:c.utf8decode}),g.isNode&&g.isStream(m)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",m,!0,v.optimizedBinaryString,v.base64).then(function(y){var A=new h(v);return A.load(y),A}).then(function(y){var A=[l.Promise.resolve(y)],S=y.files;if(v.checkCRC32)for(var w=0;w<S.length;w++)A.push(p(S[w]));return l.Promise.all(A)}).then(function(y){for(var A=y.shift(),S=A.files,w=0;w<S.length;w++){var E=S[w],D=E.fileNameStr,P=o.resolve(E.fileNameStr);b.file(P,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:v.createFolders}),E.dir||(b.file(P).unsafeOriginalName=D)}return A.zipComment.length&&(b.comment=A.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,n,r){var o=e("../utils"),l=e("../stream/GenericWorker");function c(h,f){l.call(this,"Nodejs stream input adapter for "+h),this._upstreamEnded=!1,this._bindStream(f)}o.inherits(c,l),c.prototype._bindStream=function(h){var f=this;(this._stream=h).pause(),h.on("data",function(g){f.push({data:g,meta:{percent:0}})}).on("error",function(g){f.isPaused?this.generatedError=g:f.error(g)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},c.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},c.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=c},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,n,r){var o=e("readable-stream").Readable;function l(c,h,f){o.call(this,h),this._helper=c;var g=this;c.on("data",function(p,m){g.push(p)||g._helper.pause(),f&&f(m)}).on("error",function(p){g.emit("error",p)}).on("end",function(){g.push(null)})}e("../utils").inherits(l,o),l.prototype._read=function(){this._helper.resume()},n.exports=l},{"../utils":32,"readable-stream":16}],14:[function(e,n,r){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,l);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,l)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var l=new Buffer(o);return l.fill(0),l},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(e,n,r){function o(P,L,R){var V,F=c.getTypeOf(L),Z=c.extend(R||{},g);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(P=S(P)),Z.createFolders&&(V=A(P))&&w.call(this,V,!0);var tt=F==="string"&&Z.binary===!1&&Z.base64===!1;R&&R.binary!==void 0||(Z.binary=!tt),(L instanceof p&&L.uncompressedSize===0||Z.dir||!L||L.length===0)&&(Z.base64=!1,Z.binary=!0,L="",Z.compression="STORE",F="string");var I=null;I=L instanceof p||L instanceof h?L:b.isNode&&b.isStream(L)?new y(P,L):c.prepareContent(P,L,Z.binary,Z.optimizedBinaryString,Z.base64);var nt=new m(P,I,Z);this.files[P]=nt}var l=e("./utf8"),c=e("./utils"),h=e("./stream/GenericWorker"),f=e("./stream/StreamHelper"),g=e("./defaults"),p=e("./compressedObject"),m=e("./zipObject"),v=e("./generate"),b=e("./nodejsUtils"),y=e("./nodejs/NodejsStreamInputAdapter"),A=function(P){P.slice(-1)==="/"&&(P=P.substring(0,P.length-1));var L=P.lastIndexOf("/");return 0<L?P.substring(0,L):""},S=function(P){return P.slice(-1)!=="/"&&(P+="/"),P},w=function(P,L){return L=L!==void 0?L:g.createFolders,P=S(P),this.files[P]||o.call(this,P,null,{dir:!0,createFolders:L}),this.files[P]};function E(P){return Object.prototype.toString.call(P)==="[object RegExp]"}var D={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(P){var L,R,V;for(L in this.files)V=this.files[L],(R=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&P(R,V)},filter:function(P){var L=[];return this.forEach(function(R,V){P(R,V)&&L.push(V)}),L},file:function(P,L,R){if(arguments.length!==1)return P=this.root+P,o.call(this,P,L,R),this;if(E(P)){var V=P;return this.filter(function(Z,tt){return!tt.dir&&V.test(Z)})}var F=this.files[this.root+P];return F&&!F.dir?F:null},folder:function(P){if(!P)return this;if(E(P))return this.filter(function(F,Z){return Z.dir&&P.test(F)});var L=this.root+P,R=w.call(this,L),V=this.clone();return V.root=R.name,V},remove:function(P){P=this.root+P;var L=this.files[P];if(L||(P.slice(-1)!=="/"&&(P+="/"),L=this.files[P]),L&&!L.dir)delete this.files[P];else for(var R=this.filter(function(F,Z){return Z.name.slice(0,P.length)===P}),V=0;V<R.length;V++)delete this.files[R[V].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(P){var L,R={};try{if((R=c.extend(P||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");c.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var V=R.comment||this.comment||"";L=v.generateWorker(this,R,V)}catch(F){(L=new h("error")).error(F)}return new f(L,R.type||"string",R.mimeType)},generateAsync:function(P,L){return this.generateInternalStream(P).accumulate(L)},generateNodeStream:function(P,L){return(P=P||{}).type||(P.type="nodebuffer"),this.generateInternalStream(P).toNodejsStream(L)}};n.exports=D},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,n,r){n.exports=e("stream")},{stream:void 0}],17:[function(e,n,r){var o=e("./DataReader");function l(c){o.call(this,c);for(var h=0;h<this.data.length;h++)c[h]=255&c[h]}e("../utils").inherits(l,o),l.prototype.byteAt=function(c){return this.data[this.zero+c]},l.prototype.lastIndexOfSignature=function(c){for(var h=c.charCodeAt(0),f=c.charCodeAt(1),g=c.charCodeAt(2),p=c.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===h&&this.data[m+1]===f&&this.data[m+2]===g&&this.data[m+3]===p)return m-this.zero;return-1},l.prototype.readAndCheckSignature=function(c){var h=c.charCodeAt(0),f=c.charCodeAt(1),g=c.charCodeAt(2),p=c.charCodeAt(3),m=this.readData(4);return h===m[0]&&f===m[1]&&g===m[2]&&p===m[3]},l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var h=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,h},n.exports=l},{"../utils":32,"./DataReader":18}],18:[function(e,n,r){var o=e("../utils");function l(c){this.data=c,this.length=c.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.length<this.zero+c||c<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+c+"). Corrupted zip ?")},setIndex:function(c){this.checkIndex(c),this.index=c},skip:function(c){this.setIndex(this.index+c)},byteAt:function(){},readInt:function(c){var h,f=0;for(this.checkOffset(c),h=this.index+c-1;h>=this.index;h--)f=(f<<8)+this.byteAt(h);return this.index+=c,f},readString:function(c){return o.transformTo("string",this.readData(c))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var c=this.readInt(4);return new Date(Date.UTC(1980+(c>>25&127),(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(31&c)<<1))}},n.exports=l},{"../utils":32}],19:[function(e,n,r){var o=e("./Uint8ArrayReader");function l(c){o.call(this,c)}e("../utils").inherits(l,o),l.prototype.readData=function(c){this.checkOffset(c);var h=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,h},n.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,n,r){var o=e("./DataReader");function l(c){o.call(this,c)}e("../utils").inherits(l,o),l.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},l.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},l.prototype.readAndCheckSignature=function(c){return c===this.readData(4)},l.prototype.readData=function(c){this.checkOffset(c);var h=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,h},n.exports=l},{"../utils":32,"./DataReader":18}],21:[function(e,n,r){var o=e("./ArrayReader");function l(c){o.call(this,c)}e("../utils").inherits(l,o),l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var h=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,h},n.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(e,n,r){var o=e("../utils"),l=e("../support"),c=e("./ArrayReader"),h=e("./StringReader"),f=e("./NodeBufferReader"),g=e("./Uint8ArrayReader");n.exports=function(p){var m=o.getTypeOf(p);return o.checkSupport(m),m!=="string"||l.uint8array?m==="nodebuffer"?new f(p):l.uint8array?new g(o.transformTo("uint8array",p)):new c(o.transformTo("array",p)):new h(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,n,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,n,r){var o=e("./GenericWorker"),l=e("../utils");function c(h){o.call(this,"ConvertWorker to "+h),this.destType=h}l.inherits(c,o),c.prototype.processChunk=function(h){this.push({data:l.transformTo(this.destType,h.data),meta:h.meta})},n.exports=c},{"../utils":32,"./GenericWorker":28}],25:[function(e,n,r){var o=e("./GenericWorker"),l=e("../crc32");function c(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(c,o),c.prototype.processChunk=function(h){this.streamInfo.crc32=l(h.data,this.streamInfo.crc32||0),this.push(h)},n.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,n,r){var o=e("../utils"),l=e("./GenericWorker");function c(h){l.call(this,"DataLengthProbe for "+h),this.propName=h,this.withStreamInfo(h,0)}o.inherits(c,l),c.prototype.processChunk=function(h){if(h){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+h.data.length}l.prototype.processChunk.call(this,h)},n.exports=c},{"../utils":32,"./GenericWorker":28}],27:[function(e,n,r){var o=e("../utils"),l=e("./GenericWorker");function c(h){l.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,h.then(function(g){f.dataIsReady=!0,f.data=g,f.max=g&&g.length||0,f.type=o.getTypeOf(g),f.isPaused||f._tickAndRepeat()},function(g){f.error(g)})}o.inherits(c,l),c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var h=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":h=this.data.substring(this.index,f);break;case"uint8array":h=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":h=this.data.slice(this.index,f)}return this.index=f,this.push({data:h,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(e,n,r){function o(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,c){return this._listeners[l].push(c),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,c){if(this._listeners[l])for(var h=0;h<this._listeners[l].length;h++)this._listeners[l][h].call(this,c)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var c=this;return l.on("data",function(h){c.processChunk(h)}),l.on("end",function(){c.end()}),l.on("error",function(h){c.error(h)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,c){return this.extraStreamInfo[l]=c,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},n.exports=o},{}],29:[function(e,n,r){var o=e("../utils"),l=e("./ConvertWorker"),c=e("./GenericWorker"),h=e("../base64"),f=e("../support"),g=e("../external"),p=null;if(f.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(b,y){return new g.Promise(function(A,S){var w=[],E=b._internalType,D=b._outputType,P=b._mimeType;b.on("data",function(L,R){w.push(L),y&&y(R)}).on("error",function(L){w=[],S(L)}).on("end",function(){try{var L=(function(R,V,F){switch(R){case"blob":return o.newBlob(o.transformTo("arraybuffer",V),F);case"base64":return h.encode(V);default:return o.transformTo(R,V)}})(D,(function(R,V){var F,Z=0,tt=null,I=0;for(F=0;F<V.length;F++)I+=V[F].length;switch(R){case"string":return V.join("");case"array":return Array.prototype.concat.apply([],V);case"uint8array":for(tt=new Uint8Array(I),F=0;F<V.length;F++)tt.set(V[F],Z),Z+=V[F].length;return tt;case"nodebuffer":return Buffer.concat(V);default:throw new Error("concat : unsupported type '"+R+"'")}})(E,w),P);A(L)}catch(R){S(R)}w=[]}).resume()})}function v(b,y,A){var S=y;switch(y){case"blob":case"arraybuffer":S="uint8array";break;case"base64":S="string"}try{this._internalType=S,this._outputType=y,this._mimeType=A,o.checkSupport(S),this._worker=b.pipe(new l(S)),b.lock()}catch(w){this._worker=new c("error"),this._worker.error(w)}}v.prototype={accumulate:function(b){return m(this,b)},on:function(b,y){var A=this;return b==="data"?this._worker.on(b,function(S){y.call(A,S.data,S.meta)}):this._worker.on(b,function(){o.delay(y,arguments,A)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},b)}},n.exports=v},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var o=new ArrayBuffer(0);try{r.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(o),r.blob=l.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(e,n,r){for(var o=e("./utils"),l=e("./support"),c=e("./nodejsUtils"),h=e("./stream/GenericWorker"),f=new Array(256),g=0;g<256;g++)f[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;f[254]=f[254]=1;function p(){h.call(this,"utf-8 decode"),this.leftOver=null}function m(){h.call(this,"utf-8 encode")}r.utf8encode=function(v){return l.nodebuffer?c.newBufferFrom(v,"utf-8"):(function(b){var y,A,S,w,E,D=b.length,P=0;for(w=0;w<D;w++)(64512&(A=b.charCodeAt(w)))==55296&&w+1<D&&(64512&(S=b.charCodeAt(w+1)))==56320&&(A=65536+(A-55296<<10)+(S-56320),w++),P+=A<128?1:A<2048?2:A<65536?3:4;for(y=l.uint8array?new Uint8Array(P):new Array(P),w=E=0;E<P;w++)(64512&(A=b.charCodeAt(w)))==55296&&w+1<D&&(64512&(S=b.charCodeAt(w+1)))==56320&&(A=65536+(A-55296<<10)+(S-56320),w++),A<128?y[E++]=A:(A<2048?y[E++]=192|A>>>6:(A<65536?y[E++]=224|A>>>12:(y[E++]=240|A>>>18,y[E++]=128|A>>>12&63),y[E++]=128|A>>>6&63),y[E++]=128|63&A);return y})(v)},r.utf8decode=function(v){return l.nodebuffer?o.transformTo("nodebuffer",v).toString("utf-8"):(function(b){var y,A,S,w,E=b.length,D=new Array(2*E);for(y=A=0;y<E;)if((S=b[y++])<128)D[A++]=S;else if(4<(w=f[S]))D[A++]=65533,y+=w-1;else{for(S&=w===2?31:w===3?15:7;1<w&&y<E;)S=S<<6|63&b[y++],w--;1<w?D[A++]=65533:S<65536?D[A++]=S:(S-=65536,D[A++]=55296|S>>10&1023,D[A++]=56320|1023&S)}return D.length!==A&&(D.subarray?D=D.subarray(0,A):D.length=A),o.applyFromCharCode(D)})(v=o.transformTo(l.uint8array?"uint8array":"array",v))},o.inherits(p,h),p.prototype.processChunk=function(v){var b=o.transformTo(l.uint8array?"uint8array":"array",v.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var y=b;(b=new Uint8Array(y.length+this.leftOver.length)).set(this.leftOver,0),b.set(y,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var A=(function(w,E){var D;for((E=E||w.length)>w.length&&(E=w.length),D=E-1;0<=D&&(192&w[D])==128;)D--;return D<0||D===0?E:D+f[w[D]]>E?D:E})(b),S=b;A!==b.length&&(l.uint8array?(S=b.subarray(0,A),this.leftOver=b.subarray(A,b.length)):(S=b.slice(0,A),this.leftOver=b.slice(A,b.length))),this.push({data:r.utf8decode(S),meta:v.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=p,o.inherits(m,h),m.prototype.processChunk=function(v){this.push({data:r.utf8encode(v.data),meta:v.meta})},r.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,n,r){var o=e("./support"),l=e("./base64"),c=e("./nodejsUtils"),h=e("./external");function f(y){return y}function g(y,A){for(var S=0;S<y.length;++S)A[S]=255&y.charCodeAt(S);return A}e("setimmediate"),r.newBlob=function(y,A){r.checkSupport("blob");try{return new Blob([y],{type:A})}catch{try{var S=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return S.append(y),S.getBlob(A)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(y,A,S){var w=[],E=0,D=y.length;if(D<=S)return String.fromCharCode.apply(null,y);for(;E<D;)A==="array"||A==="nodebuffer"?w.push(String.fromCharCode.apply(null,y.slice(E,Math.min(E+S,D)))):w.push(String.fromCharCode.apply(null,y.subarray(E,Math.min(E+S,D)))),E+=S;return w.join("")},stringifyByChar:function(y){for(var A="",S=0;S<y.length;S++)A+=String.fromCharCode(y[S]);return A},applyCanBeUsed:{uint8array:(function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,c.allocBuffer(1)).length===1}catch{return!1}})()}};function m(y){var A=65536,S=r.getTypeOf(y),w=!0;if(S==="uint8array"?w=p.applyCanBeUsed.uint8array:S==="nodebuffer"&&(w=p.applyCanBeUsed.nodebuffer),w)for(;1<A;)try{return p.stringifyByChunk(y,S,A)}catch{A=Math.floor(A/2)}return p.stringifyByChar(y)}function v(y,A){for(var S=0;S<y.length;S++)A[S]=y[S];return A}r.applyFromCharCode=m;var b={};b.string={string:f,array:function(y){return g(y,new Array(y.length))},arraybuffer:function(y){return b.string.uint8array(y).buffer},uint8array:function(y){return g(y,new Uint8Array(y.length))},nodebuffer:function(y){return g(y,c.allocBuffer(y.length))}},b.array={string:m,array:f,arraybuffer:function(y){return new Uint8Array(y).buffer},uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return c.newBufferFrom(y)}},b.arraybuffer={string:function(y){return m(new Uint8Array(y))},array:function(y){return v(new Uint8Array(y),new Array(y.byteLength))},arraybuffer:f,uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return c.newBufferFrom(new Uint8Array(y))}},b.uint8array={string:m,array:function(y){return v(y,new Array(y.length))},arraybuffer:function(y){return y.buffer},uint8array:f,nodebuffer:function(y){return c.newBufferFrom(y)}},b.nodebuffer={string:m,array:function(y){return v(y,new Array(y.length))},arraybuffer:function(y){return b.nodebuffer.uint8array(y).buffer},uint8array:function(y){return v(y,new Uint8Array(y.length))},nodebuffer:f},r.transformTo=function(y,A){if(A=A||"",!y)return A;r.checkSupport(y);var S=r.getTypeOf(A);return b[S][y](A)},r.resolve=function(y){for(var A=y.split("/"),S=[],w=0;w<A.length;w++){var E=A[w];E==="."||E===""&&w!==0&&w!==A.length-1||(E===".."?S.pop():S.push(E))}return S.join("/")},r.getTypeOf=function(y){return typeof y=="string"?"string":Object.prototype.toString.call(y)==="[object Array]"?"array":o.nodebuffer&&c.isBuffer(y)?"nodebuffer":o.uint8array&&y instanceof Uint8Array?"uint8array":o.arraybuffer&&y instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(y){if(!o[y.toLowerCase()])throw new Error(y+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(y){var A,S,w="";for(S=0;S<(y||"").length;S++)w+="\\x"+((A=y.charCodeAt(S))<16?"0":"")+A.toString(16).toUpperCase();return w},r.delay=function(y,A,S){setImmediate(function(){y.apply(S||null,A||[])})},r.inherits=function(y,A){function S(){}S.prototype=A.prototype,y.prototype=new S},r.extend=function(){var y,A,S={};for(y=0;y<arguments.length;y++)for(A in arguments[y])Object.prototype.hasOwnProperty.call(arguments[y],A)&&S[A]===void 0&&(S[A]=arguments[y][A]);return S},r.prepareContent=function(y,A,S,w,E){return h.Promise.resolve(A).then(function(D){return o.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1)&&typeof FileReader<"u"?new h.Promise(function(P,L){var R=new FileReader;R.onload=function(V){P(V.target.result)},R.onerror=function(V){L(V.target.error)},R.readAsArrayBuffer(D)}):D}).then(function(D){var P=r.getTypeOf(D);return P?(P==="arraybuffer"?D=r.transformTo("uint8array",D):P==="string"&&(E?D=l.decode(D):S&&w!==!0&&(D=(function(L){return g(L,o.uint8array?new Uint8Array(L.length):new Array(L.length))})(D))),D):h.Promise.reject(new Error("Can't read the data of '"+y+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,n,r){var o=e("./reader/readerFor"),l=e("./utils"),c=e("./signature"),h=e("./zipEntry"),f=e("./support");function g(p){this.files=[],this.loadOptions=p}g.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(m)+", expected "+l.pretty(p)+")")}},isSignature:function(p,m){var v=this.reader.index;this.reader.setIndex(p);var b=this.reader.readString(4)===m;return this.reader.setIndex(v),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),m=f.uint8array?"uint8array":"array",v=l.transformTo(m,p);this.zipComment=this.loadOptions.decodeFileName(v)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,m,v,b=this.zip64EndOfCentralSize-44;0<b;)p=this.reader.readInt(2),m=this.reader.readInt(4),v=this.reader.readData(m),this.zip64ExtensibleData[p]={id:p,length:m,value:v}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,m;for(p=0;p<this.files.length;p++)m=this.files[p],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(c.CENTRAL_FILE_HEADER);)(p=new h({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,c.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var m=p;if(this.checkSignature(c.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var b=m-v;if(0<b)this.isSignature(m,c.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(p){this.reader=o(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=g},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,n,r){var o=e("./reader/readerFor"),l=e("./utils"),c=e("./compressedObject"),h=e("./crc32"),f=e("./utf8"),g=e("./compressions"),p=e("./support");function m(v,b){this.options=v,this.loadOptions=b}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(v){var b,y;if(v.skip(22),this.fileNameLength=v.readInt(2),y=v.readInt(2),this.fileName=v.readData(this.fileNameLength),v.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=(function(A){for(var S in g)if(Object.prototype.hasOwnProperty.call(g,S)&&g[S].magic===A)return g[S];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new c(this.compressedSize,this.uncompressedSize,this.crc32,b,v.readData(this.compressedSize))},readCentralPart:function(v){this.versionMadeBy=v.readInt(2),v.skip(2),this.bitFlag=v.readInt(2),this.compressionMethod=v.readString(2),this.date=v.readDate(),this.crc32=v.readInt(4),this.compressedSize=v.readInt(4),this.uncompressedSize=v.readInt(4);var b=v.readInt(2);if(this.extraFieldsLength=v.readInt(2),this.fileCommentLength=v.readInt(2),this.diskNumberStart=v.readInt(2),this.internalFileAttributes=v.readInt(2),this.externalFileAttributes=v.readInt(4),this.localHeaderOffset=v.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");v.skip(b),this.readExtraFields(v),this.parseZIP64ExtraField(v),this.fileComment=v.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var v=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),v==0&&(this.dosPermissions=63&this.externalFileAttributes),v==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var v=o(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=v.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=v.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=v.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=v.readInt(4))}},readExtraFields:function(v){var b,y,A,S=v.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});v.index+4<S;)b=v.readInt(2),y=v.readInt(2),A=v.readData(y),this.extraFields[b]={id:b,length:y,value:A};v.setIndex(S)},handleUTF8:function(){var v=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var y=l.transformTo(v,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var A=this.findExtraFieldUnicodeComment();if(A!==null)this.fileCommentStr=A;else{var S=l.transformTo(v,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(S)}}},findExtraFieldUnicodePath:function(){var v=this.extraFields[28789];if(v){var b=o(v.value);return b.readInt(1)!==1||h(this.fileName)!==b.readInt(4)?null:f.utf8decode(b.readData(v.length-5))}return null},findExtraFieldUnicodeComment:function(){var v=this.extraFields[25461];if(v){var b=o(v.value);return b.readInt(1)!==1||h(this.fileComment)!==b.readInt(4)?null:f.utf8decode(b.readData(v.length-5))}return null}},n.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,n,r){function o(b,y,A){this.name=b,this.dir=A.dir,this.date=A.date,this.comment=A.comment,this.unixPermissions=A.unixPermissions,this.dosPermissions=A.dosPermissions,this._data=y,this._dataBinary=A.binary,this.options={compression:A.compression,compressionOptions:A.compressionOptions}}var l=e("./stream/StreamHelper"),c=e("./stream/DataWorker"),h=e("./utf8"),f=e("./compressedObject"),g=e("./stream/GenericWorker");o.prototype={internalStream:function(b){var y=null,A="string";try{if(!b)throw new Error("No output type specified.");var S=(A=b.toLowerCase())==="string"||A==="text";A!=="binarystring"&&A!=="text"||(A="string"),y=this._decompressWorker();var w=!this._dataBinary;w&&!S&&(y=y.pipe(new h.Utf8EncodeWorker)),!w&&S&&(y=y.pipe(new h.Utf8DecodeWorker))}catch(E){(y=new g("error")).error(E)}return new l(y,A,"")},async:function(b,y){return this.internalStream(b).accumulate(y)},nodeStream:function(b,y){return this.internalStream(b||"nodebuffer").toNodejsStream(y)},_compressWorker:function(b,y){if(this._data instanceof f&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var A=this._decompressWorker();return this._dataBinary||(A=A.pipe(new h.Utf8EncodeWorker)),f.createWorkerFrom(A,b,y)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof g?this._data:new c(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},v=0;v<p.length;v++)o.prototype[p[v]]=m;n.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,n,r){(function(o){var l,c,h=o.MutationObserver||o.WebKitMutationObserver;if(h){var f=0,g=new h(b),p=o.document.createTextNode("");g.observe(p,{characterData:!0}),l=function(){p.data=f=++f%2}}else if(o.setImmediate||o.MessageChannel===void 0)l="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var y=o.document.createElement("script");y.onreadystatechange=function(){b(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},o.document.documentElement.appendChild(y)}:function(){setTimeout(b,0)};else{var m=new o.MessageChannel;m.port1.onmessage=b,l=function(){m.port2.postMessage(0)}}var v=[];function b(){var y,A;c=!0;for(var S=v.length;S;){for(A=v,v=[],y=-1;++y<S;)A[y]();S=v.length}c=!1}n.exports=function(y){v.push(y)!==1||c||l()}}).call(this,typeof bu<"u"?bu:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,n,r){var o=e("immediate");function l(){}var c={},h=["REJECTED"],f=["FULFILLED"],g=["PENDING"];function p(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,S!==l&&y(this,S)}function m(S,w,E){this.promise=S,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function v(S,w,E){o(function(){var D;try{D=w(E)}catch(P){return c.reject(S,P)}D===S?c.reject(S,new TypeError("Cannot resolve promise with itself")):c.resolve(S,D)})}function b(S){var w=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof w=="function")return function(){w.apply(S,arguments)}}function y(S,w){var E=!1;function D(R){E||(E=!0,c.reject(S,R))}function P(R){E||(E=!0,c.resolve(S,R))}var L=A(function(){w(P,D)});L.status==="error"&&D(L.value)}function A(S,w){var E={};try{E.value=S(w),E.status="success"}catch(D){E.status="error",E.value=D}return E}(n.exports=p).prototype.finally=function(S){if(typeof S!="function")return this;var w=this.constructor;return this.then(function(E){return w.resolve(S()).then(function(){return E})},function(E){return w.resolve(S()).then(function(){throw E})})},p.prototype.catch=function(S){return this.then(null,S)},p.prototype.then=function(S,w){if(typeof S!="function"&&this.state===f||typeof w!="function"&&this.state===h)return this;var E=new this.constructor(l);return this.state!==g?v(E,this.state===f?S:w,this.outcome):this.queue.push(new m(E,S,w)),E},m.prototype.callFulfilled=function(S){c.resolve(this.promise,S)},m.prototype.otherCallFulfilled=function(S){v(this.promise,this.onFulfilled,S)},m.prototype.callRejected=function(S){c.reject(this.promise,S)},m.prototype.otherCallRejected=function(S){v(this.promise,this.onRejected,S)},c.resolve=function(S,w){var E=A(b,w);if(E.status==="error")return c.reject(S,E.value);var D=E.value;if(D)y(S,D);else{S.state=f,S.outcome=w;for(var P=-1,L=S.queue.length;++P<L;)S.queue[P].callFulfilled(w)}return S},c.reject=function(S,w){S.state=h,S.outcome=w;for(var E=-1,D=S.queue.length;++E<D;)S.queue[E].callRejected(w);return S},p.resolve=function(S){return S instanceof this?S:c.resolve(new this(l),S)},p.reject=function(S){var w=new this(l);return c.reject(w,S)},p.all=function(S){var w=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=S.length,D=!1;if(!E)return this.resolve([]);for(var P=new Array(E),L=0,R=-1,V=new this(l);++R<E;)F(S[R],R);return V;function F(Z,tt){w.resolve(Z).then(function(I){P[tt]=I,++L!==E||D||(D=!0,c.resolve(V,P))},function(I){D||(D=!0,c.reject(V,I))})}},p.race=function(S){var w=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=S.length,D=!1;if(!E)return this.resolve([]);for(var P=-1,L=new this(l);++P<E;)R=S[P],w.resolve(R).then(function(V){D||(D=!0,c.resolve(L,V))},function(V){D||(D=!0,c.reject(L,V))});var R;return L}},{immediate:36}],38:[function(e,n,r){var o={};(0,e("./lib/utils/common").assign)(o,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,n,r){var o=e("./zlib/deflate"),l=e("./utils/common"),c=e("./utils/strings"),h=e("./zlib/messages"),f=e("./zlib/zstream"),g=Object.prototype.toString,p=0,m=-1,v=0,b=8;function y(S){if(!(this instanceof y))return new y(S);this.options=l.assign({level:m,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},S||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var E=o.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(E!==p)throw new Error(h[E]);if(w.header&&o.deflateSetHeader(this.strm,w.header),w.dictionary){var D;if(D=typeof w.dictionary=="string"?c.string2buf(w.dictionary):g.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(E=o.deflateSetDictionary(this.strm,D))!==p)throw new Error(h[E]);this._dict_set=!0}}function A(S,w){var E=new y(w);if(E.push(S,!0),E.err)throw E.msg||h[E.err];return E.result}y.prototype.push=function(S,w){var E,D,P=this.strm,L=this.options.chunkSize;if(this.ended)return!1;D=w===~~w?w:w===!0?4:0,typeof S=="string"?P.input=c.string2buf(S):g.call(S)==="[object ArrayBuffer]"?P.input=new Uint8Array(S):P.input=S,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new l.Buf8(L),P.next_out=0,P.avail_out=L),(E=o.deflate(P,D))!==1&&E!==p)return this.onEnd(E),!(this.ended=!0);P.avail_out!==0&&(P.avail_in!==0||D!==4&&D!==2)||(this.options.to==="string"?this.onData(c.buf2binstring(l.shrinkBuf(P.output,P.next_out))):this.onData(l.shrinkBuf(P.output,P.next_out)))}while((0<P.avail_in||P.avail_out===0)&&E!==1);return D===4?(E=o.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===p):D!==2||(this.onEnd(p),!(P.avail_out=0))},y.prototype.onData=function(S){this.chunks.push(S)},y.prototype.onEnd=function(S){S===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg},r.Deflate=y,r.deflate=A,r.deflateRaw=function(S,w){return(w=w||{}).raw=!0,A(S,w)},r.gzip=function(S,w){return(w=w||{}).gzip=!0,A(S,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,n,r){var o=e("./zlib/inflate"),l=e("./utils/common"),c=e("./utils/strings"),h=e("./zlib/constants"),f=e("./zlib/messages"),g=e("./zlib/zstream"),p=e("./zlib/gzheader"),m=Object.prototype.toString;function v(y){if(!(this instanceof v))return new v(y);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},y||{});var A=this.options;A.raw&&0<=A.windowBits&&A.windowBits<16&&(A.windowBits=-A.windowBits,A.windowBits===0&&(A.windowBits=-15)),!(0<=A.windowBits&&A.windowBits<16)||y&&y.windowBits||(A.windowBits+=32),15<A.windowBits&&A.windowBits<48&&(15&A.windowBits)==0&&(A.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var S=o.inflateInit2(this.strm,A.windowBits);if(S!==h.Z_OK)throw new Error(f[S]);this.header=new p,o.inflateGetHeader(this.strm,this.header)}function b(y,A){var S=new v(A);if(S.push(y,!0),S.err)throw S.msg||f[S.err];return S.result}v.prototype.push=function(y,A){var S,w,E,D,P,L,R=this.strm,V=this.options.chunkSize,F=this.options.dictionary,Z=!1;if(this.ended)return!1;w=A===~~A?A:A===!0?h.Z_FINISH:h.Z_NO_FLUSH,typeof y=="string"?R.input=c.binstring2buf(y):m.call(y)==="[object ArrayBuffer]"?R.input=new Uint8Array(y):R.input=y,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new l.Buf8(V),R.next_out=0,R.avail_out=V),(S=o.inflate(R,h.Z_NO_FLUSH))===h.Z_NEED_DICT&&F&&(L=typeof F=="string"?c.string2buf(F):m.call(F)==="[object ArrayBuffer]"?new Uint8Array(F):F,S=o.inflateSetDictionary(this.strm,L)),S===h.Z_BUF_ERROR&&Z===!0&&(S=h.Z_OK,Z=!1),S!==h.Z_STREAM_END&&S!==h.Z_OK)return this.onEnd(S),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&S!==h.Z_STREAM_END&&(R.avail_in!==0||w!==h.Z_FINISH&&w!==h.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=c.utf8border(R.output,R.next_out),D=R.next_out-E,P=c.buf2string(R.output,E),R.next_out=D,R.avail_out=V-D,D&&l.arraySet(R.output,R.output,E,D,0),this.onData(P)):this.onData(l.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(Z=!0)}while((0<R.avail_in||R.avail_out===0)&&S!==h.Z_STREAM_END);return S===h.Z_STREAM_END&&(w=h.Z_FINISH),w===h.Z_FINISH?(S=o.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===h.Z_OK):w!==h.Z_SYNC_FLUSH||(this.onEnd(h.Z_OK),!(R.avail_out=0))},v.prototype.onData=function(y){this.chunks.push(y)},v.prototype.onEnd=function(y){y===h.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},r.Inflate=v,r.inflate=b,r.inflateRaw=function(y,A){return(A=A||{}).raw=!0,b(y,A)},r.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,n,r){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(h){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var g=f.shift();if(g){if(typeof g!="object")throw new TypeError(g+"must be non-object");for(var p in g)g.hasOwnProperty(p)&&(h[p]=g[p])}}return h},r.shrinkBuf=function(h,f){return h.length===f?h:h.subarray?h.subarray(0,f):(h.length=f,h)};var l={arraySet:function(h,f,g,p,m){if(f.subarray&&h.subarray)h.set(f.subarray(g,g+p),m);else for(var v=0;v<p;v++)h[m+v]=f[g+v]},flattenChunks:function(h){var f,g,p,m,v,b;for(f=p=0,g=h.length;f<g;f++)p+=h[f].length;for(b=new Uint8Array(p),f=m=0,g=h.length;f<g;f++)v=h[f],b.set(v,m),m+=v.length;return b}},c={arraySet:function(h,f,g,p,m){for(var v=0;v<p;v++)h[m+v]=f[g+v]},flattenChunks:function(h){return[].concat.apply([],h)}};r.setTyped=function(h){h?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,l)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,c))},r.setTyped(o)},{}],42:[function(e,n,r){var o=e("./common"),l=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{c=!1}for(var h=new o.Buf8(256),f=0;f<256;f++)h[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function g(p,m){if(m<65537&&(p.subarray&&c||!p.subarray&&l))return String.fromCharCode.apply(null,o.shrinkBuf(p,m));for(var v="",b=0;b<m;b++)v+=String.fromCharCode(p[b]);return v}h[254]=h[254]=1,r.string2buf=function(p){var m,v,b,y,A,S=p.length,w=0;for(y=0;y<S;y++)(64512&(v=p.charCodeAt(y)))==55296&&y+1<S&&(64512&(b=p.charCodeAt(y+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),y++),w+=v<128?1:v<2048?2:v<65536?3:4;for(m=new o.Buf8(w),y=A=0;A<w;y++)(64512&(v=p.charCodeAt(y)))==55296&&y+1<S&&(64512&(b=p.charCodeAt(y+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),y++),v<128?m[A++]=v:(v<2048?m[A++]=192|v>>>6:(v<65536?m[A++]=224|v>>>12:(m[A++]=240|v>>>18,m[A++]=128|v>>>12&63),m[A++]=128|v>>>6&63),m[A++]=128|63&v);return m},r.buf2binstring=function(p){return g(p,p.length)},r.binstring2buf=function(p){for(var m=new o.Buf8(p.length),v=0,b=m.length;v<b;v++)m[v]=p.charCodeAt(v);return m},r.buf2string=function(p,m){var v,b,y,A,S=m||p.length,w=new Array(2*S);for(v=b=0;v<S;)if((y=p[v++])<128)w[b++]=y;else if(4<(A=h[y]))w[b++]=65533,v+=A-1;else{for(y&=A===2?31:A===3?15:7;1<A&&v<S;)y=y<<6|63&p[v++],A--;1<A?w[b++]=65533:y<65536?w[b++]=y:(y-=65536,w[b++]=55296|y>>10&1023,w[b++]=56320|1023&y)}return g(w,b)},r.utf8border=function(p,m){var v;for((m=m||p.length)>p.length&&(m=p.length),v=m-1;0<=v&&(192&p[v])==128;)v--;return v<0||v===0?m:v+h[p[v]]>m?v:m}},{"./common":41}],43:[function(e,n,r){n.exports=function(o,l,c,h){for(var f=65535&o|0,g=o>>>16&65535|0,p=0;c!==0;){for(c-=p=2e3<c?2e3:c;g=g+(f=f+l[h++]|0)|0,--p;);f%=65521,g%=65521}return f|g<<16|0}},{}],44:[function(e,n,r){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,n,r){var o=(function(){for(var l,c=[],h=0;h<256;h++){l=h;for(var f=0;f<8;f++)l=1&l?3988292384^l>>>1:l>>>1;c[h]=l}return c})();n.exports=function(l,c,h,f){var g=o,p=f+h;l^=-1;for(var m=f;m<p;m++)l=l>>>8^g[255&(l^c[m])];return-1^l}},{}],46:[function(e,n,r){var o,l=e("../utils/common"),c=e("./trees"),h=e("./adler32"),f=e("./crc32"),g=e("./messages"),p=0,m=4,v=0,b=-2,y=-1,A=4,S=2,w=8,E=9,D=286,P=30,L=19,R=2*D+1,V=15,F=3,Z=258,tt=Z+F+1,I=42,nt=113,O=1,rt=2,Q=3,J=4;function _t(k,St){return k.msg=g[St],St}function vt(k){return(k<<1)-(4<k?9:0)}function Nt(k){for(var St=k.length;0<=--St;)k[St]=0}function M(k){var St=k.state,lt=St.pending;lt>k.avail_out&&(lt=k.avail_out),lt!==0&&(l.arraySet(k.output,St.pending_buf,St.pending_out,lt,k.next_out),k.next_out+=lt,St.pending_out+=lt,k.total_out+=lt,k.avail_out-=lt,St.pending-=lt,St.pending===0&&(St.pending_out=0))}function C(k,St){c._tr_flush_block(k,0<=k.block_start?k.block_start:-1,k.strstart-k.block_start,St),k.block_start=k.strstart,M(k.strm)}function X(k,St){k.pending_buf[k.pending++]=St}function U(k,St){k.pending_buf[k.pending++]=St>>>8&255,k.pending_buf[k.pending++]=255&St}function j(k,St){var lt,z,K=k.max_chain_length,at=k.strstart,kt=k.prev_length,Rt=k.nice_match,ht=k.strstart>k.w_size-tt?k.strstart-(k.w_size-tt):0,Bt=k.window,It=k.w_mask,Ut=k.prev,$t=k.strstart+Z,ye=Bt[at+kt-1],ne=Bt[at+kt];k.prev_length>=k.good_match&&(K>>=2),Rt>k.lookahead&&(Rt=k.lookahead);do if(Bt[(lt=St)+kt]===ne&&Bt[lt+kt-1]===ye&&Bt[lt]===Bt[at]&&Bt[++lt]===Bt[at+1]){at+=2,lt++;do;while(Bt[++at]===Bt[++lt]&&Bt[++at]===Bt[++lt]&&Bt[++at]===Bt[++lt]&&Bt[++at]===Bt[++lt]&&Bt[++at]===Bt[++lt]&&Bt[++at]===Bt[++lt]&&Bt[++at]===Bt[++lt]&&Bt[++at]===Bt[++lt]&&at<$t);if(z=Z-($t-at),at=$t-Z,kt<z){if(k.match_start=St,Rt<=(kt=z))break;ye=Bt[at+kt-1],ne=Bt[at+kt]}}while((St=Ut[St&It])>ht&&--K!=0);return kt<=k.lookahead?kt:k.lookahead}function ot(k){var St,lt,z,K,at,kt,Rt,ht,Bt,It,Ut=k.w_size;do{if(K=k.window_size-k.lookahead-k.strstart,k.strstart>=Ut+(Ut-tt)){for(l.arraySet(k.window,k.window,Ut,Ut,0),k.match_start-=Ut,k.strstart-=Ut,k.block_start-=Ut,St=lt=k.hash_size;z=k.head[--St],k.head[St]=Ut<=z?z-Ut:0,--lt;);for(St=lt=Ut;z=k.prev[--St],k.prev[St]=Ut<=z?z-Ut:0,--lt;);K+=Ut}if(k.strm.avail_in===0)break;if(kt=k.strm,Rt=k.window,ht=k.strstart+k.lookahead,Bt=K,It=void 0,It=kt.avail_in,Bt<It&&(It=Bt),lt=It===0?0:(kt.avail_in-=It,l.arraySet(Rt,kt.input,kt.next_in,It,ht),kt.state.wrap===1?kt.adler=h(kt.adler,Rt,It,ht):kt.state.wrap===2&&(kt.adler=f(kt.adler,Rt,It,ht)),kt.next_in+=It,kt.total_in+=It,It),k.lookahead+=lt,k.lookahead+k.insert>=F)for(at=k.strstart-k.insert,k.ins_h=k.window[at],k.ins_h=(k.ins_h<<k.hash_shift^k.window[at+1])&k.hash_mask;k.insert&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[at+F-1])&k.hash_mask,k.prev[at&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=at,at++,k.insert--,!(k.lookahead+k.insert<F)););}while(k.lookahead<tt&&k.strm.avail_in!==0)}function bt(k,St){for(var lt,z;;){if(k.lookahead<tt){if(ot(k),k.lookahead<tt&&St===p)return O;if(k.lookahead===0)break}if(lt=0,k.lookahead>=F&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,lt=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),lt!==0&&k.strstart-lt<=k.w_size-tt&&(k.match_length=j(k,lt)),k.match_length>=F)if(z=c._tr_tally(k,k.strstart-k.match_start,k.match_length-F),k.lookahead-=k.match_length,k.match_length<=k.max_lazy_match&&k.lookahead>=F){for(k.match_length--;k.strstart++,k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,lt=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart,--k.match_length!=0;);k.strstart++}else k.strstart+=k.match_length,k.match_length=0,k.ins_h=k.window[k.strstart],k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+1])&k.hash_mask;else z=c._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++;if(z&&(C(k,!1),k.strm.avail_out===0))return O}return k.insert=k.strstart<F-1?k.strstart:F-1,St===m?(C(k,!0),k.strm.avail_out===0?Q:J):k.last_lit&&(C(k,!1),k.strm.avail_out===0)?O:rt}function Ot(k,St){for(var lt,z,K;;){if(k.lookahead<tt){if(ot(k),k.lookahead<tt&&St===p)return O;if(k.lookahead===0)break}if(lt=0,k.lookahead>=F&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,lt=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),k.prev_length=k.match_length,k.prev_match=k.match_start,k.match_length=F-1,lt!==0&&k.prev_length<k.max_lazy_match&&k.strstart-lt<=k.w_size-tt&&(k.match_length=j(k,lt),k.match_length<=5&&(k.strategy===1||k.match_length===F&&4096<k.strstart-k.match_start)&&(k.match_length=F-1)),k.prev_length>=F&&k.match_length<=k.prev_length){for(K=k.strstart+k.lookahead-F,z=c._tr_tally(k,k.strstart-1-k.prev_match,k.prev_length-F),k.lookahead-=k.prev_length-1,k.prev_length-=2;++k.strstart<=K&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,lt=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),--k.prev_length!=0;);if(k.match_available=0,k.match_length=F-1,k.strstart++,z&&(C(k,!1),k.strm.avail_out===0))return O}else if(k.match_available){if((z=c._tr_tally(k,0,k.window[k.strstart-1]))&&C(k,!1),k.strstart++,k.lookahead--,k.strm.avail_out===0)return O}else k.match_available=1,k.strstart++,k.lookahead--}return k.match_available&&(z=c._tr_tally(k,0,k.window[k.strstart-1]),k.match_available=0),k.insert=k.strstart<F-1?k.strstart:F-1,St===m?(C(k,!0),k.strm.avail_out===0?Q:J):k.last_lit&&(C(k,!1),k.strm.avail_out===0)?O:rt}function Tt(k,St,lt,z,K){this.good_length=k,this.max_lazy=St,this.nice_length=lt,this.max_chain=z,this.func=K}function Mt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*R),this.dyn_dtree=new l.Buf16(2*(2*P+1)),this.bl_tree=new l.Buf16(2*(2*L+1)),Nt(this.dyn_ltree),Nt(this.dyn_dtree),Nt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(V+1),this.heap=new l.Buf16(2*D+1),Nt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*D+1),Nt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Zt(k){var St;return k&&k.state?(k.total_in=k.total_out=0,k.data_type=S,(St=k.state).pending=0,St.pending_out=0,St.wrap<0&&(St.wrap=-St.wrap),St.status=St.wrap?I:nt,k.adler=St.wrap===2?0:1,St.last_flush=p,c._tr_init(St),v):_t(k,b)}function te(k){var St=Zt(k);return St===v&&(function(lt){lt.window_size=2*lt.w_size,Nt(lt.head),lt.max_lazy_match=o[lt.level].max_lazy,lt.good_match=o[lt.level].good_length,lt.nice_match=o[lt.level].nice_length,lt.max_chain_length=o[lt.level].max_chain,lt.strstart=0,lt.block_start=0,lt.lookahead=0,lt.insert=0,lt.match_length=lt.prev_length=F-1,lt.match_available=0,lt.ins_h=0})(k.state),St}function ve(k,St,lt,z,K,at){if(!k)return b;var kt=1;if(St===y&&(St=6),z<0?(kt=0,z=-z):15<z&&(kt=2,z-=16),K<1||E<K||lt!==w||z<8||15<z||St<0||9<St||at<0||A<at)return _t(k,b);z===8&&(z=9);var Rt=new Mt;return(k.state=Rt).strm=k,Rt.wrap=kt,Rt.gzhead=null,Rt.w_bits=z,Rt.w_size=1<<Rt.w_bits,Rt.w_mask=Rt.w_size-1,Rt.hash_bits=K+7,Rt.hash_size=1<<Rt.hash_bits,Rt.hash_mask=Rt.hash_size-1,Rt.hash_shift=~~((Rt.hash_bits+F-1)/F),Rt.window=new l.Buf8(2*Rt.w_size),Rt.head=new l.Buf16(Rt.hash_size),Rt.prev=new l.Buf16(Rt.w_size),Rt.lit_bufsize=1<<K+6,Rt.pending_buf_size=4*Rt.lit_bufsize,Rt.pending_buf=new l.Buf8(Rt.pending_buf_size),Rt.d_buf=1*Rt.lit_bufsize,Rt.l_buf=3*Rt.lit_bufsize,Rt.level=St,Rt.strategy=at,Rt.method=lt,te(k)}o=[new Tt(0,0,0,0,function(k,St){var lt=65535;for(lt>k.pending_buf_size-5&&(lt=k.pending_buf_size-5);;){if(k.lookahead<=1){if(ot(k),k.lookahead===0&&St===p)return O;if(k.lookahead===0)break}k.strstart+=k.lookahead,k.lookahead=0;var z=k.block_start+lt;if((k.strstart===0||k.strstart>=z)&&(k.lookahead=k.strstart-z,k.strstart=z,C(k,!1),k.strm.avail_out===0)||k.strstart-k.block_start>=k.w_size-tt&&(C(k,!1),k.strm.avail_out===0))return O}return k.insert=0,St===m?(C(k,!0),k.strm.avail_out===0?Q:J):(k.strstart>k.block_start&&(C(k,!1),k.strm.avail_out),O)}),new Tt(4,4,8,4,bt),new Tt(4,5,16,8,bt),new Tt(4,6,32,32,bt),new Tt(4,4,16,16,Ot),new Tt(8,16,32,32,Ot),new Tt(8,16,128,128,Ot),new Tt(8,32,128,256,Ot),new Tt(32,128,258,1024,Ot),new Tt(32,258,258,4096,Ot)],r.deflateInit=function(k,St){return ve(k,St,w,15,8,0)},r.deflateInit2=ve,r.deflateReset=te,r.deflateResetKeep=Zt,r.deflateSetHeader=function(k,St){return k&&k.state?k.state.wrap!==2?b:(k.state.gzhead=St,v):b},r.deflate=function(k,St){var lt,z,K,at;if(!k||!k.state||5<St||St<0)return k?_t(k,b):b;if(z=k.state,!k.output||!k.input&&k.avail_in!==0||z.status===666&&St!==m)return _t(k,k.avail_out===0?-5:b);if(z.strm=k,lt=z.last_flush,z.last_flush=St,z.status===I)if(z.wrap===2)k.adler=0,X(z,31),X(z,139),X(z,8),z.gzhead?(X(z,(z.gzhead.text?1:0)+(z.gzhead.hcrc?2:0)+(z.gzhead.extra?4:0)+(z.gzhead.name?8:0)+(z.gzhead.comment?16:0)),X(z,255&z.gzhead.time),X(z,z.gzhead.time>>8&255),X(z,z.gzhead.time>>16&255),X(z,z.gzhead.time>>24&255),X(z,z.level===9?2:2<=z.strategy||z.level<2?4:0),X(z,255&z.gzhead.os),z.gzhead.extra&&z.gzhead.extra.length&&(X(z,255&z.gzhead.extra.length),X(z,z.gzhead.extra.length>>8&255)),z.gzhead.hcrc&&(k.adler=f(k.adler,z.pending_buf,z.pending,0)),z.gzindex=0,z.status=69):(X(z,0),X(z,0),X(z,0),X(z,0),X(z,0),X(z,z.level===9?2:2<=z.strategy||z.level<2?4:0),X(z,3),z.status=nt);else{var kt=w+(z.w_bits-8<<4)<<8;kt|=(2<=z.strategy||z.level<2?0:z.level<6?1:z.level===6?2:3)<<6,z.strstart!==0&&(kt|=32),kt+=31-kt%31,z.status=nt,U(z,kt),z.strstart!==0&&(U(z,k.adler>>>16),U(z,65535&k.adler)),k.adler=1}if(z.status===69)if(z.gzhead.extra){for(K=z.pending;z.gzindex<(65535&z.gzhead.extra.length)&&(z.pending!==z.pending_buf_size||(z.gzhead.hcrc&&z.pending>K&&(k.adler=f(k.adler,z.pending_buf,z.pending-K,K)),M(k),K=z.pending,z.pending!==z.pending_buf_size));)X(z,255&z.gzhead.extra[z.gzindex]),z.gzindex++;z.gzhead.hcrc&&z.pending>K&&(k.adler=f(k.adler,z.pending_buf,z.pending-K,K)),z.gzindex===z.gzhead.extra.length&&(z.gzindex=0,z.status=73)}else z.status=73;if(z.status===73)if(z.gzhead.name){K=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>K&&(k.adler=f(k.adler,z.pending_buf,z.pending-K,K)),M(k),K=z.pending,z.pending===z.pending_buf_size)){at=1;break}at=z.gzindex<z.gzhead.name.length?255&z.gzhead.name.charCodeAt(z.gzindex++):0,X(z,at)}while(at!==0);z.gzhead.hcrc&&z.pending>K&&(k.adler=f(k.adler,z.pending_buf,z.pending-K,K)),at===0&&(z.gzindex=0,z.status=91)}else z.status=91;if(z.status===91)if(z.gzhead.comment){K=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>K&&(k.adler=f(k.adler,z.pending_buf,z.pending-K,K)),M(k),K=z.pending,z.pending===z.pending_buf_size)){at=1;break}at=z.gzindex<z.gzhead.comment.length?255&z.gzhead.comment.charCodeAt(z.gzindex++):0,X(z,at)}while(at!==0);z.gzhead.hcrc&&z.pending>K&&(k.adler=f(k.adler,z.pending_buf,z.pending-K,K)),at===0&&(z.status=103)}else z.status=103;if(z.status===103&&(z.gzhead.hcrc?(z.pending+2>z.pending_buf_size&&M(k),z.pending+2<=z.pending_buf_size&&(X(z,255&k.adler),X(z,k.adler>>8&255),k.adler=0,z.status=nt)):z.status=nt),z.pending!==0){if(M(k),k.avail_out===0)return z.last_flush=-1,v}else if(k.avail_in===0&&vt(St)<=vt(lt)&&St!==m)return _t(k,-5);if(z.status===666&&k.avail_in!==0)return _t(k,-5);if(k.avail_in!==0||z.lookahead!==0||St!==p&&z.status!==666){var Rt=z.strategy===2?(function(ht,Bt){for(var It;;){if(ht.lookahead===0&&(ot(ht),ht.lookahead===0)){if(Bt===p)return O;break}if(ht.match_length=0,It=c._tr_tally(ht,0,ht.window[ht.strstart]),ht.lookahead--,ht.strstart++,It&&(C(ht,!1),ht.strm.avail_out===0))return O}return ht.insert=0,Bt===m?(C(ht,!0),ht.strm.avail_out===0?Q:J):ht.last_lit&&(C(ht,!1),ht.strm.avail_out===0)?O:rt})(z,St):z.strategy===3?(function(ht,Bt){for(var It,Ut,$t,ye,ne=ht.window;;){if(ht.lookahead<=Z){if(ot(ht),ht.lookahead<=Z&&Bt===p)return O;if(ht.lookahead===0)break}if(ht.match_length=0,ht.lookahead>=F&&0<ht.strstart&&(Ut=ne[$t=ht.strstart-1])===ne[++$t]&&Ut===ne[++$t]&&Ut===ne[++$t]){ye=ht.strstart+Z;do;while(Ut===ne[++$t]&&Ut===ne[++$t]&&Ut===ne[++$t]&&Ut===ne[++$t]&&Ut===ne[++$t]&&Ut===ne[++$t]&&Ut===ne[++$t]&&Ut===ne[++$t]&&$t<ye);ht.match_length=Z-(ye-$t),ht.match_length>ht.lookahead&&(ht.match_length=ht.lookahead)}if(ht.match_length>=F?(It=c._tr_tally(ht,1,ht.match_length-F),ht.lookahead-=ht.match_length,ht.strstart+=ht.match_length,ht.match_length=0):(It=c._tr_tally(ht,0,ht.window[ht.strstart]),ht.lookahead--,ht.strstart++),It&&(C(ht,!1),ht.strm.avail_out===0))return O}return ht.insert=0,Bt===m?(C(ht,!0),ht.strm.avail_out===0?Q:J):ht.last_lit&&(C(ht,!1),ht.strm.avail_out===0)?O:rt})(z,St):o[z.level].func(z,St);if(Rt!==Q&&Rt!==J||(z.status=666),Rt===O||Rt===Q)return k.avail_out===0&&(z.last_flush=-1),v;if(Rt===rt&&(St===1?c._tr_align(z):St!==5&&(c._tr_stored_block(z,0,0,!1),St===3&&(Nt(z.head),z.lookahead===0&&(z.strstart=0,z.block_start=0,z.insert=0))),M(k),k.avail_out===0))return z.last_flush=-1,v}return St!==m?v:z.wrap<=0?1:(z.wrap===2?(X(z,255&k.adler),X(z,k.adler>>8&255),X(z,k.adler>>16&255),X(z,k.adler>>24&255),X(z,255&k.total_in),X(z,k.total_in>>8&255),X(z,k.total_in>>16&255),X(z,k.total_in>>24&255)):(U(z,k.adler>>>16),U(z,65535&k.adler)),M(k),0<z.wrap&&(z.wrap=-z.wrap),z.pending!==0?v:1)},r.deflateEnd=function(k){var St;return k&&k.state?(St=k.state.status)!==I&&St!==69&&St!==73&&St!==91&&St!==103&&St!==nt&&St!==666?_t(k,b):(k.state=null,St===nt?_t(k,-3):v):b},r.deflateSetDictionary=function(k,St){var lt,z,K,at,kt,Rt,ht,Bt,It=St.length;if(!k||!k.state||(at=(lt=k.state).wrap)===2||at===1&&lt.status!==I||lt.lookahead)return b;for(at===1&&(k.adler=h(k.adler,St,It,0)),lt.wrap=0,It>=lt.w_size&&(at===0&&(Nt(lt.head),lt.strstart=0,lt.block_start=0,lt.insert=0),Bt=new l.Buf8(lt.w_size),l.arraySet(Bt,St,It-lt.w_size,lt.w_size,0),St=Bt,It=lt.w_size),kt=k.avail_in,Rt=k.next_in,ht=k.input,k.avail_in=It,k.next_in=0,k.input=St,ot(lt);lt.lookahead>=F;){for(z=lt.strstart,K=lt.lookahead-(F-1);lt.ins_h=(lt.ins_h<<lt.hash_shift^lt.window[z+F-1])&lt.hash_mask,lt.prev[z&lt.w_mask]=lt.head[lt.ins_h],lt.head[lt.ins_h]=z,z++,--K;);lt.strstart=z,lt.lookahead=F-1,ot(lt)}return lt.strstart+=lt.lookahead,lt.block_start=lt.strstart,lt.insert=lt.lookahead,lt.lookahead=0,lt.match_length=lt.prev_length=F-1,lt.match_available=0,k.next_in=Rt,k.input=ht,k.avail_in=kt,lt.wrap=at,v},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,n,r){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,n,r){n.exports=function(o,l){var c,h,f,g,p,m,v,b,y,A,S,w,E,D,P,L,R,V,F,Z,tt,I,nt,O,rt;c=o.state,h=o.next_in,O=o.input,f=h+(o.avail_in-5),g=o.next_out,rt=o.output,p=g-(l-o.avail_out),m=g+(o.avail_out-257),v=c.dmax,b=c.wsize,y=c.whave,A=c.wnext,S=c.window,w=c.hold,E=c.bits,D=c.lencode,P=c.distcode,L=(1<<c.lenbits)-1,R=(1<<c.distbits)-1;t:do{E<15&&(w+=O[h++]<<E,E+=8,w+=O[h++]<<E,E+=8),V=D[w&L];e:for(;;){if(w>>>=F=V>>>24,E-=F,(F=V>>>16&255)===0)rt[g++]=65535&V;else{if(!(16&F)){if((64&F)==0){V=D[(65535&V)+(w&(1<<F)-1)];continue e}if(32&F){c.mode=12;break t}o.msg="invalid literal/length code",c.mode=30;break t}Z=65535&V,(F&=15)&&(E<F&&(w+=O[h++]<<E,E+=8),Z+=w&(1<<F)-1,w>>>=F,E-=F),E<15&&(w+=O[h++]<<E,E+=8,w+=O[h++]<<E,E+=8),V=P[w&R];n:for(;;){if(w>>>=F=V>>>24,E-=F,!(16&(F=V>>>16&255))){if((64&F)==0){V=P[(65535&V)+(w&(1<<F)-1)];continue n}o.msg="invalid distance code",c.mode=30;break t}if(tt=65535&V,E<(F&=15)&&(w+=O[h++]<<E,(E+=8)<F&&(w+=O[h++]<<E,E+=8)),v<(tt+=w&(1<<F)-1)){o.msg="invalid distance too far back",c.mode=30;break t}if(w>>>=F,E-=F,(F=g-p)<tt){if(y<(F=tt-F)&&c.sane){o.msg="invalid distance too far back",c.mode=30;break t}if(nt=S,(I=0)===A){if(I+=b-F,F<Z){for(Z-=F;rt[g++]=S[I++],--F;);I=g-tt,nt=rt}}else if(A<F){if(I+=b+A-F,(F-=A)<Z){for(Z-=F;rt[g++]=S[I++],--F;);if(I=0,A<Z){for(Z-=F=A;rt[g++]=S[I++],--F;);I=g-tt,nt=rt}}}else if(I+=A-F,F<Z){for(Z-=F;rt[g++]=S[I++],--F;);I=g-tt,nt=rt}for(;2<Z;)rt[g++]=nt[I++],rt[g++]=nt[I++],rt[g++]=nt[I++],Z-=3;Z&&(rt[g++]=nt[I++],1<Z&&(rt[g++]=nt[I++]))}else{for(I=g-tt;rt[g++]=rt[I++],rt[g++]=rt[I++],rt[g++]=rt[I++],2<(Z-=3););Z&&(rt[g++]=rt[I++],1<Z&&(rt[g++]=rt[I++]))}break}}break}}while(h<f&&g<m);h-=Z=E>>3,w&=(1<<(E-=Z<<3))-1,o.next_in=h,o.next_out=g,o.avail_in=h<f?f-h+5:5-(h-f),o.avail_out=g<m?m-g+257:257-(g-m),c.hold=w,c.bits=E}},{}],49:[function(e,n,r){var o=e("../utils/common"),l=e("./adler32"),c=e("./crc32"),h=e("./inffast"),f=e("./inftrees"),g=1,p=2,m=0,v=-2,b=1,y=852,A=592;function S(I){return(I>>>24&255)+(I>>>8&65280)+((65280&I)<<8)+((255&I)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(I){var nt;return I&&I.state?(nt=I.state,I.total_in=I.total_out=nt.total=0,I.msg="",nt.wrap&&(I.adler=1&nt.wrap),nt.mode=b,nt.last=0,nt.havedict=0,nt.dmax=32768,nt.head=null,nt.hold=0,nt.bits=0,nt.lencode=nt.lendyn=new o.Buf32(y),nt.distcode=nt.distdyn=new o.Buf32(A),nt.sane=1,nt.back=-1,m):v}function D(I){var nt;return I&&I.state?((nt=I.state).wsize=0,nt.whave=0,nt.wnext=0,E(I)):v}function P(I,nt){var O,rt;return I&&I.state?(rt=I.state,nt<0?(O=0,nt=-nt):(O=1+(nt>>4),nt<48&&(nt&=15)),nt&&(nt<8||15<nt)?v:(rt.window!==null&&rt.wbits!==nt&&(rt.window=null),rt.wrap=O,rt.wbits=nt,D(I))):v}function L(I,nt){var O,rt;return I?(rt=new w,(I.state=rt).window=null,(O=P(I,nt))!==m&&(I.state=null),O):v}var R,V,F=!0;function Z(I){if(F){var nt;for(R=new o.Buf32(512),V=new o.Buf32(32),nt=0;nt<144;)I.lens[nt++]=8;for(;nt<256;)I.lens[nt++]=9;for(;nt<280;)I.lens[nt++]=7;for(;nt<288;)I.lens[nt++]=8;for(f(g,I.lens,0,288,R,0,I.work,{bits:9}),nt=0;nt<32;)I.lens[nt++]=5;f(p,I.lens,0,32,V,0,I.work,{bits:5}),F=!1}I.lencode=R,I.lenbits=9,I.distcode=V,I.distbits=5}function tt(I,nt,O,rt){var Q,J=I.state;return J.window===null&&(J.wsize=1<<J.wbits,J.wnext=0,J.whave=0,J.window=new o.Buf8(J.wsize)),rt>=J.wsize?(o.arraySet(J.window,nt,O-J.wsize,J.wsize,0),J.wnext=0,J.whave=J.wsize):(rt<(Q=J.wsize-J.wnext)&&(Q=rt),o.arraySet(J.window,nt,O-rt,Q,J.wnext),(rt-=Q)?(o.arraySet(J.window,nt,O-rt,rt,0),J.wnext=rt,J.whave=J.wsize):(J.wnext+=Q,J.wnext===J.wsize&&(J.wnext=0),J.whave<J.wsize&&(J.whave+=Q))),0}r.inflateReset=D,r.inflateReset2=P,r.inflateResetKeep=E,r.inflateInit=function(I){return L(I,15)},r.inflateInit2=L,r.inflate=function(I,nt){var O,rt,Q,J,_t,vt,Nt,M,C,X,U,j,ot,bt,Ot,Tt,Mt,Zt,te,ve,k,St,lt,z,K=0,at=new o.Buf8(4),kt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!I||!I.state||!I.output||!I.input&&I.avail_in!==0)return v;(O=I.state).mode===12&&(O.mode=13),_t=I.next_out,Q=I.output,Nt=I.avail_out,J=I.next_in,rt=I.input,vt=I.avail_in,M=O.hold,C=O.bits,X=vt,U=Nt,St=m;t:for(;;)switch(O.mode){case b:if(O.wrap===0){O.mode=13;break}for(;C<16;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}if(2&O.wrap&&M===35615){at[O.check=0]=255&M,at[1]=M>>>8&255,O.check=c(O.check,at,2,0),C=M=0,O.mode=2;break}if(O.flags=0,O.head&&(O.head.done=!1),!(1&O.wrap)||(((255&M)<<8)+(M>>8))%31){I.msg="incorrect header check",O.mode=30;break}if((15&M)!=8){I.msg="unknown compression method",O.mode=30;break}if(C-=4,k=8+(15&(M>>>=4)),O.wbits===0)O.wbits=k;else if(k>O.wbits){I.msg="invalid window size",O.mode=30;break}O.dmax=1<<k,I.adler=O.check=1,O.mode=512&M?10:12,C=M=0;break;case 2:for(;C<16;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}if(O.flags=M,(255&O.flags)!=8){I.msg="unknown compression method",O.mode=30;break}if(57344&O.flags){I.msg="unknown header flags set",O.mode=30;break}O.head&&(O.head.text=M>>8&1),512&O.flags&&(at[0]=255&M,at[1]=M>>>8&255,O.check=c(O.check,at,2,0)),C=M=0,O.mode=3;case 3:for(;C<32;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}O.head&&(O.head.time=M),512&O.flags&&(at[0]=255&M,at[1]=M>>>8&255,at[2]=M>>>16&255,at[3]=M>>>24&255,O.check=c(O.check,at,4,0)),C=M=0,O.mode=4;case 4:for(;C<16;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}O.head&&(O.head.xflags=255&M,O.head.os=M>>8),512&O.flags&&(at[0]=255&M,at[1]=M>>>8&255,O.check=c(O.check,at,2,0)),C=M=0,O.mode=5;case 5:if(1024&O.flags){for(;C<16;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}O.length=M,O.head&&(O.head.extra_len=M),512&O.flags&&(at[0]=255&M,at[1]=M>>>8&255,O.check=c(O.check,at,2,0)),C=M=0}else O.head&&(O.head.extra=null);O.mode=6;case 6:if(1024&O.flags&&(vt<(j=O.length)&&(j=vt),j&&(O.head&&(k=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Array(O.head.extra_len)),o.arraySet(O.head.extra,rt,J,j,k)),512&O.flags&&(O.check=c(O.check,rt,j,J)),vt-=j,J+=j,O.length-=j),O.length))break t;O.length=0,O.mode=7;case 7:if(2048&O.flags){if(vt===0)break t;for(j=0;k=rt[J+j++],O.head&&k&&O.length<65536&&(O.head.name+=String.fromCharCode(k)),k&&j<vt;);if(512&O.flags&&(O.check=c(O.check,rt,j,J)),vt-=j,J+=j,k)break t}else O.head&&(O.head.name=null);O.length=0,O.mode=8;case 8:if(4096&O.flags){if(vt===0)break t;for(j=0;k=rt[J+j++],O.head&&k&&O.length<65536&&(O.head.comment+=String.fromCharCode(k)),k&&j<vt;);if(512&O.flags&&(O.check=c(O.check,rt,j,J)),vt-=j,J+=j,k)break t}else O.head&&(O.head.comment=null);O.mode=9;case 9:if(512&O.flags){for(;C<16;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}if(M!==(65535&O.check)){I.msg="header crc mismatch",O.mode=30;break}C=M=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),I.adler=O.check=0,O.mode=12;break;case 10:for(;C<32;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}I.adler=O.check=S(M),C=M=0,O.mode=11;case 11:if(O.havedict===0)return I.next_out=_t,I.avail_out=Nt,I.next_in=J,I.avail_in=vt,O.hold=M,O.bits=C,2;I.adler=O.check=1,O.mode=12;case 12:if(nt===5||nt===6)break t;case 13:if(O.last){M>>>=7&C,C-=7&C,O.mode=27;break}for(;C<3;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}switch(O.last=1&M,C-=1,3&(M>>>=1)){case 0:O.mode=14;break;case 1:if(Z(O),O.mode=20,nt!==6)break;M>>>=2,C-=2;break t;case 2:O.mode=17;break;case 3:I.msg="invalid block type",O.mode=30}M>>>=2,C-=2;break;case 14:for(M>>>=7&C,C-=7&C;C<32;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}if((65535&M)!=(M>>>16^65535)){I.msg="invalid stored block lengths",O.mode=30;break}if(O.length=65535&M,C=M=0,O.mode=15,nt===6)break t;case 15:O.mode=16;case 16:if(j=O.length){if(vt<j&&(j=vt),Nt<j&&(j=Nt),j===0)break t;o.arraySet(Q,rt,J,j,_t),vt-=j,J+=j,Nt-=j,_t+=j,O.length-=j;break}O.mode=12;break;case 17:for(;C<14;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}if(O.nlen=257+(31&M),M>>>=5,C-=5,O.ndist=1+(31&M),M>>>=5,C-=5,O.ncode=4+(15&M),M>>>=4,C-=4,286<O.nlen||30<O.ndist){I.msg="too many length or distance symbols",O.mode=30;break}O.have=0,O.mode=18;case 18:for(;O.have<O.ncode;){for(;C<3;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}O.lens[kt[O.have++]]=7&M,M>>>=3,C-=3}for(;O.have<19;)O.lens[kt[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,lt={bits:O.lenbits},St=f(0,O.lens,0,19,O.lencode,0,O.work,lt),O.lenbits=lt.bits,St){I.msg="invalid code lengths set",O.mode=30;break}O.have=0,O.mode=19;case 19:for(;O.have<O.nlen+O.ndist;){for(;Tt=(K=O.lencode[M&(1<<O.lenbits)-1])>>>16&255,Mt=65535&K,!((Ot=K>>>24)<=C);){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}if(Mt<16)M>>>=Ot,C-=Ot,O.lens[O.have++]=Mt;else{if(Mt===16){for(z=Ot+2;C<z;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}if(M>>>=Ot,C-=Ot,O.have===0){I.msg="invalid bit length repeat",O.mode=30;break}k=O.lens[O.have-1],j=3+(3&M),M>>>=2,C-=2}else if(Mt===17){for(z=Ot+3;C<z;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}C-=Ot,k=0,j=3+(7&(M>>>=Ot)),M>>>=3,C-=3}else{for(z=Ot+7;C<z;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}C-=Ot,k=0,j=11+(127&(M>>>=Ot)),M>>>=7,C-=7}if(O.have+j>O.nlen+O.ndist){I.msg="invalid bit length repeat",O.mode=30;break}for(;j--;)O.lens[O.have++]=k}}if(O.mode===30)break;if(O.lens[256]===0){I.msg="invalid code -- missing end-of-block",O.mode=30;break}if(O.lenbits=9,lt={bits:O.lenbits},St=f(g,O.lens,0,O.nlen,O.lencode,0,O.work,lt),O.lenbits=lt.bits,St){I.msg="invalid literal/lengths set",O.mode=30;break}if(O.distbits=6,O.distcode=O.distdyn,lt={bits:O.distbits},St=f(p,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,lt),O.distbits=lt.bits,St){I.msg="invalid distances set",O.mode=30;break}if(O.mode=20,nt===6)break t;case 20:O.mode=21;case 21:if(6<=vt&&258<=Nt){I.next_out=_t,I.avail_out=Nt,I.next_in=J,I.avail_in=vt,O.hold=M,O.bits=C,h(I,U),_t=I.next_out,Q=I.output,Nt=I.avail_out,J=I.next_in,rt=I.input,vt=I.avail_in,M=O.hold,C=O.bits,O.mode===12&&(O.back=-1);break}for(O.back=0;Tt=(K=O.lencode[M&(1<<O.lenbits)-1])>>>16&255,Mt=65535&K,!((Ot=K>>>24)<=C);){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}if(Tt&&(240&Tt)==0){for(Zt=Ot,te=Tt,ve=Mt;Tt=(K=O.lencode[ve+((M&(1<<Zt+te)-1)>>Zt)])>>>16&255,Mt=65535&K,!(Zt+(Ot=K>>>24)<=C);){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}M>>>=Zt,C-=Zt,O.back+=Zt}if(M>>>=Ot,C-=Ot,O.back+=Ot,O.length=Mt,Tt===0){O.mode=26;break}if(32&Tt){O.back=-1,O.mode=12;break}if(64&Tt){I.msg="invalid literal/length code",O.mode=30;break}O.extra=15&Tt,O.mode=22;case 22:if(O.extra){for(z=O.extra;C<z;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}O.length+=M&(1<<O.extra)-1,M>>>=O.extra,C-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=23;case 23:for(;Tt=(K=O.distcode[M&(1<<O.distbits)-1])>>>16&255,Mt=65535&K,!((Ot=K>>>24)<=C);){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}if((240&Tt)==0){for(Zt=Ot,te=Tt,ve=Mt;Tt=(K=O.distcode[ve+((M&(1<<Zt+te)-1)>>Zt)])>>>16&255,Mt=65535&K,!(Zt+(Ot=K>>>24)<=C);){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}M>>>=Zt,C-=Zt,O.back+=Zt}if(M>>>=Ot,C-=Ot,O.back+=Ot,64&Tt){I.msg="invalid distance code",O.mode=30;break}O.offset=Mt,O.extra=15&Tt,O.mode=24;case 24:if(O.extra){for(z=O.extra;C<z;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}O.offset+=M&(1<<O.extra)-1,M>>>=O.extra,C-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){I.msg="invalid distance too far back",O.mode=30;break}O.mode=25;case 25:if(Nt===0)break t;if(j=U-Nt,O.offset>j){if((j=O.offset-j)>O.whave&&O.sane){I.msg="invalid distance too far back",O.mode=30;break}ot=j>O.wnext?(j-=O.wnext,O.wsize-j):O.wnext-j,j>O.length&&(j=O.length),bt=O.window}else bt=Q,ot=_t-O.offset,j=O.length;for(Nt<j&&(j=Nt),Nt-=j,O.length-=j;Q[_t++]=bt[ot++],--j;);O.length===0&&(O.mode=21);break;case 26:if(Nt===0)break t;Q[_t++]=O.length,Nt--,O.mode=21;break;case 27:if(O.wrap){for(;C<32;){if(vt===0)break t;vt--,M|=rt[J++]<<C,C+=8}if(U-=Nt,I.total_out+=U,O.total+=U,U&&(I.adler=O.check=O.flags?c(O.check,Q,U,_t-U):l(O.check,Q,U,_t-U)),U=Nt,(O.flags?M:S(M))!==O.check){I.msg="incorrect data check",O.mode=30;break}C=M=0}O.mode=28;case 28:if(O.wrap&&O.flags){for(;C<32;){if(vt===0)break t;vt--,M+=rt[J++]<<C,C+=8}if(M!==(4294967295&O.total)){I.msg="incorrect length check",O.mode=30;break}C=M=0}O.mode=29;case 29:St=1;break t;case 30:St=-3;break t;case 31:return-4;default:return v}return I.next_out=_t,I.avail_out=Nt,I.next_in=J,I.avail_in=vt,O.hold=M,O.bits=C,(O.wsize||U!==I.avail_out&&O.mode<30&&(O.mode<27||nt!==4))&&tt(I,I.output,I.next_out,U-I.avail_out)?(O.mode=31,-4):(X-=I.avail_in,U-=I.avail_out,I.total_in+=X,I.total_out+=U,O.total+=U,O.wrap&&U&&(I.adler=O.check=O.flags?c(O.check,Q,U,I.next_out-U):l(O.check,Q,U,I.next_out-U)),I.data_type=O.bits+(O.last?64:0)+(O.mode===12?128:0)+(O.mode===20||O.mode===15?256:0),(X==0&&U===0||nt===4)&&St===m&&(St=-5),St)},r.inflateEnd=function(I){if(!I||!I.state)return v;var nt=I.state;return nt.window&&(nt.window=null),I.state=null,m},r.inflateGetHeader=function(I,nt){var O;return I&&I.state?(2&(O=I.state).wrap)==0?v:((O.head=nt).done=!1,m):v},r.inflateSetDictionary=function(I,nt){var O,rt=nt.length;return I&&I.state?(O=I.state).wrap!==0&&O.mode!==11?v:O.mode===11&&l(1,nt,rt,0)!==O.check?-3:tt(I,nt,rt,rt)?(O.mode=31,-4):(O.havedict=1,m):v},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,n,r){var o=e("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(g,p,m,v,b,y,A,S){var w,E,D,P,L,R,V,F,Z,tt=S.bits,I=0,nt=0,O=0,rt=0,Q=0,J=0,_t=0,vt=0,Nt=0,M=0,C=null,X=0,U=new o.Buf16(16),j=new o.Buf16(16),ot=null,bt=0;for(I=0;I<=15;I++)U[I]=0;for(nt=0;nt<v;nt++)U[p[m+nt]]++;for(Q=tt,rt=15;1<=rt&&U[rt]===0;rt--);if(rt<Q&&(Q=rt),rt===0)return b[y++]=20971520,b[y++]=20971520,S.bits=1,0;for(O=1;O<rt&&U[O]===0;O++);for(Q<O&&(Q=O),I=vt=1;I<=15;I++)if(vt<<=1,(vt-=U[I])<0)return-1;if(0<vt&&(g===0||rt!==1))return-1;for(j[1]=0,I=1;I<15;I++)j[I+1]=j[I]+U[I];for(nt=0;nt<v;nt++)p[m+nt]!==0&&(A[j[p[m+nt]]++]=nt);if(R=g===0?(C=ot=A,19):g===1?(C=l,X-=257,ot=c,bt-=257,256):(C=h,ot=f,-1),I=O,L=y,_t=nt=M=0,D=-1,P=(Nt=1<<(J=Q))-1,g===1&&852<Nt||g===2&&592<Nt)return 1;for(;;){for(V=I-_t,Z=A[nt]<R?(F=0,A[nt]):A[nt]>R?(F=ot[bt+A[nt]],C[X+A[nt]]):(F=96,0),w=1<<I-_t,O=E=1<<J;b[L+(M>>_t)+(E-=w)]=V<<24|F<<16|Z|0,E!==0;);for(w=1<<I-1;M&w;)w>>=1;if(w!==0?(M&=w-1,M+=w):M=0,nt++,--U[I]==0){if(I===rt)break;I=p[m+A[nt]]}if(Q<I&&(M&P)!==D){for(_t===0&&(_t=Q),L+=O,vt=1<<(J=I-_t);J+_t<rt&&!((vt-=U[J+_t])<=0);)J++,vt<<=1;if(Nt+=1<<J,g===1&&852<Nt||g===2&&592<Nt)return 1;b[D=M&P]=Q<<24|J<<16|L-y|0}}return M!==0&&(b[L+M]=I-_t<<24|64<<16|0),S.bits=Q,0}},{"../utils/common":41}],51:[function(e,n,r){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,n,r){var o=e("../utils/common"),l=0,c=1;function h(K){for(var at=K.length;0<=--at;)K[at]=0}var f=0,g=29,p=256,m=p+1+g,v=30,b=19,y=2*m+1,A=15,S=16,w=7,E=256,D=16,P=17,L=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],tt=new Array(2*(m+2));h(tt);var I=new Array(2*v);h(I);var nt=new Array(512);h(nt);var O=new Array(256);h(O);var rt=new Array(g);h(rt);var Q,J,_t,vt=new Array(v);function Nt(K,at,kt,Rt,ht){this.static_tree=K,this.extra_bits=at,this.extra_base=kt,this.elems=Rt,this.max_length=ht,this.has_stree=K&&K.length}function M(K,at){this.dyn_tree=K,this.max_code=0,this.stat_desc=at}function C(K){return K<256?nt[K]:nt[256+(K>>>7)]}function X(K,at){K.pending_buf[K.pending++]=255&at,K.pending_buf[K.pending++]=at>>>8&255}function U(K,at,kt){K.bi_valid>S-kt?(K.bi_buf|=at<<K.bi_valid&65535,X(K,K.bi_buf),K.bi_buf=at>>S-K.bi_valid,K.bi_valid+=kt-S):(K.bi_buf|=at<<K.bi_valid&65535,K.bi_valid+=kt)}function j(K,at,kt){U(K,kt[2*at],kt[2*at+1])}function ot(K,at){for(var kt=0;kt|=1&K,K>>>=1,kt<<=1,0<--at;);return kt>>>1}function bt(K,at,kt){var Rt,ht,Bt=new Array(A+1),It=0;for(Rt=1;Rt<=A;Rt++)Bt[Rt]=It=It+kt[Rt-1]<<1;for(ht=0;ht<=at;ht++){var Ut=K[2*ht+1];Ut!==0&&(K[2*ht]=ot(Bt[Ut]++,Ut))}}function Ot(K){var at;for(at=0;at<m;at++)K.dyn_ltree[2*at]=0;for(at=0;at<v;at++)K.dyn_dtree[2*at]=0;for(at=0;at<b;at++)K.bl_tree[2*at]=0;K.dyn_ltree[2*E]=1,K.opt_len=K.static_len=0,K.last_lit=K.matches=0}function Tt(K){8<K.bi_valid?X(K,K.bi_buf):0<K.bi_valid&&(K.pending_buf[K.pending++]=K.bi_buf),K.bi_buf=0,K.bi_valid=0}function Mt(K,at,kt,Rt){var ht=2*at,Bt=2*kt;return K[ht]<K[Bt]||K[ht]===K[Bt]&&Rt[at]<=Rt[kt]}function Zt(K,at,kt){for(var Rt=K.heap[kt],ht=kt<<1;ht<=K.heap_len&&(ht<K.heap_len&&Mt(at,K.heap[ht+1],K.heap[ht],K.depth)&&ht++,!Mt(at,Rt,K.heap[ht],K.depth));)K.heap[kt]=K.heap[ht],kt=ht,ht<<=1;K.heap[kt]=Rt}function te(K,at,kt){var Rt,ht,Bt,It,Ut=0;if(K.last_lit!==0)for(;Rt=K.pending_buf[K.d_buf+2*Ut]<<8|K.pending_buf[K.d_buf+2*Ut+1],ht=K.pending_buf[K.l_buf+Ut],Ut++,Rt===0?j(K,ht,at):(j(K,(Bt=O[ht])+p+1,at),(It=R[Bt])!==0&&U(K,ht-=rt[Bt],It),j(K,Bt=C(--Rt),kt),(It=V[Bt])!==0&&U(K,Rt-=vt[Bt],It)),Ut<K.last_lit;);j(K,E,at)}function ve(K,at){var kt,Rt,ht,Bt=at.dyn_tree,It=at.stat_desc.static_tree,Ut=at.stat_desc.has_stree,$t=at.stat_desc.elems,ye=-1;for(K.heap_len=0,K.heap_max=y,kt=0;kt<$t;kt++)Bt[2*kt]!==0?(K.heap[++K.heap_len]=ye=kt,K.depth[kt]=0):Bt[2*kt+1]=0;for(;K.heap_len<2;)Bt[2*(ht=K.heap[++K.heap_len]=ye<2?++ye:0)]=1,K.depth[ht]=0,K.opt_len--,Ut&&(K.static_len-=It[2*ht+1]);for(at.max_code=ye,kt=K.heap_len>>1;1<=kt;kt--)Zt(K,Bt,kt);for(ht=$t;kt=K.heap[1],K.heap[1]=K.heap[K.heap_len--],Zt(K,Bt,1),Rt=K.heap[1],K.heap[--K.heap_max]=kt,K.heap[--K.heap_max]=Rt,Bt[2*ht]=Bt[2*kt]+Bt[2*Rt],K.depth[ht]=(K.depth[kt]>=K.depth[Rt]?K.depth[kt]:K.depth[Rt])+1,Bt[2*kt+1]=Bt[2*Rt+1]=ht,K.heap[1]=ht++,Zt(K,Bt,1),2<=K.heap_len;);K.heap[--K.heap_max]=K.heap[1],(function(ne,zn){var Ki,Vn,na,Te,an,Xn,je=zn.dyn_tree,gs=zn.max_code,ps=zn.stat_desc.static_tree,ms=zn.stat_desc.has_stree,xa=zn.stat_desc.extra_bits,_a=zn.stat_desc.extra_base,Ci=zn.stat_desc.max_length,Cn=0;for(Te=0;Te<=A;Te++)ne.bl_count[Te]=0;for(je[2*ne.heap[ne.heap_max]+1]=0,Ki=ne.heap_max+1;Ki<y;Ki++)Ci<(Te=je[2*je[2*(Vn=ne.heap[Ki])+1]+1]+1)&&(Te=Ci,Cn++),je[2*Vn+1]=Te,gs<Vn||(ne.bl_count[Te]++,an=0,_a<=Vn&&(an=xa[Vn-_a]),Xn=je[2*Vn],ne.opt_len+=Xn*(Te+an),ms&&(ne.static_len+=Xn*(ps[2*Vn+1]+an)));if(Cn!==0){do{for(Te=Ci-1;ne.bl_count[Te]===0;)Te--;ne.bl_count[Te]--,ne.bl_count[Te+1]+=2,ne.bl_count[Ci]--,Cn-=2}while(0<Cn);for(Te=Ci;Te!==0;Te--)for(Vn=ne.bl_count[Te];Vn!==0;)gs<(na=ne.heap[--Ki])||(je[2*na+1]!==Te&&(ne.opt_len+=(Te-je[2*na+1])*je[2*na],je[2*na+1]=Te),Vn--)}})(K,at),bt(Bt,ye,K.bl_count)}function k(K,at,kt){var Rt,ht,Bt=-1,It=at[1],Ut=0,$t=7,ye=4;for(It===0&&($t=138,ye=3),at[2*(kt+1)+1]=65535,Rt=0;Rt<=kt;Rt++)ht=It,It=at[2*(Rt+1)+1],++Ut<$t&&ht===It||(Ut<ye?K.bl_tree[2*ht]+=Ut:ht!==0?(ht!==Bt&&K.bl_tree[2*ht]++,K.bl_tree[2*D]++):Ut<=10?K.bl_tree[2*P]++:K.bl_tree[2*L]++,Bt=ht,ye=(Ut=0)===It?($t=138,3):ht===It?($t=6,3):($t=7,4))}function St(K,at,kt){var Rt,ht,Bt=-1,It=at[1],Ut=0,$t=7,ye=4;for(It===0&&($t=138,ye=3),Rt=0;Rt<=kt;Rt++)if(ht=It,It=at[2*(Rt+1)+1],!(++Ut<$t&&ht===It)){if(Ut<ye)for(;j(K,ht,K.bl_tree),--Ut!=0;);else ht!==0?(ht!==Bt&&(j(K,ht,K.bl_tree),Ut--),j(K,D,K.bl_tree),U(K,Ut-3,2)):Ut<=10?(j(K,P,K.bl_tree),U(K,Ut-3,3)):(j(K,L,K.bl_tree),U(K,Ut-11,7));Bt=ht,ye=(Ut=0)===It?($t=138,3):ht===It?($t=6,3):($t=7,4)}}h(vt);var lt=!1;function z(K,at,kt,Rt){U(K,(f<<1)+(Rt?1:0),3),(function(ht,Bt,It,Ut){Tt(ht),X(ht,It),X(ht,~It),o.arraySet(ht.pending_buf,ht.window,Bt,It,ht.pending),ht.pending+=It})(K,at,kt)}r._tr_init=function(K){lt||((function(){var at,kt,Rt,ht,Bt,It=new Array(A+1);for(ht=Rt=0;ht<g-1;ht++)for(rt[ht]=Rt,at=0;at<1<<R[ht];at++)O[Rt++]=ht;for(O[Rt-1]=ht,ht=Bt=0;ht<16;ht++)for(vt[ht]=Bt,at=0;at<1<<V[ht];at++)nt[Bt++]=ht;for(Bt>>=7;ht<v;ht++)for(vt[ht]=Bt<<7,at=0;at<1<<V[ht]-7;at++)nt[256+Bt++]=ht;for(kt=0;kt<=A;kt++)It[kt]=0;for(at=0;at<=143;)tt[2*at+1]=8,at++,It[8]++;for(;at<=255;)tt[2*at+1]=9,at++,It[9]++;for(;at<=279;)tt[2*at+1]=7,at++,It[7]++;for(;at<=287;)tt[2*at+1]=8,at++,It[8]++;for(bt(tt,m+1,It),at=0;at<v;at++)I[2*at+1]=5,I[2*at]=ot(at,5);Q=new Nt(tt,R,p+1,m,A),J=new Nt(I,V,0,v,A),_t=new Nt(new Array(0),F,0,b,w)})(),lt=!0),K.l_desc=new M(K.dyn_ltree,Q),K.d_desc=new M(K.dyn_dtree,J),K.bl_desc=new M(K.bl_tree,_t),K.bi_buf=0,K.bi_valid=0,Ot(K)},r._tr_stored_block=z,r._tr_flush_block=function(K,at,kt,Rt){var ht,Bt,It=0;0<K.level?(K.strm.data_type===2&&(K.strm.data_type=(function(Ut){var $t,ye=4093624447;for($t=0;$t<=31;$t++,ye>>>=1)if(1&ye&&Ut.dyn_ltree[2*$t]!==0)return l;if(Ut.dyn_ltree[18]!==0||Ut.dyn_ltree[20]!==0||Ut.dyn_ltree[26]!==0)return c;for($t=32;$t<p;$t++)if(Ut.dyn_ltree[2*$t]!==0)return c;return l})(K)),ve(K,K.l_desc),ve(K,K.d_desc),It=(function(Ut){var $t;for(k(Ut,Ut.dyn_ltree,Ut.l_desc.max_code),k(Ut,Ut.dyn_dtree,Ut.d_desc.max_code),ve(Ut,Ut.bl_desc),$t=b-1;3<=$t&&Ut.bl_tree[2*Z[$t]+1]===0;$t--);return Ut.opt_len+=3*($t+1)+5+5+4,$t})(K),ht=K.opt_len+3+7>>>3,(Bt=K.static_len+3+7>>>3)<=ht&&(ht=Bt)):ht=Bt=kt+5,kt+4<=ht&&at!==-1?z(K,at,kt,Rt):K.strategy===4||Bt===ht?(U(K,2+(Rt?1:0),3),te(K,tt,I)):(U(K,4+(Rt?1:0),3),(function(Ut,$t,ye,ne){var zn;for(U(Ut,$t-257,5),U(Ut,ye-1,5),U(Ut,ne-4,4),zn=0;zn<ne;zn++)U(Ut,Ut.bl_tree[2*Z[zn]+1],3);St(Ut,Ut.dyn_ltree,$t-1),St(Ut,Ut.dyn_dtree,ye-1)})(K,K.l_desc.max_code+1,K.d_desc.max_code+1,It+1),te(K,K.dyn_ltree,K.dyn_dtree)),Ot(K),Rt&&Tt(K)},r._tr_tally=function(K,at,kt){return K.pending_buf[K.d_buf+2*K.last_lit]=at>>>8&255,K.pending_buf[K.d_buf+2*K.last_lit+1]=255&at,K.pending_buf[K.l_buf+K.last_lit]=255&kt,K.last_lit++,at===0?K.dyn_ltree[2*kt]++:(K.matches++,at--,K.dyn_ltree[2*(O[kt]+p+1)]++,K.dyn_dtree[2*C(at)]++),K.last_lit===K.lit_bufsize-1},r._tr_align=function(K){U(K,2,3),j(K,E,tt),(function(at){at.bi_valid===16?(X(at,at.bi_buf),at.bi_buf=0,at.bi_valid=0):8<=at.bi_valid&&(at.pending_buf[at.pending++]=255&at.bi_buf,at.bi_buf>>=8,at.bi_valid-=8)})(K)}},{"../utils/common":41}],53:[function(e,n,r){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,n,r){(function(o){(function(l,c){if(!l.setImmediate){var h,f,g,p,m=1,v={},b=!1,y=l.document,A=Object.getPrototypeOf&&Object.getPrototypeOf(l);A=A&&A.setTimeout?A:l,h={}.toString.call(l.process)==="[object process]"?function(D){process.nextTick(function(){w(D)})}:(function(){if(l.postMessage&&!l.importScripts){var D=!0,P=l.onmessage;return l.onmessage=function(){D=!1},l.postMessage("","*"),l.onmessage=P,D}})()?(p="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",E,!1):l.attachEvent("onmessage",E),function(D){l.postMessage(p+D,"*")}):l.MessageChannel?((g=new MessageChannel).port1.onmessage=function(D){w(D.data)},function(D){g.port2.postMessage(D)}):y&&"onreadystatechange"in y.createElement("script")?(f=y.documentElement,function(D){var P=y.createElement("script");P.onreadystatechange=function(){w(D),P.onreadystatechange=null,f.removeChild(P),P=null},f.appendChild(P)}):function(D){setTimeout(w,0,D)},A.setImmediate=function(D){typeof D!="function"&&(D=new Function(""+D));for(var P=new Array(arguments.length-1),L=0;L<P.length;L++)P[L]=arguments[L+1];var R={callback:D,args:P};return v[m]=R,h(m),m++},A.clearImmediate=S}function S(D){delete v[D]}function w(D){if(b)setTimeout(w,0,D);else{var P=v[D];if(P){b=!0;try{(function(L){var R=L.callback,V=L.args;switch(V.length){case 0:R();break;case 1:R(V[0]);break;case 2:R(V[0],V[1]);break;case 3:R(V[0],V[1],V[2]);break;default:R.apply(c,V)}})(P)}finally{S(D),b=!1}}}}function E(D){D.source===l&&typeof D.data=="string"&&D.data.indexOf(p)===0&&w(+D.data.slice(p.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof bu<"u"?bu:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(qd)),qd.exports}var tw=QS();const J2=Ub(tw);ts.workerSrc=new URL("/coretax_bukpot_pdf_to_excel/assets/pdf.worker.min-LyOxJPrg.mjs",import.meta.url).toString();const ew={"21-100-01":"Penghasilan yang Diterima atau Diperoleh Pegawai Tetap","21-100-02":"Penghasilan yang Diterima atau Diperoleh Pensiunan Secara Teratur","21-100-05":"Imbalan kepada Agen Asuransi","21-100-06":"Imbalan kepada Petugas Penjaja Barang Dagangan","21-100-07":"Imbalan kepada Tenaga Ahli (Pengacara, Akuntan, Arsitek, Dokter, Konsultan, Notaris, Pejabat Pembuat Akte Tanah, Penilai, Aktuaris)","21-100-10":"Honorarium atau Imbalan kepada Anggota Dewan Komisaris atau Dewan Pengawas yang Menerima Imbalan secara Tidak Teratur","21-100-12":"Uang Manfaat Pensiun atau Penghasilan Sejenisnya yang diambil sebagian oleh Peserta Program Pensiun yang Masih Berstatus sebagai Pegawai","21-100-14":"Imbalan kepada Peserta Rapat, Konferensi, Sidang, Pertemuan, Kunjungan Kerja, Seminar, Lokakarya, atau Pertunjukan, atau Kegiatan Tertentu Lainnya","21-100-15":"Imbalan kepada Peserta atau Anggota dalam Suatu Kepanitiaan sebagai Penyelenggara Kegiatan Tertentu","21-100-16":"Imbalan kepada Peserta Pendidikan, Pelatihan, dan Magang","21-100-17":"Imbalan kepada Peserta Kegiatan Lainnya","21-100-18":"Imbalan kepada Penasihat, Pengajar, Pelatih, Penceramah, Penyuluh, dan Moderator","21-100-19":"Imbalan kepada Pengarang, Peneliti, Penerjemah","21-100-20":"Imbalan kepada Pemberi Jasa dalam Segala Bidang","21-100-21":"Imbalan kepada Agen Iklan","21-100-22":"Imbalan kepada Pengawas atau Pengelola Proyek","21-100-23":"Imbalan kepada Pembawa Pesanan atau yang Menemukan Langganan atau yang Menjadi Perantara","21-100-24":"Upah Pegawai Tidak Tetap yang Dibayarkan secara Harian, Mingguan, Satuan dan Borongan dengan Penghasilan Bruto sampai dengan Rp2.500.000 Sehari","21-100-27":"Upah Pegawai Tidak Tetap yang Dibayarkan secara Bulanan yang Mendapat Fasilitas di Daerah Tertentu","21-100-29":"Upah Pegawai Tidak Tetap yang Dibayarkan secara Harian, Mingguan, Satuan dan Borongan dengan Penghasilan Bruto sampai dengan Rp2.500.000 Sehari yang Mendapat Fasilitas di Daerah Tertentu","21-100-30":"Upah Pegawai Tidak Tetap yang Dibayarkan secara Harian, Mingguan, Satuan dan Borongan dengan Penghasilan Bruto lebih dari Rp2.500.000 Sehari","21-100-31":"Upah Pegawai Tidak Tetap yang Dibayarkan secara Harian, Mingguan, Satuan dan Borongan dengan Penghasilan Bruto lebih dari Rp2.500.000 Sehari yang Mendapat Fasilitas di Daerah Tertentu","21-100-32":"Penghasilan yang Diterima atau Diperoleh Pegawai Tetap yang Menerima fasilitas di Daerah Tertentu","21-100-33":"Imbalan kepada Pemain Musik, Pembawa Acara, Penyanyi, Pelawak, Bintang Film, Bintang Sinetron, Bintang Iklan, Sutradara, Kru Film, Foto Model, Peragawan/Peragawati, Pemain Drama, Penari, Pemahat, Pelukis, Pembuat/Pencipta Konten pada Media yang Dibagikan secara Daring (Influencer, Selebgram, Blogger, Vlogger, dan Sejenis Lainnya), dan Seniman Lainnya","21-100-34":"Imbalan yang Diterima oleh Olahragawan","21-100-35":"Upah Pegawai Tidak Tetap yang Dibayarkan secara Bulanan","21-100-36":"Imbalan kepada Peserta Perlombaan dalam Segala Bidang, antara lain Perlombaan Olah Raga, Seni, Ketangkasan, Ilmu Pengetahuan, Teknologi, dan Perlombaan Lainnya","21-401-01":"Uang Pesangon yang Dibayarkan Sekaligus","21-401-02":"Uang Manfaat Pensiun, Tunjangan Hari Tua, atau Jaminan Hari Tua yang Dibayarkan Sekaligus"};function nw(i){const t=i.replace(/\s+/g," ").trim(),e=t.match(/NOMOR BUKTI PEMOTONGAN MASA PAJAK SIFAT PEMOTONGAN STATUS BUKTI PEMOTONGAN ([A-Z0-9]+) (\d{2}-\d{4}) (TIDAK FINAL|FINAL|BERSIFAT FINAL|TIDAK BERSIFAT FINAL) (NORMAL|PBK|SATUAN KERJA)/i),n={nomor_bukti:e?e[1]:Ua(t,[/No\.? Bukti Pemotongan ([A-Z0-9]+)/i]),masa_pajak:e?e[2]:Ua(t,[/Masa Pajak (\d{2}-\d{4})/i]),sifat_pemotongan:e?e[3]:Ua(t,[/Sifat Pemotongan ([A-Z\s]+?) Status/i]),status_bukti:e?e[4]:Ua(t,[/Status Bukti Pemotongan ([A-Z]+?) A/i]),nik:Ua(t,[/A\.1\s+NIK\/NPWP\s+:?\s*([\d.]+)/i,/NIK\/NPWP\s+:?\s*([\d.]+)/i]),nama_penerima:Ua(t,[/A\.2\s+Nama\s+:?\s*([A-Z][A-Z\s\.]+?)(?=\s+A\.3|$)/i]),kode_objek_pajak:Ua(t,[/KODE\s+OBJEK\s+PAJAK\s*:\s*(\d{2}-\d{3}-\d{2})/i,/(\d{2}-\d{3}-\d{2})/i]),penghasilan_bruto:Pv(t,[/Imbalan kepada Pemberi Jasa[^\d]*?([\d.,]+)\s+[\d.]+\s+[\d.]+\s+[\d.]+/i]),pph_dipotong:Pv(t,[/Imbalan kepada Pemberi Jasa[^\d]*?[\d.,]+\s+[\d.]+\s+[\d.]+\s+([\d.,]+)/i]),nama_pemotong:Ua(t,[/C\.3\s+Nama Pemotong\s+:?\s*([A-Z][A-Z\s\.,]+?)(?=\s+C\.4|$)/i,/Nama Pemotong\s+:?\s*([A-Z][A-Z\s\.,]+)/i]),tanggal_pemotong:Ua(t,[/C\.4\s+Tanggal\s+:?\s*(\d{1,2}\s+[A-Za-z]+\s+\d{4})/i,/Tanggal\s+:?\s*(\d{1,2}\s+[A-Za-z]+\s+\d{4})/i])};return n.kode_objek_pajak?n.nama_objek_pajak=ew[n.kode_objek_pajak]||"":n.nama_objek_pajak="",Object.keys(n).forEach(r=>{typeof n[r]=="string"&&(n[r]=n[r].trim())}),n}function Ua(i,t){for(const e of t){const n=i.match(e);if(n&&n[1])return n[1].trim()}return""}function Pv(i,t){for(const e of t){const n=i.match(e);if(n&&n[1]){const r=n[1].replace(/\./g,"").replace(",","."),o=parseFloat(r);return isNaN(o)?0:o}}return 0}async function iw(i,t){try{const n=await R0({data:i}).promise;let r="";for(let l=1;l<=n.numPages;l++){const f=(await(await n.getPage(l)).getTextContent()).items.map(g=>g.str).join(" ");r+=f+`
`}console.log(`=== Text from ${t} ===`),console.log(r.substring(0,800));const o=nw(r);return console.log(`=== Extracted data from ${t} ===`),console.log(JSON.stringify(o,null,2)),{success:!0,filename:t,data:o}}catch(e){return console.error(`Error parsing PDF ${t}:`,e),{success:!1,filename:t,error:e.message}}}async function aw(i,t){const e=await J2.loadAsync(i),n=[],r=[];if(e.forEach((o,l)=>{o.toLowerCase().endsWith(".pdf")&&!l.dir&&n.push(l)}),n.length===0)throw new Error("Tidak ada file PDF ditemukan dalam arsip ZIP");t(o=>({...o,percentage:20,message:`Ditemukan ${n.length} file PDF`,total:n.length}));for(let o=0;o<n.length;o++){const l=n[o];try{const c=await l.async("arraybuffer"),h=await iw(c,l.name);r.push(h);const f=20+Math.floor((o+1)/n.length*70);t(g=>({...g,percentage:f,message:`Memproses: ${l.name}`,current:o+1}))}catch(c){console.error(`Error processing ${l.name}:`,c),r.push({success:!1,filename:l.name,error:c.message})}}return r}var Ku={};Ku.version="0.18.5";var Q2=1252,rw=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ty=function(i){rw.indexOf(i)!=-1&&(Q2=i)};function sw(){ty(1252)}var Hl=function(i){ty(i)};function ow(){Hl(1200),sw()}var Pu=function(t){return String.fromCharCode(t)},Mv=function(t){return String.fromCharCode(t)},Wu,Ar="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jl(i){for(var t="",e=0,n=0,r=0,o=0,l=0,c=0,h=0,f=0;f<i.length;)e=i.charCodeAt(f++),o=e>>2,n=i.charCodeAt(f++),l=(e&3)<<4|n>>4,r=i.charCodeAt(f++),c=(n&15)<<2|r>>6,h=r&63,isNaN(n)?c=h=64:isNaN(r)&&(h=64),t+=Ar.charAt(o)+Ar.charAt(l)+Ar.charAt(c)+Ar.charAt(h);return t}function Ka(i){var t="",e=0,n=0,r=0,o=0,l=0,c=0,h=0;i=i.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<i.length;)o=Ar.indexOf(i.charAt(f++)),l=Ar.indexOf(i.charAt(f++)),e=o<<2|l>>4,t+=String.fromCharCode(e),c=Ar.indexOf(i.charAt(f++)),n=(l&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(n)),h=Ar.indexOf(i.charAt(f++)),r=(c&3)<<6|h,h!==64&&(t+=String.fromCharCode(r));return t}var Ee=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ya=(function(){if(typeof Buffer<"u"){var i=!Buffer.from;if(!i)try{Buffer.from("foo","utf8")}catch{i=!0}return i?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function as(i){return Ee?Buffer.alloc?Buffer.alloc(i):new Buffer(i):typeof Uint8Array<"u"?new Uint8Array(i):new Array(i)}function Nv(i){return Ee?Buffer.allocUnsafe?Buffer.allocUnsafe(i):new Buffer(i):typeof Uint8Array<"u"?new Uint8Array(i):new Array(i)}var Qi=function(t){return Ee?Ya(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function ph(i){if(typeof ArrayBuffer>"u")return Qi(i);for(var t=new ArrayBuffer(i.length),e=new Uint8Array(t),n=0;n!=i.length;++n)e[n]=i.charCodeAt(n)&255;return t}function ec(i){if(Array.isArray(i))return i.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],e=0;e<i.length;++e)t[e]=String.fromCharCode(i[e]);return t.join("")}function lw(i){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(i)}var Ln=Ee?function(i){return Buffer.concat(i.map(function(t){return Buffer.isBuffer(t)?t:Ya(t)}))}:function(i){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<i.length;++t)e+=i[t].length;var n=new Uint8Array(e),r=0;for(t=0,e=0;t<i.length;e+=r,++t)if(r=i[t].length,i[t]instanceof Uint8Array)n.set(i[t],e);else{if(typeof i[t]=="string")throw"wtf";n.set(new Uint8Array(i[t]),e)}return n}return[].concat.apply([],i.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function cw(i){for(var t=[],e=0,n=i.length+250,r=as(i.length+255),o=0;o<i.length;++o){var l=i.charCodeAt(o);if(l<128)r[e++]=l;else if(l<2048)r[e++]=192|l>>6&31,r[e++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=i.charCodeAt(++o)&1023;r[e++]=240|l>>8&7,r[e++]=128|l>>2&63,r[e++]=128|c>>6&15|(l&3)<<4,r[e++]=128|c&63}else r[e++]=224|l>>12&15,r[e++]=128|l>>6&63,r[e++]=128|l&63;e>n&&(t.push(r.slice(0,e)),e=0,r=as(65535),n=65530)}return t.push(r.slice(0,e)),Ln(t)}var Ol=/\u0000/g,Mu=/[\u0001-\u0006]/g;function go(i){for(var t="",e=i.length-1;e>=0;)t+=i.charAt(e--);return t}function ta(i,t){var e=""+i;return e.length>=t?e:en("0",t-e.length)+e}function U0(i,t){var e=""+i;return e.length>=t?e:en(" ",t-e.length)+e}function Yu(i,t){var e=""+i;return e.length>=t?e:e+en(" ",t-e.length)}function uw(i,t){var e=""+Math.round(i);return e.length>=t?e:en("0",t-e.length)+e}function hw(i,t){var e=""+i;return e.length>=t?e:en("0",t-e.length)+e}var Fv=Math.pow(2,32);function Qs(i,t){if(i>Fv||i<-Fv)return uw(i,t);var e=Math.round(i);return hw(e,t)}function qu(i,t){return t=t||0,i.length>=7+t&&(i.charCodeAt(t)|32)===103&&(i.charCodeAt(t+1)|32)===101&&(i.charCodeAt(t+2)|32)===110&&(i.charCodeAt(t+3)|32)===101&&(i.charCodeAt(t+4)|32)===114&&(i.charCodeAt(t+5)|32)===97&&(i.charCodeAt(t+6)|32)===108}var Lv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],$d=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function fw(i){return i||(i={}),i[0]="General",i[1]="0",i[2]="0.00",i[3]="#,##0",i[4]="#,##0.00",i[9]="0%",i[10]="0.00%",i[11]="0.00E+00",i[12]="# ?/?",i[13]="# ??/??",i[14]="m/d/yy",i[15]="d-mmm-yy",i[16]="d-mmm",i[17]="mmm-yy",i[18]="h:mm AM/PM",i[19]="h:mm:ss AM/PM",i[20]="h:mm",i[21]="h:mm:ss",i[22]="m/d/yy h:mm",i[37]="#,##0 ;(#,##0)",i[38]="#,##0 ;[Red](#,##0)",i[39]="#,##0.00;(#,##0.00)",i[40]="#,##0.00;[Red](#,##0.00)",i[45]="mm:ss",i[46]="[h]:mm:ss",i[47]="mmss.0",i[48]="##0.0E+0",i[49]="@",i[56]='"/ "hh""mm""ss" "',i}var nn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Bv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},dw={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $u(i,t,e){for(var n=i<0?-1:1,r=i*n,o=0,l=1,c=0,h=1,f=0,g=0,p=Math.floor(r);f<t&&(p=Math.floor(r),c=p*l+o,g=p*f+h,!(r-p<5e-8));)r=1/(r-p),o=l,l=c,h=f,f=g;if(g>t&&(f>t?(g=h,c=o):(g=f,c=l)),!e)return[0,n*c,g];var m=Math.floor(n*c/g);return[m,n*c-m*g,g]}function Nu(i,t,e){if(i>2958465||i<0)return null;var n=i|0,r=Math.floor(86400*(i-n)),o=0,l=[],c={D:n,T:r,u:86400*(i-n)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++r==86400&&(c.T=r=0,++n,++c.D)),n===60)l=e?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=e?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),l=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),n<60&&(o=(o+6)%7),e&&(o=_w(h,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=r%60,r=Math.floor(r/60),c.M=r%60,r=Math.floor(r/60),c.H=r,c.q=o,c}var ey=new Date(1899,11,31,0,0,0),gw=ey.getTime(),pw=new Date(1900,2,1,0,0,0);function ny(i,t){var e=i.getTime();return t?e-=1461*24*60*60*1e3:i>=pw&&(e+=1440*60*1e3),(e-(gw+(i.getTimezoneOffset()-ey.getTimezoneOffset())*6e4))/(1440*60*1e3)}function z0(i){return i.indexOf(".")==-1?i:i.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mw(i){return i.indexOf("E")==-1?i:i.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function vw(i){var t=i<0?12:11,e=z0(i.toFixed(12));return e.length<=t||(e=i.toPrecision(10),e.length<=t)?e:i.toExponential(5)}function yw(i){var t=z0(i.toFixed(11));return t.length>(i<0?12:11)||t==="0"||t==="-0"?i.toPrecision(6):t}function xw(i){var t=Math.floor(Math.log(Math.abs(i))*Math.LOG10E),e;return t>=-4&&t<=-1?e=i.toPrecision(10+t):Math.abs(t)<=9?e=vw(i):t===10?e=i.toFixed(10).substr(0,12):e=yw(i),z0(mw(e.toUpperCase()))}function y0(i,t){switch(typeof i){case"string":return i;case"boolean":return i?"TRUE":"FALSE";case"number":return(i|0)===i?i.toString(10):xw(i);case"undefined":return"";case"object":if(i==null)return"";if(i instanceof Date)return Tr(14,ny(i,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+i)}function _w(i,t){t[0]-=581;var e=i.getDay();return i<60&&(e=(e+6)%7),e}function bw(i,t,e,n){var r="",o=0,l=0,c=e.y,h,f=0;switch(i){case 98:c=e.y+543;case 121:switch(t.length){case 1:case 2:h=c%100,f=2;break;default:h=c%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:h=e.m,f=t.length;break;case 3:return $d[e.m-1][1];case 5:return $d[e.m-1][0];default:return $d[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=e.d,f=t.length;break;case 3:return Lv[e.q][0];default:return Lv[e.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(e.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=e.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=e.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?ta(e.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(e.S+e.u)),o>=60*l&&(o=0),t==="s"?o===0?"0":""+o/l:(r=ta(o,2+n),t==="ss"?r.substr(0,2):"."+r.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=e.D*24+e.H;break;case"[m]":case"[mm]":h=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":h=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:h=c,f=1;break}var g=f>0?ta(h,f):"";return g}function Sr(i){var t=3;if(i.length<=t)return i;for(var e=i.length%t,n=i.substr(0,e);e!=i.length;e+=t)n+=(n.length>0?",":"")+i.substr(e,t);return n}var iy=/%/g;function Aw(i,t,e){var n=t.replace(iy,""),r=t.length-n.length;return Ga(i,n,e*Math.pow(10,2*r))+en("%",r)}function Sw(i,t,e){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ga(i,t.substr(0,n),e/Math.pow(10,3*(t.length-n)))}function ay(i,t){var e,n=i.indexOf("E")-i.indexOf(".")-1;if(i.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ay(i,-t);var r=i.indexOf(".");r===-1&&(r=i.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%r;if(o<0&&(o+=r),e=(t/Math.pow(10,o)).toPrecision(n+1+(r+o)%r),e.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(l-e.length+o):e+="E+"+(l-o);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,r)+"."+e.substr(2+r),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,g){return h+f+g.substr(0,(r+o)%r)+"."+g.substr(o)+"E"})}else e=t.toExponential(n);return i.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),i.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var ry=/# (\?+)( ?)\/( ?)(\d+)/;function ww(i,t,e){var n=parseInt(i[4],10),r=Math.round(t*n),o=Math.floor(r/n),l=r-o*n,c=n;return e+(o===0?"":""+o)+" "+(l===0?en(" ",i[1].length+1+i[4].length):U0(l,i[1].length)+i[2]+"/"+i[3]+ta(c,i[4].length))}function Ew(i,t,e){return e+(t===0?"":""+t)+en(" ",i[1].length+2+i[4].length)}var sy=/^#*0*\.([0#]+)/,oy=/\).*[0#]/,ly=/\(###\) ###\\?-####/;function qn(i){for(var t="",e,n=0;n!=i.length;++n)switch(e=i.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function Iv(i,t){var e=Math.pow(10,t);return""+Math.round(i*e)/e}function Uv(i,t){var e=i-Math.floor(i),n=Math.pow(10,t);return t<(""+Math.round(e*n)).length?0:Math.round(e*n)}function Tw(i,t){return t<(""+Math.round((i-Math.floor(i))*Math.pow(10,t))).length?1:0}function Cw(i){return i<2147483647&&i>-2147483648?""+(i>=0?i|0:i-1|0):""+Math.floor(i)}function Hi(i,t,e){if(i.charCodeAt(0)===40&&!t.match(oy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Hi("n",n,e):"("+Hi("n",n,-e)+")"}if(t.charCodeAt(t.length-1)===44)return Sw(i,t,e);if(t.indexOf("%")!==-1)return Aw(i,t,e);if(t.indexOf("E")!==-1)return ay(t,e);if(t.charCodeAt(0)===36)return"$"+Hi(i,t.substr(t.charAt(1)==" "?2:1),e);var r,o,l,c,h=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+Qs(h,t.length);if(t.match(/^[#?]+$/))return r=Qs(e,0),r==="0"&&(r=""),r.length>t.length?r:qn(t.substr(0,t.length-r.length))+r;if(o=t.match(ry))return ww(o,h,f);if(t.match(/^#+0+$/))return f+Qs(h,t.length-t.indexOf("0"));if(o=t.match(sy))return r=Iv(e,o[1].length).replace(/^([^\.]+)$/,"$1."+qn(o[1])).replace(/\.$/,"."+qn(o[1])).replace(/\.(\d*)$/,function(b,y){return"."+y+en("0",qn(o[1]).length-y.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return f+Iv(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return f+Sr(Qs(h,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Hi(i,t,-e):Sr(""+(Math.floor(e)+Tw(e,o[1].length)))+"."+ta(Uv(e,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return Hi(i,t.replace(/^#,#*,/,""),e);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=go(Hi(i,t.replace(/[\\-]/g,""),e)),l=0,go(go(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<r.length?r.charAt(l++):b==="0"?"0":""}));if(t.match(ly))return r=Hi(i,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var g="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=$u(h,Math.pow(10,l)-1,!1),r=""+f,g=Ga("n",o[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),r+=g+o[2]+"/"+o[3],g=Yu(c[2],l),g.length<o[4].length&&(g=qn(o[4].substr(o[4].length-g.length))+g),r+=g,r;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=$u(h,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?U0(c[1],l)+o[2]+"/"+o[3]+Yu(c[2],l):en(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return r=Qs(e,0),t.length<=r.length?r:qn(t.substr(0,t.length-r.length))+r;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=r.indexOf(".");var p=t.indexOf(".")-l,m=t.length-r.length-p;return qn(t.substr(0,p)+r+t.substr(t.length-m))}if(o=t.match(/^00,000\.([#0]*0)$/))return l=Uv(e,o[1].length),e<0?"-"+Hi(i,t,-e):Sr(Cw(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?ta(0,3-b.length):"")+b})+"."+ta(l,o[1].length);switch(t){case"###,##0.00":return Hi(i,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var v=Sr(Qs(h,0));return v!=="0"?f+v:"";case"###,###.00":return Hi(i,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Hi(i,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function kw(i,t,e){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ga(i,t.substr(0,n),e/Math.pow(10,3*(t.length-n)))}function Dw(i,t,e){var n=t.replace(iy,""),r=t.length-n.length;return Ga(i,n,e*Math.pow(10,2*r))+en("%",r)}function cy(i,t){var e,n=i.indexOf("E")-i.indexOf(".")-1;if(i.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+cy(i,-t);var r=i.indexOf(".");r===-1&&(r=i.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%r;if(o<0&&(o+=r),e=(t/Math.pow(10,o)).toPrecision(n+1+(r+o)%r),!e.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(l-e.length+o):e+="E+"+(l-o),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,g){return h+f+g.substr(0,(r+o)%r)+"."+g.substr(o)+"E"})}else e=t.toExponential(n);return i.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),i.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function fa(i,t,e){if(i.charCodeAt(0)===40&&!t.match(oy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?fa("n",n,e):"("+fa("n",n,-e)+")"}if(t.charCodeAt(t.length-1)===44)return kw(i,t,e);if(t.indexOf("%")!==-1)return Dw(i,t,e);if(t.indexOf("E")!==-1)return cy(t,e);if(t.charCodeAt(0)===36)return"$"+fa(i,t.substr(t.charAt(1)==" "?2:1),e);var r,o,l,c,h=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+ta(h,t.length);if(t.match(/^[#?]+$/))return r=""+e,e===0&&(r=""),r.length>t.length?r:qn(t.substr(0,t.length-r.length))+r;if(o=t.match(ry))return Ew(o,h,f);if(t.match(/^#+0+$/))return f+ta(h,t.length-t.indexOf("0"));if(o=t.match(sy))return r=(""+e).replace(/^([^\.]+)$/,"$1."+qn(o[1])).replace(/\.$/,"."+qn(o[1])),r=r.replace(/\.(\d*)$/,function(b,y){return"."+y+en("0",qn(o[1]).length-y.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return f+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return f+Sr(""+h);if(o=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+fa(i,t,-e):Sr(""+e)+"."+en("0",o[1].length);if(o=t.match(/^#,#*,#0/))return fa(i,t.replace(/^#,#*,/,""),e);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=go(fa(i,t.replace(/[\\-]/g,""),e)),l=0,go(go(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<r.length?r.charAt(l++):b==="0"?"0":""}));if(t.match(ly))return r=fa(i,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var g="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=$u(h,Math.pow(10,l)-1,!1),r=""+f,g=Ga("n",o[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),r+=g+o[2]+"/"+o[3],g=Yu(c[2],l),g.length<o[4].length&&(g=qn(o[4].substr(o[4].length-g.length))+g),r+=g,r;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=$u(h,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?U0(c[1],l)+o[2]+"/"+o[3]+Yu(c[2],l):en(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return r=""+e,t.length<=r.length?r:qn(t.substr(0,t.length-r.length))+r;if(o=t.match(/^([#0]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=r.indexOf(".");var p=t.indexOf(".")-l,m=t.length-r.length-p;return qn(t.substr(0,p)+r+t.substr(t.length-m))}if(o=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+fa(i,t,-e):Sr(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?ta(0,3-b.length):"")+b})+"."+ta(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=Sr(""+h);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return fa(i,t.slice(0,t.lastIndexOf(".")),e)+qn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ga(i,t,e){return(e|0)===e?fa(i,t,e):Hi(i,t,e)}function Ow(i){for(var t=[],e=!1,n=0,r=0;n<i.length;++n)switch(i.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=i.substr(r,n-r),r=n+1}if(t[t.length]=i.substr(r),e===!0)throw new Error("Format |"+i+"| unterminated string ");return t}var uy=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function hy(i){for(var t=0,e="",n="";t<i.length;)switch(e=i.charAt(t)){case"G":qu(i,t)&&(t+=6),t++;break;case'"':for(;i.charCodeAt(++t)!==34&&t<i.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(i.charAt(t+1)==="1"||i.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(i.substr(t,3).toUpperCase()==="A/P"||i.substr(t,5).toUpperCase()==="AM/PM"||i.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=e;i.charAt(t++)!=="]"&&t<i.length;)n+=i.charAt(t);if(n.match(uy))return!0;break;case".":case"0":case"#":for(;t<i.length&&("0#?.,E+-%".indexOf(e=i.charAt(++t))>-1||e=="\\"&&i.charAt(t+1)=="-"&&"0#".indexOf(i.charAt(t+2))>-1););break;case"?":for(;i.charAt(++t)===e;);break;case"*":++t,(i.charAt(t)==" "||i.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<i.length&&"0123456789".indexOf(i.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Rw(i,t,e,n){for(var r=[],o="",l=0,c="",h="t",f,g,p,m="H";l<i.length;)switch(c=i.charAt(l)){case"G":if(!qu(i,l))throw new Error("unrecognized character "+c+" in "+i);r[r.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(p=i.charCodeAt(++l))!==34&&l<i.length;)o+=String.fromCharCode(p);r[r.length]={t:"t",v:o},++l;break;case"\\":var v=i.charAt(++l),b=v==="("||v===")"?v:"t";r[r.length]={t:b,v},++l;break;case"_":r[r.length]={t:"t",v:" "},l+=2;break;case"@":r[r.length]={t:"T",v:t},++l;break;case"B":case"b":if(i.charAt(l+1)==="1"||i.charAt(l+1)==="2"){if(f==null&&(f=Nu(t,e,i.charAt(l+1)==="2"),f==null))return"";r[r.length]={t:"X",v:i.substr(l,2)},h=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Nu(t,e),f==null))return"";for(o=c;++l<i.length&&i.charAt(l).toLowerCase()===c;)o+=c;c==="m"&&h.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=m),r[r.length]={t:c,v:o},h=c;break;case"A":case"a":case"":var y={t:c,v:c};if(f==null&&(f=Nu(t,e)),i.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",m="h",l+=3):i.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",l+=5,m="h"):i.substr(l,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",l+=5,m="h"):(y.t="t",++l),f==null&&y.t==="T")return"";r[r.length]=y,h=c;break;case"[":for(o=c;i.charAt(l++)!=="]"&&l<i.length;)o+=i.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(uy)){if(f==null&&(f=Nu(t,e),f==null))return"";r[r.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",hy(i)||(r[r.length]={t:"t",v:o}));break;case".":if(f!=null){for(o=c;++l<i.length&&(c=i.charAt(l))==="0";)o+=c;r[r.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++l<i.length&&"0#?.,E+-%".indexOf(c=i.charAt(l))>-1;)o+=c;r[r.length]={t:"n",v:o};break;case"?":for(o=c;i.charAt(++l)===c;)o+=c;r[r.length]={t:c,v:o},h=c;break;case"*":++l,(i.charAt(l)==" "||i.charAt(l)=="*")&&++l;break;case"(":case")":r[r.length]={t:n===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;l<i.length&&"0123456789".indexOf(i.charAt(++l))>-1;)o+=i.charAt(l);r[r.length]={t:"D",v:o};break;case" ":r[r.length]={t:c,v:c},++l;break;case"$":r[r.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+i);r[r.length]={t:"t",v:c},++l;break}var A=0,S=0,w;for(l=r.length-1,h="t";l>=0;--l)switch(r[l].t){case"h":case"H":r[l].t=m,h="h",A<1&&(A=1);break;case"s":(w=r[l].v.match(/\.0+$/))&&(S=Math.max(S,w[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":h=r[l].t;break;case"m":h==="s"&&(r[l].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&r[l].v.match(/[Hh]/)&&(A=1),A<2&&r[l].v.match(/[Mm]/)&&(A=2),A<3&&r[l].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var E="",D;for(l=0;l<r.length;++l)switch(r[l].t){case"t":case"T":case" ":case"D":break;case"X":r[l].v="",r[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[l].v=bw(r[l].t.charCodeAt(0),r[l].v,f,S),r[l].t="t";break;case"n":case"?":for(D=l+1;r[D]!=null&&((c=r[D].t)==="?"||c==="D"||(c===" "||c==="t")&&r[D+1]!=null&&(r[D+1].t==="?"||r[D+1].t==="t"&&r[D+1].v==="/")||r[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(r[D].v==="/"||r[D].v===" "&&r[D+1]!=null&&r[D+1].t=="?"));)r[l].v+=r[D].v,r[D]={v:"",t:";"},++D;E+=r[l].v,l=D-1;break;case"G":r[l].t="t",r[l].v=y0(t,e);break}var P="",L,R;if(E.length>0){E.charCodeAt(0)==40?(L=t<0&&E.charCodeAt(0)===45?-t:t,R=Ga("n",E,L)):(L=t<0&&n>1?-t:t,R=Ga("n",E,L),L<0&&r[0]&&r[0].t=="t"&&(R=R.substr(1),r[0].v="-"+r[0].v)),D=R.length-1;var V=r.length;for(l=0;l<r.length;++l)if(r[l]!=null&&r[l].t!="t"&&r[l].v.indexOf(".")>-1){V=l;break}var F=r.length;if(V===r.length&&R.indexOf("E")===-1){for(l=r.length-1;l>=0;--l)r[l]==null||"n?".indexOf(r[l].t)===-1||(D>=r[l].v.length-1?(D-=r[l].v.length,r[l].v=R.substr(D+1,r[l].v.length)):D<0?r[l].v="":(r[l].v=R.substr(0,D+1),D=-1),r[l].t="t",F=l);D>=0&&F<r.length&&(r[F].v=R.substr(0,D+1)+r[F].v)}else if(V!==r.length&&R.indexOf("E")===-1){for(D=R.indexOf(".")-1,l=V;l>=0;--l)if(!(r[l]==null||"n?".indexOf(r[l].t)===-1)){for(g=r[l].v.indexOf(".")>-1&&l===V?r[l].v.indexOf(".")-1:r[l].v.length-1,P=r[l].v.substr(g+1);g>=0;--g)D>=0&&(r[l].v.charAt(g)==="0"||r[l].v.charAt(g)==="#")&&(P=R.charAt(D--)+P);r[l].v=P,r[l].t="t",F=l}for(D>=0&&F<r.length&&(r[F].v=R.substr(0,D+1)+r[F].v),D=R.indexOf(".")+1,l=V;l<r.length;++l)if(!(r[l]==null||"n?(".indexOf(r[l].t)===-1&&l!==V)){for(g=r[l].v.indexOf(".")>-1&&l===V?r[l].v.indexOf(".")+1:0,P=r[l].v.substr(0,g);g<r[l].v.length;++g)D<R.length&&(P+=R.charAt(D++));r[l].v=P,r[l].t="t",F=l}}}for(l=0;l<r.length;++l)r[l]!=null&&"n?".indexOf(r[l].t)>-1&&(L=n>1&&t<0&&l>0&&r[l-1].v==="-"?-t:t,r[l].v=Ga(r[l].t,r[l].v,L),r[l].t="t");var Z="";for(l=0;l!==r.length;++l)r[l]!=null&&(Z+=r[l].v);return Z}var zv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Hv(i,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(i==e)return!0;break;case">":if(i>e)return!0;break;case"<":if(i<e)return!0;break;case"<>":if(i!=e)return!0;break;case">=":if(i>=e)return!0;break;case"<=":if(i<=e)return!0;break}return!1}function Pw(i,t){var e=Ow(i),n=e.length,r=e[n-1].indexOf("@");if(n<4&&r>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||r>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=r>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=r>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=r>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var o=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,o];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var l=e[0].match(zv),c=e[1].match(zv);return Hv(t,l)?[n,e[0]]:Hv(t,c)?[n,e[1]]:[n,e[l!=null&&c!=null?2:1]]}return[n,o]}function Tr(i,t,e){e==null&&(e={});var n="";switch(typeof i){case"string":i=="m/d/yy"&&e.dateNF?n=e.dateNF:n=i;break;case"number":i==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:nn)[i],n==null&&(n=e.table&&e.table[Bv[i]]||nn[Bv[i]]),n==null&&(n=dw[i]||"General");break}if(qu(n,0))return y0(t,e);t instanceof Date&&(t=ny(t,e.date1904));var r=Pw(n,t);if(qu(r[1]))return y0(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Rw(r[1],t,e,r[0])}function fy(i,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(nn[e]==null){t<0&&(t=e);continue}if(nn[e]==i){t=e;break}}t<0&&(t=391)}return nn[t]=i,t}function mh(i){for(var t=0;t!=392;++t)i[t]!==void 0&&fy(i[t],t)}function vh(){nn=fw()}var dy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Mw(i){var t=typeof i=="number"?nn[i]:i;return t=t.replace(dy,"(\\d+)"),new RegExp("^"+t+"$")}function Nw(i,t,e){var n=-1,r=-1,o=-1,l=-1,c=-1,h=-1;(t.match(dy)||[]).forEach(function(p,m){var v=parseInt(e[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=v;break;case"d":o=v;break;case"h":l=v;break;case"s":h=v;break;case"m":l>=0?c=v:r=v;break}}),h>=0&&c==-1&&r>=0&&(c=r,r=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var g=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return l==-1&&c==-1&&h==-1?f:n==-1&&r==-1&&o==-1?g:f+"T"+g}var Fw=(function(){var i={};i.version="1.2.0";function t(){for(var R=0,V=new Array(256),F=0;F!=256;++F)R=F,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,V[F]=R;return typeof Int32Array<"u"?new Int32Array(V):V}var e=t();function n(R){var V=0,F=0,Z=0,tt=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Z=0;Z!=256;++Z)tt[Z]=R[Z];for(Z=0;Z!=256;++Z)for(F=R[Z],V=256+Z;V<4096;V+=256)F=tt[V]=F>>>8^R[F&255];var I=[];for(Z=1;Z!=16;++Z)I[Z-1]=typeof Int32Array<"u"?tt.subarray(Z*256,Z*256+256):tt.slice(Z*256,Z*256+256);return I}var r=n(e),o=r[0],l=r[1],c=r[2],h=r[3],f=r[4],g=r[5],p=r[6],m=r[7],v=r[8],b=r[9],y=r[10],A=r[11],S=r[12],w=r[13],E=r[14];function D(R,V){for(var F=V^-1,Z=0,tt=R.length;Z<tt;)F=F>>>8^e[(F^R.charCodeAt(Z++))&255];return~F}function P(R,V){for(var F=V^-1,Z=R.length-15,tt=0;tt<Z;)F=E[R[tt++]^F&255]^w[R[tt++]^F>>8&255]^S[R[tt++]^F>>16&255]^A[R[tt++]^F>>>24]^y[R[tt++]]^b[R[tt++]]^v[R[tt++]]^m[R[tt++]]^p[R[tt++]]^g[R[tt++]]^f[R[tt++]]^h[R[tt++]]^c[R[tt++]]^l[R[tt++]]^o[R[tt++]]^e[R[tt++]];for(Z+=15;tt<Z;)F=F>>>8^e[(F^R[tt++])&255];return~F}function L(R,V){for(var F=V^-1,Z=0,tt=R.length,I=0,nt=0;Z<tt;)I=R.charCodeAt(Z++),I<128?F=F>>>8^e[(F^I)&255]:I<2048?(F=F>>>8^e[(F^(192|I>>6&31))&255],F=F>>>8^e[(F^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,nt=R.charCodeAt(Z++)&1023,F=F>>>8^e[(F^(240|I>>8&7))&255],F=F>>>8^e[(F^(128|I>>2&63))&255],F=F>>>8^e[(F^(128|nt>>6&15|(I&3)<<4))&255],F=F>>>8^e[(F^(128|nt&63))&255]):(F=F>>>8^e[(F^(224|I>>12&15))&255],F=F>>>8^e[(F^(128|I>>6&63))&255],F=F>>>8^e[(F^(128|I&63))&255]);return~F}return i.table=e,i.bstr=D,i.buf=P,i.str=L,i})(),Be=(function(){var t={};t.version="1.2.1";function e(N,Y){for(var H=N.split("/"),G=Y.split("/"),W=0,q=0,ft=Math.min(H.length,G.length);W<ft;++W){if(q=H[W].length-G[W].length)return q;if(H[W]!=G[W])return H[W]<G[W]?-1:1}return H.length-G.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var Y=N.lastIndexOf("/");return Y===-1?N:N.slice(0,Y+1)}function r(N){if(N.charAt(N.length-1)=="/")return r(N.slice(0,-1));var Y=N.lastIndexOf("/");return Y===-1?N:N.slice(Y+1)}function o(N,Y){typeof Y=="string"&&(Y=new Date(Y));var H=Y.getHours();H=H<<6|Y.getMinutes(),H=H<<5|Y.getSeconds()>>>1,N.write_shift(2,H);var G=Y.getFullYear()-1980;G=G<<4|Y.getMonth()+1,G=G<<5|Y.getDate(),N.write_shift(2,G)}function l(N){var Y=N.read_shift(2)&65535,H=N.read_shift(2)&65535,G=new Date,W=H&31;H>>>=5;var q=H&15;H>>>=4,G.setMilliseconds(0),G.setFullYear(H+1980),G.setMonth(q-1),G.setDate(W);var ft=Y&31;Y>>>=5;var Et=Y&63;return Y>>>=6,G.setHours(Y),G.setMinutes(Et),G.setSeconds(ft<<1),G}function c(N){Si(N,0);for(var Y={},H=0;N.l<=N.length-4;){var G=N.read_shift(2),W=N.read_shift(2),q=N.l+W,ft={};G===21589&&(H=N.read_shift(1),H&1&&(ft.mtime=N.read_shift(4)),W>5&&(H&2&&(ft.atime=N.read_shift(4)),H&4&&(ft.ctime=N.read_shift(4))),ft.mtime&&(ft.mt=new Date(ft.mtime*1e3))),N.l=q,Y[G]=ft}return Y}var h;function f(){return h||(h={})}function g(N,Y){if(N[0]==80&&N[1]==75)return xa(N,Y);if((N[0]|32)==109&&(N[1]|32)==105)return Rr(N,Y);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var H=3,G=512,W=0,q=0,ft=0,Et=0,dt=0,gt=[],mt=N.slice(0,512);Si(mt,0);var Ft=p(mt);switch(H=Ft[0],H){case 3:G=512;break;case 4:G=4096;break;case 0:if(Ft[1]==0)return xa(N,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}G!==512&&(mt=N.slice(0,G),Si(mt,28));var zt=N.slice(0,G);m(mt,H);var Vt=mt.read_shift(4,"i");if(H===3&&Vt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Vt);mt.l+=4,ft=mt.read_shift(4,"i"),mt.l+=4,mt.chk("00100000","Mini Stream Cutoff Size: "),Et=mt.read_shift(4,"i"),W=mt.read_shift(4,"i"),dt=mt.read_shift(4,"i"),q=mt.read_shift(4,"i");for(var Lt=-1,Gt=0;Gt<109&&(Lt=mt.read_shift(4,"i"),!(Lt<0));++Gt)gt[Gt]=Lt;var Yt=v(N,G);A(dt,q,Yt,G,gt);var ze=w(Yt,ft,gt,G);ze[ft].name="!Directory",W>0&&Et!==nt&&(ze[Et].name="!MiniFAT"),ze[gt[0]].name="!FAT",ze.fat_addrs=gt,ze.ssz=G;var He={},Ke=[],ki=[],Pr=[];E(ft,ze,Yt,Ke,W,He,ki,Et),b(ki,Pr,Ke),Ke.shift();var qa={FileIndex:ki,FullPaths:Pr};return Y&&Y.raw&&(qa.raw={header:zt,sectors:Yt}),qa}function p(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(O,"Header Signature: "),N.l+=16;var Y=N.read_shift(2,"u");return[N.read_shift(2,"u"),Y]}function m(N,Y){var H=9;switch(N.l+=2,H=N.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function v(N,Y){for(var H=Math.ceil(N.length/Y)-1,G=[],W=1;W<H;++W)G[W-1]=N.slice(W*Y,(W+1)*Y);return G[H-1]=N.slice(H*Y),G}function b(N,Y,H){for(var G=0,W=0,q=0,ft=0,Et=0,dt=H.length,gt=[],mt=[];G<dt;++G)gt[G]=mt[G]=G,Y[G]=H[G];for(;Et<mt.length;++Et)G=mt[Et],W=N[G].L,q=N[G].R,ft=N[G].C,gt[G]===G&&(W!==-1&&gt[W]!==W&&(gt[G]=gt[W]),q!==-1&&gt[q]!==q&&(gt[G]=gt[q])),ft!==-1&&(gt[ft]=G),W!==-1&&G!=gt[G]&&(gt[W]=gt[G],mt.lastIndexOf(W)<Et&&mt.push(W)),q!==-1&&G!=gt[G]&&(gt[q]=gt[G],mt.lastIndexOf(q)<Et&&mt.push(q));for(G=1;G<dt;++G)gt[G]===G&&(q!==-1&&gt[q]!==q?gt[G]=gt[q]:W!==-1&&gt[W]!==W&&(gt[G]=gt[W]));for(G=1;G<dt;++G)if(N[G].type!==0){if(Et=G,Et!=gt[Et])do Et=gt[Et],Y[G]=Y[Et]+"/"+Y[G];while(Et!==0&&gt[Et]!==-1&&Et!=gt[Et]);gt[G]=-1}for(Y[0]+="/",G=1;G<dt;++G)N[G].type!==2&&(Y[G]+="/")}function y(N,Y,H){for(var G=N.start,W=N.size,q=[],ft=G;H&&W>0&&ft>=0;)q.push(Y.slice(ft*I,ft*I+I)),W-=I,ft=qr(H,ft*4);return q.length===0?At(0):Ln(q).slice(0,N.size)}function A(N,Y,H,G,W){var q=nt;if(N===nt){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var ft=H[N],Et=(G>>>2)-1;if(!ft)return;for(var dt=0;dt<Et&&(q=qr(ft,dt*4))!==nt;++dt)W.push(q);A(qr(ft,G-4),Y-1,H,G,W)}}function S(N,Y,H,G,W){var q=[],ft=[];W||(W=[]);var Et=G-1,dt=0,gt=0;for(dt=Y;dt>=0;){W[dt]=!0,q[q.length]=dt,ft.push(N[dt]);var mt=H[Math.floor(dt*4/G)];if(gt=dt*4&Et,G<4+gt)throw new Error("FAT boundary crossed: "+dt+" 4 "+G);if(!N[mt])break;dt=qr(N[mt],gt)}return{nodes:q,data:qv([ft])}}function w(N,Y,H,G){var W=N.length,q=[],ft=[],Et=[],dt=[],gt=G-1,mt=0,Ft=0,zt=0,Vt=0;for(mt=0;mt<W;++mt)if(Et=[],zt=mt+Y,zt>=W&&(zt-=W),!ft[zt]){dt=[];var Lt=[];for(Ft=zt;Ft>=0;){Lt[Ft]=!0,ft[Ft]=!0,Et[Et.length]=Ft,dt.push(N[Ft]);var Gt=H[Math.floor(Ft*4/G)];if(Vt=Ft*4&gt,G<4+Vt)throw new Error("FAT boundary crossed: "+Ft+" 4 "+G);if(!N[Gt]||(Ft=qr(N[Gt],Vt),Lt[Ft]))break}q[zt]={nodes:Et,data:qv([dt])}}return q}function E(N,Y,H,G,W,q,ft,Et){for(var dt=0,gt=G.length?2:0,mt=Y[N].data,Ft=0,zt=0,Vt;Ft<mt.length;Ft+=128){var Lt=mt.slice(Ft,Ft+128);Si(Lt,64),zt=Lt.read_shift(2),Vt=X0(Lt,0,zt-gt),G.push(Vt);var Gt={name:Vt,type:Lt.read_shift(1),color:Lt.read_shift(1),L:Lt.read_shift(4,"i"),R:Lt.read_shift(4,"i"),C:Lt.read_shift(4,"i"),clsid:Lt.read_shift(16),state:Lt.read_shift(4,"i"),start:0,size:0},Yt=Lt.read_shift(2)+Lt.read_shift(2)+Lt.read_shift(2)+Lt.read_shift(2);Yt!==0&&(Gt.ct=D(Lt,Lt.l-8));var ze=Lt.read_shift(2)+Lt.read_shift(2)+Lt.read_shift(2)+Lt.read_shift(2);ze!==0&&(Gt.mt=D(Lt,Lt.l-8)),Gt.start=Lt.read_shift(4,"i"),Gt.size=Lt.read_shift(4,"i"),Gt.size<0&&Gt.start<0&&(Gt.size=Gt.type=0,Gt.start=nt,Gt.name=""),Gt.type===5?(dt=Gt.start,W>0&&dt!==nt&&(Y[dt].name="!StreamData")):Gt.size>=4096?(Gt.storage="fat",Y[Gt.start]===void 0&&(Y[Gt.start]=S(H,Gt.start,Y.fat_addrs,Y.ssz)),Y[Gt.start].name=Gt.name,Gt.content=Y[Gt.start].data.slice(0,Gt.size)):(Gt.storage="minifat",Gt.size<0?Gt.size=0:dt!==nt&&Gt.start!==nt&&Y[dt]&&(Gt.content=y(Gt,Y[dt].data,(Y[Et]||{}).data))),Gt.content&&Si(Gt.content,0),q[Vt]=Gt,ft.push(Gt)}}function D(N,Y){return new Date((Ei(N,Y+4)/1e7*Math.pow(2,32)+Ei(N,Y)/1e7-11644473600)*1e3)}function P(N,Y){return f(),g(h.readFileSync(N),Y)}function L(N,Y){var H=Y&&Y.type;switch(H||Ee&&Buffer.isBuffer(N)&&(H="buffer"),H||"base64"){case"file":return P(N,Y);case"base64":return g(Qi(Ka(N)),Y);case"binary":return g(Qi(N),Y)}return g(N,Y)}function R(N,Y){var H=Y||{},G=H.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=G+"/",N.FileIndex[0]={name:G,type:5}),H.CLSID&&(N.FileIndex[0].clsid=H.CLSID),V(N)}function V(N){var Y="Sh33tJ5";if(!Be.find(N,"/"+Y)){var H=At(4);H[0]=55,H[1]=H[3]=50,H[2]=54,N.FileIndex.push({name:Y,type:2,content:H,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+Y),F(N)}}function F(N,Y){R(N);for(var H=!1,G=!1,W=N.FullPaths.length-1;W>=0;--W){var q=N.FileIndex[W];switch(q.type){case 0:G?H=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:G=!0,isNaN(q.R*q.L*q.C)&&(H=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!Y)){var ft=new Date(1987,1,19),Et=0,dt=Object.create?Object.create(null):{},gt=[];for(W=0;W<N.FullPaths.length;++W)dt[N.FullPaths[W]]=!0,N.FileIndex[W].type!==0&&gt.push([N.FullPaths[W],N.FileIndex[W]]);for(W=0;W<gt.length;++W){var mt=n(gt[W][0]);G=dt[mt],G||(gt.push([mt,{name:r(mt).replace("/",""),type:1,clsid:Q,ct:ft,mt:ft,content:null}]),dt[mt]=!0)}for(gt.sort(function(Vt,Lt){return e(Vt[0],Lt[0])}),N.FullPaths=[],N.FileIndex=[],W=0;W<gt.length;++W)N.FullPaths[W]=gt[W][0],N.FileIndex[W]=gt[W][1];for(W=0;W<gt.length;++W){var Ft=N.FileIndex[W],zt=N.FullPaths[W];if(Ft.name=r(zt).replace("/",""),Ft.L=Ft.R=Ft.C=-(Ft.color=1),Ft.size=Ft.content?Ft.content.length:0,Ft.start=0,Ft.clsid=Ft.clsid||Q,W===0)Ft.C=gt.length>1?1:-1,Ft.size=0,Ft.type=5;else if(zt.slice(-1)=="/"){for(Et=W+1;Et<gt.length&&n(N.FullPaths[Et])!=zt;++Et);for(Ft.C=Et>=gt.length?-1:Et,Et=W+1;Et<gt.length&&n(N.FullPaths[Et])!=n(zt);++Et);Ft.R=Et>=gt.length?-1:Et,Ft.type=1}else n(N.FullPaths[W+1]||"")==n(zt)&&(Ft.R=W+1),Ft.type=2}}}function Z(N,Y){var H=Y||{};if(H.fileType=="mad")return wh(N,H);if(F(N),H.fileType==="zip")return Ci(N,H);var G=(function(Vt){for(var Lt=0,Gt=0,Yt=0;Yt<Vt.FileIndex.length;++Yt){var ze=Vt.FileIndex[Yt];if(ze.content){var He=ze.content.length;He>0&&(He<4096?Lt+=He+63>>6:Gt+=He+511>>9)}}for(var Ke=Vt.FullPaths.length+3>>2,ki=Lt+7>>3,Pr=Lt+127>>7,qa=ki+Gt+Ke+Pr,ia=qa+127>>7,Do=ia<=109?0:Math.ceil((ia-109)/127);qa+ia+Do+127>>7>ia;)Do=++ia<=109?0:Math.ceil((ia-109)/127);var Qn=[1,Do,ia,Pr,Ke,Gt,Lt,0];return Vt.FileIndex[0].size=Lt<<6,Qn[7]=(Vt.FileIndex[0].start=Qn[0]+Qn[1]+Qn[2]+Qn[3]+Qn[4]+Qn[5])+(Qn[6]+7>>3),Qn})(N),W=At(G[7]<<9),q=0,ft=0;{for(q=0;q<8;++q)W.write_shift(1,rt[q]);for(q=0;q<8;++q)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),q=0;q<3;++q)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,G[2]),W.write_shift(4,G[0]+G[1]+G[2]+G[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,G[3]?G[0]+G[1]+G[2]-1:nt),W.write_shift(4,G[3]),W.write_shift(-4,G[1]?G[0]-1:nt),W.write_shift(4,G[1]),q=0;q<109;++q)W.write_shift(-4,q<G[2]?G[1]+q:-1)}if(G[1])for(ft=0;ft<G[1];++ft){for(;q<236+ft*127;++q)W.write_shift(-4,q<G[2]?G[1]+q:-1);W.write_shift(-4,ft===G[1]-1?nt:ft+1)}var Et=function(Vt){for(ft+=Vt;q<ft-1;++q)W.write_shift(-4,q+1);Vt&&(++q,W.write_shift(-4,nt))};for(ft=q=0,ft+=G[1];q<ft;++q)W.write_shift(-4,J.DIFSECT);for(ft+=G[2];q<ft;++q)W.write_shift(-4,J.FATSECT);Et(G[3]),Et(G[4]);for(var dt=0,gt=0,mt=N.FileIndex[0];dt<N.FileIndex.length;++dt)mt=N.FileIndex[dt],mt.content&&(gt=mt.content.length,!(gt<4096)&&(mt.start=ft,Et(gt+511>>9)));for(Et(G[6]+7>>3);W.l&511;)W.write_shift(-4,J.ENDOFCHAIN);for(ft=q=0,dt=0;dt<N.FileIndex.length;++dt)mt=N.FileIndex[dt],mt.content&&(gt=mt.content.length,!(!gt||gt>=4096)&&(mt.start=ft,Et(gt+63>>6)));for(;W.l&511;)W.write_shift(-4,J.ENDOFCHAIN);for(q=0;q<G[4]<<2;++q){var Ft=N.FullPaths[q];if(!Ft||Ft.length===0){for(dt=0;dt<17;++dt)W.write_shift(4,0);for(dt=0;dt<3;++dt)W.write_shift(4,-1);for(dt=0;dt<12;++dt)W.write_shift(4,0);continue}mt=N.FileIndex[q],q===0&&(mt.start=mt.size?mt.start-1:nt);var zt=q===0&&H.root||mt.name;if(gt=2*(zt.length+1),W.write_shift(64,zt,"utf16le"),W.write_shift(2,gt),W.write_shift(1,mt.type),W.write_shift(1,mt.color),W.write_shift(-4,mt.L),W.write_shift(-4,mt.R),W.write_shift(-4,mt.C),mt.clsid)W.write_shift(16,mt.clsid,"hex");else for(dt=0;dt<4;++dt)W.write_shift(4,0);W.write_shift(4,mt.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,mt.start),W.write_shift(4,mt.size),W.write_shift(4,0)}for(q=1;q<N.FileIndex.length;++q)if(mt=N.FileIndex[q],mt.size>=4096)if(W.l=mt.start+1<<9,Ee&&Buffer.isBuffer(mt.content))mt.content.copy(W,W.l,0,mt.size),W.l+=mt.size+511&-512;else{for(dt=0;dt<mt.size;++dt)W.write_shift(1,mt.content[dt]);for(;dt&511;++dt)W.write_shift(1,0)}for(q=1;q<N.FileIndex.length;++q)if(mt=N.FileIndex[q],mt.size>0&&mt.size<4096)if(Ee&&Buffer.isBuffer(mt.content))mt.content.copy(W,W.l,0,mt.size),W.l+=mt.size+63&-64;else{for(dt=0;dt<mt.size;++dt)W.write_shift(1,mt.content[dt]);for(;dt&63;++dt)W.write_shift(1,0)}if(Ee)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function tt(N,Y){var H=N.FullPaths.map(function(dt){return dt.toUpperCase()}),G=H.map(function(dt){var gt=dt.split("/");return gt[gt.length-(dt.slice(-1)=="/"?2:1)]}),W=!1;Y.charCodeAt(0)===47?(W=!0,Y=H[0].slice(0,-1)+Y):W=Y.indexOf("/")!==-1;var q=Y.toUpperCase(),ft=W===!0?H.indexOf(q):G.indexOf(q);if(ft!==-1)return N.FileIndex[ft];var Et=!q.match(Mu);for(q=q.replace(Ol,""),Et&&(q=q.replace(Mu,"!")),ft=0;ft<H.length;++ft)if((Et?H[ft].replace(Mu,"!"):H[ft]).replace(Ol,"")==q||(Et?G[ft].replace(Mu,"!"):G[ft]).replace(Ol,"")==q)return N.FileIndex[ft];return null}var I=64,nt=-2,O="d0cf11e0a1b11ae1",rt=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:nt,FREESECT:-1,HEADER_SIGNATURE:O,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _t(N,Y,H){f();var G=Z(N,H);h.writeFileSync(Y,G)}function vt(N){for(var Y=new Array(N.length),H=0;H<N.length;++H)Y[H]=String.fromCharCode(N[H]);return Y.join("")}function Nt(N,Y){var H=Z(N,Y);switch(Y&&Y.type||"buffer"){case"file":return f(),h.writeFileSync(Y.filename,H),H;case"binary":return typeof H=="string"?H:vt(H);case"base64":return jl(typeof H=="string"?H:vt(H));case"buffer":if(Ee)return Buffer.isBuffer(H)?H:Ya(H);case"array":return typeof H=="string"?Qi(H):H}return H}var M;function C(N){try{var Y=N.InflateRaw,H=new Y;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)M=N;else throw new Error("zlib does not expose bytesRead")}catch(G){console.error("cannot use native zlib: "+(G.message||G))}}function X(N,Y){if(!M)return ps(N,Y);var H=M.InflateRaw,G=new H,W=G._processChunk(N.slice(N.l),G._finishFlushFlag);return N.l+=G.bytesRead,W}function U(N){return M?M.deflateRawSync(N):Ki(N)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ot=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],bt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ot(N){var Y=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var Tt=typeof Uint8Array<"u",Mt=Tt?new Uint8Array(256):[],Zt=0;Zt<256;++Zt)Mt[Zt]=Ot(Zt);function te(N,Y){var H=Mt[N&255];return Y<=8?H>>>8-Y:(H=H<<8|Mt[N>>8&255],Y<=16?H>>>16-Y:(H=H<<8|Mt[N>>16&255],H>>>24-Y))}function ve(N,Y){var H=Y&7,G=Y>>>3;return(N[G]|(H<=6?0:N[G+1]<<8))>>>H&3}function k(N,Y){var H=Y&7,G=Y>>>3;return(N[G]|(H<=5?0:N[G+1]<<8))>>>H&7}function St(N,Y){var H=Y&7,G=Y>>>3;return(N[G]|(H<=4?0:N[G+1]<<8))>>>H&15}function lt(N,Y){var H=Y&7,G=Y>>>3;return(N[G]|(H<=3?0:N[G+1]<<8))>>>H&31}function z(N,Y){var H=Y&7,G=Y>>>3;return(N[G]|(H<=1?0:N[G+1]<<8))>>>H&127}function K(N,Y,H){var G=Y&7,W=Y>>>3,q=(1<<H)-1,ft=N[W]>>>G;return H<8-G||(ft|=N[W+1]<<8-G,H<16-G)||(ft|=N[W+2]<<16-G,H<24-G)||(ft|=N[W+3]<<24-G),ft&q}function at(N,Y,H){var G=Y&7,W=Y>>>3;return G<=5?N[W]|=(H&7)<<G:(N[W]|=H<<G&255,N[W+1]=(H&7)>>8-G),Y+3}function kt(N,Y,H){var G=Y&7,W=Y>>>3;return H=(H&1)<<G,N[W]|=H,Y+1}function Rt(N,Y,H){var G=Y&7,W=Y>>>3;return H<<=G,N[W]|=H&255,H>>>=8,N[W+1]=H,Y+8}function ht(N,Y,H){var G=Y&7,W=Y>>>3;return H<<=G,N[W]|=H&255,H>>>=8,N[W+1]=H&255,N[W+2]=H>>>8,Y+16}function Bt(N,Y){var H=N.length,G=2*H>Y?2*H:Y+5,W=0;if(H>=Y)return N;if(Ee){var q=Nv(G);if(N.copy)N.copy(q);else for(;W<N.length;++W)q[W]=N[W];return q}else if(Tt){var ft=new Uint8Array(G);if(ft.set)ft.set(N);else for(;W<H;++W)ft[W]=N[W];return ft}return N.length=G,N}function It(N){for(var Y=new Array(N),H=0;H<N;++H)Y[H]=0;return Y}function Ut(N,Y,H){var G=1,W=0,q=0,ft=0,Et=0,dt=N.length,gt=Tt?new Uint16Array(32):It(32);for(q=0;q<32;++q)gt[q]=0;for(q=dt;q<H;++q)N[q]=0;dt=N.length;var mt=Tt?new Uint16Array(dt):It(dt);for(q=0;q<dt;++q)gt[W=N[q]]++,G<W&&(G=W),mt[q]=0;for(gt[0]=0,q=1;q<=G;++q)gt[q+16]=Et=Et+gt[q-1]<<1;for(q=0;q<dt;++q)Et=N[q],Et!=0&&(mt[q]=gt[Et+16]++);var Ft=0;for(q=0;q<dt;++q)if(Ft=N[q],Ft!=0)for(Et=te(mt[q],G)>>G-Ft,ft=(1<<G+4-Ft)-1;ft>=0;--ft)Y[Et|ft<<Ft]=Ft&15|q<<4;return G}var $t=Tt?new Uint16Array(512):It(512),ye=Tt?new Uint16Array(32):It(32);if(!Tt){for(var ne=0;ne<512;++ne)$t[ne]=0;for(ne=0;ne<32;++ne)ye[ne]=0}(function(){for(var N=[],Y=0;Y<32;Y++)N.push(5);Ut(N,ye,32);var H=[];for(Y=0;Y<=143;Y++)H.push(8);for(;Y<=255;Y++)H.push(9);for(;Y<=279;Y++)H.push(7);for(;Y<=287;Y++)H.push(8);Ut(H,$t,288)})();var zn=(function(){for(var Y=Tt?new Uint8Array(32768):[],H=0,G=0;H<bt.length-1;++H)for(;G<bt[H+1];++G)Y[G]=H;for(;G<32768;++G)Y[G]=29;var W=Tt?new Uint8Array(259):[];for(H=0,G=0;H<ot.length-1;++H)for(;G<ot[H+1];++G)W[G]=H;function q(Et,dt){for(var gt=0;gt<Et.length;){var mt=Math.min(65535,Et.length-gt),Ft=gt+mt==Et.length;for(dt.write_shift(1,+Ft),dt.write_shift(2,mt),dt.write_shift(2,~mt&65535);mt-- >0;)dt[dt.l++]=Et[gt++]}return dt.l}function ft(Et,dt){for(var gt=0,mt=0,Ft=Tt?new Uint16Array(32768):[];mt<Et.length;){var zt=Math.min(65535,Et.length-mt);if(zt<10){for(gt=at(dt,gt,+(mt+zt==Et.length)),gt&7&&(gt+=8-(gt&7)),dt.l=gt/8|0,dt.write_shift(2,zt),dt.write_shift(2,~zt&65535);zt-- >0;)dt[dt.l++]=Et[mt++];gt=dt.l*8;continue}gt=at(dt,gt,+(mt+zt==Et.length)+2);for(var Vt=0;zt-- >0;){var Lt=Et[mt];Vt=(Vt<<5^Lt)&32767;var Gt=-1,Yt=0;if((Gt=Ft[Vt])&&(Gt|=mt&-32768,Gt>mt&&(Gt-=32768),Gt<mt))for(;Et[Gt+Yt]==Et[mt+Yt]&&Yt<250;)++Yt;if(Yt>2){Lt=W[Yt],Lt<=22?gt=Rt(dt,gt,Mt[Lt+1]>>1)-1:(Rt(dt,gt,3),gt+=5,Rt(dt,gt,Mt[Lt-23]>>5),gt+=3);var ze=Lt<8?0:Lt-4>>2;ze>0&&(ht(dt,gt,Yt-ot[Lt]),gt+=ze),Lt=Y[mt-Gt],gt=Rt(dt,gt,Mt[Lt]>>3),gt-=3;var He=Lt<4?0:Lt-2>>1;He>0&&(ht(dt,gt,mt-Gt-bt[Lt]),gt+=He);for(var Ke=0;Ke<Yt;++Ke)Ft[Vt]=mt&32767,Vt=(Vt<<5^Et[mt])&32767,++mt;zt-=Yt-1}else Lt<=143?Lt=Lt+48:gt=kt(dt,gt,1),gt=Rt(dt,gt,Mt[Lt]),Ft[Vt]=mt&32767,++mt}gt=Rt(dt,gt,0)-1}return dt.l=(gt+7)/8|0,dt.l}return function(dt,gt){return dt.length<8?q(dt,gt):ft(dt,gt)}})();function Ki(N){var Y=At(50+Math.floor(N.length*1.1)),H=zn(N,Y);return Y.slice(0,H)}var Vn=Tt?new Uint16Array(32768):It(32768),na=Tt?new Uint16Array(32768):It(32768),Te=Tt?new Uint16Array(128):It(128),an=1,Xn=1;function je(N,Y){var H=lt(N,Y)+257;Y+=5;var G=lt(N,Y)+1;Y+=5;var W=St(N,Y)+4;Y+=4;for(var q=0,ft=Tt?new Uint8Array(19):It(19),Et=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],dt=1,gt=Tt?new Uint8Array(8):It(8),mt=Tt?new Uint8Array(8):It(8),Ft=ft.length,zt=0;zt<W;++zt)ft[j[zt]]=q=k(N,Y),dt<q&&(dt=q),gt[q]++,Y+=3;var Vt=0;for(gt[0]=0,zt=1;zt<=dt;++zt)mt[zt]=Vt=Vt+gt[zt-1]<<1;for(zt=0;zt<Ft;++zt)(Vt=ft[zt])!=0&&(Et[zt]=mt[Vt]++);var Lt=0;for(zt=0;zt<Ft;++zt)if(Lt=ft[zt],Lt!=0){Vt=Mt[Et[zt]]>>8-Lt;for(var Gt=(1<<7-Lt)-1;Gt>=0;--Gt)Te[Vt|Gt<<Lt]=Lt&7|zt<<3}var Yt=[];for(dt=1;Yt.length<H+G;)switch(Vt=Te[z(N,Y)],Y+=Vt&7,Vt>>>=3){case 16:for(q=3+ve(N,Y),Y+=2,Vt=Yt[Yt.length-1];q-- >0;)Yt.push(Vt);break;case 17:for(q=3+k(N,Y),Y+=3;q-- >0;)Yt.push(0);break;case 18:for(q=11+z(N,Y),Y+=7;q-- >0;)Yt.push(0);break;default:Yt.push(Vt),dt<Vt&&(dt=Vt);break}var ze=Yt.slice(0,H),He=Yt.slice(H);for(zt=H;zt<286;++zt)ze[zt]=0;for(zt=G;zt<30;++zt)He[zt]=0;return an=Ut(ze,Vn,286),Xn=Ut(He,na,30),Y}function gs(N,Y){if(N[0]==3&&!(N[1]&3))return[as(Y),2];for(var H=0,G=0,W=Nv(Y||1<<18),q=0,ft=W.length>>>0,Et=0,dt=0;(G&1)==0;){if(G=k(N,H),H+=3,G>>>1)G>>1==1?(Et=9,dt=5):(H=je(N,H),Et=an,dt=Xn);else{H&7&&(H+=8-(H&7));var gt=N[H>>>3]|N[(H>>>3)+1]<<8;if(H+=32,gt>0)for(!Y&&ft<q+gt&&(W=Bt(W,q+gt),ft=W.length);gt-- >0;)W[q++]=N[H>>>3],H+=8;continue}for(;;){!Y&&ft<q+32767&&(W=Bt(W,q+32767),ft=W.length);var mt=K(N,H,Et),Ft=G>>>1==1?$t[mt]:Vn[mt];if(H+=Ft&15,Ft>>>=4,(Ft>>>8&255)===0)W[q++]=Ft;else{if(Ft==256)break;Ft-=257;var zt=Ft<8?0:Ft-4>>2;zt>5&&(zt=0);var Vt=q+ot[Ft];zt>0&&(Vt+=K(N,H,zt),H+=zt),mt=K(N,H,dt),Ft=G>>>1==1?ye[mt]:na[mt],H+=Ft&15,Ft>>>=4;var Lt=Ft<4?0:Ft-2>>1,Gt=bt[Ft];for(Lt>0&&(Gt+=K(N,H,Lt),H+=Lt),!Y&&ft<Vt&&(W=Bt(W,Vt+100),ft=W.length);q<Vt;)W[q]=W[q-Gt],++q}}}return Y?[W,H+7>>>3]:[W.slice(0,q),H+7>>>3]}function ps(N,Y){var H=N.slice(N.l||0),G=gs(H,Y);return N.l+=G[1],G[0]}function ms(N,Y){if(N)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function xa(N,Y){var H=N;Si(H,0);var G=[],W=[],q={FileIndex:G,FullPaths:W};R(q,{root:Y.root});for(var ft=H.length-4;(H[ft]!=80||H[ft+1]!=75||H[ft+2]!=5||H[ft+3]!=6)&&ft>=0;)--ft;H.l=ft+4,H.l+=4;var Et=H.read_shift(2);H.l+=6;var dt=H.read_shift(4);for(H.l=dt,ft=0;ft<Et;++ft){H.l+=20;var gt=H.read_shift(4),mt=H.read_shift(4),Ft=H.read_shift(2),zt=H.read_shift(2),Vt=H.read_shift(2);H.l+=8;var Lt=H.read_shift(4),Gt=c(H.slice(H.l+Ft,H.l+Ft+zt));H.l+=Ft+zt+Vt;var Yt=H.l;H.l=Lt+4,_a(H,gt,mt,q,Gt),H.l=Yt}return q}function _a(N,Y,H,G,W){N.l+=2;var q=N.read_shift(2),ft=N.read_shift(2),Et=l(N);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var dt=N.read_shift(4),gt=N.read_shift(4),mt=N.read_shift(4),Ft=N.read_shift(2),zt=N.read_shift(2),Vt="",Lt=0;Lt<Ft;++Lt)Vt+=String.fromCharCode(N[N.l++]);if(zt){var Gt=c(N.slice(N.l,N.l+zt));(Gt[21589]||{}).mt&&(Et=Gt[21589].mt),((W||{})[21589]||{}).mt&&(Et=W[21589].mt)}N.l+=zt;var Yt=N.slice(N.l,N.l+gt);switch(ft){case 8:Yt=X(N,mt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ft)}var ze=!1;q&8&&(dt=N.read_shift(4),dt==134695760&&(dt=N.read_shift(4),ze=!0),gt=N.read_shift(4),mt=N.read_shift(4)),gt!=Y&&ms(ze,"Bad compressed size: "+Y+" != "+gt),mt!=H&&ms(ze,"Bad uncompressed size: "+H+" != "+mt),ys(G,Vt,Yt,{unsafe:!0,mt:Et})}function Ci(N,Y){var H=Y||{},G=[],W=[],q=At(1),ft=H.compression?8:0,Et=0,dt=0,gt=0,mt=0,Ft=0,zt=N.FullPaths[0],Vt=zt,Lt=N.FileIndex[0],Gt=[],Yt=0;for(dt=1;dt<N.FullPaths.length;++dt)if(Vt=N.FullPaths[dt].slice(zt.length),Lt=N.FileIndex[dt],!(!Lt.size||!Lt.content||Vt=="Sh33tJ5")){var ze=mt,He=At(Vt.length);for(gt=0;gt<Vt.length;++gt)He.write_shift(1,Vt.charCodeAt(gt)&127);He=He.slice(0,He.l),Gt[Ft]=Fw.buf(Lt.content,0);var Ke=Lt.content;ft==8&&(Ke=U(Ke)),q=At(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,Et),q.write_shift(2,ft),Lt.mt?o(q,Lt.mt):q.write_shift(4,0),q.write_shift(-4,Gt[Ft]),q.write_shift(4,Ke.length),q.write_shift(4,Lt.content.length),q.write_shift(2,He.length),q.write_shift(2,0),mt+=q.length,G.push(q),mt+=He.length,G.push(He),mt+=Ke.length,G.push(Ke),q=At(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,Et),q.write_shift(2,ft),q.write_shift(4,0),q.write_shift(-4,Gt[Ft]),q.write_shift(4,Ke.length),q.write_shift(4,Lt.content.length),q.write_shift(2,He.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,ze),Yt+=q.l,W.push(q),Yt+=He.length,W.push(He),++Ft}return q=At(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,Ft),q.write_shift(2,Ft),q.write_shift(4,Yt),q.write_shift(4,mt),q.write_shift(2,0),Ln([Ln(G),Ln(W),q])}var Cn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vs(N,Y){if(N.ctype)return N.ctype;var H=N.name||"",G=H.match(/\.([^\.]+)$/);return G&&Cn[G[1]]||Y&&(G=(H=Y).match(/[\.\\]([^\.\\])+$/),G&&Cn[G[1]])?Cn[G[1]]:"application/octet-stream"}function Or(N){for(var Y=jl(N),H=[],G=0;G<Y.length;G+=76)H.push(Y.slice(G,G+76));return H.join(`\r
`)+`\r
`}function Sh(N){var Y=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(gt){var mt=gt.charCodeAt(0).toString(16).toUpperCase();return"="+(mt.length==1?"0"+mt:mt)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],G=Y.split(`\r
`),W=0;W<G.length;++W){var q=G[W];if(q.length==0){H.push("");continue}for(var ft=0;ft<q.length;){var Et=76,dt=q.slice(ft,ft+Et);dt.charAt(Et-1)=="="?Et--:dt.charAt(Et-2)=="="?Et-=2:dt.charAt(Et-3)=="="&&(Et-=3),dt=q.slice(ft,ft+Et),ft+=Et,ft<q.length&&(dt+="="),H.push(dt)}}return H.join(`\r
`)}function oc(N){for(var Y=[],H=0;H<N.length;++H){for(var G=N[H];H<=N.length&&G.charAt(G.length-1)=="=";)G=G.slice(0,G.length-1)+N[++H];Y.push(G)}for(var W=0;W<Y.length;++W)Y[W]=Y[W].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return Qi(Y.join(`\r
`))}function To(N,Y,H){for(var G="",W="",q="",ft,Et=0;Et<10;++Et){var dt=Y[Et];if(!dt||dt.match(/^\s*$/))break;var gt=dt.match(/^(.*?):\s*([^\s].*)$/);if(gt)switch(gt[1].toLowerCase()){case"content-location":G=gt[2].trim();break;case"content-type":q=gt[2].trim();break;case"content-transfer-encoding":W=gt[2].trim();break}}switch(++Et,W.toLowerCase()){case"base64":ft=Qi(Ka(Y.slice(Et).join("")));break;case"quoted-printable":ft=oc(Y.slice(Et));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var mt=ys(N,G.slice(H.length),ft,{unsafe:!0});q&&(mt.ctype=q)}function Rr(N,Y){if(vt(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=Y&&Y.root||"",G=(Ee&&Buffer.isBuffer(N)?N.toString("binary"):vt(N)).split(`\r
`),W=0,q="";for(W=0;W<G.length;++W)if(q=G[W],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),H||(H=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),q.slice(0,H.length)!=H););var ft=(G[1]||"").match(/boundary="(.*?)"/);if(!ft)throw new Error("MAD cannot find boundary");var Et="--"+(ft[1]||""),dt=[],gt=[],mt={FileIndex:dt,FullPaths:gt};R(mt);var Ft,zt=0;for(W=0;W<G.length;++W){var Vt=G[W];Vt!==Et&&Vt!==Et+"--"||(zt++&&To(mt,G.slice(Ft,W),H),Ft=W)}return mt}function wh(N,Y){var H=Y||{},G=H.boundary||"SheetJS";G="------="+G;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+G.slice(2)+'"',"","",""],q=N.FullPaths[0],ft=q,Et=N.FileIndex[0],dt=1;dt<N.FullPaths.length;++dt)if(ft=N.FullPaths[dt].slice(q.length),Et=N.FileIndex[dt],!(!Et.size||!Et.content||ft=="Sh33tJ5")){ft=ft.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Yt){return"_x"+Yt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Yt){return"_u"+Yt.charCodeAt(0).toString(16)+"_"});for(var gt=Et.content,mt=Ee&&Buffer.isBuffer(gt)?gt.toString("binary"):vt(gt),Ft=0,zt=Math.min(1024,mt.length),Vt=0,Lt=0;Lt<=zt;++Lt)(Vt=mt.charCodeAt(Lt))>=32&&Vt<128&&++Ft;var Gt=Ft>=zt*4/5;W.push(G),W.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+ft),W.push("Content-Transfer-Encoding: "+(Gt?"quoted-printable":"base64")),W.push("Content-Type: "+vs(Et,ft)),W.push(""),W.push(Gt?Sh(mt):Or(mt))}return W.push(G+`--\r
`),W.join(`\r
`)}function lc(N){var Y={};return R(Y,N),Y}function ys(N,Y,H,G){var W=G&&G.unsafe;W||R(N);var q=!W&&Be.find(N,Y);if(!q){var ft=N.FullPaths[0];Y.slice(0,ft.length)==ft?ft=Y:(ft.slice(-1)!="/"&&(ft+="/"),ft=(ft+Y).replace("//","/")),q={name:r(Y),type:2},N.FileIndex.push(q),N.FullPaths.push(ft),W||Be.utils.cfb_gc(N)}return q.content=H,q.size=H?H.length:0,G&&(G.CLSID&&(q.clsid=G.CLSID),G.mt&&(q.mt=G.mt),G.ct&&(q.ct=G.ct)),q}function cc(N,Y){R(N);var H=Be.find(N,Y);if(H){for(var G=0;G<N.FileIndex.length;++G)if(N.FileIndex[G]==H)return N.FileIndex.splice(G,1),N.FullPaths.splice(G,1),!0}return!1}function Co(N,Y,H){R(N);var G=Be.find(N,Y);if(G){for(var W=0;W<N.FileIndex.length;++W)if(N.FileIndex[W]==G)return N.FileIndex[W].name=r(H),N.FullPaths[W]=H,!0}return!1}function ko(N){F(N,!0)}return t.find=tt,t.read=L,t.parse=g,t.write=Nt,t.writeFile=_t,t.utils={cfb_new:lc,cfb_add:ys,cfb_del:cc,cfb_mov:Co,cfb_gc:ko,ReadShift:Pl,CheckField:Ry,prep_blob:Si,bconcat:Ln,use_zlib:C,_deflateRaw:Ki,_inflateRaw:ps,consts:J},t})();function Lw(i){return typeof i=="string"?ph(i):Array.isArray(i)?lw(i):i}function nc(i,t,e){if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=ph(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(i,t)}var n=e=="utf8"?Vl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,i);if(typeof Blob<"u"){var r=new Blob([Lw(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,i);if(typeof saveAs<"u")return saveAs(r,i);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:i,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=i,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(i);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=ec(t)),c.write(t),c.close(),t}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+i)}function Un(i){for(var t=Object.keys(i),e=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(i,t[n])&&e.push(t[n]);return e}function jv(i,t){for(var e=[],n=Un(i),r=0;r!==n.length;++r)e[i[n[r]][t]]==null&&(e[i[n[r]][t]]=n[r]);return e}function H0(i){for(var t=[],e=Un(i),n=0;n!==e.length;++n)t[i[e[n]]]=e[n];return t}function yh(i){for(var t=[],e=Un(i),n=0;n!==e.length;++n)t[i[e[n]]]=parseInt(e[n],10);return t}function Bw(i){for(var t=[],e=Un(i),n=0;n!==e.length;++n)t[i[e[n]]]==null&&(t[i[e[n]]]=[]),t[i[e[n]]].push(e[n]);return t}var Zu=new Date(1899,11,30,0,0,0);function ui(i,t){var e=i.getTime(),n=Zu.getTime()+(i.getTimezoneOffset()-Zu.getTimezoneOffset())*6e4;return(e-n)/(1440*60*1e3)}var gy=new Date,Iw=Zu.getTime()+(gy.getTimezoneOffset()-Zu.getTimezoneOffset())*6e4,Gv=gy.getTimezoneOffset();function py(i){var t=new Date;return t.setTime(i*24*60*60*1e3+Iw),t.getTimezoneOffset()!==Gv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Gv)*6e4),t}var Vv=new Date("2017-02-19T19:06:09.000Z"),my=isNaN(Vv.getFullYear())?new Date("2/19/17"):Vv,Uw=my.getFullYear()==2017;function Jn(i,t){var e=new Date(i);if(Uw)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(i instanceof Date)return i;if(my.getFullYear()==1917&&!isNaN(e.getFullYear())){var n=e.getFullYear();return i.indexOf(""+n)>-1||e.setFullYear(e.getFullYear()+100),e}var r=i.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return i.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function xh(i,t){if(Ee&&Buffer.isBuffer(i))return i.toString("binary");if(typeof TextDecoder<"u")try{var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(i)&&(i=new Uint8Array(i)),new TextDecoder("latin1").decode(i).replace(/[]/g,function(o){return e[o]||o})}catch{}for(var n=[],r=0;r!=i.length;++r)n.push(String.fromCharCode(i[r]));return n.join("")}function hi(i){if(typeof JSON<"u"&&!Array.isArray(i))return JSON.parse(JSON.stringify(i));if(typeof i!="object"||i==null)return i;if(i instanceof Date)return new Date(i.getTime());var t={};for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=hi(i[e]));return t}function en(i,t){for(var e="";e.length<t;)e+=i;return e}function Va(i){var t=Number(i);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(i))return t;var e=1,n=i.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(r,o){return e=-e,o}),!isNaN(t=Number(n)))?t/e:t}var zw=["january","february","march","april","may","june","july","august","september","october","november","december"];function Gl(i){var t=new Date(i),e=new Date(NaN),n=t.getYear(),r=t.getMonth(),o=t.getDate();if(isNaN(o))return e;var l=i.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&zw.indexOf(l)==-1)return e}else if(l.match(/[a-z]/))return e;return n<0||n>8099?e:(r>0||o>1)&&n!=101?t:i.match(/[^-0-9:,\/\\]/)?e:t}function ce(i,t,e){if(i.FullPaths){if(typeof e=="string"){var n;return Ee?n=Ya(e):n=cw(e),Be.utils.cfb_add(i,t,n)}Be.utils.cfb_add(i,t,e)}else i.file(t,e)}function j0(){return Be.utils.cfb_new()}var mn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Hw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},G0=H0(Hw),V0=/[&<>'"]/g,jw=/[\u0000-\u0008\u000b-\u001f]/g;function Re(i){var t=i+"";return t.replace(V0,function(e){return G0[e]}).replace(jw,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Xv(i){return Re(i).replace(/ /g,"_x0020_")}var vy=/[\u0000-\u001f]/g;function Gw(i){var t=i+"";return t.replace(V0,function(e){return G0[e]}).replace(/\n/g,"<br/>").replace(vy,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Vw(i){var t=i+"";return t.replace(V0,function(e){return G0[e]}).replace(vy,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function Xw(i){return i.replace(/(\r\n|[\r\n])/g,"&#10;")}function Kw(i){switch(i){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Zd(i){for(var t="",e=0,n=0,r=0,o=0,l=0,c=0;e<i.length;){if(n=i.charCodeAt(e++),n<128){t+=String.fromCharCode(n);continue}if(r=i.charCodeAt(e++),n>191&&n<224){l=(n&31)<<6,l|=r&63,t+=String.fromCharCode(l);continue}if(o=i.charCodeAt(e++),n<240){t+=String.fromCharCode((n&15)<<12|(r&63)<<6|o&63);continue}l=i.charCodeAt(e++),c=((n&7)<<18|(r&63)<<12|(o&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function Kv(i){var t=as(2*i.length),e,n,r=1,o=0,l=0,c;for(n=0;n<i.length;n+=r)r=1,(c=i.charCodeAt(n))<128?e=c:c<224?(e=(c&31)*64+(i.charCodeAt(n+1)&63),r=2):c<240?(e=(c&15)*4096+(i.charCodeAt(n+1)&63)*64+(i.charCodeAt(n+2)&63),r=3):(r=4,e=(c&7)*262144+(i.charCodeAt(n+1)&63)*4096+(i.charCodeAt(n+2)&63)*64+(i.charCodeAt(n+3)&63),e-=65536,l=55296+(e>>>10&1023),e=56320+(e&1023)),l!==0&&(t[o++]=l&255,t[o++]=l>>>8,l=0),t[o++]=e%256,t[o++]=e>>>8;return t.slice(0,o).toString("ucs2")}function Wv(i){return Ya(i,"binary").toString("utf8")}var Fu="foo bar baz",Rl=Ee&&(Wv(Fu)==Zd(Fu)&&Wv||Kv(Fu)==Zd(Fu)&&Kv)||Zd,Vl=Ee?function(i){return Ya(i,"utf8").toString("binary")}:function(i){for(var t=[],e=0,n=0,r=0;e<i.length;)switch(n=i.charCodeAt(e++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,r=i.charCodeAt(e++)-56320+(n<<10),t.push(String.fromCharCode(240+(r>>18&7))),t.push(String.fromCharCode(144+(r>>12&63))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Ww=(function(){var i=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<i.length;++r)n=n.replace(i[r][0],i[r][1]);return n}})(),yy=/(^\s|\s$|\n)/;function Bn(i,t){return"<"+i+(t.match(yy)?' xml:space="preserve"':"")+">"+t+"</"+i+">"}function Xl(i){return Un(i).map(function(t){return" "+t+'="'+i[t]+'"'}).join("")}function Ht(i,t,e){return"<"+i+(e!=null?Xl(e):"")+(t!=null?(t.match(yy)?' xml:space="preserve"':"")+">"+t+"</"+i:"/")+">"}function x0(i,t){try{return i.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function Yw(i,t){switch(typeof i){case"string":var e=Ht("vt:lpwstr",Re(i));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return Ht((i|0)==i?"vt:i4":"vt:r8",Re(String(i)));case"boolean":return Ht("vt:bool",i?"true":"false")}if(i instanceof Date)return Ht("vt:filetime",x0(i));throw new Error("Unable to serialize "+i)}var wn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ao=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],wi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function qw(i,t){for(var e=1-2*(i[t+7]>>>7),n=((i[t+7]&127)<<4)+(i[t+6]>>>4&15),r=i[t+6]&15,o=5;o>=0;--o)r=r*256+i[t+o];return n==2047?r==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,r+=Math.pow(2,52)),e*Math.pow(2,n-52)*r)}function $w(i,t,e){var n=(t<0||1/t==-1/0?1:0)<<7,r=0,o=0,l=n?-t:t;isFinite(l)?l==0?r=o=0:(r=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-r),r<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?r=-1022:(o-=Math.pow(2,52),r+=1023)):(r=2047,o=isNaN(t)?26985:0);for(var c=0;c<=5;++c,o/=256)i[e+c]=o&255;i[e+6]=(r&15)<<4|o&15,i[e+7]=r>>4|n}var Yv=function(i){for(var t=[],e=10240,n=0;n<i[0].length;++n)if(i[0][n])for(var r=0,o=i[0][n].length;r<o;r+=e)t.push.apply(t,i[0][n].slice(r,r+e));return t},qv=Ee?function(i){return i[0].length>0&&Buffer.isBuffer(i[0][0])?Buffer.concat(i[0].map(function(t){return Buffer.isBuffer(t)?t:Ya(t)})):Yv(i)}:Yv,$v=function(i,t,e){for(var n=[],r=t;r<e;r+=2)n.push(String.fromCharCode(kl(i,r)));return n.join("").replace(Ol,"")},X0=Ee?function(i,t,e){return Buffer.isBuffer(i)?i.toString("utf16le",t,e).replace(Ol,""):$v(i,t,e)}:$v,Zv=function(i,t,e){for(var n=[],r=t;r<t+e;++r)n.push(("0"+i[r].toString(16)).slice(-2));return n.join("")},xy=Ee?function(i,t,e){return Buffer.isBuffer(i)?i.toString("hex",t,t+e):Zv(i,t,e)}:Zv,Jv=function(i,t,e){for(var n=[],r=t;r<e;r++)n.push(String.fromCharCode(ro(i,r)));return n.join("")},ic=Ee?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf8",e,n):Jv(t,e,n)}:Jv,_y=function(i,t){var e=Ei(i,t);return e>0?ic(i,t+4,t+4+e-1):""},by=_y,Ay=function(i,t){var e=Ei(i,t);return e>0?ic(i,t+4,t+4+e-1):""},Sy=Ay,wy=function(i,t){var e=2*Ei(i,t);return e>0?ic(i,t+4,t+4+e-1):""},Ey=wy,Ty=function(t,e){var n=Ei(t,e);return n>0?X0(t,e+4,e+4+n):""},Cy=Ty,ky=function(i,t){var e=Ei(i,t);return e>0?ic(i,t+4,t+4+e):""},Dy=ky,Oy=function(i,t){return qw(i,t)},Ju=Oy,K0=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ee&&(by=function(t,e){if(!Buffer.isBuffer(t))return _y(t,e);var n=t.readUInt32LE(e);return n>0?t.toString("utf8",e+4,e+4+n-1):""},Sy=function(t,e){if(!Buffer.isBuffer(t))return Ay(t,e);var n=t.readUInt32LE(e);return n>0?t.toString("utf8",e+4,e+4+n-1):""},Ey=function(t,e){if(!Buffer.isBuffer(t))return wy(t,e);var n=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+n-1)},Cy=function(t,e){if(!Buffer.isBuffer(t))return Ty(t,e);var n=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+n)},Dy=function(t,e){if(!Buffer.isBuffer(t))return ky(t,e);var n=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+n)},Ju=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):Oy(t,e)},K0=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ro=function(i,t){return i[t]},kl=function(i,t){return i[t+1]*256+i[t]},Zw=function(i,t){var e=i[t+1]*256+i[t];return e<32768?e:(65535-e+1)*-1},Ei=function(i,t){return i[t+3]*(1<<24)+(i[t+2]<<16)+(i[t+1]<<8)+i[t]},qr=function(i,t){return i[t+3]<<24|i[t+2]<<16|i[t+1]<<8|i[t]},Jw=function(i,t){return i[t]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3]};function Pl(i,t){var e="",n,r,o=[],l,c,h,f;switch(t){case"dbcs":if(f=this.l,Ee&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*i).toString("utf16le");else for(h=0;h<i;++h)e+=String.fromCharCode(kl(this,f)),f+=2;i*=2;break;case"utf8":e=ic(this,this.l,this.l+i);break;case"utf16le":i*=2,e=X0(this,this.l,this.l+i);break;case"wstr":return Pl.call(this,i,"dbcs");case"lpstr-ansi":e=by(this,this.l),i=4+Ei(this,this.l);break;case"lpstr-cp":e=Sy(this,this.l),i=4+Ei(this,this.l);break;case"lpwstr":e=Ey(this,this.l),i=4+2*Ei(this,this.l);break;case"lpp4":i=4+Ei(this,this.l),e=Cy(this,this.l),i&2&&(i+=2);break;case"8lpp4":i=4+Ei(this,this.l),e=Dy(this,this.l),i&3&&(i+=4-(i&3));break;case"cstr":for(i=0,e="";(l=ro(this,this.l+i++))!==0;)o.push(Pu(l));e=o.join("");break;case"_wstr":for(i=0,e="";(l=kl(this,this.l+i))!==0;)o.push(Pu(l)),i+=2;i+=2,e=o.join("");break;case"dbcs-cont":for(e="",f=this.l,h=0;h<i;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return l=ro(this,f),this.l=f+1,c=Pl.call(this,i-h,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Pu(kl(this,f))),f+=2}e=o.join(""),i*=2;break;case"cpstr":case"sbcs-cont":for(e="",f=this.l,h=0;h!=i;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return l=ro(this,f),this.l=f+1,c=Pl.call(this,i-h,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Pu(ro(this,f))),f+=1}e=o.join("");break;default:switch(i){case 1:return n=ro(this,this.l),this.l++,n;case 2:return n=(t==="i"?Zw:kl)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(i>0?qr:Jw)(this,this.l),this.l+=4,n):(r=Ei(this,this.l),this.l+=4,r);case 8:case-8:if(t==="f")return i==8?r=Ju(this,this.l):r=Ju([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;i=8;case 16:e=xy(this,this.l,i);break}}return this.l+=i,e}var Qw=function(i,t,e){i[e]=t&255,i[e+1]=t>>>8&255,i[e+2]=t>>>16&255,i[e+3]=t>>>24&255},tE=function(i,t,e){i[e]=t&255,i[e+1]=t>>8&255,i[e+2]=t>>16&255,i[e+3]=t>>24&255},eE=function(i,t,e){i[e]=t&255,i[e+1]=t>>>8&255};function nE(i,t,e){var n=0,r=0;if(e==="dbcs"){for(r=0;r!=t.length;++r)eE(this,t.charCodeAt(r),this.l+2*r);n=2*t.length}else if(e==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=t.charCodeAt(r)&255;n=t.length}else if(e==="hex"){for(;r<i;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}else if(e==="utf16le"){var o=Math.min(this.l+i,this.length);for(r=0;r<Math.min(t.length,i);++r){var l=t.charCodeAt(r);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(i){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Qw(this,t,this.l);break;case 8:if(n=8,e==="f"){$w(this,t,this.l);break}case 16:break;case-4:n=4,tE(this,t,this.l);break}return this.l+=n,this}function Ry(i,t){var e=xy(this,this.l,i.length>>1);if(e!==i)throw new Error(t+"Expected "+i+" saw "+e);this.l+=i.length>>1}function Si(i,t){i.l=t,i.read_shift=Pl,i.chk=Ry,i.write_shift=nE}function ya(i,t){i.l+=t}function At(i){var t=as(i);return Si(t,0),t}function ci(){var i=[],t=Ee?256:2048,e=function(f){var g=At(f);return Si(g,0),g},n=e(t),r=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&i.push(n),n=null)},o=function(f){return n&&f<n.length-n.l?n:(r(),n=e(Math.max(f+1,t)))},l=function(){return r(),Ln(i)},c=function(f){r(),n=f,n.l==null&&(n.l=n.length),o(t)};return{next:o,push:c,end:l,_bufs:i}}function Pt(i,t,e,n){var r=+t,o;if(!isNaN(r)){n||(n=q3[r].p||(e||[]).length||0),o=1+(r>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var l=i.next(o);r<=127?l.write_shift(1,r):(l.write_shift(1,(r&127)+128),l.write_shift(1,r>>7));for(var c=0;c!=4;++c)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&K0(e)&&i.push(e)}}function Ml(i,t,e){var n=hi(i);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Qv(i,t,e){var n=hi(i);return n.s=Ml(n.s,t.s,e),n.e=Ml(n.e,t.s,e),n}function Nl(i,t){if(i.cRel&&i.c<0)for(i=hi(i);i.c<0;)i.c+=t>8?16384:256;if(i.rRel&&i.r<0)for(i=hi(i);i.r<0;)i.r+=t>8?1048576:t>5?65536:16384;var e=Pe(i);return!i.cRel&&i.cRel!=null&&(e=rE(e)),!i.rRel&&i.rRel!=null&&(e=iE(e)),e}function Jd(i,t){return i.s.r==0&&!i.s.rRel&&i.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!i.e.rRel?(i.s.cRel?"":"$")+jn(i.s.c)+":"+(i.e.cRel?"":"$")+jn(i.e.c):i.s.c==0&&!i.s.cRel&&i.e.c==(t.biff>=12?16383:255)&&!i.e.cRel?(i.s.rRel?"":"$")+In(i.s.r)+":"+(i.e.rRel?"":"$")+In(i.e.r):Nl(i.s,t.biff)+":"+Nl(i.e,t.biff)}function W0(i){return parseInt(aE(i),10)-1}function In(i){return""+(i+1)}function iE(i){return i.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function aE(i){return i.replace(/\$(\d+)$/,"$1")}function Y0(i){for(var t=sE(i),e=0,n=0;n!==t.length;++n)e=26*e+t.charCodeAt(n)-64;return e-1}function jn(i){if(i<0)throw new Error("invalid column "+i);var t="";for(++i;i;i=Math.floor((i-1)/26))t=String.fromCharCode((i-1)%26+65)+t;return t}function rE(i){return i.replace(/^([A-Z])/,"$$$1")}function sE(i){return i.replace(/^\$([A-Z])/,"$1")}function oE(i){return i.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function En(i){for(var t=0,e=0,n=0;n<i.length;++n){var r=i.charCodeAt(n);r>=48&&r<=57?t=10*t+(r-48):r>=65&&r<=90&&(e=26*e+(r-64))}return{c:e-1,r:t-1}}function Pe(i){for(var t=i.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(i.r+1)}function Ti(i){var t=i.indexOf(":");return t==-1?{s:En(i),e:En(i)}:{s:En(i.slice(0,t)),e:En(i.slice(t+1))}}function pn(i,t){return typeof t>"u"||typeof t=="number"?pn(i.s,i.e):(typeof i!="string"&&(i=Pe(i)),typeof t!="string"&&(t=Pe(t)),i==t?i:i+":"+t)}function Xe(i){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,r=0,o=i.length;for(e=0;n<o&&!((r=i.charCodeAt(n)-64)<1||r>26);++n)e=26*e+r;for(t.s.c=--e,e=0;n<o&&!((r=i.charCodeAt(n)-48)<0||r>9);++n)e=10*e+r;if(t.s.r=--e,n===o||r!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,e=0;n!=o&&!((r=i.charCodeAt(n)-64)<1||r>26);++n)e=26*e+r;for(t.e.c=--e,e=0;n!=o&&!((r=i.charCodeAt(n)-48)<0||r>9);++n)e=10*e+r;return t.e.r=--e,t}function t2(i,t){var e=i.t=="d"&&t instanceof Date;if(i.z!=null)try{return i.w=Tr(i.z,e?ui(t):t)}catch{}try{return i.w=Tr((i.XF||{}).numFmtId||(e?14:0),e?ui(t):t)}catch{return""+t}}function Wa(i,t,e){return i==null||i.t==null||i.t=="z"?"":i.w!==void 0?i.w:(i.t=="d"&&!i.z&&e&&e.dateNF&&(i.z=e.dateNF),i.t=="e"?ac[i.v]||i.v:t==null?t2(i,i.v):t2(i,t))}function cs(i,t){var e=t&&t.sheet?t.sheet:"Sheet1",n={};return n[e]=i,{SheetNames:[e],Sheets:n}}function Py(i,t,e){var n=e||{},r=i?Array.isArray(i):n.dense,o=i||(r?[]:{}),l=0,c=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?En(n.origin):n.origin;l=h.r,c=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var g=Xe(o["!ref"]);f.s.c=g.s.c,f.s.r=g.s.r,f.e.c=Math.max(f.e.c,g.e.c),f.e.r=Math.max(f.e.r,g.e.r),l==-1&&(f.e.r=l=g.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[p].length;++m)if(!(typeof t[p][m]>"u")){var v={v:t[p][m]},b=l+p,y=c+m;if(f.s.r>b&&(f.s.r=b),f.s.c>y&&(f.s.c=y),f.e.r<b&&(f.e.r=b),f.e.c<y&&(f.e.c=y),t[p][m]&&typeof t[p][m]=="object"&&!Array.isArray(t[p][m])&&!(t[p][m]instanceof Date))v=t[p][m];else if(Array.isArray(v.v)&&(v.f=t[p][m][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||nn[14],n.cellDates?(v.t="d",v.w=Tr(v.z,ui(v.v))):(v.t="n",v.v=ui(v.v),v.w=Tr(v.z,v.v))):v.t="s";if(r)o[b]||(o[b]=[]),o[b][y]&&o[b][y].z&&(v.z=o[b][y].z),o[b][y]=v;else{var A=Pe({c:y,r:b});o[A]&&o[A].z&&(v.z=o[A].z),o[A]=v}}}return f.s.c<1e7&&(o["!ref"]=pn(f)),o}function So(i,t){return Py(null,i,t)}function lE(i){return i.read_shift(4,"i")}function ea(i,t){return t||(t=At(4)),t.write_shift(4,i),t}function Gn(i){var t=i.read_shift(4);return t===0?"":i.read_shift(t,"dbcs")}function Tn(i,t){var e=!1;return t==null&&(e=!0,t=At(4+2*i.length)),t.write_shift(4,i.length),i.length>0&&t.write_shift(0,i,"dbcs"),e?t.slice(0,t.l):t}function cE(i){return{ich:i.read_shift(2),ifnt:i.read_shift(2)}}function uE(i,t){return t||(t=At(4)),t.write_shift(2,0),t.write_shift(2,0),t}function q0(i,t){var e=i.l,n=i.read_shift(1),r=Gn(i),o=[],l={t:r,h:r};if((n&1)!==0){for(var c=i.read_shift(4),h=0;h!=c;++h)o.push(cE(i));l.r=o}else l.r=[{ich:0,ifnt:0}];return i.l=e+t,l}function hE(i,t){var e=!1;return t==null&&(e=!0,t=At(15+4*i.t.length)),t.write_shift(1,0),Tn(i.t,t),e?t.slice(0,t.l):t}var fE=q0;function dE(i,t){var e=!1;return t==null&&(e=!0,t=At(23+4*i.t.length)),t.write_shift(1,1),Tn(i.t,t),t.write_shift(4,1),uE({},t),e?t.slice(0,t.l):t}function Xi(i){var t=i.read_shift(4),e=i.read_shift(2);return e+=i.read_shift(1)<<16,i.l++,{c:t,iStyleRef:e}}function us(i,t){return t==null&&(t=At(8)),t.write_shift(-4,i.c),t.write_shift(3,i.iStyleRef||i.s),t.write_shift(1,0),t}function hs(i){var t=i.read_shift(2);return t+=i.read_shift(1)<<16,i.l++,{c:-1,iStyleRef:t}}function fs(i,t){return t==null&&(t=At(4)),t.write_shift(3,i.iStyleRef||i.s),t.write_shift(1,0),t}var gE=Gn,My=Tn;function $0(i){var t=i.read_shift(4);return t===0||t===4294967295?"":i.read_shift(t,"dbcs")}function Qu(i,t){var e=!1;return t==null&&(e=!0,t=At(127)),t.write_shift(4,i.length>0?i.length:4294967295),i.length>0&&t.write_shift(0,i,"dbcs"),e?t.slice(0,t.l):t}var pE=Gn,_0=$0,Z0=Qu;function Ny(i){var t=i.slice(i.l,i.l+4),e=t[0]&1,n=t[0]&2;i.l+=4;var r=n===0?Ju([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):qr(t,0)>>2;return e?r/100:r}function Fy(i,t){t==null&&(t=At(4));var e=0,n=0,r=i*100;if(i==(i|0)&&i>=-536870912&&i<1<<29?n=1:r==(r|0)&&r>=-536870912&&r<1<<29&&(n=1,e=1),n)t.write_shift(-4,((e?r:i)<<2)+(e+2));else throw new Error("unsupported RkNumber "+i)}function Ly(i){var t={s:{},e:{}};return t.s.r=i.read_shift(4),t.e.r=i.read_shift(4),t.s.c=i.read_shift(4),t.e.c=i.read_shift(4),t}function mE(i,t){return t||(t=At(16)),t.write_shift(4,i.s.r),t.write_shift(4,i.e.r),t.write_shift(4,i.s.c),t.write_shift(4,i.e.c),t}var ds=Ly,wo=mE;function Eo(i){if(i.length-i.l<8)throw"XLS Xnum Buffer underflow";return i.read_shift(8,"f")}function rs(i,t){return(t||At(8)).write_shift(8,i,"f")}function vE(i){var t={},e=i.read_shift(1),n=e>>>1,r=i.read_shift(1),o=i.read_shift(2,"i"),l=i.read_shift(1),c=i.read_shift(1),h=i.read_shift(1);switch(i.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var f=TE[r];f&&(t.rgb=h2(f));break;case 2:t.rgb=h2([l,c,h]);break;case 3:t.theme=r;break}return o!=0&&(t.tint=o>0?o/32767:o/32768),t}function th(i,t){if(t||(t=At(8)),!i||i.auto)return t.write_shift(4,0),t.write_shift(4,0),t;i.index!=null?(t.write_shift(1,2),t.write_shift(1,i.index)):i.theme!=null?(t.write_shift(1,6),t.write_shift(1,i.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=i.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!i.rgb||i.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=i.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function yE(i){var t=i.read_shift(1);i.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function xE(i,t){t||(t=At(2));var e=(i.italic?2:0)|(i.strike?8:0)|(i.outline?16:0)|(i.shadow?32:0)|(i.condense?64:0)|(i.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var By=2,bi=3,Lu=11,eh=19,Bu=64,_E=65,bE=71,AE=4108,SE=4126,Nn=80,e2={1:{n:"CodePage",t:By},2:{n:"Category",t:Nn},3:{n:"PresentationFormat",t:Nn},4:{n:"ByteCount",t:bi},5:{n:"LineCount",t:bi},6:{n:"ParagraphCount",t:bi},7:{n:"SlideCount",t:bi},8:{n:"NoteCount",t:bi},9:{n:"HiddenCount",t:bi},10:{n:"MultimediaClipCount",t:bi},11:{n:"ScaleCrop",t:Lu},12:{n:"HeadingPairs",t:AE},13:{n:"TitlesOfParts",t:SE},14:{n:"Manager",t:Nn},15:{n:"Company",t:Nn},16:{n:"LinksUpToDate",t:Lu},17:{n:"CharacterCount",t:bi},19:{n:"SharedDoc",t:Lu},22:{n:"HyperlinksChanged",t:Lu},23:{n:"AppVersion",t:bi,p:"version"},24:{n:"DigSig",t:_E},26:{n:"ContentType",t:Nn},27:{n:"ContentStatus",t:Nn},28:{n:"Language",t:Nn},29:{n:"Version",t:Nn},255:{},2147483648:{n:"Locale",t:eh},2147483651:{n:"Behavior",t:eh},1919054434:{}},n2={1:{n:"CodePage",t:By},2:{n:"Title",t:Nn},3:{n:"Subject",t:Nn},4:{n:"Author",t:Nn},5:{n:"Keywords",t:Nn},6:{n:"Comments",t:Nn},7:{n:"Template",t:Nn},8:{n:"LastAuthor",t:Nn},9:{n:"RevNumber",t:Nn},10:{n:"EditTime",t:Bu},11:{n:"LastPrinted",t:Bu},12:{n:"CreatedDate",t:Bu},13:{n:"ModifiedDate",t:Bu},14:{n:"PageCount",t:bi},15:{n:"WordCount",t:bi},16:{n:"CharCount",t:bi},17:{n:"Thumbnail",t:bE},18:{n:"Application",t:Nn},19:{n:"DocSecurity",t:bi},255:{},2147483648:{n:"Locale",t:eh},2147483651:{n:"Behavior",t:eh},1919054434:{}};function wE(i){return i.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var EE=wE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),TE=hi(EE),ac={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},CE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Iu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Iy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Uy(i,t){var e=Bw(CE),n=[],r;n[n.length]=mn,n[n.length]=Ht("Types",null,{xmlns:wn.CT,"xmlns:xsd":wn.xsd,"xmlns:xsi":wn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Ht("Default",null,{Extension:h[0],ContentType:h[1]})}));var o=function(h){i[h]&&i[h].length>0&&(r=i[h][0],n[n.length]=Ht("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:Iu[h][t.bookType]||Iu[h].xlsx}))},l=function(h){(i[h]||[]).forEach(function(f){n[n.length]=Ht("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Iu[h][t.bookType]||Iu[h].xlsx})})},c=function(h){(i[h]||[]).forEach(function(f){n[n.length]=Ht("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:e[h][0]})})};return o("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var be={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zy(i){var t=i.lastIndexOf("/");return i.slice(0,t+1)+"_rels/"+i.slice(t+1)+".rels"}function po(i){var t=[mn,Ht("Relationships",null,{xmlns:wn.RELS})];return Un(i["!id"]).forEach(function(e){t[t.length]=Ht("Relationship",null,i["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Oe(i,t,e,n,r,o){if(r||(r={}),i["!id"]||(i["!id"]={}),i["!idx"]||(i["!idx"]=1),t<0)for(t=i["!idx"];i["!id"]["rId"+t];++t);if(i["!idx"]=t+1,r.Id="rId"+t,r.Type=n,r.Target=e,[be.HLINK,be.XPATH,be.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),i["!id"][r.Id])throw new Error("Cannot rewrite rId "+t);return i["!id"][r.Id]=r,i[("/"+r.Target).replace("//","/")]=r,t}function kE(i){var t=[mn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<i.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+i[e][0]+'" manifest:media-type="'+i[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function i2(i,t,e){return['  <rdf:Description rdf:about="'+i+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function DE(i,t){return['  <rdf:Description rdf:about="'+i+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function OE(i){var t=[mn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=i.length;++e)t.push(i2(i[e][0],i[e][1])),t.push(DE("",i[e][0]));return t.push(i2("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Hy(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ku.version+"</meta:generator></office:meta></office:document-meta>"}var es=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Qd(i,t,e,n,r){r[i]!=null||t==null||t===""||(r[i]=t,t=Re(t),n[n.length]=e?Ht(i,t,e):Bn(i,t))}function jy(i,t){var e=t||{},n=[mn,Ht("cp:coreProperties",null,{"xmlns:cp":wn.CORE_PROPS,"xmlns:dc":wn.dc,"xmlns:dcterms":wn.dcterms,"xmlns:dcmitype":wn.dcmitype,"xmlns:xsi":wn.xsi})],r={};if(!i&&!e.Props)return n.join("");i&&(i.CreatedDate!=null&&Qd("dcterms:created",typeof i.CreatedDate=="string"?i.CreatedDate:x0(i.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,r),i.ModifiedDate!=null&&Qd("dcterms:modified",typeof i.ModifiedDate=="string"?i.ModifiedDate:x0(i.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,r));for(var o=0;o!=es.length;++o){var l=es[o],c=e.Props&&e.Props[l[1]]!=null?e.Props[l[1]]:i?i[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Qd(l[0],c,null,n,r)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var mo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Gy=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Vy(i){var t=[],e=Ht;return i||(i={}),i.Application="SheetJS",t[t.length]=mn,t[t.length]=Ht("Properties",null,{xmlns:wn.EXT_PROPS,"xmlns:vt":wn.vt}),mo.forEach(function(n){if(i[n[1]]!==void 0){var r;switch(n[2]){case"string":r=Re(String(i[n[1]]));break;case"bool":r=i[n[1]]?"true":"false";break}r!==void 0&&(t[t.length]=e(n[0],r))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(i.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",i.SheetNames.map(function(n){return"<vt:lpstr>"+Re(n)+"</vt:lpstr>"}).join(""),{size:i.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Xy(i){var t=[mn,Ht("Properties",null,{xmlns:wn.CUST_PROPS,"xmlns:vt":wn.vt})];if(!i)return t.join("");var e=1;return Un(i).forEach(function(r){++e,t[t.length]=Ht("property",Yw(i[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Re(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var a2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function RE(i,t){var e=[];return Un(a2).map(function(n){for(var r=0;r<es.length;++r)if(es[r][1]==n)return es[r];for(r=0;r<mo.length;++r)if(mo[r][1]==n)return mo[r];throw n}).forEach(function(n){if(i[n[1]]!=null){var r=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:i[n[1]];n[2]==="date"&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"Z")),typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),e.push(Bn(a2[n[1]]||n[1],r))}}),Ht("DocumentProperties",e.join(""),{xmlns:wi.o})}function PE(i,t){var e=["Worksheets","SheetNames"],n="CustomDocumentProperties",r=[];return i&&Un(i).forEach(function(o){if(Object.prototype.hasOwnProperty.call(i,o)){for(var l=0;l<es.length;++l)if(o==es[l][1])return;for(l=0;l<mo.length;++l)if(o==mo[l][1])return;for(l=0;l<e.length;++l)if(o==e[l])return;var c=i[o],h="string";typeof c=="number"?(h="float",c=String(c)):c===!0||c===!1?(h="boolean",c=c?"1":"0"):c=String(c),r.push(Ht(Xv(o),c,{"dt:dt":h}))}}),t&&Un(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)&&!(i&&Object.prototype.hasOwnProperty.call(i,o))){var l=t[o],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),r.push(Ht(Xv(o),l,{"dt:dt":c}))}}),"<"+n+' xmlns="'+wi.o+'">'+r.join("")+"</"+n+">"}function ME(i){var t=typeof i=="string"?new Date(Date.parse(i)):i,e=t.getTime()/1e3+11644473600,n=e%Math.pow(2,32),r=(e-n)/Math.pow(2,32);n*=1e7,r*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),r+=o);var l=At(8);return l.write_shift(4,n),l.write_shift(4,r),l}function r2(i,t){var e=At(4),n=At(4);switch(e.write_shift(4,i==80?31:i),i){case 3:n.write_shift(-4,t);break;case 5:n=At(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=ME(t);break;case 31:case 80:for(n=At(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+i+" "+t)}return Ln([e,n])}var Ky=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function NE(i){switch(typeof i){case"boolean":return 11;case"number":return(i|0)==i?3:5;case"string":return 31;case"object":if(i instanceof Date)return 64;break}return-1}function s2(i,t,e){var n=At(8),r=[],o=[],l=8,c=0,h=At(8),f=At(8);if(h.write_shift(4,2),h.write_shift(4,1200),f.write_shift(4,1),o.push(h),r.push(f),l+=8+h.length,!t){f=At(8),f.write_shift(4,0),r.unshift(f);var g=[At(4)];for(g[0].write_shift(4,i.length),c=0;c<i.length;++c){var p=i[c][0];for(h=At(8+2*(p.length+1)+(p.length%2?0:2)),h.write_shift(4,c+2),h.write_shift(4,p.length+1),h.write_shift(0,p,"dbcs");h.l!=h.length;)h.write_shift(1,0);g.push(h)}h=Ln(g),o.unshift(h),l+=8+h.length}for(c=0;c<i.length;++c)if(!(t&&!t[i[c][0]])&&!(Ky.indexOf(i[c][0])>-1||Gy.indexOf(i[c][0])>-1)&&i[c][1]!=null){var m=i[c][1],v=0;if(t){v=+t[i[c][0]];var b=e[v];if(b.p=="version"&&typeof m=="string"){var y=m.split(".");m=(+y[0]<<16)+(+y[1]||0)}h=r2(b.t,m)}else{var A=NE(m);A==-1&&(A=31,m=String(m)),h=r2(A,m)}o.push(h),f=At(8),f.write_shift(4,t?v:2+c),r.push(f),l+=8+h.length}var S=8*(o.length+1);for(c=0;c<o.length;++c)r[c].write_shift(4,S),S+=o[c].length;return n.write_shift(4,l),n.write_shift(4,o.length),Ln([n].concat(r).concat(o))}function o2(i,t,e,n,r,o){var l=At(r?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Be.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,r?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,r?68:48);var h=s2(i,e,n);if(c.push(h),r){var f=s2(r,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+h.length),c.push(f)}return Ln(c)}function FE(i,t){t||(t=At(i));for(var e=0;e<i;++e)t.write_shift(1,0);return t}function LE(i,t){return i.read_shift(t)===1}function $n(i,t){return t||(t=At(2)),t.write_shift(2,+!!i),t}function Wy(i){return i.read_shift(2,"u")}function Gi(i,t){return t||(t=At(2)),t.write_shift(2,i),t}function Yy(i,t,e){return e||(e=At(2)),e.write_shift(1,t=="e"?+i:+!!i),e.write_shift(1,t=="e"?1:0),e}function qy(i,t,e){var n=i.read_shift(e&&e.biff>=12?2:1),r="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var o=i.read_shift(1);o&&(r="dbcs-cont")}else e.biff==12&&(r="wstr");e.biff>=2&&e.biff<=5&&(r="cpstr");var l=n?i.read_shift(n,r):"";return l}function BE(i){var t=i.t||"",e=At(3);e.write_shift(2,t.length),e.write_shift(1,1);var n=At(2*t.length);n.write_shift(2*t.length,t,"utf16le");var r=[e,n];return Ln(r)}function IE(i,t,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return i.read_shift(t,"cpstr");if(e.biff>=12)return i.read_shift(t,"dbcs-cont")}var r=i.read_shift(1);return r===0?n=i.read_shift(t,"sbcs-cont"):n=i.read_shift(t,"dbcs-cont"),n}function UE(i,t,e){var n=i.read_shift(e&&e.biff==2?1:2);return n===0?(i.l++,""):IE(i,n,e)}function zE(i,t,e){if(e.biff>5)return UE(i,t,e);var n=i.read_shift(1);return n===0?(i.l++,""):i.read_shift(n,e.biff<=4||!i.lens?"cpstr":"sbcs-cont")}function $y(i,t,e){return e||(e=At(3+2*i.length)),e.write_shift(2,i.length),e.write_shift(1,1),e.write_shift(31,i,"utf16le"),e}function l2(i,t){t||(t=At(6+i.length*2)),t.write_shift(4,1+i.length);for(var e=0;e<i.length;++e)t.write_shift(2,i.charCodeAt(e));return t.write_shift(2,0),t}function HE(i){var t=At(512),e=0,n=i.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var r=n.indexOf("#"),o=r>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}t.write_shift(4,2),t.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(e=0;e<l.length;++e)t.write_shift(4,l[e]);if(o==28)n=n.slice(1),l2(n,t);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<l.length;++e)t.write_shift(1,parseInt(l[e],16));var c=r>-1?n.slice(0,r):n;for(t.write_shift(4,2*(c.length+1)),e=0;e<c.length;++e)t.write_shift(2,c.charCodeAt(e));t.write_shift(2,0),o&8&&l2(r>-1?n.slice(r+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<l.length;++e)t.write_shift(1,parseInt(l[e],16));for(var h=0;n.slice(h*3,h*3+3)=="../"||n.slice(h*3,h*3+3)=="..\\";)++h;for(t.write_shift(2,h),t.write_shift(4,n.length-3*h+1),e=0;e<n.length-3*h;++e)t.write_shift(1,n.charCodeAt(e+3*h)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function ss(i,t,e,n){return n||(n=At(6)),n.write_shift(2,i),n.write_shift(2,t),n.write_shift(2,e||0),n}function jE(i,t,e){var n=e.biff>8?4:2,r=i.read_shift(n),o=i.read_shift(n,"i"),l=i.read_shift(n,"i");return[r,o,l]}function GE(i){var t=i.read_shift(2),e=i.read_shift(2),n=i.read_shift(2),r=i.read_shift(2);return{s:{c:n,r:t},e:{c:r,r:e}}}function Zy(i,t){return t||(t=At(8)),t.write_shift(2,i.s.r),t.write_shift(2,i.e.r),t.write_shift(2,i.s.c),t.write_shift(2,i.e.c),t}function J0(i,t,e){var n=1536,r=16;switch(e.bookType){case"biff8":break;case"biff5":n=1280,r=8;break;case"biff4":n=4,r=6;break;case"biff3":n=3,r=6;break;case"biff2":n=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=At(r);return o.write_shift(2,n),o.write_shift(2,t),r>4&&o.write_shift(2,29282),r>6&&o.write_shift(2,1997),r>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function VE(i,t){var e=!t||t.biff==8,n=At(e?112:54);for(n.write_shift(t.biff==8?2:1,7),e&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(e?0:536870912));n.l<n.length;)n.write_shift(1,e?0:32);return n}function XE(i,t){var e=!t||t.biff>=8?2:1,n=At(8+e*i.name.length);n.write_shift(4,i.pos),n.write_shift(1,i.hs||0),n.write_shift(1,i.dt),n.write_shift(1,i.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(e*i.name.length,i.name,t.biff<8?"sbcs":"utf16le");var r=n.slice(0,n.l);return r.l=n.l,r}function KE(i,t){var e=At(8);e.write_shift(4,i.Count),e.write_shift(4,i.Unique);for(var n=[],r=0;r<i.length;++r)n[r]=BE(i[r]);var o=Ln([e].concat(n));return o.parts=[e.length].concat(n.map(function(l){return l.length})),o}function WE(){var i=At(18);return i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,29280),i.write_shift(2,17600),i.write_shift(2,56),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,1),i.write_shift(2,500),i}function YE(i){var t=At(18),e=1718;return i&&i.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function qE(i,t){var e=i.name||"Arial",n=t&&t.biff==5,r=n?15+e.length:16+2*e.length,o=At(r);return o.write_shift(2,i.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,e.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le"),o}function $E(i,t,e,n){var r=At(10);return ss(i,t,n,r),r.write_shift(4,e),r}function ZE(i,t,e,n,r){var o=!r||r.biff==8,l=At(8+ +o+(1+o)*e.length);return ss(i,t,n,l),l.write_shift(2,e.length),o&&l.write_shift(1,1),l.write_shift((1+o)*e.length,e,o?"utf16le":"sbcs"),l}function JE(i,t,e,n){var r=e&&e.biff==5;n||(n=At(r?3+t.length:5+2*t.length)),n.write_shift(2,i),n.write_shift(r?1:2,t.length),r||n.write_shift(1,1),n.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}function QE(i,t){var e=t.biff==8||!t.biff?4:2,n=At(2*e+6);return n.write_shift(e,i.s.r),n.write_shift(e,i.e.r+1),n.write_shift(2,i.s.c),n.write_shift(2,i.e.c+1),n.write_shift(2,0),n}function c2(i,t,e,n){var r=e&&e.biff==5;n||(n=At(r?16:20)),n.write_shift(2,0),i.style?(n.write_shift(2,i.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,i.numFmtId||0),n.write_shift(2,t<<4));var o=0;return i.numFmtId>0&&r&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),r||n.write_shift(4,0),n.write_shift(2,0),n}function tT(i){var t=At(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function eT(i,t,e,n,r,o){var l=At(8);return ss(i,t,n,l),Yy(e,o,l),l}function nT(i,t,e,n){var r=At(14);return ss(i,t,n,r),rs(e,r),r}function iT(i,t,e){if(e.biff<8)return aT(i,t,e);for(var n=[],r=i.l+t,o=i.read_shift(e.biff>8?4:2);o--!==0;)n.push(jE(i,e.biff>8?12:6,e));if(i.l!=r)throw new Error("Bad ExternSheet: "+i.l+" != "+r);return n}function aT(i,t,e){i[i.l+1]==3&&i[i.l]++;var n=qy(i,t,e);return n.charCodeAt(0)==3?n.slice(1):n}function rT(i){var t=At(2+i.length*8);t.write_shift(2,i.length);for(var e=0;e<i.length;++e)Zy(i[e],t);return t}function sT(i){var t=At(24),e=En(i[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)t.write_shift(1,parseInt(n[r],16));return Ln([t,HE(i[1])])}function oT(i){var t=i[1].Tooltip,e=At(10+2*(t.length+1));e.write_shift(2,2048);var n=En(i[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function lT(i){return i||(i=At(4)),i.write_shift(2,1),i.write_shift(2,1),i}function cT(i,t,e){if(!e.cellStyles)return ya(i,t);var n=e&&e.biff>=12?4:2,r=i.read_shift(n),o=i.read_shift(n),l=i.read_shift(n),c=i.read_shift(n),h=i.read_shift(2);n==2&&(i.l+=2);var f={s:r,e:o,w:l,ixfe:c,flags:h};return(e.biff>=5||!e.biff)&&(f.level=h>>8&7),f}function uT(i,t){var e=At(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,i.width*256),e.write_shift(2,0);var n=0;return i.hidden&&(n|=1),e.write_shift(1,n),n=i.level||0,e.write_shift(1,n),e.write_shift(2,0),e}function hT(i){for(var t=At(2*i),e=0;e<i;++e)t.write_shift(2,e+1);return t}function fT(i,t,e){var n=At(15);return sc(n,i,t),n.write_shift(8,e,"f"),n}function dT(i,t,e){var n=At(9);return sc(n,i,t),n.write_shift(2,e),n}var gT=(function(){var i={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=H0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(c,h){var f=[],g=as(1);switch(h.type){case"base64":g=Qi(Ka(c));break;case"binary":g=Qi(c);break;case"buffer":case"array":g=c;break}Si(g,0);var p=g.read_shift(1),m=!!(p&136),v=!1,b=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,m=!0;break;case 49:v=!0,m=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,A=521;p==2&&(y=g.read_shift(2)),g.l+=3,p!=2&&(y=g.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(A=g.read_shift(2));var S=g.read_shift(2),w=h.codepage||1252;p!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(w=i[g[g.l]]),g.l+=1,g.l+=2),b&&(g.l+=36);for(var E=[],D={},P=Math.min(g.length,p==2?521:A-10-(v?264:0)),L=b?32:11;g.l<P&&g[g.l]!=13;)switch(D={},D.name=Wu.utils.decode(w,g.slice(g.l,g.l+L)).replace(/[\u0000\r\n].*$/g,""),g.l+=L,D.type=String.fromCharCode(g.read_shift(1)),p!=2&&!b&&(D.offset=g.read_shift(4)),D.len=g.read_shift(1),p==2&&(D.offset=g.read_shift(2)),D.dec=g.read_shift(1),D.name.length&&E.push(D),p!=2&&(g.l+=b?13:14),D.type){case"B":(!v||D.len!=8)&&h.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(g[g.l]!==13&&(g.l=A-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=A;var R=0,V=0;for(f[0]=[],V=0;V!=E.length;++V)f[0][V]=E[V].name;for(;y-- >0;){if(g[g.l]===42){g.l+=S;continue}for(++g.l,f[++R]=[],V=0,V=0;V!=E.length;++V){var F=g.slice(g.l,g.l+E[V].len);g.l+=E[V].len,Si(F,0);var Z=Wu.utils.decode(w,F);switch(E[V].type){case"C":Z.trim().length&&(f[R][V]=Z.replace(/\s+$/,""));break;case"D":Z.length===8?f[R][V]=new Date(+Z.slice(0,4),+Z.slice(4,6)-1,+Z.slice(6,8)):f[R][V]=Z;break;case"F":f[R][V]=parseFloat(Z.trim());break;case"+":case"I":f[R][V]=b?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(Z.trim().toUpperCase()){case"Y":case"T":f[R][V]=!0;break;case"N":case"F":f[R][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Z+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[R][V]="##MEMO##"+(b?parseInt(Z.trim(),10):F.read_shift(4));break;case"N":Z=Z.replace(/\u0000/g,"").trim(),Z&&Z!="."&&(f[R][V]=+Z||0);break;case"@":f[R][V]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":f[R][V]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":f[R][V]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[R][V]=-F.read_shift(-8,"f");break;case"B":if(v&&E[V].len==8){f[R][V]=F.read_shift(8,"f");break}case"G":case"P":F.l+=E[V].len;break;case"0":if(E[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[V].type)}}}if(p!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h&&h.sheetRows&&(f=f.slice(0,h.sheetRows)),h.DBF=E,f}function n(c,h){var f=h||{};f.dateNF||(f.dateNF="yyyymmdd");var g=So(e(c,f),f);return g["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,g}function r(c,h){try{return cs(n(c,h),h)}catch(f){if(h&&h.WTF)throw f}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,h){var f=h||{};if(+f.codepage>=0&&Hl(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var g=ci(),p=sh(c,{header:1,raw:!0,cellDates:!0}),m=p[0],v=p.slice(1),b=c["!cols"]||[],y=0,A=0,S=0,w=1;for(y=0;y<m.length;++y){if(((b[y]||{}).DBF||{}).name){m[y]=b[y].DBF.name,++S;continue}if(m[y]!=null){if(++S,typeof m[y]=="number"&&(m[y]=m[y].toString(10)),typeof m[y]!="string")throw new Error("DBF Invalid column name "+m[y]+" |"+typeof m[y]+"|");if(m.indexOf(m[y])!==y){for(A=0;A<1024;++A)if(m.indexOf(m[y]+"_"+A)==-1){m[y]+="_"+A;break}}}}var E=Xe(c["!ref"]),D=[],P=[],L=[];for(y=0;y<=E.e.c-E.s.c;++y){var R="",V="",F=0,Z=[];for(A=0;A<v.length;++A)v[A][y]!=null&&Z.push(v[A][y]);if(Z.length==0||m[y]==null){D[y]="?";continue}for(A=0;A<Z.length;++A){switch(typeof Z[A]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=Z[A]instanceof Date?"D":"C";break;default:V="C"}F=Math.max(F,String(Z[A]).length),R=R&&R!=V?"C":V}F>250&&(F=250),V=((b[y]||{}).DBF||{}).type,V=="C"&&b[y].DBF.len>F&&(F=b[y].DBF.len),R=="B"&&V=="N"&&(R="N",L[y]=b[y].DBF.dec,F=b[y].DBF.len),P[y]=R=="C"||V=="N"?F:o[R]||0,w+=P[y],D[y]=R}var tt=g.next(32);for(tt.write_shift(4,318902576),tt.write_shift(4,v.length),tt.write_shift(2,296+32*S),tt.write_shift(2,w),y=0;y<4;++y)tt.write_shift(4,0);for(tt.write_shift(4,0|(+t[Q2]||3)<<8),y=0,A=0;y<m.length;++y)if(m[y]!=null){var I=g.next(32),nt=(m[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,nt,"sbcs"),I.write_shift(1,D[y]=="?"?"C":D[y],"sbcs"),I.write_shift(4,A),I.write_shift(1,P[y]||o[D[y]]||0),I.write_shift(1,L[y]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),A+=P[y]||o[D[y]]||0}var O=g.next(264);for(O.write_shift(4,13),y=0;y<65;++y)O.write_shift(4,0);for(y=0;y<v.length;++y){var rt=g.next(w);for(rt.write_shift(1,0),A=0;A<m.length;++A)if(m[A]!=null)switch(D[A]){case"L":rt.write_shift(1,v[y][A]==null?63:v[y][A]?84:70);break;case"B":rt.write_shift(8,v[y][A]||0,"f");break;case"N":var Q="0";for(typeof v[y][A]=="number"&&(Q=v[y][A].toFixed(L[A]||0)),S=0;S<P[A]-Q.length;++S)rt.write_shift(1,32);rt.write_shift(1,Q,"sbcs");break;case"D":v[y][A]?(rt.write_shift(4,("0000"+v[y][A].getFullYear()).slice(-4),"sbcs"),rt.write_shift(2,("00"+(v[y][A].getMonth()+1)).slice(-2),"sbcs"),rt.write_shift(2,("00"+v[y][A].getDate()).slice(-2),"sbcs")):rt.write_shift(8,"00000000","sbcs");break;case"C":var J=String(v[y][A]!=null?v[y][A]:"").slice(0,P[A]);for(rt.write_shift(1,J,"sbcs"),S=0;S<P[A]-J.length;++S)rt.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:r,to_sheet:n,from_sheet:l}})(),pT=(function(){var i={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Un(i).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(m,v){var b=i[v];return typeof b=="number"?Mv(b):b},n=function(m,v,b){var y=v.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return y==59?m:Mv(y)};i["|"]=254;function r(m,v){switch(v.type){case"base64":return o(Ka(m),v);case"binary":return o(m,v);case"buffer":return o(Ee&&Buffer.isBuffer(m)?m.toString("binary"):ec(m),v);case"array":return o(xh(m),v)}throw new Error("Unrecognized type "+v.type)}function o(m,v){var b=m.split(/[\n\r]+/),y=-1,A=-1,S=0,w=0,E=[],D=[],P=null,L={},R=[],V=[],F=[],Z=0,tt;for(+v.codepage>=0&&Hl(+v.codepage);S!==b.length;++S){Z=0;var I=b[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,e),nt=I.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),O=nt[0],rt;if(I.length>0)switch(O){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":nt[1].charAt(0)=="P"&&D.push(I.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,J=!1,_t=!1,vt=!1,Nt=-1,M=-1;for(w=1;w<nt.length;++w)switch(nt[w].charAt(0)){case"A":break;case"X":A=parseInt(nt[w].slice(1))-1,J=!0;break;case"Y":for(y=parseInt(nt[w].slice(1))-1,J||(A=0),tt=E.length;tt<=y;++tt)E[tt]=[];break;case"K":rt=nt[w].slice(1),rt.charAt(0)==='"'?rt=rt.slice(1,rt.length-1):rt==="TRUE"?rt=!0:rt==="FALSE"?rt=!1:isNaN(Va(rt))?isNaN(Gl(rt).getDate())||(rt=Jn(rt)):(rt=Va(rt),P!==null&&hy(P)&&(rt=py(rt))),Q=!0;break;case"E":vt=!0;var C=dC(nt[w].slice(1),{r:y,c:A});E[y][A]=[E[y][A],C];break;case"S":_t=!0,E[y][A]=[E[y][A],"S5S"];break;case"G":break;case"R":Nt=parseInt(nt[w].slice(1))-1;break;case"C":M=parseInt(nt[w].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+I)}if(Q&&(E[y][A]&&E[y][A].length==2?E[y][A][0]=rt:E[y][A]=rt,P=null),_t){if(vt)throw new Error("SYLK shared formula cannot have own formula");var X=Nt>-1&&E[Nt][M];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");E[y][A][1]=gC(X[1],{r:y-Nt,c:A-M})}break;case"F":var U=0;for(w=1;w<nt.length;++w)switch(nt[w].charAt(0)){case"X":A=parseInt(nt[w].slice(1))-1,++U;break;case"Y":for(y=parseInt(nt[w].slice(1))-1,tt=E.length;tt<=y;++tt)E[tt]=[];break;case"M":Z=parseInt(nt[w].slice(1))/20;break;case"F":break;case"G":break;case"P":P=D[parseInt(nt[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=nt[w].slice(1).split(" "),tt=parseInt(F[0],10);tt<=parseInt(F[1],10);++tt)Z=parseInt(F[2],10),V[tt-1]=Z===0?{hidden:!0}:{wch:Z},Q0(V[tt-1]);break;case"C":A=parseInt(nt[w].slice(1))-1,V[A]||(V[A]={});break;case"R":y=parseInt(nt[w].slice(1))-1,R[y]||(R[y]={}),Z>0?(R[y].hpt=Z,R[y].hpx=nx(Z)):Z===0&&(R[y].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+I)}U<1&&(P=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+I)}}return R.length>0&&(L["!rows"]=R),V.length>0&&(L["!cols"]=V),v&&v.sheetRows&&(E=E.slice(0,v.sheetRows)),[E,L]}function l(m,v){var b=r(m,v),y=b[0],A=b[1],S=So(y,v);return Un(A).forEach(function(w){S[w]=A[w]}),S}function c(m,v){return cs(l(m,v),v)}function h(m,v,b,y){var A="C;Y"+(b+1)+";X"+(y+1)+";K";switch(m.t){case"n":A+=m.v||0,m.f&&!m.F&&(A+=";E"+eg(m.f,{r:b,c:y}));break;case"b":A+=m.v?"TRUE":"FALSE";break;case"e":A+=m.w||m.v;break;case"d":A+='"'+(m.w||m.v)+'"';break;case"s":A+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function f(m,v){v.forEach(function(b,y){var A="F;W"+(y+1)+" "+(y+1)+" ";b.hidden?A+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=nh(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=ih(b.wpx)),typeof b.wch=="number"&&(A+=Math.round(b.wch))),A.charAt(A.length-1)!=" "&&m.push(A)})}function g(m,v){v.forEach(function(b,y){var A="F;";b.hidden?A+="M0;":b.hpt?A+="M"+20*b.hpt+";":b.hpx&&(A+="M"+20*ah(b.hpx)+";"),A.length>2&&m.push(A+"R"+(y+1))})}function p(m,v){var b=["ID;PWXL;N;E"],y=[],A=Xe(m["!ref"]),S,w=Array.isArray(m),E=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),m["!cols"]&&f(b,m["!cols"]),m["!rows"]&&g(b,m["!rows"]),b.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var D=A.s.r;D<=A.e.r;++D)for(var P=A.s.c;P<=A.e.c;++P){var L=Pe({r:D,c:P});S=w?(m[D]||[])[P]:m[L],!(!S||S.v==null&&(!S.f||S.F))&&y.push(h(S,m,D,P))}return b.join(E)+E+y.join(E)+E+"E"+E}return{to_workbook:c,to_sheet:l,from_sheet:p}})(),mT=(function(){function i(o,l){switch(l.type){case"base64":return t(Ka(o),l);case"binary":return t(o,l);case"buffer":return t(Ee&&Buffer.isBuffer(o)?o.toString("binary"):ec(o),l);case"array":return t(xh(o),l)}throw new Error("Unrecognized type "+l.type)}function t(o,l){for(var c=o.split(`
`),h=-1,f=-1,g=0,p=[];g!==c.length;++g){if(c[g].trim()==="BOT"){p[++h]=[],f=0;continue}if(!(h<0)){var m=c[g].trim().split(","),v=m[0],b=m[1];++g;for(var y=c[g]||"";(y.match(/["]/g)||[]).length&1&&g<c.length-1;)y+=`
`+c[++g];switch(y=y.trim(),+v){case-1:if(y==="BOT"){p[++h]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[h][f]=!0:y==="FALSE"?p[h][f]=!1:isNaN(Va(b))?isNaN(Gl(b).getDate())?p[h][f]=b:p[h][f]=Jn(b):p[h][f]=Va(b),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[h][f++]=y!==""?y:null;break}if(y==="EOD")break}}return l&&l.sheetRows&&(p=p.slice(0,l.sheetRows)),p}function e(o,l){return So(i(o,l),l)}function n(o,l){return cs(e(o,l),l)}var r=(function(){var o=function(h,f,g,p,m){h.push(f),h.push(g+","+p),h.push('"'+m.replace(/"/g,'""')+'"')},l=function(h,f,g,p){h.push(f+","+g),h.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(h){var f=[],g=Xe(h["!ref"]),p,m=Array.isArray(h);o(f,"TABLE",0,1,"sheetjs"),o(f,"VECTORS",0,g.e.r-g.s.r+1,""),o(f,"TUPLES",0,g.e.c-g.s.c+1,""),o(f,"DATA",0,0,"");for(var v=g.s.r;v<=g.e.r;++v){l(f,-1,0,"BOT");for(var b=g.s.c;b<=g.e.c;++b){var y=Pe({r:v,c:b});if(p=m?(h[v]||[])[b]:h[y],!p){l(f,1,0,"");continue}switch(p.t){case"n":var A=p.w;!A&&p.v!=null&&(A=p.v),A==null?p.f&&!p.F?l(f,1,0,"="+p.f):l(f,1,0,""):l(f,0,A,"V");break;case"b":l(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Tr(p.z||nn[14],ui(Jn(p.v)))),l(f,0,p.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var S=`\r
`,w=f.join(S);return w}})();return{to_workbook:n,to_sheet:e,from_sheet:r}})(),Jy=(function(){function i(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(p,m){for(var v=p.split(`
`),b=-1,y=-1,A=0,S=[];A!==v.length;++A){var w=v[A].trim().split(":");if(w[0]==="cell"){var E=En(w[1]);if(S.length<=E.r)for(b=S.length;b<=E.r;++b)S[b]||(S[b]=[]);switch(b=E.r,y=E.c,w[2]){case"t":S[b][y]=i(w[3]);break;case"v":S[b][y]=+w[3];break;case"vtf":var D=w[w.length-1];case"vtc":w[3]==="nl"?S[b][y]=!!+w[4]:S[b][y]=+w[4],w[2]=="vtf"&&(S[b][y]=[S[b][y],D])}}}return m&&m.sheetRows&&(S=S.slice(0,m.sheetRows)),S}function n(p,m){return So(e(p,m),m)}function r(p,m){return cs(n(p,m),m)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var m=[],v=[],b,y="",A=Ti(p["!ref"]),S=Array.isArray(p),w=A.s.r;w<=A.e.r;++w)for(var E=A.s.c;E<=A.e.c;++E)if(y=Pe({r:w,c:E}),b=S?(p[w]||[])[E]:p[y],!(!b||b.v==null||b.t==="z")){switch(v=["cell",y,"t"],b.t){case"s":case"str":v.push(t(b.v));break;case"n":b.f?(v[2]="vtf",v[3]="n",v[4]=b.v,v[5]=t(b.f)):(v[2]="v",v[3]=b.v);break;case"b":v[2]="vt"+(b.f?"f":"c"),v[3]="nl",v[4]=b.v?"1":"0",v[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var D=ui(Jn(b.v));v[2]="vtc",v[3]="nd",v[4]=""+D,v[5]=b.w||Tr(b.z||nn[14],D);break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function g(p){return[o,l,c,l,f(p),h].join(`
`)}return{to_workbook:r,to_sheet:n,from_sheet:g}})(),vT=(function(){function i(g,p,m,v,b){b.raw?p[m][v]=g:g===""||(g==="TRUE"?p[m][v]=!0:g==="FALSE"?p[m][v]=!1:isNaN(Va(g))?isNaN(Gl(g).getDate())?p[m][v]=g:p[m][v]=Jn(g):p[m][v]=Va(g))}function t(g,p){var m=p||{},v=[];if(!g||g.length===0)return v;for(var b=g.split(/[\r\n]/),y=b.length-1;y>=0&&b[y].length===0;)--y;for(var A=10,S=0,w=0;w<=y;++w)S=b[w].indexOf(" "),S==-1?S=b[w].length:S++,A=Math.max(A,S);for(w=0;w<=y;++w){v[w]=[];var E=0;for(i(b[w].slice(0,A).trim(),v,w,E,m),E=1;E<=(b[w].length-A)/10+1;++E)i(b[w].slice(A+(E-1)*10,A+E*10).trim(),v,w,E,m)}return m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(g){for(var p={},m=!1,v=0,b=0;v<g.length;++v)(b=g.charCodeAt(v))==34?m=!m:!m&&b in e&&(p[b]=(p[b]||0)+1);b=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&b.push([p[v],v]);if(!b.length){p=n;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&b.push([p[v],v])}return b.sort(function(y,A){return y[0]-A[0]||n[y[1]]-n[A[1]]}),e[b.pop()[1]]||44}function o(g,p){var m=p||{},v="",b=m.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(v=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(v=g.charAt(4),g=g.slice(6)):v=r(g.slice(0,1024)):m&&m.FS?v=m.FS:v=r(g.slice(0,1024));var A=0,S=0,w=0,E=0,D=0,P=v.charCodeAt(0),L=!1,R=0,V=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var F=m.dateNF!=null?Mw(m.dateNF):null;function Z(){var tt=g.slice(E,D),I={};if(tt.charAt(0)=='"'&&tt.charAt(tt.length-1)=='"'&&(tt=tt.slice(1,-1).replace(/""/g,'"')),tt.length===0)I.t="z";else if(m.raw)I.t="s",I.v=tt;else if(tt.trim().length===0)I.t="s",I.v=tt;else if(tt.charCodeAt(0)==61)tt.charCodeAt(1)==34&&tt.charCodeAt(tt.length-1)==34?(I.t="s",I.v=tt.slice(2,-1).replace(/""/g,'"')):pC(tt)?(I.t="n",I.f=tt.slice(1)):(I.t="s",I.v=tt);else if(tt=="TRUE")I.t="b",I.v=!0;else if(tt=="FALSE")I.t="b",I.v=!1;else if(!isNaN(w=Va(tt)))I.t="n",m.cellText!==!1&&(I.w=tt),I.v=w;else if(!isNaN(Gl(tt).getDate())||F&&tt.match(F)){I.z=m.dateNF||nn[14];var nt=0;F&&tt.match(F)&&(tt=Nw(tt,m.dateNF,tt.match(F)||[]),nt=1),m.cellDates?(I.t="d",I.v=Jn(tt,nt)):(I.t="n",I.v=ui(Jn(tt,nt))),m.cellText!==!1&&(I.w=Tr(I.z,I.v instanceof Date?ui(I.v):I.v)),m.cellNF||delete I.z}else I.t="s",I.v=tt;if(I.t=="z"||(m.dense?(b[A]||(b[A]=[]),b[A][S]=I):b[Pe({c:S,r:A})]=I),E=D+1,V=g.charCodeAt(E),y.e.c<S&&(y.e.c=S),y.e.r<A&&(y.e.r=A),R==P)++S;else if(S=0,++A,m.sheetRows&&m.sheetRows<=A)return!0}t:for(;D<g.length;++D)switch(R=g.charCodeAt(D)){case 34:V===34&&(L=!L);break;case P:case 10:case 13:if(!L&&Z())break t;break}return D-E>0&&Z(),b["!ref"]=pn(y),b}function l(g,p){return!(p&&p.PRN)||p.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?o(g,p):So(t(g,p),p)}function c(g,p){var m="",v=p.type=="string"?[0,0,0,0]:DD(g,p);switch(p.type){case"base64":m=Ka(g);break;case"binary":m=g;break;case"buffer":p.codepage==65001?m=g.toString("utf8"):p.codepage&&typeof Wu<"u"||(m=Ee&&Buffer.isBuffer(g)?g.toString("binary"):ec(g));break;case"array":m=xh(g);break;case"string":m=g;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?m=Rl(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=Rl(m):p.type=="binary"&&typeof Wu<"u",m.slice(0,19)=="socialcalc:version:"?Jy.to_sheet(p.type=="string"?m:Rl(m),p):l(m,p)}function h(g,p){return cs(c(g,p),p)}function f(g){for(var p=[],m=Xe(g["!ref"]),v,b=Array.isArray(g),y=m.s.r;y<=m.e.r;++y){for(var A=[],S=m.s.c;S<=m.e.c;++S){var w=Pe({r:y,c:S});if(v=b?(g[y]||[])[S]:g[w],!v||v.v==null){A.push("          ");continue}for(var E=(v.w||(Wa(v),v.w)||"").slice(0,10);E.length<10;)E+=" ";A.push(E+(S===0?" ":""))}p.push(A.join(""))}return p.join(`
`)}return{to_workbook:h,to_sheet:c,from_sheet:f}})(),u2=(function(){function i(C,X,U){if(C){Si(C,C.l||0);for(var j=U.Enum||Nt;C.l<C.length;){var ot=C.read_shift(2),bt=j[ot]||j[65535],Ot=C.read_shift(2),Tt=C.l+Ot,Mt=bt.f&&bt.f(C,Ot,U);if(C.l=Tt,X(Mt,bt,ot))return}}}function t(C,X){switch(X.type){case"base64":return e(Qi(Ka(C)),X);case"binary":return e(Qi(C),X);case"buffer":case"array":return e(C,X)}throw"Unsupported type "+X.type}function e(C,X){if(!C)return C;var U=X||{},j=U.dense?[]:{},ot="Sheet1",bt="",Ot=0,Tt={},Mt=[],Zt=[],te={s:{r:0,c:0},e:{r:0,c:0}},ve=U.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)U.Enum=Nt,i(C,function(z,K,at){switch(at){case 0:U.vers=z,z>=4096&&(U.qpro=!0);break;case 6:te=z;break;case 204:z&&(bt=z);break;case 222:bt=z;break;case 15:case 51:U.qpro||(z[1].v=z[1].v.slice(1));case 13:case 14:case 16:at==14&&(z[2]&112)==112&&(z[2]&15)>1&&(z[2]&15)<15&&(z[1].z=U.dateNF||nn[14],U.cellDates&&(z[1].t="d",z[1].v=py(z[1].v))),U.qpro&&z[3]>Ot&&(j["!ref"]=pn(te),Tt[ot]=j,Mt.push(ot),j=U.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},Ot=z[3],ot=bt||"Sheet"+(Ot+1),bt="");var kt=U.dense?(j[z[0].r]||[])[z[0].c]:j[Pe(z[0])];if(kt){kt.t=z[1].t,kt.v=z[1].v,z[1].z!=null&&(kt.z=z[1].z),z[1].f!=null&&(kt.f=z[1].f);break}U.dense?(j[z[0].r]||(j[z[0].r]=[]),j[z[0].r][z[0].c]=z[1]):j[Pe(z[0])]=z[1];break}},U);else if(C[2]==26||C[2]==14)U.Enum=M,C[2]==14&&(U.qpro=!0,C.l=0),i(C,function(z,K,at){switch(at){case 204:ot=z;break;case 22:z[1].v=z[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(z[3]>Ot&&(j["!ref"]=pn(te),Tt[ot]=j,Mt.push(ot),j=U.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},Ot=z[3],ot="Sheet"+(Ot+1)),ve>0&&z[0].r>=ve)break;U.dense?(j[z[0].r]||(j[z[0].r]=[]),j[z[0].r][z[0].c]=z[1]):j[Pe(z[0])]=z[1],te.e.c<z[0].c&&(te.e.c=z[0].c),te.e.r<z[0].r&&(te.e.r=z[0].r);break;case 27:z[14e3]&&(Zt[z[14e3][0]]=z[14e3][1]);break;case 1537:Zt[z[0]]=z[1],z[0]==Ot&&(ot=z[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(j["!ref"]=pn(te),Tt[bt||ot]=j,Mt.push(bt||ot),!Zt.length)return{SheetNames:Mt,Sheets:Tt};for(var k={},St=[],lt=0;lt<Zt.length;++lt)Tt[Mt[lt]]?(St.push(Zt[lt]||Mt[lt]),k[Zt[lt]]=Tt[Zt[lt]]||Tt[Mt[lt]]):(St.push(Zt[lt]),k[Zt[lt]]={"!ref":"A1"});return{SheetNames:St,Sheets:k}}function n(C,X){var U=X||{};if(+U.codepage>=0&&Hl(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var j=ci(),ot=Xe(C["!ref"]),bt=Array.isArray(C),Ot=[];jt(j,0,o(1030)),jt(j,6,h(ot));for(var Tt=Math.min(ot.e.r,8191),Mt=ot.s.r;Mt<=Tt;++Mt)for(var Zt=In(Mt),te=ot.s.c;te<=ot.e.c;++te){Mt===ot.s.r&&(Ot[te]=jn(te));var ve=Ot[te]+Zt,k=bt?(C[Mt]||[])[te]:C[ve];if(!(!k||k.t=="z"))if(k.t=="n")(k.v|0)==k.v&&k.v>=-32768&&k.v<=32767?jt(j,13,v(Mt,te,k.v)):jt(j,14,y(Mt,te,k.v));else{var St=Wa(k);jt(j,15,p(Mt,te,St.slice(0,239)))}}return jt(j,1),j.end()}function r(C,X){var U=X||{};if(+U.codepage>=0&&Hl(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var j=ci();jt(j,0,l(C));for(var ot=0,bt=0;ot<C.SheetNames.length;++ot)(C.Sheets[C.SheetNames[ot]]||{})["!ref"]&&jt(j,27,vt(C.SheetNames[ot],bt++));var Ot=0;for(ot=0;ot<C.SheetNames.length;++ot){var Tt=C.Sheets[C.SheetNames[ot]];if(!(!Tt||!Tt["!ref"])){for(var Mt=Xe(Tt["!ref"]),Zt=Array.isArray(Tt),te=[],ve=Math.min(Mt.e.r,8191),k=Mt.s.r;k<=ve;++k)for(var St=In(k),lt=Mt.s.c;lt<=Mt.e.c;++lt){k===Mt.s.r&&(te[lt]=jn(lt));var z=te[lt]+St,K=Zt?(Tt[k]||[])[lt]:Tt[z];if(!(!K||K.t=="z"))if(K.t=="n")jt(j,23,Z(k,lt,Ot,K.v));else{var at=Wa(K);jt(j,22,R(k,lt,Ot,at.slice(0,239)))}}++Ot}}return jt(j,1),j.end()}function o(C){var X=At(2);return X.write_shift(2,C),X}function l(C){var X=At(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var U=0,j=0,ot=0,bt=0;bt<C.SheetNames.length;++bt){var Ot=C.SheetNames[bt],Tt=C.Sheets[Ot];if(!(!Tt||!Tt["!ref"])){++ot;var Mt=Ti(Tt["!ref"]);U<Mt.e.r&&(U=Mt.e.r),j<Mt.e.c&&(j=Mt.e.c)}}return U>8191&&(U=8191),X.write_shift(2,U),X.write_shift(1,ot),X.write_shift(1,j),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function c(C,X,U){var j={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&U.qpro?(j.s.c=C.read_shift(1),C.l++,j.s.r=C.read_shift(2),j.e.c=C.read_shift(1),C.l++,j.e.r=C.read_shift(2),j):(j.s.c=C.read_shift(2),j.s.r=C.read_shift(2),X==12&&U.qpro&&(C.l+=2),j.e.c=C.read_shift(2),j.e.r=C.read_shift(2),X==12&&U.qpro&&(C.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function h(C){var X=At(8);return X.write_shift(2,C.s.c),X.write_shift(2,C.s.r),X.write_shift(2,C.e.c),X.write_shift(2,C.e.r),X}function f(C,X,U){var j=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(j[0].c=C.read_shift(1),j[3]=C.read_shift(1),j[0].r=C.read_shift(2),C.l+=2):(j[2]=C.read_shift(1),j[0].c=C.read_shift(2),j[0].r=C.read_shift(2)),j}function g(C,X,U){var j=C.l+X,ot=f(C,X,U);if(ot[1].t="s",U.vers==20768){C.l++;var bt=C.read_shift(1);return ot[1].v=C.read_shift(bt,"utf8"),ot}return U.qpro&&C.l++,ot[1].v=C.read_shift(j-C.l,"cstr"),ot}function p(C,X,U){var j=At(7+U.length);j.write_shift(1,255),j.write_shift(2,X),j.write_shift(2,C),j.write_shift(1,39);for(var ot=0;ot<j.length;++ot){var bt=U.charCodeAt(ot);j.write_shift(1,bt>=128?95:bt)}return j.write_shift(1,0),j}function m(C,X,U){var j=f(C,X,U);return j[1].v=C.read_shift(2,"i"),j}function v(C,X,U){var j=At(7);return j.write_shift(1,255),j.write_shift(2,X),j.write_shift(2,C),j.write_shift(2,U,"i"),j}function b(C,X,U){var j=f(C,X,U);return j[1].v=C.read_shift(8,"f"),j}function y(C,X,U){var j=At(13);return j.write_shift(1,255),j.write_shift(2,X),j.write_shift(2,C),j.write_shift(8,U,"f"),j}function A(C,X,U){var j=C.l+X,ot=f(C,X,U);if(ot[1].v=C.read_shift(8,"f"),U.qpro)C.l=j;else{var bt=C.read_shift(2);D(C.slice(C.l,C.l+bt),ot),C.l+=bt}return ot}function S(C,X,U){var j=X&32768;return X&=-32769,X=(j?C:0)+(X>=8192?X-16384:X),(j?"":"$")+(U?jn(X):In(X))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(C,X){Si(C,0);for(var U=[],j=0,ot="",bt="",Ot="",Tt="";C.l<C.length;){var Mt=C[C.l++];switch(Mt){case 0:U.push(C.read_shift(8,"f"));break;case 1:bt=S(X[0].c,C.read_shift(2),!0),ot=S(X[0].r,C.read_shift(2),!1),U.push(bt+ot);break;case 2:{var Zt=S(X[0].c,C.read_shift(2),!0),te=S(X[0].r,C.read_shift(2),!1);bt=S(X[0].c,C.read_shift(2),!0),ot=S(X[0].r,C.read_shift(2),!1),U.push(Zt+te+":"+bt+ot)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(C.read_shift(2));break;case 6:{for(var ve="";Mt=C[C.l++];)ve+=String.fromCharCode(Mt);U.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:Tt=U.pop(),Ot=U.pop(),U.push(["AND","OR"][Mt-20]+"("+Ot+","+Tt+")");break;default:if(Mt<32&&E[Mt])Tt=U.pop(),Ot=U.pop(),U.push(Ot+E[Mt]+Tt);else if(w[Mt]){if(j=w[Mt][1],j==69&&(j=C[C.l++]),j>U.length){console.error("WK1 bad formula parse 0x"+Mt.toString(16)+":|"+U.join("|")+"|");return}var k=U.slice(-j);U.length-=j,U.push(w[Mt][0]+"("+k.join(",")+")")}else return Mt<=7?console.error("WK1 invalid opcode "+Mt.toString(16)):Mt<=24?console.error("WK1 unsupported op "+Mt.toString(16)):Mt<=30?console.error("WK1 invalid opcode "+Mt.toString(16)):Mt<=115?console.error("WK1 unsupported function opcode "+Mt.toString(16)):console.error("WK1 unrecognized opcode "+Mt.toString(16))}}U.length==1?X[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function P(C){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=C.read_shift(2),X[3]=C[C.l++],X[0].c=C[C.l++],X}function L(C,X){var U=P(C);return U[1].t="s",U[1].v=C.read_shift(X-4,"cstr"),U}function R(C,X,U,j){var ot=At(6+j.length);ot.write_shift(2,C),ot.write_shift(1,U),ot.write_shift(1,X),ot.write_shift(1,39);for(var bt=0;bt<j.length;++bt){var Ot=j.charCodeAt(bt);ot.write_shift(1,Ot>=128?95:Ot)}return ot.write_shift(1,0),ot}function V(C,X){var U=P(C);U[1].v=C.read_shift(2);var j=U[1].v>>1;if(U[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return U[1].v=j,U}function F(C,X){var U=P(C),j=C.read_shift(4),ot=C.read_shift(4),bt=C.read_shift(2);if(bt==65535)return j===0&&ot===3221225472?(U[1].t="e",U[1].v=15):j===0&&ot===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var Ot=bt&32768;return bt=(bt&32767)-16446,U[1].v=(1-Ot*2)*(ot*Math.pow(2,bt+32)+j*Math.pow(2,bt)),U}function Z(C,X,U,j){var ot=At(14);if(ot.write_shift(2,C),ot.write_shift(1,U),ot.write_shift(1,X),j==0)return ot.write_shift(4,0),ot.write_shift(4,0),ot.write_shift(2,65535),ot;var bt=0,Ot=0,Tt=0,Mt=0;return j<0&&(bt=1,j=-j),Ot=Math.log2(j)|0,j/=Math.pow(2,Ot-31),Mt=j>>>0,(Mt&2147483648)==0&&(j/=2,++Ot,Mt=j>>>0),j-=Mt,Mt|=2147483648,Mt>>>=0,j*=Math.pow(2,32),Tt=j>>>0,ot.write_shift(4,Tt),ot.write_shift(4,Mt),Ot+=16383+(bt?32768:0),ot.write_shift(2,Ot),ot}function tt(C,X){var U=F(C);return C.l+=X-14,U}function I(C,X){var U=P(C),j=C.read_shift(4);return U[1].v=j>>6,U}function nt(C,X){var U=P(C),j=C.read_shift(8,"f");return U[1].v=j,U}function O(C,X){var U=nt(C);return C.l+=X-10,U}function rt(C,X){return C[C.l+X-1]==0?C.read_shift(X,"cstr"):""}function Q(C,X){var U=C[C.l++];U>X-1&&(U=X-1);for(var j="";j.length<U;)j+=String.fromCharCode(C[C.l++]);return j}function J(C,X,U){if(!(!U.qpro||X<21)){var j=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var ot=C.read_shift(X-21,"cstr");return[j,ot]}}function _t(C,X){for(var U={},j=C.l+X;C.l<j;){var ot=C.read_shift(2);if(ot==14e3){for(U[ot]=[0,""],U[ot][0]=C.read_shift(2);C[C.l];)U[ot][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return U}function vt(C,X){var U=At(5+C.length);U.write_shift(2,14e3),U.write_shift(2,X);for(var j=0;j<C.length;++j){var ot=C.charCodeAt(j);U[U.l++]=ot>127?95:ot}return U[U.l++]=0,U}var Nt={0:{n:"BOF",f:Wy},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:rt},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},M={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:tt},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:_t},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:nt},40:{n:"FORMULA28",f:O},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:rt},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:r,to_workbook:t}})(),yT=/^\s|\s$|[\t\n\r]/;function Qy(i,t){if(!t.bookSST)return"";var e=[mn];e[e.length]=Ht("sst",null,{xmlns:Ao[0],count:i.Count,uniqueCount:i.Unique});for(var n=0;n!=i.length;++n)if(i[n]!=null){var r=i[n],o="<si>";r.r?o+=r.r:(o+="<t",r.t||(r.t=""),r.t.match(yT)&&(o+=' xml:space="preserve"'),o+=">"+Re(r.t)+"</t>"),o+="</si>",e[e.length]=o}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function xT(i){return[i.read_shift(4),i.read_shift(4)]}function _T(i,t){return t||(t=At(8)),t.write_shift(4,i.Count),t.write_shift(4,i.Unique),t}var bT=hE;function AT(i){var t=ci();Pt(t,159,_T(i));for(var e=0;e<i.length;++e)Pt(t,19,bT(i[e]));return Pt(t,160),t.end()}function ST(i){for(var t=[],e=i.split(""),n=0;n<e.length;++n)t[n]=e[n].charCodeAt(0);return t}function tx(i){var t=0,e,n=ST(i),r=n.length+1,o,l,c,h,f;for(e=as(r),e[0]=n.length,o=1;o!=r;++o)e[o]=n[o-1];for(o=r-1;o>=0;--o)l=e[o],c=(t&16384)===0?0:1,h=t<<1&32767,f=c|h,t=f^l;return t^52811}var wT=(function(){function i(r,o){switch(o.type){case"base64":return t(Ka(r),o);case"binary":return t(r,o);case"buffer":return t(Ee&&Buffer.isBuffer(r)?r.toString("binary"):ec(r),o);case"array":return t(xh(r),o)}throw new Error("Unrecognized type "+o.type)}function t(r,o){var l=o||{},c=l.dense?[]:{},h=r.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,p){Array.isArray(c)&&(c[p]=[]);for(var m=/\\\w+\b/g,v=0,b,y=-1;b=m.exec(g);){switch(b[0]){case"\\cell":var A=g.slice(v,m.lastIndex-b[0].length);if(A[0]==" "&&(A=A.slice(1)),++y,A.length){var S={v:A,t:"s"};Array.isArray(c)?c[p][y]=S:c[Pe({r:p,c:y})]=S}break}v=m.lastIndex}y>f.e.c&&(f.e.c=y)}),c["!ref"]=pn(f),c}function e(r,o){return cs(i(r,o),o)}function n(r){for(var o=["{\\rtf1\\ansi"],l=Xe(r["!ref"]),c,h=Array.isArray(r),f=l.s.r;f<=l.e.r;++f){o.push("\\trowd\\trautofit1");for(var g=l.s.c;g<=l.e.c;++g)o.push("\\cellx"+(g+1));for(o.push("\\pard\\intbl"),g=l.s.c;g<=l.e.c;++g){var p=Pe({r:f,c:g});c=h?(r[f]||[])[g]:r[p],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(Wa(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:e,to_sheet:i,from_sheet:n}})();function h2(i){for(var t=0,e=1;t!=3;++t)e=e*256+(i[t]>255?255:i[t]<0?0:i[t]);return e.toString(16).toUpperCase().slice(1)}var ET=6,Xa=ET;function nh(i){return Math.floor((i+Math.round(128/Xa)/256)*Xa)}function ih(i){return Math.floor((i-5)/Xa*100+.5)/100}function b0(i){return Math.round((i*Xa+5)/Xa*256)/256}function Q0(i){i.width?(i.wpx=nh(i.width),i.wch=ih(i.wpx),i.MDW=Xa):i.wpx?(i.wch=ih(i.wpx),i.width=b0(i.wch),i.MDW=Xa):typeof i.wch=="number"&&(i.width=b0(i.wch),i.wpx=nh(i.width),i.MDW=Xa),i.customWidth&&delete i.customWidth}var TT=96,ex=TT;function ah(i){return i*96/ex}function nx(i){return i*ex/96}function CT(i){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var n=e[0];n<=e[1];++n)i[n]!=null&&(t[t.length]=Ht("numFmt",null,{numFmtId:n,formatCode:Re(i[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ht("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function kT(i){var t=[];return t[t.length]=Ht("cellXfs",null),i.forEach(function(e){t[t.length]=Ht("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ht("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function ix(i,t){var e=[mn,Ht("styleSheet",null,{xmlns:Ao[0],"xmlns:vt":wn.vt})],n;return i.SSF&&(n=CT(i.SSF))!=null&&(e[e.length]=n),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=kT(t.cellXfs))&&(e[e.length]=n),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function DT(i,t){var e=i.read_shift(2),n=Gn(i);return[e,n]}function OT(i,t,e){e||(e=At(6+4*t.length)),e.write_shift(2,i),Tn(t,e);var n=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),n}function RT(i,t,e){var n={};n.sz=i.read_shift(2)/20;var r=yE(i);r.fItalic&&(n.italic=1),r.fCondense&&(n.condense=1),r.fExtend&&(n.extend=1),r.fShadow&&(n.shadow=1),r.fOutline&&(n.outline=1),r.fStrikeout&&(n.strike=1);var o=i.read_shift(2);switch(o===700&&(n.bold=1),i.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=i.read_shift(1);l!=0&&(n.underline=l);var c=i.read_shift(1);c>0&&(n.family=c);var h=i.read_shift(1);switch(h>0&&(n.charset=h),i.l++,n.color=vE(i),i.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Gn(i),n}function PT(i,t){t||(t=At(153)),t.write_shift(2,i.sz*20),xE(i,t),t.write_shift(2,i.bold?700:400);var e=0;i.vertAlign=="superscript"?e=1:i.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,i.underline||0),t.write_shift(1,i.family||0),t.write_shift(1,i.charset||0),t.write_shift(1,0),th(i.color,t);var n=0;return n=2,t.write_shift(1,n),Tn(i.name,t),t.length>t.l?t.slice(0,t.l):t}var MT=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],t0,NT=ya;function f2(i,t){t||(t=At(84)),t0||(t0=H0(MT));var e=t0[i.patternType];e==null&&(e=40),t.write_shift(4,e);var n=0;if(e!=40)for(th({auto:1},t),th({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function FT(i,t){var e=i.l+t,n=i.read_shift(2),r=i.read_shift(2);return i.l=e,{ixfe:n,numFmtId:r}}function ax(i,t,e){e||(e=At(16)),e.write_shift(2,t||0),e.write_shift(2,i.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var n=0;return e.write_shift(1,n),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function wl(i,t){return t||(t=At(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var LT=ya;function BT(i,t){return t||(t=At(51)),t.write_shift(1,0),wl(null,t),wl(null,t),wl(null,t),wl(null,t),wl(null,t),t.length>t.l?t.slice(0,t.l):t}function IT(i,t){return t||(t=At(52)),t.write_shift(4,i.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Qu(i.name||"",t),t.length>t.l?t.slice(0,t.l):t}function UT(i,t,e){var n=At(2052);return n.write_shift(4,i),Qu(t,n),Qu(e,n),n.length>n.l?n.slice(0,n.l):n}function zT(i,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&++e}),e!=0&&(Pt(i,615,ea(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&Pt(i,44,OT(r,t[r]))}),Pt(i,616))}}function HT(i){var t=1;Pt(i,611,ea(t)),Pt(i,43,PT({sz:12,color:{theme:1},name:"Calibri",family:2})),Pt(i,612)}function jT(i){var t=2;Pt(i,603,ea(t)),Pt(i,45,f2({patternType:"none"})),Pt(i,45,f2({patternType:"gray125"})),Pt(i,604)}function GT(i){var t=1;Pt(i,613,ea(t)),Pt(i,46,BT()),Pt(i,614)}function VT(i){var t=1;Pt(i,626,ea(t)),Pt(i,47,ax({numFmtId:0},65535)),Pt(i,627)}function XT(i,t){Pt(i,617,ea(t.length)),t.forEach(function(e){Pt(i,47,ax(e,0))}),Pt(i,618)}function KT(i){var t=1;Pt(i,619,ea(t)),Pt(i,48,IT({xfId:0,name:"Normal"})),Pt(i,620)}function WT(i){var t=0;Pt(i,505,ea(t)),Pt(i,506)}function YT(i){var t=0;Pt(i,508,UT(t,"TableStyleMedium9","PivotStyleMedium4")),Pt(i,509)}function qT(i,t){var e=ci();return Pt(e,278),zT(e,i.SSF),HT(e),jT(e),GT(e),VT(e),XT(e,t.cellXfs),KT(e),WT(e),YT(e),Pt(e,279),e.end()}function rx(i,t){if(t&&t.themeXLSX)return t.themeXLSX;if(i&&typeof i.raw=="string")return i.raw;var e=[mn];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function $T(i,t){return{flags:i.read_shift(4),version:i.read_shift(4),name:Gn(i)}}function ZT(i){var t=At(12+2*i.name.length);return t.write_shift(4,i.flags),t.write_shift(4,i.version),Tn(i.name,t),t.slice(0,t.l)}function JT(i){for(var t=[],e=i.read_shift(4);e-- >0;)t.push([i.read_shift(4),i.read_shift(4)]);return t}function QT(i){var t=At(4+8*i.length);t.write_shift(4,i.length);for(var e=0;e<i.length;++e)t.write_shift(4,i[e][0]),t.write_shift(4,i[e][1]);return t}function tC(i,t){var e=At(8+2*t.length);return e.write_shift(4,i),Tn(t,e),e.slice(0,e.l)}function eC(i){return i.l+=4,i.read_shift(4)!=0}function nC(i,t){var e=At(8);return e.write_shift(4,i),e.write_shift(4,1),e}function iC(){var i=ci();return Pt(i,332),Pt(i,334,ea(1)),Pt(i,335,ZT({name:"XLDAPR",version:12e4,flags:3496657072})),Pt(i,336),Pt(i,339,tC(1,"XLDAPR")),Pt(i,52),Pt(i,35,ea(514)),Pt(i,4096,ea(0)),Pt(i,4097,Gi(1)),Pt(i,36),Pt(i,53),Pt(i,340),Pt(i,337,nC(1)),Pt(i,51,QT([[1,0]])),Pt(i,338),Pt(i,333),i.end()}function sx(){var i=[mn];return i.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),i.join("")}function aC(i){var t={};t.i=i.read_shift(4);var e={};e.r=i.read_shift(4),e.c=i.read_shift(4),t.r=Pe(e);var n=i.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var co=1024;function ox(i,t){for(var e=[21600,21600],n=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),r=[Ht("xml",null,{"xmlns:v":wi.v,"xmlns:o":wi.o,"xmlns:x":wi.x,"xmlns:mv":wi.mv}).replace(/\/>/,">"),Ht("o:shapelayout",Ht("o:idmap",null,{"v:ext":"edit",data:i}),{"v:ext":"edit"}),Ht("v:shapetype",[Ht("v:stroke",null,{joinstyle:"miter"}),Ht("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:n})];co<i*1e3;)co+=1e3;return t.forEach(function(o){var l=En(o[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var h=c.type=="gradient"?Ht("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Ht("v:fill",h,c),g={on:"t",obscured:"t"};++co,r=r.concat(["<v:shape"+Xl({id:"_x0000_s"+co,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Ht("v:shadow",null,g),Ht("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Bn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Bn("x:AutoFill","False"),Bn("x:Row",String(l.r)),Bn("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function lx(i){var t=[mn,Ht("comments",null,{xmlns:Ao[0]})],e=[];return t.push("<authors>"),i.forEach(function(n){n[1].forEach(function(r){var o=Re(r.a);e.indexOf(o)==-1&&(e.push(o),t.push("<author>"+o+"</author>")),r.T&&r.ID&&e.indexOf("tc="+r.ID)==-1&&(e.push("tc="+r.ID),t.push("<author>tc="+r.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),i.forEach(function(n){var r=0,o=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?r=e.indexOf("tc="+n[1][0].ID):n[1].forEach(function(h){h.a&&(r=e.indexOf(Re(h.a))),o.push(h.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+r+'"><text>'),o.length<=1)t.push(Bn("t",Re(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,c=1;c<o.length;++c)l+=`Reply:
    `+o[c]+`
`;t.push(Bn("t",Re(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function rC(i,t,e){var n=[mn,Ht("ThreadedComments",null,{xmlns:wn.TCMNT}).replace(/[\/]>/,">")];return i.forEach(function(r){var o="";(r[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var h={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};c==0?o=h.id:h.parentId=o,l.ID=h.id,l.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(Ht("threadedComment",Bn("text",l.t||""),h))})}),n.push("</ThreadedComments>"),n.join("")}function sC(i){var t=[mn,Ht("personList",null,{xmlns:wn.TCMNT,"xmlns:x":Ao[0]}).replace(/[\/]>/,">")];return i.forEach(function(e,n){t.push(Ht("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function oC(i){var t={};t.iauthor=i.read_shift(4);var e=ds(i);return t.rfx=e.s,t.ref=Pe(e.s),i.l+=16,t}function lC(i,t){return t==null&&(t=At(36)),t.write_shift(4,i[1].iauthor),wo(i[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var cC=Gn;function uC(i){return Tn(i.slice(0,54))}function hC(i){var t=ci(),e=[];return Pt(t,628),Pt(t,630),i.forEach(function(n){n[1].forEach(function(r){e.indexOf(r.a)>-1||(e.push(r.a.slice(0,54)),Pt(t,632,uC(r.a)))})}),Pt(t,631),Pt(t,633),i.forEach(function(n){n[1].forEach(function(r){r.iauthor=e.indexOf(r.a);var o={s:En(n[0]),e:En(n[0])};Pt(t,635,lC([o,r])),r.t&&r.t.length>0&&Pt(t,637,dE(r)),Pt(t,636),delete r.iauthor})}),Pt(t,634),Pt(t,629),t.end()}function fC(i,t){t.FullPaths.forEach(function(e,n){if(n!=0){var r=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&Be.utils.cfb_add(i,r,t.FileIndex[n].content)}})}var cx=["xlsb","xlsm","xlam","biff8","xla"],dC=(function(){var i=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(n,r,o,l){var c=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var f=o.length>0?parseInt(o,10)|0:0,g=l.length>0?parseInt(l,10)|0:0;return c?g+=t.c:--g,h?f+=t.r:--f,r+(c?"":"$")+jn(g)+(h?"":"$")+In(f)}return function(r,o){return t=o,r.replace(i,e)}})(),tg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,eg=(function(){return function(t,e){return t.replace(tg,function(n,r,o,l,c,h){var f=Y0(l)-(o?0:e.c),g=W0(h)-(c?0:e.r),p=g==0?"":c?g+1:"["+g+"]",m=f==0?"":o?f+1:"["+f+"]";return r+"R"+p+"C"+m})}})();function gC(i,t){return i.replace(tg,function(e,n,r,o,l,c){return n+(r=="$"?r+o:jn(Y0(o)+t.c))+(l=="$"?l+c:In(W0(c)+t.r))})}function pC(i){return i.length!=1}function dn(i){i.l+=1}function Cr(i,t){var e=i.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function ux(i,t,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return hx(i);e.biff==12&&(n=4)}var r=i.read_shift(n),o=i.read_shift(n),l=Cr(i),c=Cr(i);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function hx(i){var t=Cr(i),e=Cr(i),n=i.read_shift(1),r=i.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:e[0],c:r,cRel:e[1],rRel:e[2]}}}function mC(i,t,e){if(e.biff<8)return hx(i);var n=i.read_shift(e.biff==12?4:2),r=i.read_shift(e.biff==12?4:2),o=Cr(i),l=Cr(i);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r,c:l[0],cRel:l[1],rRel:l[2]}}}function fx(i,t,e){if(e&&e.biff>=2&&e.biff<=5)return vC(i);var n=i.read_shift(e&&e.biff==12?4:2),r=Cr(i);return{r:n,c:r[0],cRel:r[1],rRel:r[2]}}function vC(i){var t=Cr(i),e=i.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function yC(i){var t=i.read_shift(2),e=i.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function xC(i,t,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return _C(i);var r=i.read_shift(n>=12?4:2),o=i.read_shift(2),l=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;r>524287;)r-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r,c:o,cRel:l,rRel:c}}function _C(i){var t=i.read_shift(2),e=i.read_shift(1),n=(t&32768)>>15,r=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),r==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:r,rRel:n}}function bC(i,t,e){var n=(i[i.l++]&96)>>5,r=ux(i,e.biff>=2&&e.biff<=5?6:8,e);return[n,r]}function AC(i,t,e){var n=(i[i.l++]&96)>>5,r=i.read_shift(2,"i"),o=8;if(e)switch(e.biff){case 5:i.l+=12,o=6;break;case 12:o=12;break}var l=ux(i,o,e);return[n,r,l]}function SC(i,t,e){var n=(i[i.l++]&96)>>5;return i.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function wC(i,t,e){var n=(i[i.l++]&96)>>5,r=i.read_shift(2),o=8;if(e)switch(e.biff){case 5:i.l+=12,o=6;break;case 12:o=12;break}return i.l+=o,[n,r]}function EC(i,t,e){var n=(i[i.l++]&96)>>5,r=mC(i,t-1,e);return[n,r]}function TC(i,t,e){var n=(i[i.l++]&96)>>5;return i.l+=e.biff==2?6:e.biff==12?14:7,[n]}function d2(i){var t=i[i.l+1]&1,e=1;return i.l+=4,[t,e]}function CC(i,t,e){i.l+=2;for(var n=i.read_shift(e&&e.biff==2?1:2),r=[],o=0;o<=n;++o)r.push(i.read_shift(e&&e.biff==2?1:2));return r}function kC(i,t,e){var n=i[i.l+1]&255?1:0;return i.l+=2,[n,i.read_shift(e&&e.biff==2?1:2)]}function DC(i,t,e){var n=i[i.l+1]&255?1:0;return i.l+=2,[n,i.read_shift(e&&e.biff==2?1:2)]}function OC(i){var t=i[i.l+1]&255?1:0;return i.l+=2,[t,i.read_shift(2)]}function RC(i,t,e){var n=i[i.l+1]&255?1:0;return i.l+=e&&e.biff==2?3:4,[n]}function dx(i){var t=i.read_shift(1),e=i.read_shift(1);return[t,e]}function PC(i){return i.read_shift(2),dx(i)}function MC(i){return i.read_shift(2),dx(i)}function NC(i,t,e){var n=(i[i.l]&96)>>5;i.l+=1;var r=fx(i,0,e);return[n,r]}function FC(i,t,e){var n=(i[i.l]&96)>>5;i.l+=1;var r=xC(i,0,e);return[n,r]}function LC(i,t,e){var n=(i[i.l]&96)>>5;i.l+=1;var r=i.read_shift(2);e&&e.biff==5&&(i.l+=12);var o=fx(i,0,e);return[n,r,o]}function BC(i,t,e){var n=(i[i.l]&96)>>5;i.l+=1;var r=i.read_shift(e&&e.biff<=3?1:2);return[B4[r],mx[r],n]}function IC(i,t,e){var n=i[i.l++],r=i.read_shift(1),o=e&&e.biff<=3?[n==88?-1:0,i.read_shift(1)]:UC(i);return[r,(o[0]===0?mx:L4)[o[1]]]}function UC(i){return[i[i.l+1]>>7,i.read_shift(2)&32767]}function zC(i,t,e){i.l+=e&&e.biff==2?3:4}function HC(i,t,e){if(i.l++,e&&e.biff==12)return[i.read_shift(4,"i"),0];var n=i.read_shift(2),r=i.read_shift(e&&e.biff==2?1:2);return[n,r]}function jC(i){return i.l++,ac[i.read_shift(1)]}function GC(i){return i.l++,i.read_shift(2)}function VC(i){return i.l++,i.read_shift(1)!==0}function XC(i){return i.l++,Eo(i)}function KC(i,t,e){return i.l++,qy(i,t-1,e)}function WC(i,t){var e=[i.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=LE(i,1)?"TRUE":"FALSE",t!=12&&(i.l+=7);break;case 37:case 16:e[1]=ac[i[i.l]],i.l+=t==12?4:8;break;case 0:i.l+=8;break;case 1:e[1]=Eo(i);break;case 2:e[1]=zE(i,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function YC(i,t,e){for(var n=i.read_shift(e.biff==12?4:2),r=[],o=0;o!=n;++o)r.push((e.biff==12?ds:GE)(i));return r}function qC(i,t,e){var n=0,r=0;e.biff==12?(n=i.read_shift(4),r=i.read_shift(4)):(r=1+i.read_shift(1),n=1+i.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--r==0&&(r=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var c=0;c!=r;++c)l[o][c]=WC(i,e.biff);return l}function $C(i,t,e){var n=i.read_shift(1)>>>5&3,r=!e||e.biff>=8?4:2,o=i.read_shift(r);switch(e.biff){case 2:i.l+=5;break;case 3:case 4:i.l+=8;break;case 5:i.l+=12;break}return[n,0,o]}function ZC(i,t,e){if(e.biff==5)return JC(i);var n=i.read_shift(1)>>>5&3,r=i.read_shift(2),o=i.read_shift(4);return[n,r,o]}function JC(i){var t=i.read_shift(1)>>>5&3,e=i.read_shift(2,"i");i.l+=8;var n=i.read_shift(2);return i.l+=12,[t,e,n]}function QC(i,t,e){var n=i.read_shift(1)>>>5&3;i.l+=e&&e.biff==2?3:4;var r=i.read_shift(e&&e.biff==2?1:2);return[n,r]}function t4(i,t,e){var n=i.read_shift(1)>>>5&3,r=i.read_shift(e&&e.biff==2?1:2);return[n,r]}function e4(i,t,e){var n=i.read_shift(1)>>>5&3;return i.l+=4,e.biff<8&&i.l--,e.biff==12&&(i.l+=2),[n]}function n4(i,t,e){var n=(i[i.l++]&96)>>5,r=i.read_shift(2),o=4;if(e)switch(e.biff){case 5:o=15;break;case 12:o=6;break}return i.l+=o,[n,r]}var i4=ya,a4=ya,r4=ya;function rc(i,t,e){return i.l+=2,[yC(i)]}function ng(i){return i.l+=6,[]}var s4=rc,o4=ng,l4=ng,c4=rc;function gx(i){return i.l+=2,[Wy(i),i.read_shift(2)&1]}var u4=rc,h4=gx,f4=ng,d4=rc,g4=rc,p4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function m4(i){i.l+=2;var t=i.read_shift(2),e=i.read_shift(2),n=i.read_shift(4),r=i.read_shift(2),o=i.read_shift(2),l=p4[e>>2&31];return{ixti:t,coltype:e&3,rt:l,idx:n,c:r,C:o}}function v4(i){return i.l+=2,[i.read_shift(4)]}function y4(i,t,e){return i.l+=5,i.l+=2,i.l+=e.biff==2?1:4,["PTGSHEET"]}function x4(i,t,e){return i.l+=e.biff==2?4:5,["PTGENDSHEET"]}function _4(i){var t=i.read_shift(1)>>>5&3,e=i.read_shift(2);return[t,e]}function b4(i){var t=i.read_shift(1)>>>5&3,e=i.read_shift(2);return[t,e]}function A4(i){return i.l+=4,[0,0]}var g2={1:{n:"PtgExp",f:HC},2:{n:"PtgTbl",f:r4},3:{n:"PtgAdd",f:dn},4:{n:"PtgSub",f:dn},5:{n:"PtgMul",f:dn},6:{n:"PtgDiv",f:dn},7:{n:"PtgPower",f:dn},8:{n:"PtgConcat",f:dn},9:{n:"PtgLt",f:dn},10:{n:"PtgLe",f:dn},11:{n:"PtgEq",f:dn},12:{n:"PtgGe",f:dn},13:{n:"PtgGt",f:dn},14:{n:"PtgNe",f:dn},15:{n:"PtgIsect",f:dn},16:{n:"PtgUnion",f:dn},17:{n:"PtgRange",f:dn},18:{n:"PtgUplus",f:dn},19:{n:"PtgUminus",f:dn},20:{n:"PtgPercent",f:dn},21:{n:"PtgParen",f:dn},22:{n:"PtgMissArg",f:dn},23:{n:"PtgStr",f:KC},26:{n:"PtgSheet",f:y4},27:{n:"PtgEndSheet",f:x4},28:{n:"PtgErr",f:jC},29:{n:"PtgBool",f:VC},30:{n:"PtgInt",f:GC},31:{n:"PtgNum",f:XC},32:{n:"PtgArray",f:TC},33:{n:"PtgFunc",f:BC},34:{n:"PtgFuncVar",f:IC},35:{n:"PtgName",f:$C},36:{n:"PtgRef",f:NC},37:{n:"PtgArea",f:bC},38:{n:"PtgMemArea",f:QC},39:{n:"PtgMemErr",f:i4},40:{n:"PtgMemNoMem",f:a4},41:{n:"PtgMemFunc",f:t4},42:{n:"PtgRefErr",f:e4},43:{n:"PtgAreaErr",f:SC},44:{n:"PtgRefN",f:FC},45:{n:"PtgAreaN",f:EC},46:{n:"PtgMemAreaN",f:_4},47:{n:"PtgMemNoMemN",f:b4},57:{n:"PtgNameX",f:ZC},58:{n:"PtgRef3d",f:LC},59:{n:"PtgArea3d",f:AC},60:{n:"PtgRefErr3d",f:n4},61:{n:"PtgAreaErr3d",f:wC},255:{}},S4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},w4={1:{n:"PtgElfLel",f:gx},2:{n:"PtgElfRw",f:d4},3:{n:"PtgElfCol",f:s4},6:{n:"PtgElfRwV",f:g4},7:{n:"PtgElfColV",f:c4},10:{n:"PtgElfRadical",f:u4},11:{n:"PtgElfRadicalS",f:f4},13:{n:"PtgElfColS",f:o4},15:{n:"PtgElfColSV",f:l4},16:{n:"PtgElfRadicalLel",f:h4},25:{n:"PtgList",f:m4},29:{n:"PtgSxName",f:v4},255:{}},E4={0:{n:"PtgAttrNoop",f:A4},1:{n:"PtgAttrSemi",f:RC},2:{n:"PtgAttrIf",f:DC},4:{n:"PtgAttrChoose",f:CC},8:{n:"PtgAttrGoto",f:kC},16:{n:"PtgAttrSum",f:zC},32:{n:"PtgAttrBaxcel",f:d2},33:{n:"PtgAttrBaxcel",f:d2},64:{n:"PtgAttrSpace",f:PC},65:{n:"PtgAttrSpaceSemi",f:MC},128:{n:"PtgAttrIfError",f:OC},255:{}};function T4(i,t,e,n){if(n.biff<8)return ya(i,t);for(var r=i.l+t,o=[],l=0;l!==e.length;++l)switch(e[l][0]){case"PtgArray":e[l][1]=qC(i,0,n),o.push(e[l][1]);break;case"PtgMemArea":e[l][2]=YC(i,e[l][1],n),o.push(e[l][2]);break;case"PtgExp":n&&n.biff==12&&(e[l][1][1]=i.read_shift(4),o.push(e[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[l][0]}return t=r-i.l,t!==0&&o.push(ya(i,t)),o}function C4(i,t,e){for(var n=i.l+t,r,o,l=[];n!=i.l;)t=n-i.l,o=i[i.l],r=g2[o]||g2[S4[o]],(o===24||o===25)&&(r=(o===24?w4:E4)[i[i.l+1]]),!r||!r.f?ya(i,t):l.push([r.n,r.f(i,t,e)]);return l}function k4(i){for(var t=[],e=0;e<i.length;++e){for(var n=i[e],r=[],o=0;o<n.length;++o){var l=n[o];l?l[0]===2?r.push('"'+l[1].replace(/"/g,'""')+'"'):r.push(l[1]):r.push("")}t.push(r.join(","))}return t.join(";")}var D4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function O4(i,t){if(!i&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(i)?"'"+i+"'":i}function px(i,t,e){if(!i)return"SH33TJSERR0";if(e.biff>8&&(!i.XTI||!i.XTI[t]))return i.SheetNames[t];if(!i.XTI)return"SH33TJSERR6";var n=i.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":i.XTI[t-1];if(!n)return"SH33TJSERR1";var r="";if(e.biff>8)switch(i[n[0]][0]){case 357:return r=n[1]==-1?"#REF":i.SheetNames[n[1]],n[1]==n[2]?r:r+":"+i.SheetNames[n[2]];case 358:return e.SID!=null?i.SheetNames[e.SID]:"SH33TJSSAME"+i[n[0]][0];default:return"SH33TJSSRC"+i[n[0]][0]}switch(i[n[0]][0][0]){case 1025:return r=n[1]==-1?"#REF":i.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?r:r+":"+i.SheetNames[n[2]];case 14849:return i[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return i[n[0]][0][3]?(r=n[1]==-1?"#REF":i[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?r:r+":"+i[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function p2(i,t,e){var n=px(i,t,e);return n=="#REF"?n:O4(n,e)}function bo(i,t,e,n,r){var o=r&&r.biff||8,l={s:{c:0,r:0}},c=[],h,f,g,p=0,m=0,v,b="";if(!i[0]||!i[0][0])return"";for(var y=-1,A="",S=0,w=i[0].length;S<w;++S){var E=i[0][S];switch(E[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=c.pop(),f=c.pop(),y>=0){switch(i[0][y][1][0]){case 0:A=en(" ",i[0][y][1][1]);break;case 1:A=en("\r",i[0][y][1][1]);break;default:if(A="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+i[0][y][1][0])}f=f+A,y=-1}c.push(f+D4[E[0]]+h);break;case"PtgIsect":h=c.pop(),f=c.pop(),c.push(f+" "+h);break;case"PtgUnion":h=c.pop(),f=c.pop(),c.push(f+","+h);break;case"PtgRange":h=c.pop(),f=c.pop(),c.push(f+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Ml(E[1][1],l,r),c.push(Nl(g,o));break;case"PtgRefN":g=e?Ml(E[1][1],e,r):E[1][1],c.push(Nl(g,o));break;case"PtgRef3d":p=E[1][1],g=Ml(E[1][2],l,r),b=p2(n,p,r),c.push(b+"!"+Nl(g,o));break;case"PtgFunc":case"PtgFuncVar":var D=E[1][0],P=E[1][1];D||(D=0),D&=127;var L=D==0?[]:c.slice(-D);c.length-=D,P==="User"&&(P=L.shift()),c.push(P+"("+L.join(",")+")");break;case"PtgBool":c.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(E[1]);break;case"PtgNum":c.push(String(E[1]));break;case"PtgStr":c.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(E[1]);break;case"PtgAreaN":v=Qv(E[1][1],e?{s:e}:l,r),c.push(Jd(v,r));break;case"PtgArea":v=Qv(E[1][1],l,r),c.push(Jd(v,r));break;case"PtgArea3d":p=E[1][1],v=E[1][2],b=p2(n,p,r),c.push(b+"!"+Jd(v,r));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=E[1][2];var R=(n.names||[])[m-1]||(n[0]||[])[m],V=R?R.Name:"SH33TJSNAME"+String(m);V&&V.slice(0,6)=="_xlfn."&&!r.xlfn&&(V=V.slice(6)),c.push(V);break;case"PtgNameX":var F=E[1][1];m=E[1][2];var Z;if(r.biff<=5)F<0&&(F=-F),n[F]&&(Z=n[F][m]);else{var tt="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][m]&&n[F][m].itab>0&&(tt=n.SheetNames[n[F][m].itab-1]+"!"):tt=n.SheetNames[m-1]+"!"),n[F]&&n[F][m])tt+=n[F][m].Name;else if(n[0]&&n[0][m])tt+=n[0][m].Name;else{var I=(px(n,F,r)||"").split(";;");I[m-1]?tt=I[m-1]:tt+="SH33TJSERRX"}c.push(tt);break}Z||(Z={Name:"SH33TJSERRY"}),c.push(Z.Name);break;case"PtgParen":var nt="(",O=")";if(y>=0){switch(A="",i[0][y][1][0]){case 2:nt=en(" ",i[0][y][1][1])+nt;break;case 3:nt=en("\r",i[0][y][1][1])+nt;break;case 4:O=en(" ",i[0][y][1][1])+O;break;case 5:O=en("\r",i[0][y][1][1])+O;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+i[0][y][1][0])}y=-1}c.push(nt+c.pop()+O);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":g={c:E[1][1],r:E[1][0]};var rt={c:e.c,r:e.r};if(n.sharedf[Pe(g)]){var Q=n.sharedf[Pe(g)];c.push(bo(Q,l,rt,n,r))}else{var J=!1;for(h=0;h!=n.arrayf.length;++h)if(f=n.arrayf[h],!(g.c<f[0].s.c||g.c>f[0].e.c)&&!(g.r<f[0].s.r||g.r>f[0].e.r)){c.push(bo(f[1],l,rt,n,r)),J=!0;break}J||c.push(E[1])}break;case"PtgArray":c.push("{"+k4(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var _t=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&y>=0&&_t.indexOf(i[0][S][0])==-1){E=i[0][y];var vt=!0;switch(E[1][0]){case 4:vt=!1;case 0:A=en(" ",E[1][1]);break;case 5:vt=!1;case 1:A=en("\r",E[1][1]);break;default:if(A="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}c.push((vt?A:"")+c.pop()+(vt?"":A)),y=-1}}if(c.length>1&&r.WTF)throw new Error("bad formula stack");return c[0]}function R4(i){if(i==null){var t=At(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof i=="number")return rs(i);return rs(0)}function P4(i,t,e,n,r){var o=ss(t,e,r),l=R4(i.v),c=At(6),h=33;c.write_shift(2,h),c.write_shift(4,0);for(var f=At(i.bf.length),g=0;g<i.bf.length;++g)f[g]=i.bf[g];var p=Ln([o,l,c,f]);return p}function _h(i,t,e){var n=i.read_shift(4),r=C4(i,n,e),o=i.read_shift(4),l=o>0?T4(i,o,r,e):null;return[r,l]}var M4=_h,bh=_h,N4=_h,F4=_h,L4={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},mx={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},B4={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function I4(i){var t="of:="+i.replace(tg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function U4(i){return i.replace(/\./,"!")}var Fl=typeof Map<"u";function ig(i,t,e){var n=0,r=i.length;if(e){if(Fl?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var o=Fl?e.get(t):e[t];n<o.length;++n)if(i[o[n]].t===t)return i.Count++,o[n]}}else for(;n<r;++n)if(i[n].t===t)return i.Count++,n;return i[r]={t},i.Count++,i.Unique++,e&&(Fl?(e.has(t)||e.set(t,[]),e.get(t).push(r)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(r))),r}function Ah(i,t){var e={min:i+1,max:i+1},n=-1;return t.MDW&&(Xa=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?n=ih(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(e.width=b0(n),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function vx(i,t){if(i){var e=[.7,.7,.75,.75,.3,.3];i.left==null&&(i.left=e[0]),i.right==null&&(i.right=e[1]),i.top==null&&(i.top=e[2]),i.bottom==null&&(i.bottom=e[3]),i.header==null&&(i.header=e[4]),i.footer==null&&(i.footer=e[5])}}function Dr(i,t,e){var n=e.revssf[t.z!=null?t.z:"General"],r=60,o=i.length;if(n==null&&e.ssf){for(;r<392;++r)if(e.ssf[r]==null){fy(t.z,r),e.ssf[r]=t.z,e.revssf[t.z]=n=r;break}}for(r=0;r!=o;++r)if(i[r].numFmtId===n)return r;return i[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function z4(i,t,e){if(i&&i["!ref"]){var n=Xe(i["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+e+"): "+i["!ref"])}}function H4(i){if(i.length===0)return"";for(var t='<mergeCells count="'+i.length+'">',e=0;e!=i.length;++e)t+='<mergeCell ref="'+pn(i[e])+'"/>';return t+"</mergeCells>"}function j4(i,t,e,n,r){var o=!1,l={},c=null;if(n.bookType!=="xlsx"&&t.vbaraw){var h=t.SheetNames[e];try{t.Workbook&&(h=t.Workbook.Sheets[e].CodeName||h)}catch{}o=!0,l.codeName=Vl(Re(h))}if(i&&i["!outline"]){var f={summaryBelow:1,summaryRight:1};i["!outline"].above&&(f.summaryBelow=0),i["!outline"].left&&(f.summaryRight=0),c=(c||"")+Ht("outlinePr",null,f)}!o&&!c||(r[r.length]=Ht("sheetPr",c,l))}var G4=["objects","scenarios","selectLockedCells","selectUnlockedCells"],V4=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function X4(i){var t={sheet:1};return G4.forEach(function(e){i[e]!=null&&i[e]&&(t[e]="1")}),V4.forEach(function(e){i[e]!=null&&!i[e]&&(t[e]="0")}),i.password&&(t.password=tx(i.password).toString(16).toUpperCase()),Ht("sheetProtection",null,t)}function K4(i){return vx(i),Ht("pageMargins",null,i)}function W4(i,t){for(var e=["<cols>"],n,r=0;r!=t.length;++r)(n=t[r])&&(e[e.length]=Ht("col",null,Ah(r,n)));return e[e.length]="</cols>",e.join("")}function Y4(i,t,e,n){var r=typeof i.ref=="string"?i.ref:pn(i.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var o=e.Workbook.Names,l=Ti(r);l.s.r==l.e.r&&(l.e.r=Ti(t["!ref"]).e.r,r=pn(l));for(var c=0;c<o.length;++c){var h=o[c];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+e.SheetNames[n]+"'!"+r;break}}return c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+r}),Ht("autoFilter",null,{ref:r})}function q4(i,t,e,n){var r={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ht("sheetViews",Ht("sheetView",null,r),{})}function $4(i,t,e,n){if(i.c&&e["!comments"].push([t,i.c]),i.v===void 0&&typeof i.f!="string"||i.t==="z"&&!i.f)return"";var r="",o=i.t,l=i.v;if(i.t!=="z")switch(i.t){case"b":r=i.v?"1":"0";break;case"n":r=""+i.v;break;case"e":r=ac[i.v];break;case"d":n&&n.cellDates?r=Jn(i.v,-1).toISOString():(i=hi(i),i.t="n",r=""+(i.v=ui(Jn(i.v)))),typeof i.z>"u"&&(i.z=nn[14]);break;default:r=i.v;break}var c=Bn("v",Re(r)),h={r:t},f=Dr(n.cellXfs,i,n);switch(f!==0&&(h.s=f),i.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(i.v==null){delete i.t;break}if(i.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=Bn("v",""+ig(n.Strings,i.v,n.revStrings)),h.t="s";break}h.t="str";break}if(i.t!=o&&(i.t=o,i.v=l),typeof i.f=="string"&&i.f){var g=i.F&&i.F.slice(0,t.length)==t?{t:"array",ref:i.F}:null;c=Ht("f",Re(i.f),g)+(i.v!=null?c:"")}return i.l&&e["!links"].push([t,i.l]),i.D&&(h.cm=1),Ht("c",c,h)}function Z4(i,t,e,n){var r=[],o=[],l=Xe(i["!ref"]),c="",h,f="",g=[],p=0,m=0,v=i["!rows"],b=Array.isArray(i),y={r:f},A,S=-1;for(m=l.s.c;m<=l.e.c;++m)g[m]=jn(m);for(p=l.s.r;p<=l.e.r;++p){for(o=[],f=In(p),m=l.s.c;m<=l.e.c;++m){h=g[m]+f;var w=b?(i[p]||[])[m]:i[h];w!==void 0&&(c=$4(w,h,i,t))!=null&&o.push(c)}(o.length>0||v&&v[p])&&(y={r:f},v&&v[p]&&(A=v[p],A.hidden&&(y.hidden=1),S=-1,A.hpx?S=ah(A.hpx):A.hpt&&(S=A.hpt),S>-1&&(y.ht=S,y.customHeight=1),A.level&&(y.outlineLevel=A.level)),r[r.length]=Ht("row",o.join(""),y))}if(v)for(;p<v.length;++p)v&&v[p]&&(y={r:p+1},A=v[p],A.hidden&&(y.hidden=1),S=-1,A.hpx?S=ah(A.hpx):A.hpt&&(S=A.hpt),S>-1&&(y.ht=S,y.customHeight=1),A.level&&(y.outlineLevel=A.level),r[r.length]=Ht("row","",y));return r.join("")}function yx(i,t,e,n){var r=[mn,Ht("worksheet",null,{xmlns:Ao[0],"xmlns:r":wn.r})],o=e.SheetNames[i],l=0,c="",h=e.Sheets[o];h==null&&(h={});var f=h["!ref"]||"A1",g=Xe(f);if(g.e.c>16383||g.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),f=pn(g)}n||(n={}),h["!comments"]=[];var p=[];j4(h,e,i,t,r),r[r.length]=Ht("dimension",null,{ref:f}),r[r.length]=q4(h,t,i,e),t.sheetFormat&&(r[r.length]=Ht("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(r[r.length]=W4(h,h["!cols"])),r[l=r.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(c=Z4(h,t),c.length>0&&(r[r.length]=c)),r.length>l+1&&(r[r.length]="</sheetData>",r[l]=r[l].replace("/>",">")),h["!protect"]&&(r[r.length]=X4(h["!protect"])),h["!autofilter"]!=null&&(r[r.length]=Y4(h["!autofilter"],h,e,i)),h["!merges"]!=null&&h["!merges"].length>0&&(r[r.length]=H4(h["!merges"]));var m=-1,v,b=-1;return h["!links"].length>0&&(r[r.length]="<hyperlinks>",h["!links"].forEach(function(y){y[1].Target&&(v={ref:y[0]},y[1].Target.charAt(0)!="#"&&(b=Oe(n,-1,Re(y[1].Target).replace(/#.*$/,""),be.HLINK),v["r:id"]="rId"+b),(m=y[1].Target.indexOf("#"))>-1&&(v.location=Re(y[1].Target.slice(m+1))),y[1].Tooltip&&(v.tooltip=Re(y[1].Tooltip)),r[r.length]=Ht("hyperlink",null,v))}),r[r.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(r[r.length]=K4(h["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(r[r.length]=Bn("ignoredErrors",Ht("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(b=Oe(n,-1,"../drawings/drawing"+(i+1)+".xml",be.DRAW),r[r.length]=Ht("drawing",null,{"r:id":"rId"+b}),h["!drawing"]=p),h["!comments"].length>0&&(b=Oe(n,-1,"../drawings/vmlDrawing"+(i+1)+".vml",be.VML),r[r.length]=Ht("legacyDrawing",null,{"r:id":"rId"+b}),h["!legacy"]=b),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function J4(i,t){var e={},n=i.l+t;e.r=i.read_shift(4),i.l+=4;var r=i.read_shift(2);i.l+=1;var o=i.read_shift(1);return i.l=n,o&7&&(e.level=o&7),o&16&&(e.hidden=!0),o&32&&(e.hpt=r/20),e}function Q4(i,t,e){var n=At(145),r=(e["!rows"]||[])[i]||{};n.write_shift(4,i),n.write_shift(4,0);var o=320;r.hpx?o=ah(r.hpx)*20:r.hpt&&(o=r.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var l=0;r.level&&(l|=r.level),r.hidden&&(l|=16),(r.hpx||r.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var c=0,h=n.l;n.l+=4;for(var f={r:i,c:0},g=0;g<16;++g)if(!(t.s.c>g+1<<10||t.e.c<g<<10)){for(var p=-1,m=-1,v=g<<10;v<g+1<<10;++v){f.c=v;var b=Array.isArray(e)?(e[f.r]||[])[f.c]:e[Pe(f)];b&&(p<0&&(p=v),m=v)}p<0||(++c,n.write_shift(4,p),n.write_shift(4,m))}var y=n.l;return n.l=h,n.write_shift(4,c),n.l=y,n.length>n.l?n.slice(0,n.l):n}function tk(i,t,e,n){var r=Q4(n,e,t);(r.length>17||(t["!rows"]||[])[n])&&Pt(i,0,r)}var ek=ds,nk=wo;function ik(){}function ak(i,t){var e={},n=i[i.l];return++i.l,e.above=!(n&64),e.left=!(n&128),i.l+=18,e.name=gE(i),e}function rk(i,t,e){e==null&&(e=At(84+4*i.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),e.write_shift(1,n);for(var r=1;r<3;++r)e.write_shift(1,0);return th({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),My(i,e),e.slice(0,e.l)}function sk(i){var t=Xi(i);return[t]}function ok(i,t,e){return e==null&&(e=At(8)),us(t,e)}function lk(i){var t=hs(i);return[t]}function ck(i,t,e){return e==null&&(e=At(4)),fs(t,e)}function uk(i){var t=Xi(i),e=i.read_shift(1);return[t,e,"b"]}function hk(i,t,e){return e==null&&(e=At(9)),us(t,e),e.write_shift(1,i.v?1:0),e}function fk(i){var t=hs(i),e=i.read_shift(1);return[t,e,"b"]}function dk(i,t,e){return e==null&&(e=At(5)),fs(t,e),e.write_shift(1,i.v?1:0),e}function gk(i){var t=Xi(i),e=i.read_shift(1);return[t,e,"e"]}function pk(i,t,e){return e==null&&(e=At(9)),us(t,e),e.write_shift(1,i.v),e}function mk(i){var t=hs(i),e=i.read_shift(1);return[t,e,"e"]}function vk(i,t,e){return e==null&&(e=At(8)),fs(t,e),e.write_shift(1,i.v),e.write_shift(2,0),e.write_shift(1,0),e}function yk(i){var t=Xi(i),e=i.read_shift(4);return[t,e,"s"]}function xk(i,t,e){return e==null&&(e=At(12)),us(t,e),e.write_shift(4,t.v),e}function _k(i){var t=hs(i),e=i.read_shift(4);return[t,e,"s"]}function bk(i,t,e){return e==null&&(e=At(8)),fs(t,e),e.write_shift(4,t.v),e}function Ak(i){var t=Xi(i),e=Eo(i);return[t,e,"n"]}function Sk(i,t,e){return e==null&&(e=At(16)),us(t,e),rs(i.v,e),e}function wk(i){var t=hs(i),e=Eo(i);return[t,e,"n"]}function Ek(i,t,e){return e==null&&(e=At(12)),fs(t,e),rs(i.v,e),e}function Tk(i){var t=Xi(i),e=Ny(i);return[t,e,"n"]}function Ck(i,t,e){return e==null&&(e=At(12)),us(t,e),Fy(i.v,e),e}function kk(i){var t=hs(i),e=Ny(i);return[t,e,"n"]}function Dk(i,t,e){return e==null&&(e=At(8)),fs(t,e),Fy(i.v,e),e}function Ok(i){var t=Xi(i),e=q0(i);return[t,e,"is"]}function Rk(i){var t=Xi(i),e=Gn(i);return[t,e,"str"]}function Pk(i,t,e){return e==null&&(e=At(12+4*i.v.length)),us(t,e),Tn(i.v,e),e.length>e.l?e.slice(0,e.l):e}function Mk(i){var t=hs(i),e=Gn(i);return[t,e,"str"]}function Nk(i,t,e){return e==null&&(e=At(8+4*i.v.length)),fs(t,e),Tn(i.v,e),e.length>e.l?e.slice(0,e.l):e}function Fk(i,t,e){var n=i.l+t,r=Xi(i);r.r=e["!row"];var o=i.read_shift(1),l=[r,o,"b"];if(e.cellFormula){i.l+=2;var c=bh(i,n-i.l,e);l[3]=bo(c,null,r,e.supbooks,e)}else i.l=n;return l}function Lk(i,t,e){var n=i.l+t,r=Xi(i);r.r=e["!row"];var o=i.read_shift(1),l=[r,o,"e"];if(e.cellFormula){i.l+=2;var c=bh(i,n-i.l,e);l[3]=bo(c,null,r,e.supbooks,e)}else i.l=n;return l}function Bk(i,t,e){var n=i.l+t,r=Xi(i);r.r=e["!row"];var o=Eo(i),l=[r,o,"n"];if(e.cellFormula){i.l+=2;var c=bh(i,n-i.l,e);l[3]=bo(c,null,r,e.supbooks,e)}else i.l=n;return l}function Ik(i,t,e){var n=i.l+t,r=Xi(i);r.r=e["!row"];var o=Gn(i),l=[r,o,"str"];if(e.cellFormula){i.l+=2;var c=bh(i,n-i.l,e);l[3]=bo(c,null,r,e.supbooks,e)}else i.l=n;return l}var Uk=ds,zk=wo;function Hk(i,t){return t==null&&(t=At(4)),t.write_shift(4,i),t}function jk(i,t){var e=i.l+t,n=ds(i),r=$0(i),o=Gn(i),l=Gn(i),c=Gn(i);i.l=e;var h={rfx:n,relId:r,loc:o,display:c};return l&&(h.Tooltip=l),h}function Gk(i,t){var e=At(50+4*(i[1].Target.length+(i[1].Tooltip||"").length));wo({s:En(i[0]),e:En(i[0])},e),Z0("rId"+t,e);var n=i[1].Target.indexOf("#"),r=n==-1?"":i[1].Target.slice(n+1);return Tn(r||"",e),Tn(i[1].Tooltip||"",e),Tn("",e),e.slice(0,e.l)}function Vk(){}function Xk(i,t,e){var n=i.l+t,r=Ly(i),o=i.read_shift(1),l=[r];if(l[2]=o,e.cellFormula){var c=M4(i,n-i.l,e);l[1]=c}else i.l=n;return l}function Kk(i,t,e){var n=i.l+t,r=ds(i),o=[r];if(e.cellFormula){var l=F4(i,n-i.l,e);o[1]=l,i.l=n}else i.l=n;return o}function Wk(i,t,e){e==null&&(e=At(18));var n=Ah(i,t);e.write_shift(-4,i),e.write_shift(-4,i),e.write_shift(4,(n.width||10)*256),e.write_shift(4,0);var r=0;return t.hidden&&(r|=1),typeof n.width=="number"&&(r|=2),t.level&&(r|=t.level<<8),e.write_shift(2,r),e}var xx=["left","right","top","bottom","header","footer"];function Yk(i){var t={};return xx.forEach(function(e){t[e]=Eo(i)}),t}function qk(i,t){return t==null&&(t=At(48)),vx(i),xx.forEach(function(e){rs(i[e],t)}),t}function $k(i){var t=i.read_shift(2);return i.l+=28,{RTL:t&32}}function Zk(i,t,e){e==null&&(e=At(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function Jk(i){var t=At(24);return t.write_shift(4,4),t.write_shift(4,1),wo(i,t),t}function Qk(i,t){return t==null&&(t=At(66)),t.write_shift(2,i.password?tx(i.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,i[e[0]]!=null&&!i[e[0]]?1:0):t.write_shift(4,i[e[0]]!=null&&i[e[0]]?0:1)}),t}function t3(){}function e3(){}function n3(i,t,e,n,r,o,l){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=hi(t),t.z=t.z||nn[14],t.v=ui(Jn(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var h={r:e,c:n};switch(h.s=Dr(r.cellXfs,t,r),t.l&&o["!links"].push([Pe(h),t.l]),t.c&&o["!comments"].push([Pe(h),t.c]),t.t){case"s":case"str":return r.bookSST?(c=ig(r.Strings,t.v,r.revStrings),h.t="s",h.v=c,l?Pt(i,18,bk(t,h)):Pt(i,7,xk(t,h))):(h.t="str",l?Pt(i,17,Nk(t,h)):Pt(i,6,Pk(t,h))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?Pt(i,13,Dk(t,h)):Pt(i,2,Ck(t,h)):l?Pt(i,16,Ek(t,h)):Pt(i,5,Sk(t,h)),!0;case"b":return h.t="b",l?Pt(i,15,dk(t,h)):Pt(i,4,hk(t,h)),!0;case"e":return h.t="e",l?Pt(i,14,vk(t,h)):Pt(i,3,pk(t,h)),!0}return l?Pt(i,12,ck(t,h)):Pt(i,1,ok(t,h)),!0}function i3(i,t,e,n){var r=Xe(t["!ref"]||"A1"),o,l="",c=[];Pt(i,145);var h=Array.isArray(t),f=r.e.r;t["!rows"]&&(f=Math.max(r.e.r,t["!rows"].length-1));for(var g=r.s.r;g<=f;++g){l=In(g),tk(i,t,r,g);var p=!1;if(g<=r.e.r)for(var m=r.s.c;m<=r.e.c;++m){g===r.s.r&&(c[m]=jn(m)),o=c[m]+l;var v=h?(t[g]||[])[m]:t[o];if(!v){p=!1;continue}p=n3(i,v,g,m,n,t,p)}}Pt(i,146)}function a3(i,t){!t||!t["!merges"]||(Pt(i,177,Hk(t["!merges"].length)),t["!merges"].forEach(function(e){Pt(i,176,zk(e))}),Pt(i,178))}function r3(i,t){!t||!t["!cols"]||(Pt(i,390),t["!cols"].forEach(function(e,n){e&&Pt(i,60,Wk(n,e))}),Pt(i,391))}function s3(i,t){!t||!t["!ref"]||(Pt(i,648),Pt(i,649,Jk(Xe(t["!ref"]))),Pt(i,650))}function o3(i,t,e){t["!links"].forEach(function(n){if(n[1].Target){var r=Oe(e,-1,n[1].Target.replace(/#.*$/,""),be.HLINK);Pt(i,494,Gk(n,r))}}),delete t["!links"]}function l3(i,t,e,n){if(t["!comments"].length>0){var r=Oe(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",be.VML);Pt(i,551,Z0("rId"+r)),t["!legacy"]=r}}function c3(i,t,e,n){if(t["!autofilter"]){var r=t["!autofilter"],o=typeof r.ref=="string"?r.ref:pn(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var l=e.Workbook.Names,c=Ti(o);c.s.r==c.e.r&&(c.e.r=Ti(t["!ref"]).e.r,o=pn(c));for(var h=0;h<l.length;++h){var f=l[h];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+e.SheetNames[n]+"'!"+o;break}}h==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+o}),Pt(i,161,wo(Xe(o))),Pt(i,162)}}function u3(i,t,e){Pt(i,133),Pt(i,137,Zk(t,e)),Pt(i,138),Pt(i,134)}function h3(i,t){t["!protect"]&&Pt(i,535,Qk(t["!protect"]))}function f3(i,t,e,n){var r=ci(),o=e.SheetNames[i],l=e.Sheets[o]||{},c=o;try{e&&e.Workbook&&(c=e.Workbook.Sheets[i].CodeName||c)}catch{}var h=Xe(l["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Pt(r,129),(e.vbaraw||l["!outline"])&&Pt(r,147,rk(c,l["!outline"])),Pt(r,148,nk(h)),u3(r,l,e.Workbook),r3(r,l),i3(r,l,i,t),h3(r,l),c3(r,l,e,i),a3(r,l),o3(r,l,n),l["!margins"]&&Pt(r,476,qk(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&s3(r,l),l3(r,l,i,n),Pt(r,130),r.end()}function d3(i,t){i.l+=10;var e=Gn(i);return{name:e}}var g3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function p3(i){return!i.Workbook||!i.Workbook.WBProps?"false":Kw(i.Workbook.WBProps.date1904)?"true":"false"}var m3="][*?/\\".split("");function _x(i,t){if(i.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return m3.forEach(function(n){if(i.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}function v3(i,t,e){i.forEach(function(n,r){_x(n);for(var o=0;o<r;++o)if(n==i[o])throw new Error("Duplicate Sheet Name: "+n);if(e){var l=t&&t[r]&&t[r].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function y3(i){if(!i||!i.SheetNames||!i.Sheets)throw new Error("Invalid Workbook");if(!i.SheetNames.length)throw new Error("Workbook is empty");var t=i.Workbook&&i.Workbook.Sheets||[];v3(i.SheetNames,t,!!i.vbaraw);for(var e=0;e<i.SheetNames.length;++e)z4(i.Sheets[i.SheetNames[e]],i.SheetNames[e],e)}function bx(i){var t=[mn];t[t.length]=Ht("workbook",null,{xmlns:Ao[0],"xmlns:r":wn.r});var e=i.Workbook&&(i.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};i.Workbook&&i.Workbook.WBProps&&(g3.forEach(function(c){i.Workbook.WBProps[c[0]]!=null&&i.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=i.Workbook.WBProps[c[0]])}),i.Workbook.WBProps.CodeName&&(n.codeName=i.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ht("workbookPr",null,n);var r=i.Workbook&&i.Workbook.Sheets||[],o=0;if(r&&r[0]&&r[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=i.SheetNames.length&&!(!r[o]||!r[o].Hidden);++o);o==i.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=i.SheetNames.length;++o){var l={name:Re(i.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),r[o])switch(r[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Ht("sheet",null,l)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",i.Workbook&&i.Workbook.Names&&i.Workbook.Names.forEach(function(c){var h={name:c.Name};c.Comment&&(h.comment=c.Comment),c.Sheet!=null&&(h.localSheetId=""+c.Sheet),c.Hidden&&(h.hidden="1"),c.Ref&&(t[t.length]=Ht("definedName",Re(c.Ref),h))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function x3(i,t){var e={};return e.Hidden=i.read_shift(4),e.iTabID=i.read_shift(4),e.strRelID=_0(i),e.name=Gn(i),e}function _3(i,t){return t||(t=At(127)),t.write_shift(4,i.Hidden),t.write_shift(4,i.iTabID),Z0(i.strRelID,t),Tn(i.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function b3(i,t){var e={},n=i.read_shift(4);e.defaultThemeVersion=i.read_shift(4);var r=t>8?Gn(i):"";return r.length>0&&(e.CodeName=r),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function A3(i,t){t||(t=At(72));var e=0;return i&&i.filterPrivacy&&(e|=8),t.write_shift(4,e),t.write_shift(4,0),My(i&&i.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function S3(i,t,e){var n=i.l+t;i.l+=4,i.l+=1;var r=i.read_shift(4),o=pE(i),l=N4(i,0,e),c=$0(i);i.l=n;var h={Name:o,Ptg:l};return r<268435455&&(h.Sheet=r),c&&(h.Comment=c),h}function w3(i,t){Pt(i,143);for(var e=0;e!=t.SheetNames.length;++e){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,r={Hidden:n,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};Pt(i,156,_3(r))}Pt(i,144)}function E3(i,t){t||(t=At(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return Tn("SheetJS",t),Tn(Ku.version,t),Tn(Ku.version,t),Tn("7262",t),t.length>t.l?t.slice(0,t.l):t}function T3(i,t){t||(t=At(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,i),t.write_shift(4,i);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function C3(i,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,n=0,r=-1,o=-1;n<e.length;++n)!e[n]||!e[n].Hidden&&r==-1?r=n:e[n].Hidden==1&&o==-1&&(o=n);o>r||(Pt(i,135),Pt(i,158,T3(r)),Pt(i,136))}}function k3(i,t){var e=ci();return Pt(e,131),Pt(e,128,E3()),Pt(e,153,A3(i.Workbook&&i.Workbook.WBProps||null)),C3(e,i),w3(e,i),Pt(e,132),e.end()}function D3(i,t,e){return(t.slice(-4)===".bin"?k3:bx)(i)}function O3(i,t,e,n,r){return(t.slice(-4)===".bin"?f3:yx)(i,e,n,r)}function R3(i,t,e){return(t.slice(-4)===".bin"?qT:ix)(i,e)}function P3(i,t,e){return(t.slice(-4)===".bin"?AT:Qy)(i,e)}function M3(i,t,e){return(t.slice(-4)===".bin"?hC:lx)(i)}function N3(i){return(i.slice(-4)===".bin"?iC:sx)()}function F3(i,t){var e=[];return i.Props&&e.push(RE(i.Props,t)),i.Custprops&&e.push(PE(i.Props,i.Custprops)),e.join("")}function L3(){return""}function B3(i,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,r){var o=[];o.push(Ht("NumberFormat",null,{"ss:Format":Re(nn[n.numFmtId])}));var l={"ss:ID":"s"+(21+r)};e.push(Ht("Style",o.join(""),l))}),Ht("Styles",e.join(""))}function Ax(i){return Ht("NamedRange",null,{"ss:Name":i.Name,"ss:RefersTo":"="+eg(i.Ref,{r:0,c:0})})}function I3(i){if(!((i||{}).Workbook||{}).Names)return"";for(var t=i.Workbook.Names,e=[],n=0;n<t.length;++n){var r=t[n];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||e.push(Ax(r)))}return Ht("Names",e.join(""))}function U3(i,t,e,n){if(!i||!((n||{}).Workbook||{}).Names)return"";for(var r=n.Workbook.Names,o=[],l=0;l<r.length;++l){var c=r[l];c.Sheet==e&&(c.Name.match(/^_xlfn\./)||o.push(Ax(c)))}return o.join("")}function z3(i,t,e,n){if(!i)return"";var r=[];if(i["!margins"]&&(r.push("<PageSetup>"),i["!margins"].header&&r.push(Ht("Header",null,{"x:Margin":i["!margins"].header})),i["!margins"].footer&&r.push(Ht("Footer",null,{"x:Margin":i["!margins"].footer})),r.push(Ht("PageMargins",null,{"x:Bottom":i["!margins"].bottom||"0.75","x:Left":i["!margins"].left||"0.7","x:Right":i["!margins"].right||"0.7","x:Top":i["!margins"].top||"0.75"})),r.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[e])if(n.Workbook.Sheets[e].Hidden)r.push(Ht("Visible",n.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<e&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==e&&r.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),i["!protect"]&&(r.push(Bn("ProtectContents","True")),i["!protect"].objects&&r.push(Bn("ProtectObjects","True")),i["!protect"].scenarios&&r.push(Bn("ProtectScenarios","True")),i["!protect"].selectLockedCells!=null&&!i["!protect"].selectLockedCells?r.push(Bn("EnableSelection","NoSelection")):i["!protect"].selectUnlockedCells!=null&&!i["!protect"].selectUnlockedCells&&r.push(Bn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){i["!protect"][l[0]]&&r.push("<"+l[1]+"/>")})),r.length==0?"":Ht("WorksheetOptions",r.join(""),{xmlns:wi.x})}function H3(i){return i.map(function(t){var e=Xw(t.t||""),n=Ht("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ht("Comment",n,{"ss:Author":t.a})}).join("")}function j3(i,t,e,n,r,o,l){if(!i||i.v==null&&i.f==null)return"";var c={};if(i.f&&(c["ss:Formula"]="="+Re(eg(i.f,l))),i.F&&i.F.slice(0,t.length)==t){var h=En(i.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(h.r==l.r?"":"["+(h.r-l.r)+"]")+"C"+(h.c==l.c?"":"["+(h.c-l.c)+"]")}if(i.l&&i.l.Target&&(c["ss:HRef"]=Re(i.l.Target),i.l.Tooltip&&(c["x:HRefScreenTip"]=Re(i.l.Tooltip))),e["!merges"])for(var f=e["!merges"],g=0;g!=f.length;++g)f[g].s.c!=l.c||f[g].s.r!=l.r||(f[g].e.c>f[g].s.c&&(c["ss:MergeAcross"]=f[g].e.c-f[g].s.c),f[g].e.r>f[g].s.r&&(c["ss:MergeDown"]=f[g].e.r-f[g].s.r));var p="",m="";switch(i.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",m=String(i.v);break;case"b":p="Boolean",m=i.v?"1":"0";break;case"e":p="Error",m=ac[i.v];break;case"d":p="DateTime",m=new Date(i.v).toISOString(),i.z==null&&(i.z=i.z||nn[14]);break;case"s":p="String",m=Vw(i.v||"");break}var v=Dr(n.cellXfs,i,n);c["ss:StyleID"]="s"+(21+v),c["ss:Index"]=l.c+1;var b=i.v!=null?m:"",y=i.t=="z"?"":'<Data ss:Type="'+p+'">'+b+"</Data>";return(i.c||[]).length>0&&(y+=H3(i.c)),Ht("Cell",y,c)}function G3(i,t){var e='<Row ss:Index="'+(i+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=nx(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function V3(i,t,e,n){if(!i["!ref"])return"";var r=Xe(i["!ref"]),o=i["!merges"]||[],l=0,c=[];i["!cols"]&&i["!cols"].forEach(function(A,S){Q0(A);var w=!!A.width,E=Ah(S,A),D={"ss:Index":S+1};w&&(D["ss:Width"]=nh(E.width)),A.hidden&&(D["ss:Hidden"]="1"),c.push(Ht("Column",null,D))});for(var h=Array.isArray(i),f=r.s.r;f<=r.e.r;++f){for(var g=[G3(f,(i["!rows"]||[])[f])],p=r.s.c;p<=r.e.c;++p){var m=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>p)&&!(o[l].s.r>f)&&!(o[l].e.c<p)&&!(o[l].e.r<f)){(o[l].s.c!=p||o[l].s.r!=f)&&(m=!0);break}if(!m){var v={r:f,c:p},b=Pe(v),y=h?(i[f]||[])[p]:i[b];g.push(j3(y,b,i,t,e,n,v))}}g.push("</Row>"),g.length>2&&c.push(g.join(""))}return c.join("")}function X3(i,t,e){var n=[],r=e.SheetNames[i],o=e.Sheets[r],l=o?U3(o,t,i,e):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=o?V3(o,t,i,e):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(z3(o,t,i,e)),n.join("")}function K3(i,t){t||(t={}),i.SSF||(i.SSF=hi(nn)),i.SSF&&(vh(),mh(i.SSF),t.revssf=yh(i.SSF),t.revssf[i.SSF[65535]]=0,t.ssf=i.SSF,t.cellXfs=[],Dr(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(F3(i,t)),e.push(L3()),e.push(""),e.push("");for(var n=0;n<i.SheetNames.length;++n)e.push(Ht("Worksheet",X3(n,t,i),{"ss:Name":Re(i.SheetNames[n])}));return e[2]=B3(i,t),e[3]=I3(i),mn+Ht("Workbook",e.join(""),{xmlns:wi.ss,"xmlns:o":wi.o,"xmlns:x":wi.x,"xmlns:ss":wi.ss,"xmlns:dt":wi.dt,"xmlns:html":wi.html})}var e0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function W3(i,t){var e=[],n=[],r=[],o=0,l,c=jv(e2,"n"),h=jv(n2,"n");if(i.Props)for(l=Un(i.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(c,l[o])?e:Object.prototype.hasOwnProperty.call(h,l[o])?n:r).push([l[o],i.Props[l[o]]]);if(i.Custprops)for(l=Un(i.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(i.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(c,l[o])?e:Object.prototype.hasOwnProperty.call(h,l[o])?n:r).push([l[o],i.Custprops[l[o]]]);var f=[];for(o=0;o<r.length;++o)Ky.indexOf(r[o][0])>-1||Gy.indexOf(r[o][0])>-1||r[o][1]!=null&&f.push(r[o]);n.length&&Be.utils.cfb_add(t,"/SummaryInformation",o2(n,e0.SI,h,n2)),(e.length||f.length)&&Be.utils.cfb_add(t,"/DocumentSummaryInformation",o2(e,e0.DSI,c,e2,f.length?f:null,e0.UDI))}function Y3(i,t){var e=t||{},n=Be.utils.cfb_new({root:"R"}),r="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":r="/Workbook",e.biff=8;break;case"biff5":r="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Be.utils.cfb_add(n,r,Sx(i,e)),e.biff==8&&(i.Props||i.Custprops)&&W3(i,n),e.biff==8&&i.vbaraw&&fC(n,Be.read(i.vbaraw,{type:typeof i.vbaraw=="string"?"binary":"buffer"})),n}var q3={0:{f:J4},1:{f:sk},2:{f:Tk},3:{f:gk},4:{f:uk},5:{f:Ak},6:{f:Rk},7:{f:yk},8:{f:Ik},9:{f:Bk},10:{f:Fk},11:{f:Lk},12:{f:lk},13:{f:kk},14:{f:mk},15:{f:fk},16:{f:wk},17:{f:Mk},18:{f:_k},19:{f:q0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:S3},40:{},42:{},43:{f:RT},44:{f:DT},45:{f:NT},46:{f:LT},47:{f:FT},48:{},49:{f:lE},50:{},51:{f:JT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:cT},62:{f:Ok},63:{f:aC},64:{f:t3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ya,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:$k},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ak},148:{f:ek,p:16},151:{f:Vk},152:{},153:{f:b3},154:{},155:{},156:{f:x3},157:{},158:{},159:{T:1,f:xT},160:{T:-1},161:{T:1,f:ds},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Uk},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:$T},336:{T:-1},337:{f:eC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:_0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:iT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Xk},427:{f:Kk},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Yk},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:ik},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:jk},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:_0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:cC},633:{T:1},634:{T:-1},635:{T:1,f:oC},636:{T:-1},637:{f:fE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:d3},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:e3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function jt(i,t,e,n){var r=t;if(!isNaN(r)){var o=n||(e||[]).length||0,l=i.next(4);l.write_shift(2,r),l.write_shift(2,o),o>0&&K0(e)&&i.push(e)}}function $3(i,t,e,n){var r=(e||[]).length||0;if(r<=8224)return jt(i,t,e,r);var o=t;if(!isNaN(o)){for(var l=e.parts||[],c=0,h=0,f=0;f+(l[c]||8224)<=8224;)f+=l[c]||8224,c++;var g=i.next(4);for(g.write_shift(2,o),g.write_shift(2,f),i.push(e.slice(h,h+f)),h+=f;h<r;){for(g=i.next(4),g.write_shift(2,60),f=0;f+(l[c]||8224)<=8224;)f+=l[c]||8224,c++;g.write_shift(2,f),i.push(e.slice(h,h+f)),h+=f}}}function sc(i,t,e){return i||(i=At(7)),i.write_shift(2,t),i.write_shift(2,e),i.write_shift(2,0),i.write_shift(1,0),i}function Z3(i,t,e,n){var r=At(9);return sc(r,i,t),Yy(e,n||"b",r),r}function J3(i,t,e){var n=At(8+2*e.length);return sc(n,i,t),n.write_shift(1,e.length),n.write_shift(e.length,e,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Q3(i,t,e,n){if(t.v!=null)switch(t.t){case"d":case"n":var r=t.t=="d"?ui(Jn(t.v)):t.v;r==(r|0)&&r>=0&&r<65536?jt(i,2,dT(e,n,r)):jt(i,3,fT(e,n,r));return;case"b":case"e":jt(i,5,Z3(e,n,t.v,t.t));return;case"s":case"str":jt(i,4,J3(e,n,(t.v||"").slice(0,255)));return}jt(i,1,sc(null,e,n))}function tD(i,t,e,n){var r=Array.isArray(t),o=Xe(t["!ref"]||"A1"),l,c="",h=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=pn(o)}for(var f=o.s.r;f<=o.e.r;++f){c=In(f);for(var g=o.s.c;g<=o.e.c;++g){f===o.s.r&&(h[g]=jn(g)),l=h[g]+c;var p=r?(t[f]||[])[g]:t[l];p&&Q3(i,p,f,g)}}}function eD(i,t){for(var e=t||{},n=ci(),r=0,o=0;o<i.SheetNames.length;++o)i.SheetNames[o]==e.sheet&&(r=o);if(r==0&&e.sheet&&i.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return jt(n,e.biff==4?1033:e.biff==3?521:9,J0(i,16,e)),tD(n,i.Sheets[i.SheetNames[r]],r,e),jt(n,10),n.end()}function nD(i,t,e){jt(i,49,qE({sz:12,name:"Arial"},e))}function iD(i,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&jt(i,1054,JE(r,t[r],e))})}function aD(i,t){var e=At(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),jt(i,2151,e),e=At(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),Zy(Xe(t["!ref"]||"A1"),e),e.write_shift(4,4),jt(i,2152,e)}function rD(i,t){for(var e=0;e<16;++e)jt(i,224,c2({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){jt(i,224,c2(n,0,t))})}function sD(i,t){for(var e=0;e<t["!links"].length;++e){var n=t["!links"][e];jt(i,440,sT(n)),n[1].Tooltip&&jt(i,2048,oT(n))}delete t["!links"]}function oD(i,t){if(t){var e=0;t.forEach(function(n,r){++e<=256&&n&&jt(i,125,uT(Ah(r,n),r))})}}function lD(i,t,e,n,r){var o=16+Dr(r.cellXfs,t,r);if(t.v==null&&!t.bf){jt(i,513,ss(e,n,o));return}if(t.bf)jt(i,6,P4(t,e,n,r,o));else switch(t.t){case"d":case"n":var l=t.t=="d"?ui(Jn(t.v)):t.v;jt(i,515,nT(e,n,l,o));break;case"b":case"e":jt(i,517,eT(e,n,t.v,o,r,t.t));break;case"s":case"str":if(r.bookSST){var c=ig(r.Strings,t.v,r.revStrings);jt(i,253,$E(e,n,c,o))}else jt(i,516,ZE(e,n,(t.v||"").slice(0,255),o,r));break;default:jt(i,513,ss(e,n,o))}}function cD(i,t,e){var n=ci(),r=e.SheetNames[i],o=e.Sheets[r]||{},l=(e||{}).Workbook||{},c=(l.Sheets||[])[i]||{},h=Array.isArray(o),f=t.biff==8,g,p="",m=[],v=Xe(o["!ref"]||"A1"),b=f?65536:16384;if(v.e.c>255||v.e.r>=b){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,b-1)}jt(n,2057,J0(e,16,t)),jt(n,13,Gi(1)),jt(n,12,Gi(100)),jt(n,15,$n(!0)),jt(n,17,$n(!1)),jt(n,16,rs(.001)),jt(n,95,$n(!0)),jt(n,42,$n(!1)),jt(n,43,$n(!1)),jt(n,130,Gi(1)),jt(n,128,tT()),jt(n,131,$n(!1)),jt(n,132,$n(!1)),f&&oD(n,o["!cols"]),jt(n,512,QE(v,t)),f&&(o["!links"]=[]);for(var y=v.s.r;y<=v.e.r;++y){p=In(y);for(var A=v.s.c;A<=v.e.c;++A){y===v.s.r&&(m[A]=jn(A)),g=m[A]+p;var S=h?(o[y]||[])[A]:o[g];S&&(lD(n,S,y,A,t),f&&S.l&&o["!links"].push([g,S.l]))}}var w=c.CodeName||c.name||r;return f&&jt(n,574,YE((l.Views||[])[0])),f&&(o["!merges"]||[]).length&&jt(n,229,rT(o["!merges"])),f&&sD(n,o),jt(n,442,$y(w)),f&&aD(n,o),jt(n,10),n.end()}function uD(i,t,e){var n=ci(),r=(i||{}).Workbook||{},o=r.Sheets||[],l=r.WBProps||{},c=e.biff==8,h=e.biff==5;if(jt(n,2057,J0(i,5,e)),e.bookType=="xla"&&jt(n,135),jt(n,225,c?Gi(1200):null),jt(n,193,FE(2)),h&&jt(n,191),h&&jt(n,192),jt(n,226),jt(n,92,VE("SheetJS",e)),jt(n,66,Gi(c?1200:1252)),c&&jt(n,353,Gi(0)),c&&jt(n,448),jt(n,317,hT(i.SheetNames.length)),c&&i.vbaraw&&jt(n,211),c&&i.vbaraw){var f=l.CodeName||"ThisWorkbook";jt(n,442,$y(f))}jt(n,156,Gi(17)),jt(n,25,$n(!1)),jt(n,18,$n(!1)),jt(n,19,Gi(0)),c&&jt(n,431,$n(!1)),c&&jt(n,444,Gi(0)),jt(n,61,WE()),jt(n,64,$n(!1)),jt(n,141,Gi(0)),jt(n,34,$n(p3(i)=="true")),jt(n,14,$n(!0)),c&&jt(n,439,$n(!1)),jt(n,218,Gi(0)),nD(n,i,e),iD(n,i.SSF,e),rD(n,e),c&&jt(n,352,$n(!1));var g=n.end(),p=ci();c&&jt(p,140,lT()),c&&e.Strings&&$3(p,252,KE(e.Strings)),jt(p,10);var m=p.end(),v=ci(),b=0,y=0;for(y=0;y<i.SheetNames.length;++y)b+=(c?12:11)+(c?2:1)*i.SheetNames[y].length;var A=g.length+b+m.length;for(y=0;y<i.SheetNames.length;++y){var S=o[y]||{};jt(v,133,XE({pos:A,hs:S.Hidden||0,dt:0,name:i.SheetNames[y]},e)),A+=t[y].length}var w=v.end();if(b!=w.length)throw new Error("BS8 "+b+" != "+w.length);var E=[];return g.length&&E.push(g),w.length&&E.push(w),m.length&&E.push(m),Ln(E)}function hD(i,t){var e=t||{},n=[];i&&!i.SSF&&(i.SSF=hi(nn)),i&&i.SSF&&(vh(),mh(i.SSF),e.revssf=yh(i.SSF),e.revssf[i.SSF[65535]]=0,e.ssf=i.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ag(e),e.cellXfs=[],Dr(e.cellXfs,{},{revssf:{General:0}}),i.Props||(i.Props={});for(var r=0;r<i.SheetNames.length;++r)n[n.length]=cD(r,e,i);return n.unshift(uD(i,n,e)),Ln(n)}function Sx(i,t){for(var e=0;e<=i.SheetNames.length;++e){var n=i.Sheets[i.SheetNames[e]];if(!(!n||!n["!ref"])){var r=Ti(n["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+i.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var o=t||{};switch(o.biff||2){case 8:case 5:return hD(i,t);case 4:case 3:case 2:return eD(i,t)}throw new Error("invalid type "+o.bookType+" for BIFF")}function fD(i,t,e,n){for(var r=i["!merges"]||[],o=[],l=t.s.c;l<=t.e.c;++l){for(var c=0,h=0,f=0;f<r.length;++f)if(!(r[f].s.r>e||r[f].s.c>l)&&!(r[f].e.r<e||r[f].e.c<l)){if(r[f].s.r<e||r[f].s.c<l){c=-1;break}c=r[f].e.r-r[f].s.r+1,h=r[f].e.c-r[f].s.c+1;break}if(!(c<0)){var g=Pe({r:e,c:l}),p=n.dense?(i[e]||[])[l]:i[g],m=p&&p.v!=null&&(p.h||Gw(p.w||(Wa(p),p.w)||""))||"",v={};c>1&&(v.rowspan=c),h>1&&(v.colspan=h),n.editable?m='<span contenteditable="true">'+m+"</span>":p&&(v["data-t"]=p&&p.t||"z",p.v!=null&&(v["data-v"]=p.v),p.z!=null&&(v["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+p.l.Target+'">'+m+"</a>")),v.id=(n.id||"sjs")+"-"+g,o.push(Ht("td",m,v))}}var b="<tr>";return b+o.join("")+"</tr>"}var dD='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',gD="</body></html>";function pD(i,t,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function wx(i,t){var e=t||{},n=e.header!=null?e.header:dD,r=e.footer!=null?e.footer:gD,o=[n],l=Ti(i["!ref"]);e.dense=Array.isArray(i),o.push(pD(i,l,e));for(var c=l.s.r;c<=l.e.r;++c)o.push(fD(i,l,c,e));return o.push("</table>"+r),o.join("")}function Ex(i,t,e){var n=e||{},r=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")r=n.origin;else{var l=typeof n.origin=="string"?En(n.origin):n.origin;r=l.r,o=l.c}var c=t.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r,c:o}};if(i["!ref"]){var g=Ti(i["!ref"]);f.s.r=Math.min(f.s.r,g.s.r),f.s.c=Math.min(f.s.c,g.s.c),f.e.r=Math.max(f.e.r,g.e.r),f.e.c=Math.max(f.e.c,g.e.c),r==-1&&(f.e.r=r=g.e.r+1)}var p=[],m=0,v=i["!rows"]||(i["!rows"]=[]),b=0,y=0,A=0,S=0,w=0,E=0;for(i["!cols"]||(i["!cols"]=[]);b<c.length&&y<h;++b){var D=c[b];if(m2(D)){if(n.display)continue;v[y]={hidden:!0}}var P=D.children;for(A=S=0;A<P.length;++A){var L=P[A];if(!(n.display&&m2(L))){var R=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):Ww(L.innerHTML),V=L.getAttribute("data-z")||L.getAttribute("z");for(m=0;m<p.length;++m){var F=p[m];F.s.c==S+o&&F.s.r<y+r&&y+r<=F.e.r&&(S=F.e.c+1-o,m=-1)}E=+L.getAttribute("colspan")||1,((w=+L.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:y+r,c:S+o},e:{r:y+r+(w||1)-1,c:S+o+(E||1)-1}});var Z={t:"s",v:R},tt=L.getAttribute("data-t")||L.getAttribute("t")||"";R!=null&&(R.length==0?Z.t=tt||"z":n.raw||R.trim().length==0||tt=="s"||(R==="TRUE"?Z={t:"b",v:!0}:R==="FALSE"?Z={t:"b",v:!1}:isNaN(Va(R))?isNaN(Gl(R).getDate())||(Z={t:"d",v:Jn(R)},n.cellDates||(Z={t:"n",v:ui(Z.v)}),Z.z=n.dateNF||nn[14]):Z={t:"n",v:Va(R)})),Z.z===void 0&&V!=null&&(Z.z=V);var I="",nt=L.getElementsByTagName("A");if(nt&&nt.length)for(var O=0;O<nt.length&&!(nt[O].hasAttribute("href")&&(I=nt[O].getAttribute("href"),I.charAt(0)!="#"));++O);I&&I.charAt(0)!="#"&&(Z.l={Target:I}),n.dense?(i[y+r]||(i[y+r]=[]),i[y+r][S+o]=Z):i[Pe({c:S+o,r:y+r})]=Z,f.e.c<S+o&&(f.e.c=S+o),S+=E}}++y}return p.length&&(i["!merges"]=(i["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,y-1+r),i["!ref"]=pn(f),y>=h&&(i["!fullref"]=pn((f.e.r=c.length-b+y-1+r,f))),i}function Tx(i,t){var e=t||{},n=e.dense?[]:{};return Ex(n,i,t)}function mD(i,t){return cs(Tx(i,t),t)}function m2(i){var t="",e=vD(i);return e&&(t=e(i).getPropertyValue("display")),t||(t=i.style&&i.style.display),t==="none"}function vD(i){return i.ownerDocument.defaultView&&typeof i.ownerDocument.defaultView.getComputedStyle=="function"?i.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var yD=(function(){var i=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Xl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+i+"</office:document-styles>";return function(){return mn+t}})(),v2=(function(){var i=function(o){return Re(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,n=function(o,l,c){var h=[];h.push('      <table:table table:name="'+Re(l.SheetNames[c])+`" table:style-name="ta1">
`);var f=0,g=0,p=Ti(o["!ref"]||"A1"),m=o["!merges"]||[],v=0,b=Array.isArray(o);if(o["!cols"])for(g=0;g<=p.e.c;++g)h.push("        <table:table-column"+(o["!cols"][g]?' table:style-name="co'+o["!cols"][g].ods+'"':"")+`></table:table-column>
`);var y="",A=o["!rows"]||[];for(f=0;f<p.s.r;++f)y=A[f]?' table:style-name="ro'+A[f].ods+'"':"",h.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=p.e.r;++f){for(y=A[f]?' table:style-name="ro'+A[f].ods+'"':"",h.push("        <table:table-row"+y+`>
`),g=0;g<p.s.c;++g)h.push(t);for(;g<=p.e.c;++g){var S=!1,w={},E="";for(v=0;v!=m.length;++v)if(!(m[v].s.c>g)&&!(m[v].s.r>f)&&!(m[v].e.c<g)&&!(m[v].e.r<f)){(m[v].s.c!=g||m[v].s.r!=f)&&(S=!0),w["table:number-columns-spanned"]=m[v].e.c-m[v].s.c+1,w["table:number-rows-spanned"]=m[v].e.r-m[v].s.r+1;break}if(S){h.push(e);continue}var D=Pe({r:f,c:g}),P=b?(o[f]||[])[g]:o[D];if(P&&P.f&&(w["table:formula"]=Re(I4(P.f)),P.F&&P.F.slice(0,D.length)==D)){var L=Ti(P.F);w["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,w["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!P){h.push(t);continue}switch(P.t){case"b":E=P.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=P.v?"true":"false";break;case"n":E=P.w||String(P.v||0),w["office:value-type"]="float",w["office:value"]=P.v||0;break;case"s":case"str":E=P.v==null?"":P.v,w["office:value-type"]="string";break;case"d":E=P.w||Jn(P.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=Jn(P.v).toISOString(),w["table:style-name"]="ce1";break;default:h.push(t);continue}var R=i(E);if(P.l&&P.l.Target){var V=P.l.Target;V=V.charAt(0)=="#"?"#"+U4(V.slice(1)):V,V.charAt(0)!="#"&&!V.match(/^\w+:/)&&(V="../"+V),R=Ht("text:a",R,{"xlink:href":V.replace(/&/g,"&amp;")})}h.push("          "+Ht("table:table-cell",Ht("text:p",R,{}),w)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},r=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var g=0;g<f["!cols"].length;++g)if(f["!cols"][g]){var p=f["!cols"][g];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Q0(p),p.ods=c;var m=f["!cols"][g].wpx+"px";o.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),o.push(`  </style:style>
`),++c}}});var h=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var g=0;g<f["!rows"].length;++g)if(f["!rows"][g]){f["!rows"][g].ods=h;var p=f["!rows"][g].hpx+"px";o.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),o.push(`  </style:style>
`),++h}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,c){var h=[mn],f=Xl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=Xl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(h.push("<office:document"+f+g+`>
`),h.push(Hy().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+f+`>
`),r(h,l),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var p=0;p!=l.SheetNames.length;++p)h.push(n(l.Sheets[l.SheetNames[p]],l,p));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),c.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function Cx(i,t){if(t.bookType=="fods")return v2(i,t);var e=j0(),n="",r=[],o=[];return n="mimetype",ce(e,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ce(e,n,v2(i,t)),r.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",ce(e,n,yD(i,t)),r.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",ce(e,n,mn+Hy()),r.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",ce(e,n,OE(o)),r.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ce(e,n,kE(r)),e}function rh(i){return new DataView(i.buffer,i.byteOffset,i.byteLength)}function xD(i){return typeof TextEncoder<"u"?new TextEncoder().encode(i):Qi(Vl(i))}function _D(i,t){t:for(var e=0;e<=i.length-t.length;++e){for(var n=0;n<t.length;++n)if(i[e+n]!=t[n])continue t;return!0}return!1}function kr(i){var t=i.reduce(function(r,o){return r+o.length},0),e=new Uint8Array(t),n=0;return i.forEach(function(r){e.set(r,n),n+=r.length}),e}function bD(i,t,e){var n=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,r=e/Math.pow(10,n-6176);i[t+15]|=n>>7,i[t+14]|=(n&127)<<1;for(var o=0;r>=1;++o,r/=256)i[t+o]=r&255;i[t+15]|=e>=0?0:128}function Kl(i,t){var e=t?t[0]:0,n=i[e]&127;t:if(i[e++]>=128&&(n|=(i[e]&127)<<7,i[e++]<128||(n|=(i[e]&127)<<14,i[e++]<128)||(n|=(i[e]&127)<<21,i[e++]<128)||(n+=(i[e]&127)*Math.pow(2,28),++e,i[e++]<128)||(n+=(i[e]&127)*Math.pow(2,35),++e,i[e++]<128)||(n+=(i[e]&127)*Math.pow(2,42),++e,i[e++]<128)))break t;return t&&(t[0]=e),n}function De(i){var t=new Uint8Array(7);t[0]=i&127;var e=1;t:if(i>127){if(t[e-1]|=128,t[e]=i>>7&127,++e,i<=16383||(t[e-1]|=128,t[e]=i>>14&127,++e,i<=2097151)||(t[e-1]|=128,t[e]=i>>21&127,++e,i<=268435455)||(t[e-1]|=128,t[e]=i/256>>>21&127,++e,i<=34359738367)||(t[e-1]|=128,t[e]=i/65536>>>21&127,++e,i<=4398046511103))break t;t[e-1]|=128,t[e]=i/16777216>>>21&127,++e}return t.slice(0,e)}function vo(i){var t=0,e=i[t]&127;t:if(i[t++]>=128){if(e|=(i[t]&127)<<7,i[t++]<128||(e|=(i[t]&127)<<14,i[t++]<128)||(e|=(i[t]&127)<<21,i[t++]<128))break t;e|=(i[t]&127)<<28}return e}function xn(i){for(var t=[],e=[0];e[0]<i.length;){var n=e[0],r=Kl(i,e),o=r&7;r=Math.floor(r/8);var l=0,c;if(r==0)break;switch(o){case 0:{for(var h=e[0];i[e[0]++]>=128;);c=i.slice(h,e[0])}break;case 5:l=4,c=i.slice(e[0],e[0]+l),e[0]+=l;break;case 1:l=8,c=i.slice(e[0],e[0]+l),e[0]+=l;break;case 2:l=Kl(i,e),c=i.slice(e[0],e[0]+l),e[0]+=l;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(r," at offset ").concat(n))}var f={data:c,type:o};t[r]==null?t[r]=[f]:t[r].push(f)}return t}function Mn(i){var t=[];return i.forEach(function(e,n){e.forEach(function(r){r.data&&(t.push(De(n*8+r.type)),r.type==2&&t.push(De(r.data.length)),t.push(r.data))})}),kr(t)}function $i(i){for(var t,e=[],n=[0];n[0]<i.length;){var r=Kl(i,n),o=xn(i.slice(n[0],n[0]+r));n[0]+=r;var l={id:vo(o[1][0].data),messages:[]};o[2].forEach(function(c){var h=xn(c.data),f=vo(h[3][0].data);l.messages.push({meta:h,data:i.slice(n[0],n[0]+f)}),n[0]+=f}),(t=o[3])!=null&&t[0]&&(l.merge=vo(o[3][0].data)>>>0>0),e.push(l)}return e}function to(i){var t=[];return i.forEach(function(e){var n=[];n[1]=[{data:De(e.id),type:0}],n[2]=[],e.merge!=null&&(n[3]=[{data:De(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(l){r.push(l.data),l.meta[3]=[{type:0,data:De(l.data.length)}],n[2].push({data:Mn(l.meta),type:2})});var o=Mn(n);t.push(De(o.length)),t.push(o),r.forEach(function(l){return t.push(l)})}),kr(t)}function AD(i,t){if(i!=0)throw new Error("Unexpected Snappy chunk type ".concat(i));for(var e=[0],n=Kl(t,e),r=[];e[0]<t.length;){var o=t[e[0]]&3;if(o==0){var l=t[e[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[e[0]],c>1&&(l|=t[e[0]+1]<<8),c>2&&(l|=t[e[0]+2]<<16),c>3&&(l|=t[e[0]+3]<<24),l>>>=0,l++,e[0]+=c}r.push(t.slice(e[0],e[0]+l)),e[0]+=l;continue}else{var h=0,f=0;if(o==1?(f=(t[e[0]]>>2&7)+4,h=(t[e[0]++]&224)<<3,h|=t[e[0]++]):(f=(t[e[0]++]>>2)+1,o==2?(h=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(h=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),r=[kr(r)],h==0)throw new Error("Invalid offset 0");if(h>r[0].length)throw new Error("Invalid offset beyond length");if(f>=h)for(r.push(r[0].slice(-h)),f-=h;f>=r[r.length-1].length;)r.push(r[r.length-1]),f-=r[r.length-1].length;r.push(r[0].slice(-h,-h+f))}}var g=kr(r);if(g.length!=n)throw new Error("Unexpected length: ".concat(g.length," != ").concat(n));return g}function Zi(i){for(var t=[],e=0;e<i.length;){var n=i[e++],r=i[e]|i[e+1]<<8|i[e+2]<<16;e+=3,t.push(AD(n,i.slice(e,e+r))),e+=r}if(e!==i.length)throw new Error("data is not a valid framed stream!");return kr(t)}function eo(i){for(var t=[],e=0;e<i.length;){var n=Math.min(i.length-e,268435455),r=new Uint8Array(4);t.push(r);var o=De(n),l=o.length;t.push(o),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(i.slice(e,e+n)),l+=n,r[0]=0,r[1]=l&255,r[2]=l>>8&255,r[3]=l>>16&255,e+=n}return kr(t)}function n0(i,t){var e=new Uint8Array(32),n=rh(e),r=12,o=0;switch(e[0]=5,i.t){case"n":e[1]=2,bD(e,r,i.v),o|=1,r+=16;break;case"b":e[1]=6,n.setFloat64(r,i.v?1:0,!0),o|=2,r+=8;break;case"s":if(t.indexOf(i.v)==-1)throw new Error("Value ".concat(i.v," missing from SST!"));e[1]=3,n.setUint32(r,t.indexOf(i.v),!0),o|=8,r+=4;break;default:throw"unsupported cell type "+i.t}return n.setUint32(8,o,!0),e.slice(0,r)}function i0(i,t){var e=new Uint8Array(32),n=rh(e),r=12,o=0;switch(e[0]=3,i.t){case"n":e[2]=2,n.setFloat64(r,i.v,!0),o|=32,r+=8;break;case"b":e[2]=6,n.setFloat64(r,i.v?1:0,!0),o|=32,r+=8;break;case"s":if(t.indexOf(i.v)==-1)throw new Error("Value ".concat(i.v," missing from SST!"));e[2]=3,n.setUint32(r,t.indexOf(i.v),!0),o|=16,r+=4;break;default:throw"unsupported cell type "+i.t}return n.setUint32(4,o,!0),e.slice(0,r)}function xr(i){var t=xn(i);return Kl(t[1][0].data)}function SD(i,t,e){var n,r,o,l;if(!((n=i[6])!=null&&n[0])||!((r=i[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(o=i[8])==null?void 0:o[0])==null?void 0:l.data)&&vo(i[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var h=0,f=rh(i[7][0].data),g=0,p=[],m=rh(i[4][0].data),v=0,b=[],y=0;y<t.length;++y){if(t[y]==null){f.setUint16(y*2,65535,!0),m.setUint16(y*2,65535);continue}f.setUint16(y*2,g,!0),m.setUint16(y*2,v,!0);var A,S;switch(typeof t[y]){case"string":A=n0({t:"s",v:t[y]},e),S=i0({t:"s",v:t[y]},e);break;case"number":A=n0({t:"n",v:t[y]},e),S=i0({t:"n",v:t[y]},e);break;case"boolean":A=n0({t:"b",v:t[y]},e),S=i0({t:"b",v:t[y]},e);break;default:throw new Error("Unsupported value "+t[y])}p.push(A),g+=A.length,b.push(S),v+=S.length,++h}for(i[2][0].data=De(h);y<i[7][0].data.length/2;++y)f.setUint16(y*2,65535,!0),m.setUint16(y*2,65535,!0);return i[6][0].data=kr(p),i[3][0].data=kr(b),h}function wD(i,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=i.Sheets[i.SheetNames[0]];i.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ti(e["!ref"]);n.s.r=n.s.c=0;var r=!1;n.e.c>9&&(r=!0,n.e.c=9),n.e.r>49&&(r=!0,n.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(pn(n)));var o=sh(e,{range:n,header:1}),l=["~Sh33tJ5~"];o.forEach(function(X){return X.forEach(function(U){typeof U=="string"&&l.push(U)})});var c={},h=[],f=Be.read(t.numbers,{type:"base64"});f.FileIndex.map(function(X,U){return[X,f.FullPaths[U]]}).forEach(function(X){var U=X[0],j=X[1];if(U.type==2&&U.name.match(/\.iwa/)){var ot=U.content,bt=Zi(ot),Ot=$i(bt);Ot.forEach(function(Tt){h.push(Tt.id),c[Tt.id]={deps:[],location:j,type:vo(Tt.messages[0].meta[1][0].data)}})}}),h.sort(function(X,U){return X-U});var g=h.filter(function(X){return X>1}).map(function(X){return[X,De(X)]});f.FileIndex.map(function(X,U){return[X,f.FullPaths[U]]}).forEach(function(X){var U=X[0];if(X[1],!!U.name.match(/\.iwa/)){var j=$i(Zi(U.content));j.forEach(function(ot){ot.messages.forEach(function(bt){g.forEach(function(Ot){ot.messages.some(function(Tt){return vo(Tt.meta[1][0].data)!=11006&&_D(Tt.data,Ot[1])})&&c[Ot[0]].deps.push(ot.id)})})})}});for(var p=Be.find(f,c[1].location),m=$i(Zi(p.content)),v,b=0;b<m.length;++b){var y=m[b];y.id==1&&(v=y)}var A=xr(xn(v.messages[0].data)[1][0].data);for(p=Be.find(f,c[A].location),m=$i(Zi(p.content)),b=0;b<m.length;++b)y=m[b],y.id==A&&(v=y);for(A=xr(xn(v.messages[0].data)[2][0].data),p=Be.find(f,c[A].location),m=$i(Zi(p.content)),b=0;b<m.length;++b)y=m[b],y.id==A&&(v=y);for(A=xr(xn(v.messages[0].data)[2][0].data),p=Be.find(f,c[A].location),m=$i(Zi(p.content)),b=0;b<m.length;++b)y=m[b],y.id==A&&(v=y);var S=xn(v.messages[0].data);{S[6][0].data=De(n.e.r+1),S[7][0].data=De(n.e.c+1);var w=xr(S[46][0].data),E=Be.find(f,c[w].location),D=$i(Zi(E.content));{for(var P=0;P<D.length&&D[P].id!=w;++P);if(D[P].id!=w)throw"Bad ColumnRowUIDMapArchive";var L=xn(D[P].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var R=0;R<=n.e.c;++R){var V=[];V[1]=V[2]=[{type:0,data:De(R+420690)}],L[1].push({type:2,data:Mn(V)}),L[2].push({type:0,data:De(R)}),L[3].push({type:0,data:De(R)})}L[4]=[],L[5]=[],L[6]=[];for(var F=0;F<=n.e.r;++F)V=[],V[1]=V[2]=[{type:0,data:De(F+726270)}],L[4].push({type:2,data:Mn(V)}),L[5].push({type:0,data:De(F)}),L[6].push({type:0,data:De(F)});D[P].messages[0].data=Mn(L)}E.content=eo(to(D)),E.size=E.content.length,delete S[46];var Z=xn(S[4][0].data);{Z[7][0].data=De(n.e.r+1);var tt=xn(Z[1][0].data),I=xr(tt[2][0].data);E=Be.find(f,c[I].location),D=$i(Zi(E.content));{if(D[0].id!=I)throw"Bad HeaderStorageBucket";var nt=xn(D[0].messages[0].data);for(F=0;F<o.length;++F){var O=xn(nt[2][0].data);O[1][0].data=De(F),O[4][0].data=De(o[F].length),nt[2][F]={type:nt[2][0].type,data:Mn(O)}}D[0].messages[0].data=Mn(nt)}E.content=eo(to(D)),E.size=E.content.length;var rt=xr(Z[2][0].data);E=Be.find(f,c[rt].location),D=$i(Zi(E.content));{if(D[0].id!=rt)throw"Bad HeaderStorageBucket";for(nt=xn(D[0].messages[0].data),R=0;R<=n.e.c;++R)O=xn(nt[2][0].data),O[1][0].data=De(R),O[4][0].data=De(n.e.r+1),nt[2][R]={type:nt[2][0].type,data:Mn(O)};D[0].messages[0].data=Mn(nt)}E.content=eo(to(D)),E.size=E.content.length;var Q=xr(Z[4][0].data);(function(){for(var X=Be.find(f,c[Q].location),U=$i(Zi(X.content)),j,ot=0;ot<U.length;++ot){var bt=U[ot];bt.id==Q&&(j=bt)}var Ot=xn(j.messages[0].data);{Ot[3]=[];var Tt=[];l.forEach(function(te,ve){Tt[1]=[{type:0,data:De(ve)}],Tt[2]=[{type:0,data:De(1)}],Tt[3]=[{type:2,data:xD(te)}],Ot[3].push({type:2,data:Mn(Tt)})})}j.messages[0].data=Mn(Ot);var Mt=to(U),Zt=eo(Mt);X.content=Zt,X.size=X.content.length})();var J=xn(Z[3][0].data);{var _t=J[1][0];delete J[2];var vt=xn(_t.data);{var Nt=xr(vt[2][0].data);(function(){for(var X=Be.find(f,c[Nt].location),U=$i(Zi(X.content)),j,ot=0;ot<U.length;++ot){var bt=U[ot];bt.id==Nt&&(j=bt)}var Ot=xn(j.messages[0].data);{delete Ot[6],delete J[7];var Tt=new Uint8Array(Ot[5][0].data);Ot[5]=[];for(var Mt=0,Zt=0;Zt<=n.e.r;++Zt){var te=xn(Tt);Mt+=SD(te,o[Zt],l),te[1][0].data=De(Zt),Ot[5].push({data:Mn(te),type:2})}Ot[1]=[{type:0,data:De(n.e.c+1)}],Ot[2]=[{type:0,data:De(n.e.r+1)}],Ot[3]=[{type:0,data:De(Mt)}],Ot[4]=[{type:0,data:De(n.e.r+1)}]}j.messages[0].data=Mn(Ot);var ve=to(U),k=eo(ve);X.content=k,X.size=X.content.length})()}_t.data=Mn(vt)}Z[3][0].data=Mn(J)}S[4][0].data=Mn(Z)}v.messages[0].data=Mn(S);var M=to(m),C=eo(M);return p.content=C,p.size=p.content.length,f}function ED(i){return function(e){for(var n=0;n!=i.length;++n){var r=i[n];e[r[0]]===void 0&&(e[r[0]]=r[1]),r[2]==="n"&&(e[r[0]]=Number(e[r[0]]))}}}function ag(i){ED([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(i)}function TD(i,t){return t.bookType=="ods"?Cx(i,t):t.bookType=="numbers"?wD(i,t):t.bookType=="xlsb"?CD(i,t):kD(i,t)}function CD(i,t){co=1024,i&&!i.SSF&&(i.SSF=hi(nn)),i&&i.SSF&&(vh(),mh(i.SSF),t.revssf=yh(i.SSF),t.revssf[i.SSF[65535]]=0,t.ssf=i.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Fl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e=t.bookType=="xlsb"?"bin":"xml",n=cx.indexOf(t.bookType)>-1,r=Iy();ag(t=t||{});var o=j0(),l="",c=0;if(t.cellXfs=[],Dr(t.cellXfs,{},{revssf:{General:0}}),i.Props||(i.Props={}),l="docProps/core.xml",ce(o,l,jy(i.Props,t)),r.coreprops.push(l),Oe(t.rels,2,l,be.CORE_PROPS),l="docProps/app.xml",!(i.Props&&i.Props.SheetNames))if(!i.Workbook||!i.Workbook.Sheets)i.Props.SheetNames=i.SheetNames;else{for(var h=[],f=0;f<i.SheetNames.length;++f)(i.Workbook.Sheets[f]||{}).Hidden!=2&&h.push(i.SheetNames[f]);i.Props.SheetNames=h}for(i.Props.Worksheets=i.Props.SheetNames.length,ce(o,l,Vy(i.Props)),r.extprops.push(l),Oe(t.rels,3,l,be.EXT_PROPS),i.Custprops!==i.Props&&Un(i.Custprops||{}).length>0&&(l="docProps/custom.xml",ce(o,l,Xy(i.Custprops)),r.custprops.push(l),Oe(t.rels,4,l,be.CUST_PROPS)),c=1;c<=i.SheetNames.length;++c){var g={"!id":{}},p=i.Sheets[i.SheetNames[c-1]],m=(p||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+c+"."+e,ce(o,l,O3(c-1,l,t,i,g)),r.sheets.push(l),Oe(t.wbrels,-1,"worksheets/sheet"+c+"."+e,be.WS[0]),p){var v=p["!comments"],b=!1,y="";v&&v.length>0&&(y="xl/comments"+c+"."+e,ce(o,y,M3(v,y)),r.comments.push(y),Oe(g,-1,"../comments"+c+"."+e,be.CMNT),b=!0),p["!legacy"]&&b&&ce(o,"xl/drawings/vmlDrawing"+c+".vml",ox(c,p["!comments"])),delete p["!comments"],delete p["!legacy"]}g["!id"].rId1&&ce(o,zy(l),po(g))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+e,ce(o,l,P3(t.Strings,l,t)),r.strs.push(l),Oe(t.wbrels,-1,"sharedStrings."+e,be.SST)),l="xl/workbook."+e,ce(o,l,D3(i,l)),r.workbooks.push(l),Oe(t.rels,1,l,be.WB),l="xl/theme/theme1.xml",ce(o,l,rx(i.Themes,t)),r.themes.push(l),Oe(t.wbrels,-1,"theme/theme1.xml",be.THEME),l="xl/styles."+e,ce(o,l,R3(i,l,t)),r.styles.push(l),Oe(t.wbrels,-1,"styles."+e,be.STY),i.vbaraw&&n&&(l="xl/vbaProject.bin",ce(o,l,i.vbaraw),r.vba.push(l),Oe(t.wbrels,-1,"vbaProject.bin",be.VBA)),l="xl/metadata."+e,ce(o,l,N3(l)),r.metadata.push(l),Oe(t.wbrels,-1,"metadata."+e,be.XLMETA),ce(o,"[Content_Types].xml",Uy(r,t)),ce(o,"_rels/.rels",po(t.rels)),ce(o,"xl/_rels/workbook."+e+".rels",po(t.wbrels)),delete t.revssf,delete t.ssf,o}function kD(i,t){co=1024,i&&!i.SSF&&(i.SSF=hi(nn)),i&&i.SSF&&(vh(),mh(i.SSF),t.revssf=yh(i.SSF),t.revssf[i.SSF[65535]]=0,t.ssf=i.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Fl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",n=cx.indexOf(t.bookType)>-1,r=Iy();ag(t=t||{});var o=j0(),l="",c=0;if(t.cellXfs=[],Dr(t.cellXfs,{},{revssf:{General:0}}),i.Props||(i.Props={}),l="docProps/core.xml",ce(o,l,jy(i.Props,t)),r.coreprops.push(l),Oe(t.rels,2,l,be.CORE_PROPS),l="docProps/app.xml",!(i.Props&&i.Props.SheetNames))if(!i.Workbook||!i.Workbook.Sheets)i.Props.SheetNames=i.SheetNames;else{for(var h=[],f=0;f<i.SheetNames.length;++f)(i.Workbook.Sheets[f]||{}).Hidden!=2&&h.push(i.SheetNames[f]);i.Props.SheetNames=h}i.Props.Worksheets=i.Props.SheetNames.length,ce(o,l,Vy(i.Props)),r.extprops.push(l),Oe(t.rels,3,l,be.EXT_PROPS),i.Custprops!==i.Props&&Un(i.Custprops||{}).length>0&&(l="docProps/custom.xml",ce(o,l,Xy(i.Custprops)),r.custprops.push(l),Oe(t.rels,4,l,be.CUST_PROPS));var g=["SheetJ5"];for(t.tcid=0,c=1;c<=i.SheetNames.length;++c){var p={"!id":{}},m=i.Sheets[i.SheetNames[c-1]],v=(m||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+c+"."+e,ce(o,l,yx(c-1,t,i,p)),r.sheets.push(l),Oe(t.wbrels,-1,"worksheets/sheet"+c+"."+e,be.WS[0]),m){var b=m["!comments"],y=!1,A="";if(b&&b.length>0){var S=!1;b.forEach(function(w){w[1].forEach(function(E){E.T==!0&&(S=!0)})}),S&&(A="xl/threadedComments/threadedComment"+c+"."+e,ce(o,A,rC(b,g,t)),r.threadedcomments.push(A),Oe(p,-1,"../threadedComments/threadedComment"+c+"."+e,be.TCMNT)),A="xl/comments"+c+"."+e,ce(o,A,lx(b)),r.comments.push(A),Oe(p,-1,"../comments"+c+"."+e,be.CMNT),y=!0}m["!legacy"]&&y&&ce(o,"xl/drawings/vmlDrawing"+c+".vml",ox(c,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&ce(o,zy(l),po(p))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+e,ce(o,l,Qy(t.Strings,t)),r.strs.push(l),Oe(t.wbrels,-1,"sharedStrings."+e,be.SST)),l="xl/workbook."+e,ce(o,l,bx(i)),r.workbooks.push(l),Oe(t.rels,1,l,be.WB),l="xl/theme/theme1.xml",ce(o,l,rx(i.Themes,t)),r.themes.push(l),Oe(t.wbrels,-1,"theme/theme1.xml",be.THEME),l="xl/styles."+e,ce(o,l,ix(i,t)),r.styles.push(l),Oe(t.wbrels,-1,"styles."+e,be.STY),i.vbaraw&&n&&(l="xl/vbaProject.bin",ce(o,l,i.vbaraw),r.vba.push(l),Oe(t.wbrels,-1,"vbaProject.bin",be.VBA)),l="xl/metadata."+e,ce(o,l,sx()),r.metadata.push(l),Oe(t.wbrels,-1,"metadata."+e,be.XLMETA),g.length>1&&(l="xl/persons/person.xml",ce(o,l,sC(g)),r.people.push(l),Oe(t.wbrels,-1,"persons/person.xml",be.PEOPLE)),ce(o,"[Content_Types].xml",Uy(r,t)),ce(o,"_rels/.rels",po(t.rels)),ce(o,"xl/_rels/workbook."+e+".rels",po(t.wbrels)),delete t.revssf,delete t.ssf,o}function DD(i,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]];case"base64":e=Ka(i.slice(0,12));break;case"binary":e=i;break;case"array":return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function kx(i,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return nc(t.file,Be.write(i,{type:Ee?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Be.write(i,t)}function OD(i,t){var e=hi(t||{}),n=TD(i,e);return RD(n,e)}function RD(i,t){var e={},n=Ee?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=n;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var r=i.FullPaths?Be.write(i,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):i.generate(e);if(typeof Deno<"u"&&typeof r=="string"){if(t.type=="binary"||t.type=="base64")return r;r=new Uint8Array(ph(r))}return t.password&&typeof encrypt_agile<"u"?kx(encrypt_agile(r,t.password),t):t.type==="file"?nc(t.file,r):t.type=="string"?Rl(r):r}function PD(i,t){var e=t||{},n=Y3(i,e);return kx(n,e)}function da(i,t,e){e||(e="");var n=e+i;switch(t.type){case"base64":return jl(Vl(n));case"binary":return Vl(n);case"string":return i;case"file":return nc(t.file,n,"utf8");case"buffer":return Ee?Ya(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):da(n,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function MD(i,t){switch(t.type){case"base64":return jl(i);case"binary":return i;case"string":return i;case"file":return nc(t.file,i,"binary");case"buffer":return Ee?Ya(i,"binary"):i.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Uu(i,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",n=0;n<i.length;++n)e+=String.fromCharCode(i[n]);return t.type=="base64"?jl(e):t.type=="string"?Rl(e):e;case"file":return nc(t.file,i);case"buffer":return i;default:throw new Error("Unrecognized type "+t.type)}}function rg(i,t){ow(),y3(i);var e=hi(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var n=rg(i,e);return e.type="array",ph(n)}var r=0;if(e.sheet&&(typeof e.sheet=="number"?r=e.sheet:r=i.SheetNames.indexOf(e.sheet),!i.SheetNames[r]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return da(K3(i,e),e);case"slk":case"sylk":return da(pT.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"htm":case"html":return da(wx(i.Sheets[i.SheetNames[r]],e),e);case"txt":return MD(Dx(i.Sheets[i.SheetNames[r]],e),e);case"csv":return da(sg(i.Sheets[i.SheetNames[r]],e),e,"\uFEFF");case"dif":return da(mT.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"dbf":return Uu(gT.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"prn":return da(vT.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"rtf":return da(wT.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"eth":return da(Jy.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"fods":return da(Cx(i,e),e);case"wk1":return Uu(u2.sheet_to_wk1(i.Sheets[i.SheetNames[r]],e),e);case"wk3":return Uu(u2.book_to_wk3(i,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),Uu(Sx(i,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),PD(i,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return OD(i,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function ND(i,t,e,n,r,o,l,c){var h=In(e),f=c.defval,g=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),p=!0,m=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:e,enumerable:!1})}catch{m.__rowNum__=e}else m.__rowNum__=e;if(!l||i[e])for(var v=t.s.c;v<=t.e.c;++v){var b=l?i[e][v]:i[n[v]+h];if(b===void 0||b.t===void 0){if(f===void 0)continue;o[v]!=null&&(m[o[v]]=f);continue}var y=b.v;switch(b.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(o[v]!=null){if(y==null)if(b.t=="e"&&y===null)m[o[v]]=null;else if(f!==void 0)m[o[v]]=f;else if(g&&y===null)m[o[v]]=null;else continue;else m[o[v]]=g&&(b.t!=="n"||b.t==="n"&&c.rawNumbers!==!1)?y:Wa(b,y,c);y!=null&&(p=!1)}}return{row:m,isempty:p}}function sh(i,t){if(i==null||i["!ref"]==null)return[];var e={t:"n",v:0},n=0,r=1,o=[],l=0,c="",h={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},g=f.range!=null?f.range:i["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof g){case"string":h=Xe(g);break;case"number":h=Xe(i["!ref"]),h.s.r=g;break;default:h=g}n>0&&(r=0);var p=In(h.s.r),m=[],v=[],b=0,y=0,A=Array.isArray(i),S=h.s.r,w=0,E={};A&&!i[S]&&(i[S]=[]);var D=f.skipHidden&&i["!cols"]||[],P=f.skipHidden&&i["!rows"]||[];for(w=h.s.c;w<=h.e.c;++w)if(!(D[w]||{}).hidden)switch(m[w]=jn(w),e=A?i[S][w]:i[m[w]+p],n){case 1:o[w]=w-h.s.c;break;case 2:o[w]=m[w];break;case 3:o[w]=f.header[w-h.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),c=l=Wa(e,null,f),y=E[l]||0,!y)E[l]=1;else{do c=l+"_"+y++;while(E[c]);E[l]=y,E[c]=1}o[w]=c}for(S=h.s.r+r;S<=h.e.r;++S)if(!(P[S]||{}).hidden){var L=ND(i,h,S,m,n,o,A,f);(L.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(v[b++]=L.row)}return v.length=b,v}var y2=/"/g;function FD(i,t,e,n,r,o,l,c){for(var h=!0,f=[],g="",p=In(e),m=t.s.c;m<=t.e.c;++m)if(n[m]){var v=c.dense?(i[e]||[])[m]:i[n[m]+p];if(v==null)g="";else if(v.v!=null){h=!1,g=""+(c.rawNumbers&&v.t=="n"?v.v:Wa(v,null,c));for(var b=0,y=0;b!==g.length;++b)if((y=g.charCodeAt(b))===r||y===o||y===34||c.forceQuotes){g='"'+g.replace(y2,'""')+'"';break}g=="ID"&&(g='"ID"')}else v.f!=null&&!v.F?(h=!1,g="="+v.f,g.indexOf(",")>=0&&(g='"'+g.replace(y2,'""')+'"')):g="";f.push(g)}return c.blankrows===!1&&h?null:f.join(l)}function sg(i,t){var e=[],n=t??{};if(i==null||i["!ref"]==null)return"";var r=Xe(i["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,h=c.charCodeAt(0),f=new RegExp((o=="|"?"\\|":o)+"+$"),g="",p=[];n.dense=Array.isArray(i);for(var m=n.skipHidden&&i["!cols"]||[],v=n.skipHidden&&i["!rows"]||[],b=r.s.c;b<=r.e.c;++b)(m[b]||{}).hidden||(p[b]=jn(b));for(var y=0,A=r.s.r;A<=r.e.r;++A)(v[A]||{}).hidden||(g=FD(i,r,A,p,l,h,o,n),g!=null&&(n.strip&&(g=g.replace(f,"")),(g||n.blankrows!==!1)&&e.push((y++?c:"")+g)));return delete n.dense,e.join("")}function Dx(i,t){t||(t={}),t.FS="	",t.RS=`
`;var e=sg(i,t);return e}function LD(i){var t="",e,n="";if(i==null||i["!ref"]==null)return[];var r=Xe(i["!ref"]),o="",l=[],c,h=[],f=Array.isArray(i);for(c=r.s.c;c<=r.e.c;++c)l[c]=jn(c);for(var g=r.s.r;g<=r.e.r;++g)for(o=In(g),c=r.s.c;c<=r.e.c;++c)if(t=l[c]+o,e=f?(i[g]||[])[c]:i[t],n="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;n=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)n=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)n=""+e.v;else if(e.t=="b")n=e.v?"TRUE":"FALSE";else if(e.w!==void 0)n="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?n="'"+e.v:n=""+e.v}}h[h.length]=t+"="+n}return h}function Ox(i,t,e){var n=e||{},r=+!n.skipHeader,o=i||{},l=0,c=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?En(n.origin):n.origin;l=h.r,c=h.c}var f,g={s:{c:0,r:0},e:{c,r:l+t.length-1+r}};if(o["!ref"]){var p=Xe(o["!ref"]);g.e.c=Math.max(g.e.c,p.e.c),g.e.r=Math.max(g.e.r,p.e.r),l==-1&&(l=p.e.r+1,g.e.r=l+t.length-1+r)}else l==-1&&(l=0,g.e.r=t.length-1+r);var m=n.header||[],v=0;t.forEach(function(y,A){Un(y).forEach(function(S){(v=m.indexOf(S))==-1&&(m[v=m.length]=S);var w=y[S],E="z",D="",P=Pe({c:c+v,r:l+A+r});f=Wl(o,P),w&&typeof w=="object"&&!(w instanceof Date)?o[P]=w:(typeof w=="number"?E="n":typeof w=="boolean"?E="b":typeof w=="string"?E="s":w instanceof Date?(E="d",n.cellDates||(E="n",w=ui(w)),D=n.dateNF||nn[14]):w===null&&n.nullError&&(E="e",w=0),f?(f.t=E,f.v=w,delete f.w,delete f.R,D&&(f.z=D)):o[P]=f={t:E,v:w},D&&(f.z=D))})}),g.e.c=Math.max(g.e.c,c+m.length-1);var b=In(l);if(r)for(v=0;v<m.length;++v)o[jn(v+c)+b]={t:"s",v:m[v]};return o["!ref"]=pn(g),o}function BD(i,t){return Ox(null,i,t)}function Wl(i,t,e){if(typeof t=="string"){if(Array.isArray(i)){var n=En(t);return i[n.r]||(i[n.r]=[]),i[n.r][n.c]||(i[n.r][n.c]={t:"z"})}return i[t]||(i[t]={t:"z"})}return typeof t!="number"?Wl(i,Pe(t)):Wl(i,Pe({r:t,c:e||0}))}function ID(i,t){if(typeof t=="number"){if(t>=0&&i.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=i.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function UD(){return{SheetNames:[],Sheets:{}}}function zD(i,t,e,n){var r=1;if(!e)for(;r<=65535&&i.SheetNames.indexOf(e="Sheet"+r)!=-1;++r,e=void 0);if(!e||i.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&i.SheetNames.indexOf(e)>=0){var o=e.match(/(^.*?)(\d+)$/);r=o&&+o[2]||0;var l=o&&o[1]||e;for(++r;r<=65535&&i.SheetNames.indexOf(e=l+r)!=-1;++r);}if(_x(e),i.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return i.SheetNames.push(e),i.Sheets[e]=t,e}function HD(i,t,e){i.Workbook||(i.Workbook={}),i.Workbook.Sheets||(i.Workbook.Sheets=[]);var n=ID(i,t);switch(i.Workbook.Sheets[n]||(i.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}i.Workbook.Sheets[n].Hidden=e}function jD(i,t){return i.z=t,i}function Rx(i,t,e){return t?(i.l={Target:t},e&&(i.l.Tooltip=e)):delete i.l,i}function GD(i,t,e){return Rx(i,"#"+t,e)}function VD(i,t,e){i.c||(i.c=[]),i.c.push({t,a:e||"SheetJS"})}function XD(i,t,e,n){for(var r=typeof t!="string"?t:Xe(t),o=typeof t=="string"?t:pn(t),l=r.s.r;l<=r.e.r;++l)for(var c=r.s.c;c<=r.e.c;++c){var h=Wl(i,l,c);h.t="n",h.F=o,delete h.v,l==r.s.r&&c==r.s.c&&(h.f=e,n&&(h.D=!0))}return i}var yo={encode_col:jn,encode_row:In,encode_cell:Pe,encode_range:pn,decode_col:Y0,decode_row:W0,split_cell:oE,decode_cell:En,decode_range:Ti,format_cell:Wa,sheet_add_aoa:Py,sheet_add_json:Ox,sheet_add_dom:Ex,aoa_to_sheet:So,json_to_sheet:BD,table_to_sheet:Tx,table_to_book:mD,sheet_to_csv:sg,sheet_to_txt:Dx,sheet_to_json:sh,sheet_to_html:wx,sheet_to_formulae:LD,sheet_to_row_object_array:sh,sheet_get_cell:Wl,book_new:UD,book_append_sheet:zD,book_set_sheet_visibility:HD,cell_set_number_format:jD,cell_set_hyperlink:Rx,cell_set_internal_link:GD,cell_add_comment:VD,sheet_set_array_formula:XD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function KD(i){const t=i.filter(l=>l.success);if(t.length===0)throw new Error("Tidak ada PDF yang berhasil di-parse");const e=WD(t),n=yo.aoa_to_sheet(e);YD(n);const r=yo.book_new();yo.book_append_sheet(r,n,"Bukti Potong");const o=rg(r,{bookType:"xlsx",type:"array"});return new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}function WD(i){const t=[["Nomor Bukti Pemotongan","Masa Pajak","Sifat Pemotongan","Status Bukti Pemotongan","NIK Penerima Penghasilan","Nama Penerima Penghasilan","Kode Objek Pajak","Nama Objek Pajak","Penghasilan Bruto","PPh Dipotong","Nama Pemotong","Tanggal Pemotong PPh"]];for(const r of i){const o=r.data;t.push([o.nomor_bukti||"",o.masa_pajak||"",o.sifat_pemotongan||"",o.status_bukti||"",o.nik||"",o.nama_penerima||"",o.kode_objek_pajak||"",o.nama_objek_pajak||"",o.penghasilan_bruto||0,o.pph_dipotong||0,o.nama_pemotong||"",o.tanggal_pemotong||""])}const e=i.reduce((r,o)=>r+(o.data.penghasilan_bruto||0),0),n=i.reduce((r,o)=>r+(o.data.pph_dipotong||0),0);return t.push([]),t.push(["","","","","","","","TOTAL:",e,n,"",""]),t}function YD(i){i["!cols"]=[{wch:20},{wch:12},{wch:15},{wch:15},{wch:25},{wch:35},{wch:15},{wch:60},{wch:18},{wch:15},{wch:40},{wch:20}]}ts.workerSrc=new URL("/coretax_bukpot_pdf_to_excel/assets/pdf.worker.min-LyOxJPrg.mjs",import.meta.url).toString();const qD={"22-100-01":"Pembelian barang oleh Bendahara Pemerintah","22-100-02":"Pembelian barang oleh BUMN/BUMD","22-100-07":"Penjualan Hasil Produksi Kepada Distributor di Dalam Negeri oleh Badan Usaha/Industri Tertentu (Industri Semen)","22-100-08":"Penjualan Hasil Produksi Kepada Distributor di Dalam Negeri oleh Badan Usaha/Industri Tertentu (Industri Baja)","22-100-09":"Penjualan Hasil Produksi Kepada Distributor di Dalam Negeri oleh Badan Usaha/Industri Tertentu (Industri Otomotif)","22-100-10":"Penjualan Hasil Produksi Kepada Distributor di Dalam Negeri oleh Badan Usaha/Industri Tertentu (Industri Farmasi)","22-100-11":"Penjualan Hasil Produksi Kepada Distributor di Dalam Negeri oleh Badan Usaha/Industri Tertentu (industri Kertas)","22-100-12":"Penjualan Kendaraan Bermotor di Dalam Negeri oleh ATPM, APM dan Importir Umum Kendaraan Bermotor","22-100-13":"Pembelian oleh Badan Usaha Berupa Komoditas Tambang Batubara, Mineral Logam dan Mineral Bukan Logam dari Badan atau Orang Pribadi Pemegang IUP","22-100-14":"Penjualan Emas Batangan di Dalam Negeri oleh Badan Usaha","22-100-15":"Pembelian Bahan Hasil Kehutanan yang Belum Melalui Proses Industri Manufaktur, untuk Keperluan Industrinya/Ekspornya oleh Badan Usaha Industri/Eksportir","22-100-16":"Pembelian Bahan Hasil Perkebunan yang Belum Melalui Proses Industri Manufaktur, untuk Keperluan Industrinya/Ekspornya Oleh Badan Usaha Industri/Eksportir","22-100-17":"Pembelian Bahan Hasil Pertanian yang Belum Melalui Proses Industri Manufaktur, untuk Keperluan Industrinya/Ekspornya Oleh Badan Usaha Industri/Eksportir","22-100-18":"Pembelian Bahan Hasil Peternakan yang Belum Melalui Proses Industri Manufaktur, untuk Keperluan Industrinya/Ekspornya Oleh Badan Usaha Industri/Eksportir","22-100-19":"Pembelian Bahan Hasil Perikanan yang Belum Melalui Proses Industri Manufaktur, untuk Keperluan Industrinya/Ekspornya Oleh Badan Usaha Industri/Eksportir","22-100-20":"Penjualan BBM oleh Pertamina atau Anak Perusahaan Pertamina Kepada Selain SPBU/Agen/Penyalur (Tidak Final)","22-100-21":"Penjualan BBM oleh Badan Usaha Selain Pertamina atau Anak Perusahaan Pertamina Kepada Selain SPBU/Agen/Penyalur (Tidak Final)","22-100-22":"Penjualan Pelumas oleh Importir/Produsen","22-100-23":"Penjualan  Pulsa dan Kartu Perdana oleh Penyelenggara Distribusi Tingkat Kedua yang Merupakan Pemungut PPh Pasal 22","22-100-24":"Penjualan BBG oleh Produsen/Importir Kepada Selain SPBU/Agen/Penyalur (Tidak Final)","22-100-25":"Penjualan Emas Batangan di Dalam Negeri oleh Pengusaha Emas Perhiasan dan/atau Emas Batangan","22-100-26":"Penjualan Emas Perhiasan di Dalam Negeri oleh Pengusaha Emas Perhiasan dan/atau Emas Batangan","22-100-27":"Penjualan Perhiasan Selain dari Emas dan/atau Batu Permata dan/atau Batu Lainnya yang Sejenis oleh Pengusaha Emas Perhiasan dan/atau Emas Batangan","22-100-28":"Pembelian emas batangan oleh Lembaga Jasa Keuangan penyelenggara Kegiatan Usaha Bulion","22-101-01":"Penghasilan Sehubungan dengan Transaksi Penjualan Barang, Penyerahan Jasa, dan/atau Persewaan serta Penghasilan Lain Sehubungan dengan Penggunaan Harta yang Dilakukan Melalui Pihak Lain dalam Sistem Informasi Pengadaan Pemerintah (Tidak Final)","22-101-02":"Penghasilan Sehubungan dengan Transaksi Penjualan Barang, Penyerahan Jasa, dan/atau Persewaan serta Penghasilan Lain Sehubungan dengan Penggunaan Harta yang Dilakukan Melalui Pihak Lain dalam Sistem Informasi Pengadaan Pemerintah (Final)","22-102-01":"Penghasilan yang Diterima atau Diperoleh Pedagang Dalam Negeri Penjualan Barang, Penyerahan Jasa, dan/atau Persewaan serta Penghasilan Lain Sehubungan dengan Penggunaan Harta yang Dilakukan Melalui Perdagangan Melalui Sistem Elektronik (Tidak Final)","22-102-02":"Penghasilan yang Diterima atau Diperoleh Pedagang Dalam Negeri Penjualan Barang, Penyerahan Jasa, dan/atau Persewaan serta Penghasilan Lain Sehubungan dengan Penggunaan Harta yang Dilakukan Melalui Perdagangan Melalui Sistem Elektronik (Final)","22-401-01":"Penjualan BBM oleh Pertamina atau Anak Perusahaan Pertamina Kepada SPBU (Final)","22-401-02":"Penjualan BBM oleh Badan Usaha Selain Pertamina atau Anak Perusahaan Pertamina Kepada SPBU/Agen/Penyalur  (Final)","22-401-03":"Penjualan BBG oleh produsen/importir Kepada SPBU/Agen/Penyalur (Final)","22-401-04":"Penjualan BBM oleh Pertamina atau Anak Perusahaan Pertamina kepada Agen/Penyalur selain SPBU (Final)","22-401-05":"Penjualan BBM oleh Badan Usaha Selain Pertamina atau Anak Perusahaan Pertamina Kepada SPBU/Agen/Penyalur  (Final) sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","22-403-01":"Penjualan Barang yang Tergolong Sangat Mewah Selain Rumah Beserta Tanahnya, Apartemen, Kondominium dan Sejenisnya","22-403-02":"Penjualan Barang yang Tergolong Sangat Mewah Untuk Rumah Beserta Tanahnya, Apartemen, Kondominium dan Sejenisnya","22-404-01":"Ekspor Komoditas Tambang Batubara, Mineral Logam, dan Mineral Bukan Logam yang Dilakukan Oleh Eksportir, Kecuali WP yang Terikat dalam PKP2B dan KK","22-405-01":"Penghasilan Sehubungan dengan Aset Kripto yang dipungut oleh Penyelenggara Perdagangan Melalui Sistem Elektronik yang Merupakan Pedagang Fisik Aset Kripto","22-405-02":"Penghasilan Sehubungan dengan Aset Kripto yang dipungut oleh Penyelenggara Perdagangan Melalui Sistem Elektronik yang Bukan Merupakan Pedagang Fisik Aset Kripto","22-405-04":"Penghasilan Sehubungan dengan Aset Kripto yang dipungut oleh Penyelenggara Perdagangan Melalui Sistem Elektronik Dalam Negeri yang Merupakan Pedagang Aset Keuangan Digital","22-405-05":"Penghasilan Sehubungan dengan Aset Kripto yang dipungut oleh Penyelenggara Perdagangan Melalui Sistem Elektronik Luar Negeri yang Merupakan Pemungut Pajak Penghasilan","22-406-01":"PPh pasal 22 yang terutang atas penghasilan Kontraktor Utama sehubungan pelaksanaan proyek pemerintah yang dibiayai Hibah atau Pinjaman Luar Negeri","22-900-01":"Pembayaran atas Pembelian Barang dan/atau Bahan untuk Kegiatan Usahanya oleh BUMN/Badan Usaha Tertentu","22-910-01":"Pemungutan oleh Bendaharawan","24-100-01":"Hadiah, Penghargaan, Bonus dan Lainnya Selain yang Telah Dipotong PPh Pasal 21 Ayat (1) Huruf E UU PPh","24-100-02":"Sewa dan Penghasilan Lain Sehubungan Dengan Penggunaan Harta Kecuali Sewa Tanah dan/atau Bangunan yang Telah Dikenai PPh Pasal 4 Ayat (2) UU PPh.","24-101-01":"Dividen","24-102-01":"Bunga Selain yang Dikenakan PPh Pasal 4 ayat (2)","24-103-01":"Royalti","24-103-02":"Royalti yang diterima atau diperoleh Wajib Pajak orang pribadi dalam negeri yang menerapkan penghitungan Pajak Penghasilan menggunakan Norma Penghitungan Penghasilan Neto","24-104-01":"Jasa Teknik","24-104-02":"Jasa Manajemen","24-104-03":"Jasa Konsultan","24-104-04":"Jasa Penilai (Appraisal)","24-104-05":"Jasa Aktuaris","24-104-06":"Jasa Akuntansi, Pembukuan, dan Atestasi Laporan Keuangan","24-104-07":"Jasa Hukum","24-104-08":"Jasa Arsitektur","24-104-09":"Jasa Perencanaan Kota dan Arsitektur Landscape;","24-104-10":"Jasa Perancang (Design)","24-104-11":"Jasa Pengeboran (Drilling) di Bidang Penambangan Minyak dan Gas Bumi (Migas) Kecuali yang Dilakukan oleh Badan Usaha Tetap (BUT)","24-104-12":"Jasa Penunjang di Bidang Usaha Panas Bumi dan Penambangan Minyak dan Gas Bumi (Migas)","24-104-13":"Jasa Penambangan dan Jasa Penunjang Selain di Bidang Usaha Panas Bumi dan Penambangan Minyak dan Gas Bumi (Migas)","24-104-14":"Jasa Penunjang di Bidang Penerbangan dan Bandar Udara","24-104-15":"Jasa Penebangan Hutan","24-104-16":"Jasa Pengolahan Limbah","24-104-17":"Jasa Penyedia Tenaga Kerja dan/atau Tenaga Ahli (Outsourcing Services)","24-104-18":"Jasa Perantara dan/atau Keagenan","24-104-19":"Jasa Bidang Perdagangan Surat-Surat Berharga, Kecuali yang Dilakukan Bursa Efek, Kustodian Sentral Efek Indonesia (KSEI) dan Kliring Penjaminan Efek Indonesia (KPEI)","24-104-20":"Jasa Kustodian/Penyimpanan/Penitipan, Kecuali yang Dilakukan Oleh KSEI","24-104-21":"Jasa Pengisian Suara (Dubbing) dan/atau Sulih Suara","24-104-22":"Jasa Mixing Film","24-104-23":"Jasa Pembuatan Sarana Promosi Film, Iklan, Poster, Foto, Slide, Klise, Banner, Pamphlet, Baliho dan Folder","24-104-24":"Jasa Sehubungan Dengan Software Atau Hardware Atau Sistem Komputer, Termasuk Perawatan, Pemeliharaan dan Perbaikan.","24-104-25":"Jasa Pembuatan dan/atau Pengelolaan Website","24-104-26":"Jasa Internet Termasuk Sambungannya","24-104-27":"Jasa Penyimpanan, Pengolahan dan/atau Penyaluran Data, Informasi, dan/atau Program","24-104-28":"Jasa Instalasi/Pemasangan Mesin, Peralatan, Listrik, Telepon, Air, Gas, Ac dan/atau Tv Kabel, Selain Yang Dilakukan Oleh Wajib Pajak Yang Ruang Lingkupnya Di Bidang Konstruksi dan Mempunyai Izin dan/atau Sertifikasi Sebagai Pengusaha Konstruksi;","24-104-29":"Jasa Perawatan/Perbaikan/Pemeliharaan Mesin, Peralatan, Listrik, Telepon, Air, Gas, Ac dan/atau Tv Kabel, Selain Yang Dilakukan Oleh Wajib Pajak Yang Ruang Lingkupnya di Bidang Konstruksi dan Mempunyai Izin dan/atau Sertifikasi Sebagai Pengusaha Konstruksi","24-104-30":"Jasa Perawatan Kendaraan dan/atau Alat Transportasi Darat, Laut dan Udara","24-104-31":"Jasa Maklon","24-104-32":"Jasa Penyelidikan dan Keamanan","24-104-33":"Jasa Penyelenggara Kegiatan Atau Event Organizer","24-104-34":"Jasa Penyediaan Tempat dan/atau Waktu Dalam Media Massa, Media Luar Ruang Atau Media Lain Untuk Penyampaian Informasi, dan/atau Jasa Periklanan","24-104-35":"Jasa Pembasmian Hama","24-104-36":"Jasa Kebersihan Atau Cleaning Service","24-104-37":"Jasa Sedot Septic Tank","24-104-38":"Jasa Pemeliharaan Kolam","24-104-39":"Jasa Katering Atau Tata Boga","24-104-40":"Jasa Freight Forwarding","24-104-41":"Jasa Logistik","24-104-42":"Jasa Pengurusan Dokumen","24-104-43":"Jasa Pengepakan","24-104-44":"Jasa Loading dan Unloading","24-104-45":"Jasa Laboratorium dan/atau Pengujian Kecuali yang Dilakukan oleh Lembaga atau Institusi Pendidikan Dalam Rangka Penelitian Akademis","24-104-46":"Jasa Pengelolaan Parkir","24-104-47":"Jasa Penyondiran Tanah","24-104-48":"Jasa Penyiapan dan/atau Pengolahan Lahan","24-104-49":"Jasa Pembibitan dan/atau Penanaman Bibit","24-104-50":"Jasa Pemeliharaan Tanaman","24-104-51":"Jasa Pemanenan","24-104-52":"Jasa Pengolahan Hasil Pertanian, Perkebunan, Perikanan, Peternakan dan/atau Perhutanan","24-104-53":"Jasa Dekorasi","24-104-54":"Jasa Pencetakan/Penerbitan","24-104-55":"Jasa Penerjemahan","24-104-56":"Jasa Pengangkutan/Ekspedisi Kecuali Yang Telah Diatur Dalam Pasal 15 Undang-Undang Pajak Penghasilan","24-104-57":"Jasa Pelayanan Pelabuhan","24-104-58":"Jasa Pengangkutan Melalui Jalur Pipa","24-104-59":"Jasa Pengelolaan Penitipan Anak","24-104-60":"Jasa Pelatihan dan/atau Kursus","24-104-61":"Jasa Pengiriman dan Pengisian Uang Ke Atm","24-104-62":"Jasa Sertifikasi","24-104-63":"Jasa Survey","24-104-64":"Jasa Tester","24-104-65":"Jasa Selain Jasa-Jasa Tersebut di Atas yang Pembayarannya Dibebankan pada APBN (Anggaran Pendapatan dan Belanja Negara) Atau APBD (Anggaran Pendapatan dan Belanja Daerah).","24-104-66":"Jasa Penyelenggaraan Layanan Transaksi Pembayaran Terkait dengan Distribusi Token Oleh Penyelenggara Distribusi","24-104-67":"Jasa Pemasaran dengan Media Voucer Oleh Penyelenggara Voucer","24-104-68":"Jasa Penyelenggaraan Layanan Transaksi Pembayaran Terkait dengan Distribusi Voucer Oleh Penyelenggara Voucer dan Penyelenggara  Distribusi","24-104-69":"Jasa Penyelenggaraan Program Loyalitas dan Penghargaan Pelanggan (Consumer Loyalty/Reward Program)  Oleh Penyelenggara Voucer","24-105-01":"Bunga Pinjaman yang Diterima  Wajib Pajak Dalam Negeri dan Bentuk Usaha Tetap Melalui Layanan Pinjam Meminjam Uang Berbasis Teknologi Informasi","24-106-01":"PPh pasal 23 yang terutang atas penghasilan Kontraktor Utama sehubungan pelaksanaan proyek pemerintah yang dibiayai Hibah atau Pinjaman Luar Negeri","28-401-01":"Bunga Obligasi, Surat Utang Negara, atau Obligasi Daerah yang Diterima Wajib Pajak Dalam Negeri dan Bentuk Usaha Tetap.","28-401-03":"Bunga Obligasi yang Diterima Wajib Pajak Dalam Negeri dan Bentuk Usaha Tetap yang diadministrasikan oleh BI","28-401-04":"Diskonto Surat Perbendaharaan Negara yang Diterima Wajib Pajak Dalam Negeri dan Bentuk Usaha Tetap","28-401-05":"Diskonto Surat Perbendaharaan Negara yang Diterima Wajib Pajak Penduduk/Berkedudukan di Luar Negeri","28-401-06":"Bunga Obligasi yang Diterima Wajib Pajak Dalam Negeri dan Bentuk Usaha Tetap","28-402-01":"Pengalihan Hak atas Tanah dan/atau Bangunan","28-402-02":"Pengalihan Rumah Sederhana dan Rumah Susun Sederhana yang Dilakukan oleh WP yang Usaha Pokoknya Mengalihkan Hak atas Tanah dan/atau Bangunan","28-402-03":"Pengalihan Hak atas Tanah dan/atau Bangunan kepada Pemerintah, BUMN yang Mendapat Penugasan Khusus dari Pemerintah, atau BUMD yang Mendapat Penugasan Khusus dari Kepala Daerah, sesuai UU mengenai Pengadaan Tanah bagi Pembangunan untuk Kepentingan Umum","28-402-04":"Pengalihan Hak atas Tanah dan/atau Bangunan sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-403-02":"Persewaan Tanah dan/atau Bangunan","28-403-04":"Persewaan Tanah dan/atau Bangunan sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-404-01":"Bunga Tabungan dan Bunga Deposito yang Ditempatkan di Dalam Negeri yang Dananya Bersumber Selain dari Devisa Hasil Ekspor (DHE)","28-404-02":"Bunga Deposito yang Ditempatkan di Dalam Negeri (mata uang IDR bersumber dari DHE tenor 1 bulan)","28-404-03":"Bunga Deposito yang Ditempatkan di Dalam Negeri (mata uang IDR bersumber dari DHE tenor 3 bulan)","28-404-04":"Bunga Deposito yang Ditempatkan di Dalam Negeri (mata uang IDR bersumber dari DHE tenor 6 bulan atau lebih)","28-404-05":"Bunga Deposito yang Ditempatkan di Dalam Negeri (mata uang USD bersumber dari DHE tenor 1 bulan)","28-404-06":"Bunga Deposito yang Ditempatkan di Dalam Negeri (mata uang USD bersumber dari DHE tenor 3 bulan)","28-404-07":"Bunga Deposito yang Ditempatkan di Dalam Negeri (mata uang USD bersumber dari DHE tenor 6 bulan)","28-404-08":"Bunga Deposito yang Ditempatkan di Dalam Negeri (mata uang USD bersumber dari DHE tenor lebih 6 bulan)","28-404-09":"Bunga Deposito/Tabungan yang Ditempatkan di Luar Negeri Melalui Bank yang Didirikan atau Bertempat Kedudukan di Indonesia atau Cabang Bank Luar Negeri di Indonesia","28-404-10":"Diskonto Sertifikat Bank Indonesia","28-404-11":"Jasa Giro","28-404-12":"Penghasilan dari Instrumen Moneter dan/atau Instrumen Keuangan Tertentu di Indonesia (Mata Uang VALAS Bersumber dari DHE SDA Tenor Lebih Dari 6 Bulan)","28-404-13":"Penghasilan dari Instrumen Moneter dan/atau Instrumen Keuangan Tertentu di Indonesia (Mata Uang VALAS Bersumber dari DHE SDA Tenor 6 Bulan)","28-404-14":"Penghasilan dari Instrumen Moneter dan/atau Instrumen Keuangan Tertentu di Indonesia (Mata Uang VALAS Bersumber dari DHE SDA Tenor Lebih Dari 3 Bulan sampai dengan Kurang Dari 6 Bulan)","28-404-15":"Penghasilan dari Instrumen Moneter dan/atau Instrumen Keuangan Tertentu di Indonesia (Mata Uang VALAS Bersumber dari DHE SDA Tenor 1 Bulan sampai dengan Kurang Dari 3 Bulan)","28-404-16":"Penghasilan dari Instrumen Moneter dan/atau Instrumen Keuangan Tertentu di Indonesia (Mata Uang IDR Bersumber dari DHE SDA Tenor 6 Bulan atau Lebih Dari 6 Bulan)","28-404-17":"Penghasilan dari Instrumen Moneter dan/atau Instrumen Keuangan Tertentu di Indonesia (Mata Uang VALAS Bersumber dari DHE SDA Tenor 3 Bulan sampai dengan Kurang Dari 6 Bulan)","28-404-18":"Penghasilan dari instrumen moneter dan/atau instrumen keuangan tertentu di Indonesia (mata uang IDR bersumber dari DHE SDA tenor 1 bulan sampai dengan kurang dari 3 bulan)","28-405-01":"Hadiah Undian","28-406-01":"Transaksi Penjualan Saham di Bursa Efek (Bukan Saham Pendiri)","28-407-01":"Transaksi Penjualan Saham di Bursa Efek (Saham Pendiri)","28-408-01":"Transaksi Penjualan Saham Milik Perusahaan Modal Ventura Tidak di Bursa Efek","28-409-22":"Pekerjaan Konstruksi yang Dilakukan oleh Penyedia Jasa yang Memiliki Sertifikat Badan Usaha Kualifikasi Kecil atau Sertifikat Kompetensi Kerja untuk Usaha Orang Perseorangan","28-409-23":"Pekerjaan Konstruksi yang Dilakukan oleh Penyedia Jasa yang Tidak Memiliki Sertifikat Badan Usaha Atau Sertifikat Kompetensi Kerja untuk Usaha Orang Perseorangan","28-409-24":"Pekerjaan Konstruksi yang Dilakukan oleh Penyedia Jasa yang Memiliki Sertifikat Selain Sertifikat Badan Usaha Kualifikasi Kecil atau Sertifikat Kompetensi Kerja untuk Usaha Orang Perseorangan","28-409-25":"Pekerjaan Konstruksi Terintegrasi yang Dilakukan oleh Penyedia Jasa yang Memiliki Sertifikat Badan Usaha","28-409-26":"Pekerjaan Konstruksi Terintegrasi yang Dilakukan oleh Penyedia Jasa yang Tidak Memiliki Sertifikat Badan Usaha","28-409-27":"Jasa Konsultansi Konstruksi yang Dilakukan oleh Penyedia Jasa yang Memiliki Sertifikat Badan Usaha atau Sertifikat Kompetensi Kerja untuk Usaha Orang Perseorangan","28-409-28":"Jasa Konsultansi Konstruksi yang Dilakukan oleh Penyedia Jasa yang Tidak Memiliki Sertifikat Badan Usaha atau Sertifikat Kompetensi Kerja untuk Usaha Orang Perseorangan","28-409-43":"Pekerjaan Konstruksi yang Dilakukan oleh Penyedia Jasa yang Memiliki Sertifikat Badan Usaha Kualifikasi Kecil atau Sertifikat Kompetensi Kerja untuk Usaha Orang Perseorangan sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-44":"Pekerjaan Konstruksi yang Dilakukan oleh Penyedia Jasa yang Tidak Memiliki Sertifikat Badan Usaha Atau Sertifikat Kompetensi Kerja untuk Usaha Orang Perseorangan sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-45":"Pekerjaan Konstruksi yang Dilakukan oleh Penyedia Jasa yang Memiliki Sertifikat Selain Sertifikat Badan Usaha Kualifikasi Kecil atau Sertifikat Kompetensi Kerja untuk Usaha Orang Perseorangan sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-46":"Pekerjaan Konstruksi Terintegrasi yang Dilakukan oleh Penyedia Jasa yang Memiliki Sertifikat Badan Usaha sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-47":"Pekerjaan Konstruksi Terintegrasi yang Dilakukan oleh Penyedia Jasa yang Tidak Memiliki Sertifikat Badan Usaha sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-48":"Jasa Konsultansi Konstruksi yang Dilakukan oleh Penyedia Jasa yang Memiliki Sertifikat Badan Usaha atau Sertifikat Kompetensi Kerja untuk Usaha Orang Perseorangan sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-49":"Jasa Konsultansi Konstruksi yang Dilakukan oleh Penyedia Jasa yang Tidak Memiliki Sertifikat Badan Usaha atau Sertifikat Kompetensi Kerja untuk Usaha Orang Perseorangan sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-50":"Jasa Konstruksi Berupa Jasa Perencanaan Konstruksi (Dengan Kualifikasi Usaha) sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-51":"Jasa Konstruksi Berupa Jasa Perencanaan Konstruksi (Tanpa Kualifikasi Usaha) sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-52":"Jasa Konstruksi Berupa Jasa Pelaksanaan Konstruksi (Kualifikasi Usaha Kecil) sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-53":"Jasa Konstruksi Berupa Jasa Pelaksanaan Konstruksi (Kualifikasi Usaha Menengah dan Besar) sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-54":"Jasa Konstruksi Berupa Jasa Pelaksanaan Konstruksi (Tanpa Kualifikasi Usaha) sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-55":"Jasa Konstruksi Berupa Jasa Pengawasan Konstruksi (Dengan Kualifikasi Usaha) sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-409-56":"Jasa Konstruksi Berupa Jasa Pengawasan Konstruksi (Tanpa Kualifikasi Usaha) sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-410-01":"Imbalan yang Diterima/Diperoleh Sehubungan dengan Pengangkutan Orang dan/atau Barang Termasuk Penyewaan Kapal Laut Oleh Perusahaan Pelayaran Dalam Negeri","28-410-02":"Imbalan yang Dibayarkan/Terutang kepada Perusahaan Pelayaran Dalam Negeri","28-410-05":"Imbalan yang Diterima/Diperoleh Sehubungan dengan Pengangkutan Orang dan/atau Barang Termasuk Penyewaan Kapal Laut Oleh Perusahaan Pelayaran Dalam Negeri sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-410-06":"Imbalan yang Dibayarkan/Terutang kepada Perusahaan Pelayaran Dalam Negeri sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-411-01":"Imbalan yang Dibayarkan/Terutang kepada Perusahaan Pelayaran dan/atau Penerbangan Luar Negeri Sehubungan dengan Pengangkutan Orang dan/atau Barang (Selain Berdasarkan Perjanjian Charter)","28-411-02":"Imbalan Charter Kapal Laut dan/atau Pesawat Udara yang Dibayarkan/ Terutang kepada Perusahaan Pelayaran dan/atau Penerbangan Luar Negeri  melalui BUT di Indonesia","28-411-04":"Imbalan yang Dibayarkan/Terutang kepada Perusahaan Pelayaran dan/atau Penerbangan Luar Negeri Sehubungan dengan Pengangkutan Orang dan/atau Barang (Selain Berdasarkan Perjanjian Charter) sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-411-05":"Imbalan Charter Kapal Laut dan/atau Pesawat Udara yang Dibayarkan/ Terutang kepada Perusahaan Pelayaran dan/atau Penerbangan Luar Negeri melalui BUT di Indonesia sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri","28-413-01":"Penghasilan Wajib Pajak Luar Negeri yang Mempunyai Kantor Perwakilan Dagang di Indonesia","28-417-01":"Bunga Simpanan yang Dibayarkan oleh Koperasi kepada Anggota Wajib Pajak Orang Pribadi (bunga sampai dengan Rp240.000,00)","28-417-02":"Bunga Simpanan yang Dibayarkan oleh Koperasi kepada Anggota Wajib Pajak Orang Pribadi (bunga di atas Rp240.000,00)","28-419-01":"Dividen yang Diterima/Diperoleh Wajib Pajak Orang Pribadi Dalam Negeri","28-421-01":"Uplift Hulu Migas","28-421-02":"Participating Interest Eksplorasi Hulu Migas","28-421-03":"Participating Interest Eksploitasi Hulu Migas","28-423-01":"Pemotongan atau pemungutan PPh atas penjualan barang atau penyerahan jasa yang dilakukan oleh Wajib Pajak dengan peredaran bruto tertentu sesuai dengan Peraturan Pemerintah Nomor 23 Tahun 2018 atau Peraturan Pemerintah Nomor 55 Tahun 2022.","28-423-02":"Pemotongan atau pemungutan PPh atas transaksi pembelian yang dilakukan oleh Wajib Pajak dengan peredaran bruto tertentu sesuai dengan Peraturan Pemerintah Nomor 55 Tahun 2022.","28-423-03":"Pemotongan atau Pemungutan PPh atas transaksi penjualan barang atau penyerahan jasa yang dilakukan oleh Wajib Pajak orang pribadi yang memiliki peredaran bruto tertentu sesuai dengan PP 55 Tahun 2022 dengan peredaran usaha s.d Rp500.000.000,00.","28-423-12":"Pemotongan atau Pemungutan PPh atas transaksi penjualan barang atau penyerahan jasa yang dilakukan oleh Wajib Pajak yang memenuhi persyaratan tertentu untuk dikenai PPh yang bersifat final dengan tarif 0% di IKN (PPh UMKM di IKN).","28-423-13":"Pemotongan atau pemungutan PPh atas transaksi pembelian yang dilakukan oleh Wajib Pajak yang memanfaatkan fasilitas PPh final dengan tarif 0% di IKN (PPh UMKM di IKN).","28-423-14":"Pemotongan atau pemungutan PPh atas penjualan barang atau penyerahan jasa yang dilakukan oleh Wajib Pajak dengan peredaran bruto tertentu yang memperoleh penghasilan sehubungan pelaksanaan proyek pemerintah yang dibiayai Hibah atau Pinjaman Luar Negeri","28-423-15":"Pemotongan atau Pemungutan PPh atas transaksi penjualan barang atau penyerahan jasa yang dilakukan oleh Wajib Pajak yang memenuhi persyaratan tertentu untuk dikenai PPh yang bersifat final dengan tarif 0% di IKN yang memperoleh penghasilan sehubungan pelaksanaan proyek pemerintah yang dibiayai Hibah atau Pinjaman Luar Negeri","28-499-01":"Penghasilan Wajib Pajak yang Melakukan Kegiatan Usaha Jasa Maklon (Contract Manufacturing) Internasional di Bidang Produksi Mainan Anak-Anak","28-499-02":"Penghasilan yang Diterima atau Diperoleh Sehubungan dengan Kerja Sama dengan Lembaga Pengelola Investasi (LPI)","29-101-01":"Imbalan Charter Pesawat Udara yang Dibayarkan/Terutang kepada Perusahaan Penerbangan Dalam Negeri oleh Pemotong Pajak","29-101-02":"Imbalan Charter Pesawat Udara yang Dibayarkan/Terutang kepada Perusahaan Penerbangan Dalam Negeri oleh Pemotong Pajak sehubungan Pelaksanaan Proyek Pemerintah yang Dibiayai dengan Hibah atau Dana Pinjaman Luar Negeri"};function $D(i){console.log("=== Raw PDF Text (first 2500 chars) ==="),console.log(i.substring(0,2500));const t=i.replace(/[\r\n]+/g," ").trim(),e=(r,o)=>{for(const l of o){const c=r.match(l);if(c&&c[1])return console.log("Match found:",c[1]),c[1].trim()}return""},n={nomor_bukti:e(t,[/PEMUNGUTAN\s+([A-Z0-9]+)\s+(\d{2}-\d{4})/i]),masa_pajak:e(t,[/PEMUNGUTAN\s+[A-Z0-9]+\s+(\d{2}-\d{4})/i]),npwp_nik:e(t,[/A\.1\s+[^:]+?:\s*([\d.]+)/i]),nama:e(t,[/A\.2\s+NAMA\s*[^:]*?:\s*([A-Z][A-Z\s]+?)(?=\s+A\.3|\s+B\.)/i]),nitku:e(t,[/A\.3\s+[^:]+?:\s*([\d.]+)/i]),kode_objek_pajak:e(t,[/B\.3\s+B\.4\s+B\.5\s+B\.6\s+B\.7[^0-9]*?(\d{2}-\d{3}-\d{2})/i,/(\d{2}-\d{3}-\d{2})/i]),dpp:e(t,[/\d{2}-\d{3}-\d{2}[\s\S]+?\s+([\d.,]+)\s+[\d.,]+\s+[\d.,]+/i]),tarif:e(t,[/\d{2}-\d{3}-\d{2}[\s\S]+?\s+[\d.,]+\s+([\d.,]+)\s+[\d.,]+/i]),pph:e(t,[/\d{2}-\d{3}-\d{2}[\s\S]+?\s+[\d.,]+\s+[\d.,]+\s+([\d.,]+)/i]),nomor_dokumen:e(t,[/B\.9\s+Nomor\s+Dokumen\s*:\s*([0-9]+)/i]),nama_pemotong:e(t,[/C\.3\s+NAMA\s+[^:]+?:\s*([A-Z][A-Z\s]+?)(?=\s+C\.4|\s+IDENTITAS)/i]),tanggal_pemotong:e(t,[/C\.4\s+TANGGAL\s+[^:]+?:\s*(\d{1,2}\s+\w+\s+\d{4})/i,/C\.4\s+[^:]+?:\s*(\d{1,2}\s+\w+\s+\d{4})/i])};return console.log("=== Extracted Data ==="),console.log(JSON.stringify(n,null,2)),n.nama&&(n.nama=n.nama.replace(/\s+A\s*\.?\d*$/,"").trim()),n.kode_objek_pajak?n.objek_pajak=qD[n.kode_objek_pajak]||"":n.objek_pajak="",n.dpp&&(n.dpp=parseFloat(n.dpp.replace(/\./g,"").replace(/,/g,"."))||0),n.pph&&(n.pph=parseFloat(n.pph.replace(/\./g,"").replace(/,/g,"."))||0),n}async function ZD(i,t){try{const n=await R0(i).promise;let r="";for(let l=1;l<=n.numPages;l++){const f=(await(await n.getPage(l)).getTextContent()).items.map(g=>g.str).join(" ");r+=f+" "}const o=$D(r);return{fileName:t,success:Object.values(o).some(l=>l!==""),data:o}}catch(e){return console.error(`Error parsing PDF ${t}:`,e),{fileName:t,success:!1,error:e.message}}}async function JD(i,t){const e=new J2;try{t({percentage:10,message:"Membuka file ZIP...",current:0,total:0});const n=await e.loadAsync(i),r=[];if(n.forEach((h,f)=>{f.name.toLowerCase().endsWith(".pdf")&&!f.dir&&r.push(f)}),r.length===0)throw new Error("Tidak ada file PDF ditemukan dalam arsip ZIP");t({percentage:20,message:`Ditemukan ${r.length} file PDF`,current:0,total:r.length});const o=[],l=70/r.length;for(let h=0;h<r.length;h++){const f=r[h];t({percentage:20+h*l,message:`Memproses ${f.name}...`,current:h+1,total:r.length});const g=await f.async("arraybuffer"),p=await ZD(g,f.name);o.push(p)}const c=o.filter(h=>h.success).map(h=>({fileName:h.fileName,...h.data}));if(c.length===0)throw new Error("Tidak ada PDF yang berhasil di-parse");return c}catch(n){throw n}}async function QD(i){if(!i||i.length===0)throw new Error("Tidak ada PDF yang berhasil di-parse");const t=[{header:"Nomor Bukti Potong",key:"nomor_bukti",width:25},{header:"Masa Pajak",key:"masa_pajak",width:15},{header:"NPWP/NIK",key:"npwp_nik",width:25},{header:"Nama",key:"nama",width:35},{header:"NITKU",key:"nitku",width:15},{header:"Kode Objek Pajak",key:"kode_objek_pajak",width:20},{header:"Objek Pajak",key:"objek_pajak",width:30},{header:"DPP (Rp)",key:"dpp",width:20},{header:"Tarif",key:"tarif",width:12},{header:"PPh (Rp)",key:"pph",width:20},{header:"Nomor Dokumen",key:"nomor_dokumen",width:25},{header:"Nama Pemotong",key:"nama_pemotong",width:35},{header:"Tanggal Pemotongan",key:"tanggal_pemotong",width:20}],e=i.map(c=>{const h={};return t.forEach(f=>{h[f.header]=c[f.key]||""}),h}),n=yo.json_to_sheet(e);n["!cols"]=t.map(c=>({wch:c.width}));const r=yo.book_new();yo.book_append_sheet(r,n,"Bukti Potong Unifikasi");const o=rg(r,{bookType:"xlsx",type:"array"});return new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}function tO(){const[i,t]=pa.useState(()=>{const A=localStorage.getItem("darkMode");return A!==null?A==="true":window.matchMedia("(prefers-color-scheme: dark)").matches}),[e,n]=pa.useState(null),[r,o]=pa.useState("selection"),[l,c]=pa.useState({percentage:0,message:"",current:0,total:0}),[h,f]=pa.useState(null),[g,p]=pa.useState(null);pa.useEffect(()=>{i?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode"),localStorage.setItem("darkMode",i)},[i]);const m=()=>{t(!i)},v=A=>{n(A),o("idle")},b=async A=>{o("processing"),c({percentage:0,message:"Memuat file ZIP...",current:0,total:0});try{const S=e==="unifikasi"?await JD(A,c):await aw(A,c);if(S.length===0)throw new av("Tidak ada file PDF ditemukan dalam arsip ZIP");c(L=>({...L,percentage:95,message:"Membuat file Excel..."}));const w=e==="unifikasi"?await QD(S):await KD(S),E=e==="unifikasi"?"BuktiPotong_Unifikasi_Rekap.xlsx":"BuktiPotong_PPh21_Rekap.xlsx",D=URL.createObjectURL(w),P=document.createElement("a");P.href=D,P.download=E,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(D),f(S),c(L=>({...L,percentage:100,message:"Selesai!"})),o("complete")}catch(S){console.error("Error processing file:",S),p(S.message),o("error")}},y=()=>{o("selection"),n(null),c({percentage:0,message:"",current:0,total:0}),f(null),p(null)};return yt.jsxs("div",{className:"App",children:[yt.jsx("header",{className:"App-header",children:yt.jsxs("div",{className:"header-content",children:[yt.jsxs("div",{className:"logo",children:[yt.jsx("span",{className:"logo-icon",children:""}),yt.jsxs("div",{children:[yt.jsx("h1",{children:"Bukti Potong Converter"}),yt.jsx("p",{children:"Convert ZIP Bukti Potong ke Excel secara instan"})]})]}),yt.jsx("button",{className:"dark-mode-toggle",onClick:m,"aria-label":"Toggle dark mode",children:i?yt.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[yt.jsx("circle",{cx:"12",cy:"12",r:"5"}),yt.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),yt.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),yt.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),yt.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),yt.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),yt.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),yt.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),yt.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}):yt.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:yt.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})}),yt.jsxs("main",{className:"App-main",children:[r==="selection"&&yt.jsx($b,{onSelectMode:v}),r==="idle"&&yt.jsx(Zb,{onFileUpload:b,onBack:y,mode:e}),r==="processing"&&yt.jsx(Jb,{progress:l}),r==="complete"&&yt.jsx(Qb,{results:h,onReset:y,mode:e}),r==="error"&&yt.jsx(av,{message:g,onReset:y})]}),yt.jsxs("footer",{className:"App-footer",children:[yt.jsx("p",{children:" Privasi Terjaga  Semua proses di browser  Data tidak dikirim ke server"}),yt.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.75rem",opacity:.8},children:"Idea by Wahyu Budi Lestari. Powered by AFS"})]})]})}qb.createRoot(document.getElementById("root")).render(yt.jsx(pa.StrictMode,{children:yt.jsx(tO,{})}));
